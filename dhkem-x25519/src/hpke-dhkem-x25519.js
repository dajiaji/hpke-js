var mr={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33},te=mr,Er={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},ee=Er;function re(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function _r(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function Oe(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Br(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");re(e.outputLen),re(e.blockLen)}function Ar(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function vr(e,t){Oe(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var Sr={number:re,bool:_r,bytes:Oe,hash:Br,exists:Ar,output:vr},et=Sr;var Tt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var Te=e=>e instanceof Uint8Array;var Ct=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),X=(e,t)=>e<<32-t|e>>>t,Ir=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ir)throw new Error("Non little-endian hardware is not supported");var zn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ne(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function vt(e){if(typeof e=="string"&&(e=ne(e)),!Te(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Ce(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;return e.forEach(n=>{if(!Te(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var xt=class{clone(){return this._cloneInto()}};function ft(e){let t=n=>e().update(vt(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function oe(e=32){if(Tt&&typeof Tt.getRandomValues=="function")return Tt.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}var Nt=class extends xt{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,et.hash(t);let n=vt(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=t.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(t){return et.exists(this),this.iHash.update(t),this}digestInto(t){et.exists(this),et.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:s,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ie=(e,t,r)=>new Nt(e,t).update(r).digest();ie.create=(e,t)=>new Nt(e,t);function Lr(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),a=Number(r&i),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)}var wt=class extends xt{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ct(this.buffer)}update(t){et.exists(this);let{view:r,buffer:n,blockLen:o}=this;t=vt(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(o-this.pos,i-s);if(a===o){let c=Ct(t);for(;o<=i-s;s+=o)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){et.exists(this),et.output(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let h=s;h<o;h++)r[h]=0;Lr(n,o-8,BigInt(this.length*8),i),this.process(n,0);let a=Ct(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,f[h],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}};var Pr=(e,t,r)=>e&t^~e&r,Ur=(e,t,r)=>e&t^e&r^t&r,Hr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ut=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),lt=new Uint32Array(64),Rt=class extends wt{constructor(){super(64,32,8,!1),this.A=ut[0]|0,this.B=ut[1]|0,this.C=ut[2]|0,this.D=ut[3]|0,this.E=ut[4]|0,this.F=ut[5]|0,this.G=ut[6]|0,this.H=ut[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:a,H:c}=this;return[t,r,n,o,i,s,a,c]}set(t,r,n,o,i,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let h=0;h<16;h++,r+=4)lt[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){let b=lt[h-15],A=lt[h-2],I=X(b,7)^X(b,18)^b>>>3,L=X(A,17)^X(A,19)^A>>>10;lt[h]=L+lt[h-7]+I+lt[h-16]|0}let{A:n,B:o,C:i,D:s,E:a,F:c,G:u,H:f}=this;for(let h=0;h<64;h++){let b=X(a,6)^X(a,11)^X(a,25),A=f+b+Pr(a,c,u)+Hr[h]+lt[h]|0,L=(X(n,2)^X(n,13)^X(n,22))+Ur(n,o,i)|0;f=u,u=c,c=a,a=s+A|0,s=i,i=o,o=n,n=A+L|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,o,i,s,a,c,u,f)}roundClean(){lt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},se=class extends Rt{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},Ne=ft(()=>new Rt),Xn=ft(()=>new se);var rt=class extends Error{constructor(t){let r;t instanceof Error?r=t.message:typeof t=="string"?r=t:r="",super(r),this.name=this.constructor.name}},gt=class extends rt{};var mt=class extends rt{},bt=class extends rt{},Dt=class extends rt{},zt=class extends rt{};var qt=class extends rt{},Et=class extends rt{};var Kr={},Re=kr(globalThis,Kr);function kr(e,t){return new Proxy(e,{get(r,n,o){return n in t?t[n]:e[n]},set(r,n,o){return n in t&&delete t[n],e[n]=o,!0},deleteProperty(r,n){let o=!1;return n in t&&(delete t[n],o=!0),n in e&&(delete e[n],o=!0),o},ownKeys(r){let n=Reflect.ownKeys(e),o=Reflect.ownKeys(t),i=new Set(o);return[...n.filter(s=>!i.has(s)),...o]},defineProperty(r,n,o){return n in t&&delete t[n],Reflect.defineProperty(e,n,o),!0},getOwnPropertyDescriptor(r,n){return n in t?Reflect.getOwnPropertyDescriptor(t,n):Reflect.getOwnPropertyDescriptor(e,n)},has(r,n){return n in t||n in e}})}var De=()=>typeof Re<"u",ze=()=>typeof caches<"u";var St=e=>typeof e=="object"&&e!==null&&typeof e.privateKey=="object"&&typeof e.publicKey=="object";function qe(e,t){if(t<=0)throw new Error("i2Osp: too small size");if(e>=256**t)throw new Error("i2Osp: too large integer");let r=new Uint8Array(t);for(let n=0;n<t&&e;n++)r[t-(n+1)]=e%256,e=e>>8;return r}function ce(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=atob(t),n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}async function Tr(){if((De()||ze())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:e}=await import("crypto");return e.subtle}catch(e){throw new Et(e)}}var Mt=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await Tr())}};var nt=new Uint8Array(0);var Me=new Uint8Array([72,80,75,69,45,118,49]),ae=class extends Mt{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ee.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:nt}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(t){this._suiteId=t}buildLabeledIkm(t,r){this._checkInit();let n=new Uint8Array(7+this._suiteId.byteLength+t.byteLength+r.byteLength);return n.set(Me,0),n.set(this._suiteId,7),n.set(t,7+this._suiteId.byteLength),n.set(r,7+this._suiteId.byteLength+t.byteLength),n}buildLabeledInfo(t,r,n){this._checkInit();let o=new Uint8Array(9+this._suiteId.byteLength+t.byteLength+r.byteLength);return o.set(new Uint8Array([0,n]),0),o.set(Me,2),o.set(this._suiteId,9),o.set(t,9+this._suiteId.byteLength),o.set(r,9+this._suiteId.byteLength+t.byteLength),o}async extract(t,r){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)throw new gt("The salt length must be the same as the hashSize");let n=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}async expand(t,r,n){await this._setup();let o=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),i=new ArrayBuffer(n),s=new Uint8Array(i),a=nt,c=new Uint8Array(r),u=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let h=1,b=0;b<s.length;h++)u[0]=h,f.set(a,0),f.set(c,a.length),f.set(u,a.length+c.length),a=new Uint8Array(await this._api.sign("HMAC",o,f.slice(0,a.length+c.length+1))),s.length-b>=a.length?(s.set(a,b),b+=a.length):(s.set(a.slice(0,s.length-b),b),b+=s.length-b);return i}async extractAndExpand(t,r,n,o){await this._setup();let i=await this._api.importKey("raw",r,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:n},i,o*8)}async labeledExtract(t,r,n){return await this.extract(t,this.buildLabeledIkm(r,n))}async labeledExpand(t,r,n,o){return await this.expand(t,this.buildLabeledInfo(r,n,o),o)}_checkInit(){if(this._suiteId===nt)throw new Error("Not initialized. Call init()")}},Gt=class extends ae{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ee.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}};var jt=class extends Gt{async extract(t,r){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)return ie(Ne,new Uint8Array(t),new Uint8Array(r));let n=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}};var Nr=new Uint8Array([75,69,77,0,0]),Rr=new Uint8Array([101,97,101,95,112,114,107]),Dr=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function Ft(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}function zr(e,t,r){let n=new Uint8Array(e.length+t.length+r.length);return n.set(e,0),n.set(t,e.length),n.set(r,e.length+t.length),n}var Zt=class{constructor(t,r,n){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this._prim=r,this._kdf=n;let o=new Uint8Array(Nr);o.set(qe(this.id,2),3),this._kdf.init(o)}async serializePublicKey(t){return await this._prim.serializePublicKey(t)}async deserializePublicKey(t){return await this._prim.deserializePublicKey(t)}async serializePrivateKey(t){return await this._prim.serializePrivateKey(t)}async deserializePrivateKey(t){return await this._prim.deserializePrivateKey(t)}async importKey(t,r,n=!0){return await this._prim.importKey(t,r,n)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>8192)throw new gt("Too long ikm");return await this._prim.deriveKeyPair(t)}async encap(t){let r=t.nonEphemeralKeyPair===void 0?await this.generateKeyPair():t.nonEphemeralKeyPair,n=await this._prim.serializePublicKey(r.publicKey),o=await this._prim.serializePublicKey(t.recipientPublicKey);try{let i;if(t.senderKey===void 0)i=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey));else{let c=St(t.senderKey)?t.senderKey.privateKey:t.senderKey,u=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,t.recipientPublicKey));i=Ft(u,f)}let s;if(t.senderKey===void 0)s=Ft(new Uint8Array(n),new Uint8Array(o));else{let c=St(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),u=await this._prim.serializePublicKey(c);s=zr(new Uint8Array(n),new Uint8Array(o),new Uint8Array(u))}let a=await this._generateSharedSecret(i,s);return{enc:n,sharedSecret:a}}catch(i){throw new Dt(i)}}async decap(t){let r=await this._prim.deserializePublicKey(t.enc),n=St(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,o=St(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),i=await this._prim.serializePublicKey(o);try{let s;if(t.senderPublicKey===void 0)s=new Uint8Array(await this._prim.dh(n,r));else{let c=new Uint8Array(await this._prim.dh(n,r)),u=new Uint8Array(await this._prim.dh(n,t.senderPublicKey));s=Ft(c,u)}let a;if(t.senderPublicKey===void 0)a=Ft(new Uint8Array(t.enc),new Uint8Array(i));else{let c=await this._prim.serializePublicKey(t.senderPublicKey);a=new Uint8Array(t.enc.byteLength+i.byteLength+c.byteLength),a.set(new Uint8Array(t.enc),0),a.set(new Uint8Array(i),t.enc.byteLength),a.set(new Uint8Array(c),t.enc.byteLength+i.byteLength)}return await this._generateSharedSecret(s,a)}catch(s){throw new zt(s)}}async _generateSharedSecret(t,r){let n=this._kdf.buildLabeledIkm(Rr,t),o=this._kdf.buildLabeledInfo(Dr,r,this.secretSize);return await this._kdf.extractAndExpand(nt,n,o,this.secretSize)}};var Vt=BigInt(4294967295),fe=BigInt(32);function Ge(e,t=!1){return t?{h:Number(e&Vt),l:Number(e>>fe&Vt)}:{h:Number(e>>fe&Vt)|0,l:Number(e&Vt)|0}}function qr(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:i,l:s}=Ge(e[o],t);[r[o],n[o]]=[i,s]}return[r,n]}var Mr=(e,t)=>BigInt(e>>>0)<<fe|BigInt(t>>>0),Gr=(e,t,r)=>e>>>r,jr=(e,t,r)=>e<<32-r|t>>>r,Fr=(e,t,r)=>e>>>r|t<<32-r,Zr=(e,t,r)=>e<<32-r|t>>>r,Vr=(e,t,r)=>e<<64-r|t>>>r-32,$r=(e,t,r)=>e>>>r-32|t<<64-r,Wr=(e,t)=>t,Xr=(e,t)=>e,Yr=(e,t,r)=>e<<r|t>>>32-r,Qr=(e,t,r)=>t<<r|e>>>32-r,Jr=(e,t,r)=>t<<r-32|e>>>64-r,tn=(e,t,r)=>e<<r-32|t>>>64-r;function en(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var rn=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),nn=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,on=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),sn=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,cn=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),an=(e,t,r,n,o,i)=>t+r+n+o+i+(e/2**32|0)|0,fn={fromBig:Ge,split:qr,toBig:Mr,shrSH:Gr,shrSL:jr,rotrSH:Fr,rotrSL:Zr,rotrBH:Vr,rotrBL:$r,rotr32H:Wr,rotr32L:Xr,rotlSH:Yr,rotlSL:Qr,rotlBH:Jr,rotlBL:tn,add:en,add3L:rn,add3H:nn,add4L:on,add4H:sn,add5H:an,add5L:cn},g=fn;var[un,ln]=g.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ht=new Uint32Array(80),dt=new Uint32Array(80),_t=class extends wt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:i,Cl:s,Dh:a,Dl:c,Eh:u,El:f,Fh:h,Fl:b,Gh:A,Gl:I,Hh:L,Hl:S}=this;return[t,r,n,o,i,s,a,c,u,f,h,b,A,I,L,S]}set(t,r,n,o,i,s,a,c,u,f,h,b,A,I,L,S){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=b|0,this.Gh=A|0,this.Gl=I|0,this.Hh=L|0,this.Hl=S|0}process(t,r){for(let d=0;d<16;d++,r+=4)ht[d]=t.getUint32(r),dt[d]=t.getUint32(r+=4);for(let d=16;d<80;d++){let m=ht[d-15]|0,x=dt[d-15]|0,N=g.rotrSH(m,x,1)^g.rotrSH(m,x,8)^g.shrSH(m,x,7),W=g.rotrSL(m,x,1)^g.rotrSL(m,x,8)^g.shrSL(m,x,7),K=ht[d-2]|0,O=dt[d-2]|0,q=g.rotrSH(K,O,19)^g.rotrBH(K,O,61)^g.shrSH(K,O,6),R=g.rotrSL(K,O,19)^g.rotrBL(K,O,61)^g.shrSL(K,O,6),Z=g.add4L(W,R,dt[d-7],dt[d-16]),T=g.add4H(Z,N,q,ht[d-7],ht[d-16]);ht[d]=T|0,dt[d]=Z|0}let{Ah:n,Al:o,Bh:i,Bl:s,Ch:a,Cl:c,Dh:u,Dl:f,Eh:h,El:b,Fh:A,Fl:I,Gh:L,Gl:S,Hh:z,Hl:F}=this;for(let d=0;d<80;d++){let m=g.rotrSH(h,b,14)^g.rotrSH(h,b,18)^g.rotrBH(h,b,41),x=g.rotrSL(h,b,14)^g.rotrSL(h,b,18)^g.rotrBL(h,b,41),N=h&A^~h&L,W=b&I^~b&S,K=g.add5L(F,x,W,ln[d],dt[d]),O=g.add5H(K,z,m,N,un[d],ht[d]),q=K|0,R=g.rotrSH(n,o,28)^g.rotrBH(n,o,34)^g.rotrBH(n,o,39),Z=g.rotrSL(n,o,28)^g.rotrBL(n,o,34)^g.rotrBL(n,o,39),T=n&i^n&a^i&a,At=o&s^o&c^s&c;z=L|0,F=S|0,L=A|0,S=I|0,A=h|0,I=b|0,{h,l:b}=g.add(u|0,f|0,O|0,q|0),u=a|0,f=c|0,a=i|0,c=s|0,i=n|0,s=o|0;let ct=g.add3L(q,Z,At);n=g.add3H(ct,O,R,T),o=ct|0}({h:n,l:o}=g.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:s}=g.add(this.Bh|0,this.Bl|0,i|0,s|0),{h:a,l:c}=g.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:f}=g.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l:b}=g.add(this.Eh|0,this.El|0,h|0,b|0),{h:A,l:I}=g.add(this.Fh|0,this.Fl|0,A|0,I|0),{h:L,l:S}=g.add(this.Gh|0,this.Gl|0,L|0,S|0),{h:z,l:F}=g.add(this.Hh|0,this.Hl|0,z|0,F|0),this.set(n,o,i,s,a,c,u,f,h,b,A,I,L,S,z,F)}roundClean(){ht.fill(0),dt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},ue=class extends _t{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},le=class extends _t{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},he=class extends _t{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},de=ft(()=>new _t),_o=ft(()=>new ue),Bo=ft(()=>new le),Ao=ft(()=>new he);var So=BigInt(0),hn=BigInt(1),dn=BigInt(2),$t=e=>e instanceof Uint8Array,pn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function It(e){if(!$t(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=pn[e[r]];return t}function je(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Fe(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){let o=n*2,i=e.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function pe(e){return je(It(e))}function J(e){if(!$t(e))throw new Error("Uint8Array expected");return je(It(Uint8Array.from(e).reverse()))}function be(e,t){return Fe(e.toString(16).padStart(t*2,"0"))}function pt(e,t){return be(e,t).reverse()}function j(e,t,r){let n;if(typeof t=="string")try{n=Fe(t)}catch(i){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${i}`)}else if($t(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${e} expected ${r} bytes, got ${o}`);return n}function Wt(...e){let t=new Uint8Array(e.reduce((n,o)=>n+o.length,0)),r=0;return e.forEach(n=>{if(!$t(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}var Ze=e=>(dn<<BigInt(e-1))-hn;var bn={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ot(e,t,r={}){let n=(o,i,s)=>{let a=bn[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);let c=e[o];if(!(s&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(o)}=${c} (${typeof c}), expected ${i}`)};for(let[o,i]of Object.entries(t))n(o,i,!1);for(let[o,i]of Object.entries(r))n(o,i,!0);return e}var C=BigInt(0),k=BigInt(1),yt=BigInt(2),xn=BigInt(3),ye=BigInt(4),Ve=BigInt(5),$e=BigInt(8),wn=BigInt(9),gn=BigInt(16);function H(e,t){let r=e%t;return r>=C?r:t+r}function xe(e,t,r){if(r<=C||t<C)throw new Error("Expected power/modulo > 0");if(r===k)return C;let n=k;for(;t>C;)t&k&&(n=n*e%r),e=e*e%r,t>>=k;return n}function $(e,t,r){let n=e;for(;t-- >C;)n*=n,n%=r;return n}function We(e,t){if(e===C||t<=C)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=H(e,t),n=t,o=C,i=k,s=k,a=C;for(;r!==C;){let u=n/r,f=n%r,h=o-s*u,b=i-a*u;n=r,r=f,o=s,i=a,s=h,a=b}if(n!==k)throw new Error("invert: does not exist");return H(o,t)}function mn(e){let t=(e-k)/yt,r,n,o;for(r=e-k,n=0;r%yt===C;r/=yt,n++);for(o=yt;o<e&&xe(o,t,e)!==e-k;o++);if(n===1){let s=(e+k)/ye;return function(c,u){let f=c.pow(u,s);if(!c.eql(c.sqr(f),u))throw new Error("Cannot find square root");return f}}let i=(r+k)/yt;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,f=a.pow(a.mul(a.ONE,o),r),h=a.pow(c,i),b=a.pow(c,r);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let A=1;for(let L=a.sqr(b);A<u&&!a.eql(L,a.ONE);A++)L=a.sqr(L);let I=a.pow(f,k<<BigInt(u-A-1));f=a.sqr(I),h=a.mul(h,I),b=a.mul(b,f),u=A}return h}}function En(e){if(e%ye===xn){let t=(e+k)/ye;return function(n,o){let i=n.pow(o,t);if(!n.eql(n.sqr(i),o))throw new Error("Cannot find square root");return i}}if(e%$e===Ve){let t=(e-Ve)/$e;return function(n,o){let i=n.mul(o,yt),s=n.pow(i,t),a=n.mul(o,s),c=n.mul(n.mul(a,yt),s),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),o))throw new Error("Cannot find square root");return u}}return e%gn,mn(e)}var Xe=(e,t)=>(H(e,t)&k)===k,_n=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ye(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=_n.reduce((n,o)=>(n[o]="function",n),t);return ot(e,r)}function Bn(e,t,r){if(r<C)throw new Error("Expected power > 0");if(r===C)return e.ONE;if(r===k)return t;let n=e.ONE,o=t;for(;r>C;)r&k&&(n=e.mul(n,o)),o=e.sqr(o),r>>=k;return n}function An(e,t){let r=new Array(t.length),n=t.reduce((i,s,a)=>e.is0(s)?i:(r[a]=i,e.mul(i,s)),e.ONE),o=e.inv(n);return t.reduceRight((i,s,a)=>e.is0(s)?i:(r[a]=e.mul(i,r[a]),e.mul(i,s)),o),r}function we(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Qe(e,t,r=!1,n={}){if(e<=C)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:i}=we(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=En(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:Ze(o),ZERO:C,ONE:k,create:c=>H(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return C<=c&&c<e},is0:c=>c===C,isOdd:c=>(c&k)===k,neg:c=>H(-c,e),eql:(c,u)=>c===u,sqr:c=>H(c*c,e),add:(c,u)=>H(c+u,e),sub:(c,u)=>H(c-u,e),mul:(c,u)=>H(c*u,e),pow:(c,u)=>Bn(a,c,u),div:(c,u)=>H(c*We(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>We(c,e),sqrt:n.sqrt||(c=>s(a,c)),invertBatch:c=>An(a,c),cmov:(c,u,f)=>f?u:c,toBytes:c=>r?pt(c,i):be(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return r?J(c):pe(c)}});return Object.freeze(a)}function Je(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}var vn=BigInt(0),ge=BigInt(1);function tr(e,t){let r=(o,i)=>{let s=i.negate();return o?s:i},n=o=>{let i=Math.ceil(t/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:r,unsafeLadder(o,i){let s=e.ZERO,a=o;for(;i>vn;)i&ge&&(s=s.add(a)),a=a.double(),i>>=ge;return s},precomputeWindow(o,i){let{windows:s,windowSize:a}=n(i),c=[],u=o,f=u;for(let h=0;h<s;h++){f=u,c.push(f);for(let b=1;b<a;b++)f=f.add(u),c.push(f);u=f.double()}return c},wNAF(o,i,s){let{windows:a,windowSize:c}=n(o),u=e.ZERO,f=e.BASE,h=BigInt(2**o-1),b=2**o,A=BigInt(o);for(let I=0;I<a;I++){let L=I*c,S=Number(s&h);s>>=A,S>c&&(S-=b,s+=ge);let z=L,F=L+Math.abs(S)-1,d=I%2!==0,m=S<0;S===0?f=f.add(r(d,i[z])):u=u.add(r(m,i[F]))}return{p:u,f}},wNAFCached(o,i,s,a){let c=o._WINDOW_SIZE||1,u=i.get(o);return u||(u=this.precomputeWindow(o,c),c!==1&&i.set(o,a(u))),this.wNAF(c,u,s)}}}function er(e){return Ye(e.Fp),ot(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...we(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var Y=BigInt(0),V=BigInt(1),Xt=BigInt(2),Sn=BigInt(8),In={zip215:!0};function Ln(e){let t=er(e);return ot(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Yt(e){let t=Ln(e),{Fp:r,n,prehash:o,hash:i,randomBytes:s,nByteLength:a,h:c}=t,u=Xt<<BigInt(a*8)-V,f=r.create,h=t.uvRatio||((p,l)=>{try{return{isValid:!0,value:r.sqrt(p*r.inv(l))}}catch{return{isValid:!1,value:Y}}}),b=t.adjustScalarBytes||(p=>p),A=t.domain||((p,l,y)=>{if(l.length||y)throw new Error("Contexts/pre-hash are not supported");return p}),I=p=>typeof p=="bigint"&&Y<p,L=(p,l)=>I(p)&&I(l)&&p<l,S=p=>p===Y||L(p,u);function z(p,l){if(L(p,l))return p;throw new Error(`Expected valid scalar < ${l}, got ${typeof p} ${p}`)}function F(p){return p===Y?p:z(p,n)}let d=new Map;function m(p){if(!(p instanceof x))throw new Error("ExtendedPoint expected")}class x{constructor(l,y,w,E){if(this.ex=l,this.ey=y,this.ez=w,this.et=E,!S(l))throw new Error("x required");if(!S(y))throw new Error("y required");if(!S(w))throw new Error("z required");if(!S(E))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(l){if(l instanceof x)throw new Error("extended point not allowed");let{x:y,y:w}=l||{};if(!S(y)||!S(w))throw new Error("invalid affine point");return new x(y,w,V,f(y*w))}static normalizeZ(l){let y=r.invertBatch(l.map(w=>w.ez));return l.map((w,E)=>w.toAffine(y[E])).map(x.fromAffine)}_setWindowSize(l){this._WINDOW_SIZE=l,d.delete(this)}assertValidity(){let{a:l,d:y}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:w,ey:E,ez:_,et:v}=this,U=f(w*w),B=f(E*E),P=f(_*_),D=f(P*P),M=f(U*l),Q=f(P*f(M+B)),G=f(D+f(y*f(U*B)));if(Q!==G)throw new Error("bad point: equation left != right (1)");let at=f(w*E),tt=f(_*v);if(at!==tt)throw new Error("bad point: equation left != right (2)")}equals(l){m(l);let{ex:y,ey:w,ez:E}=this,{ex:_,ey:v,ez:U}=l,B=f(y*U),P=f(_*E),D=f(w*U),M=f(v*E);return B===P&&D===M}is0(){return this.equals(x.ZERO)}negate(){return new x(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:l}=t,{ex:y,ey:w,ez:E}=this,_=f(y*y),v=f(w*w),U=f(Xt*f(E*E)),B=f(l*_),P=y+w,D=f(f(P*P)-_-v),M=B+v,Q=M-U,G=B-v,at=f(D*Q),tt=f(M*G),kt=f(D*G),Ot=f(Q*M);return new x(at,tt,Ot,kt)}add(l){m(l);let{a:y,d:w}=t,{ex:E,ey:_,ez:v,et:U}=this,{ex:B,ey:P,ez:D,et:M}=l;if(y===BigInt(-1)){let Ie=f((_-E)*(P+B)),Le=f((_+E)*(P-B)),Jt=f(Le-Ie);if(Jt===Y)return this.double();let Pe=f(v*Xt*M),Ue=f(U*Xt*D),He=Ue+Pe,Ke=Le+Ie,ke=Ue-Pe,yr=f(He*Jt),xr=f(Ke*ke),wr=f(He*ke),gr=f(Jt*Ke);return new x(yr,xr,gr,wr)}let Q=f(E*B),G=f(_*P),at=f(U*w*M),tt=f(v*D),kt=f((E+_)*(B+P)-Q-G),Ot=tt-at,ve=tt+at,Se=f(G-y*Q),hr=f(kt*Ot),dr=f(ve*Se),pr=f(kt*Se),br=f(Ot*ve);return new x(hr,dr,br,pr)}subtract(l){return this.add(l.negate())}wNAF(l){return K.wNAFCached(this,d,l,x.normalizeZ)}multiply(l){let{p:y,f:w}=this.wNAF(z(l,n));return x.normalizeZ([y,w])[0]}multiplyUnsafe(l){let y=F(l);return y===Y?W:this.equals(W)||y===V?this:this.equals(N)?this.wNAF(y).p:K.unsafeLadder(this,y)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return K.unsafeLadder(this,n).is0()}toAffine(l){let{ex:y,ey:w,ez:E}=this,_=this.is0();l==null&&(l=_?Sn:r.inv(E));let v=f(y*l),U=f(w*l),B=f(E*l);if(_)return{x:Y,y:V};if(B!==V)throw new Error("invZ was invalid");return{x:v,y:U}}clearCofactor(){let{h:l}=t;return l===V?this:this.multiplyUnsafe(l)}static fromHex(l,y=!1){let{d:w,a:E}=t,_=r.BYTES;l=j("pointHex",l,_);let v=l.slice(),U=l[_-1];v[_-1]=U&-129;let B=J(v);B===Y||(y?z(B,u):z(B,r.ORDER));let P=f(B*B),D=f(P-V),M=f(w*P-E),{isValid:Q,value:G}=h(D,M);if(!Q)throw new Error("Point.fromHex: invalid y coordinate");let at=(G&V)===V,tt=(U&128)!==0;if(!y&&G===Y&&tt)throw new Error("Point.fromHex: x=0 and x_0=1");return tt!==at&&(G=f(-G)),x.fromAffine({x:G,y:B})}static fromPrivateKey(l){return R(l).point}toRawBytes(){let{x:l,y}=this.toAffine(),w=pt(y,r.BYTES);return w[w.length-1]|=l&V?128:0,w}toHex(){return It(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,V,f(t.Gx*t.Gy)),x.ZERO=new x(Y,V,V,Y);let{BASE:N,ZERO:W}=x,K=tr(x,a*8);function O(p){return H(p,n)}function q(p){return O(J(p))}function R(p){let l=a;p=j("private key",p,l);let y=j("hashed private key",i(p),2*l),w=b(y.slice(0,l)),E=y.slice(l,2*l),_=q(w),v=N.multiply(_),U=v.toRawBytes();return{head:w,prefix:E,scalar:_,point:v,pointBytes:U}}function Z(p){return R(p).pointBytes}function T(p=new Uint8Array,...l){let y=Wt(...l);return q(i(A(y,j("context",p),!!o)))}function At(p,l,y={}){p=j("message",p),o&&(p=o(p));let{prefix:w,scalar:E,pointBytes:_}=R(l),v=T(y.context,w,p),U=N.multiply(v).toRawBytes(),B=T(y.context,U,_,p),P=O(v+B*E);F(P);let D=Wt(U,pt(P,r.BYTES));return j("result",D,a*2)}let ct=In;function Ht(p,l,y,w=ct){let{context:E,zip215:_}=w,v=r.BYTES;p=j("signature",p,2*v),l=j("message",l),o&&(l=o(l));let U=J(p.slice(v,2*v)),B,P,D;try{B=x.fromHex(y,_),P=x.fromHex(p.slice(0,v),_),D=N.multiplyUnsafe(U)}catch{return!1}if(!_&&B.isSmallOrder())return!1;let M=T(E,P.toRawBytes(),B.toRawBytes(),l);return P.add(B.multiplyUnsafe(M)).subtract(D).clearCofactor().equals(x.ZERO)}return N._setWindowSize(8),{CURVE:t,getPublicKey:Z,sign:At,verify:Ht,ExtendedPoint:x,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>s(r.BYTES),precompute(p=8,l=x.BASE){return l._setWindowSize(p),l.multiply(BigInt(3)),l}}}}var Lt=BigInt(0),me=BigInt(1);function Pn(e){return ot(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function rr(e){let t=Pn(e),{P:r}=t,n=d=>H(d,r),o=t.montgomeryBits,i=Math.ceil(o/8),s=t.nByteLength,a=t.adjustScalarBytes||(d=>d),c=t.powPminus2||(d=>xe(d,r-BigInt(2),r));function u(d,m,x){let N=n(d*(m-x));return m=n(m-N),x=n(x+N),[m,x]}function f(d){if(typeof d=="bigint"&&Lt<=d&&d<r)return d;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(t.a-BigInt(2))/BigInt(4);function b(d,m){let x=f(d),N=f(m),W=x,K=me,O=Lt,q=x,R=me,Z=Lt,T;for(let ct=BigInt(o-1);ct>=Lt;ct--){let Ht=N>>ct&me;Z^=Ht,T=u(Z,K,q),K=T[0],q=T[1],T=u(Z,O,R),O=T[0],R=T[1],Z=Ht;let Kt=K+O,p=n(Kt*Kt),l=K-O,y=n(l*l),w=p-y,E=q+R,_=q-R,v=n(_*Kt),U=n(E*l),B=v+U,P=v-U;q=n(B*B),R=n(W*n(P*P)),K=n(p*y),O=n(w*(p+n(h*w)))}T=u(Z,K,q),K=T[0],q=T[1],T=u(Z,O,R),O=T[0],R=T[1];let At=c(O);return n(K*At)}function A(d){return pt(n(d),i)}function I(d){let m=j("u coordinate",d,i);return s===i&&(m[s-1]&=127),J(m)}function L(d){let m=j("scalar",d);if(m.length!==i&&m.length!==s)throw new Error(`Expected ${i} or ${s} bytes, got ${m.length}`);return J(a(m))}function S(d,m){let x=I(m),N=L(d),W=b(x,N);if(W===Lt)throw new Error("Invalid private or public key received");return A(W)}let z=A(t.Gu);function F(d){return S(d,z)}return{scalarMult:S,scalarMultBase:F,getSharedSecret:(d,m)=>S(d,m),getPublicKey:d=>F(d),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:z}}var Pt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),nr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Jo=BigInt(0),Un=BigInt(1),Ee=BigInt(2),Hn=BigInt(5),or=BigInt(10),Kn=BigInt(20),kn=BigInt(40),ir=BigInt(80);function sr(e){let t=Pt,n=e*e%t*e%t,o=$(n,Ee,t)*n%t,i=$(o,Un,t)*e%t,s=$(i,Hn,t)*i%t,a=$(s,or,t)*s%t,c=$(a,Kn,t)*a%t,u=$(c,kn,t)*c%t,f=$(u,ir,t)*u%t,h=$(f,ir,t)*u%t,b=$(h,or,t)*s%t;return{pow_p_5_8:$(b,Ee,t)*e%t,b2:n}}function cr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function On(e,t){let r=Pt,n=H(t*t*t,r),o=H(n*n*t,r),i=sr(e*o).pow_p_5_8,s=H(e*n*i,r),a=H(t*s*s,r),c=s,u=H(s*nr,r),f=a===e,h=a===H(-e,r),b=a===H(-e*nr,r);return f&&(s=c),(h||b)&&(s=u),Xe(s,r)&&(s=H(-s,r)),{isValid:f||h,value:s}}var it=Qe(Pt,void 0,!0),_e={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:it,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:de,randomBytes:oe,adjustScalarBytes:cr,uvRatio:On},ar=Yt(_e);function fr(e,t,r){if(t.length>255)throw new Error("Context is too big");return Ce(ne("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}var ti=Yt({..._e,domain:fr}),ei=Yt({..._e,domain:fr,prehash:de}),Be=(()=>rr({P:Pt,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=Pt,{pow_p_5_8:r,b2:n}=sr(e);return H($(r,BigInt(3),t)*n,t)},adjustScalarBytes:cr,randomBytes:oe}))();var Tn=(it.ORDER+BigInt(3))/BigInt(8),ri=it.pow(Ee,Tn),ni=it.sqrt(it.neg(it.ONE)),oi=(it.ORDER-BigInt(5))/BigInt(8),ii=BigInt(486662);var si=Je(it,it.neg(BigInt(486664)));var ci=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),ai=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),fi=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ui=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var li=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Ut=["deriveBits"],ur=new Uint8Array([100,107,112,95,112,114,107]),lr=new Uint8Array([115,107]);var st=class{constructor(t,r,n,o=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=r,this.type=n,this.algorithm={name:t},this.usages=o,n==="public"&&(this.usages=[])}};var Bt="X25519",Qt=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=32,this._nSk=32}async serializePublicKey(t){try{return await this._serializePublicKey(t)}catch(r){throw new mt(r)}}async deserializePublicKey(t){try{return await this._importRawKey(t,!0)}catch(r){throw new bt(r)}}async serializePrivateKey(t){try{return await this._serializePrivateKey(t)}catch(r){throw new mt(r)}}async deserializePrivateKey(t){try{return await this._importRawKey(t,!1)}catch(r){throw new bt(r)}}async importKey(t,r,n){try{if(t==="raw")return await this._importRawKey(r,n);if(r instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(r,n)}catch(o){throw new bt(o)}}async generateKeyPair(){try{let t=ar.utils.randomPrivateKey(),r=new st(Bt,t,"private",Ut);return{publicKey:await this.derivePublicKey(r),privateKey:r}}catch(t){throw new Et(t)}}async deriveKeyPair(t){try{let r=await this._hkdf.labeledExtract(nt,ur,new Uint8Array(t)),n=await this._hkdf.labeledExpand(r,lr,nt,this._nSk),o=new st(Bt,new Uint8Array(n),"private",Ut);return{privateKey:o,publicKey:await this.derivePublicKey(o)}}catch(r){throw new qt(r)}}async derivePublicKey(t){try{return await this._derivePublicKey(t)}catch(r){throw new bt(r)}}async dh(t,r){try{return await this._dh(t,r)}catch(n){throw new mt(n)}}_serializePublicKey(t){return new Promise(r=>{r(t.key.buffer)})}_serializePrivateKey(t){return new Promise(r=>{r(t.key.buffer)})}_importRawKey(t,r){return new Promise((n,o)=>{r&&t.byteLength!==this._nPk&&o(new Error("Invalid length of the key")),!r&&t.byteLength!==this._nSk&&o(new Error("Invalid length of the key")),n(new st(Bt,new Uint8Array(t),r?"public":"private",r?[]:Ut))})}_importJWK(t,r){return new Promise((n,o)=>{(typeof t.kty>"u"||t.kty!=="OKP")&&o(new Error(`Invalid kty: ${t.kty}`)),(typeof t.crv>"u"||t.crv!=="X25519")&&o(new Error(`Invalid crv: ${t.crv}`)),r?(typeof t.d<"u"&&o(new Error("Invalid key: `d` should not be set")),typeof t.x>"u"&&o(new Error("Invalid key: `x` not found")),n(new st(Bt,ce(t.x),"public"))):(typeof t.d!="string"&&o(new Error("Invalid key: `d` not found")),n(new st(Bt,ce(t.d),"private",Ut)))})}_derivePublicKey(t){return new Promise((r,n)=>{try{let o=Be.getPublicKey(t.key);r(new st(Bt,o,"public"))}catch(o){n(o)}})}_dh(t,r){return new Promise((n,o)=>{try{n(Be.getSharedSecret(t.key,r.key).buffer)}catch(i){o(i)}})}};var Ae=class extends Zt{constructor(){let t=new jt;super(te.DhkemX25519HkdfSha256,new Qt(t),t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};export{Ae as DhkemX25519HkdfSha256};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
