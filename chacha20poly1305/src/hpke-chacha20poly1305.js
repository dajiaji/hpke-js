function J(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`positive integer expected, not ${r}`)}function te(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function re(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function D(r,...e){if(!re(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function ne(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function be(r,e){D(r);let s=e.outputLen;if(r.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}var G=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),xe=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Ie=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ie)throw new Error("Non little-endian hardware is not supported");function Oe(r){if(typeof r!="string")throw new Error(`string expected, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Q(r){if(typeof r=="string")r=Oe(r);else if(re(r))r=r.slice();else throw new Error(`Uint8Array expected, got ${typeof r}`);return r}function we(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function ge(r,e){if(r.length!==e.length)return!1;let s=0;for(let t=0;t<r.length;t++)s|=r[t]^e[t];return s===0}var ie=(r,e)=>(Object.assign(e,r),e);function se(r,e,s,t){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,s,t);let o=BigInt(32),n=BigInt(4294967295),a=Number(s>>o&n),i=Number(s&n),c=t?4:0,l=t?0:4;r.setUint32(e+c,a,t),r.setUint32(e+l,i,t)}var T=(r,e)=>r[e++]&255|(r[e++]&255)<<8,oe=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Q(e),D(e,32);let s=T(e,0),t=T(e,2),o=T(e,4),n=T(e,6),a=T(e,8),i=T(e,10),c=T(e,12),l=T(e,14);this.r[0]=s&8191,this.r[1]=(s>>>13|t<<3)&8191,this.r[2]=(t>>>10|o<<6)&7939,this.r[3]=(o>>>7|n<<9)&8191,this.r[4]=(n>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|i<<2)&8191,this.r[7]=(i>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let h=0;h<8;h++)this.pad[h]=T(e,16+2*h)}process(e,s,t=!1){let o=t?0:2048,{h:n,r:a}=this,i=a[0],c=a[1],l=a[2],h=a[3],b=a[4],w=a[5],x=a[6],y=a[7],p=a[8],d=a[9],g=T(e,s+0),_=T(e,s+2),j=T(e,s+4),H=T(e,s+6),M=T(e,s+8),N=T(e,s+10),B=T(e,s+12),C=T(e,s+14),m=n[0]+(g&8191),k=n[1]+((g>>>13|_<<3)&8191),P=n[2]+((_>>>10|j<<6)&8191),A=n[3]+((j>>>7|H<<9)&8191),v=n[4]+((H>>>4|M<<12)&8191),S=n[5]+(M>>>1&8191),K=n[6]+((M>>>14|N<<2)&8191),E=n[7]+((N>>>11|B<<5)&8191),U=n[8]+((B>>>8|C<<8)&8191),L=n[9]+(C>>>5|o),u=0,O=u+m*i+k*(5*d)+P*(5*p)+A*(5*y)+v*(5*x);u=O>>>13,O&=8191,O+=S*(5*w)+K*(5*b)+E*(5*h)+U*(5*l)+L*(5*c),u+=O>>>13,O&=8191;let z=u+m*c+k*i+P*(5*d)+A*(5*p)+v*(5*y);u=z>>>13,z&=8191,z+=S*(5*x)+K*(5*w)+E*(5*b)+U*(5*h)+L*(5*l),u+=z>>>13,z&=8191;let I=u+m*l+k*c+P*i+A*(5*d)+v*(5*p);u=I>>>13,I&=8191,I+=S*(5*y)+K*(5*x)+E*(5*w)+U*(5*b)+L*(5*h),u+=I>>>13,I&=8191;let R=u+m*h+k*l+P*c+A*i+v*(5*d);u=R>>>13,R&=8191,R+=S*(5*p)+K*(5*y)+E*(5*x)+U*(5*w)+L*(5*b),u+=R>>>13,R&=8191;let F=u+m*b+k*h+P*l+A*c+v*i;u=F>>>13,F&=8191,F+=S*(5*d)+K*(5*p)+E*(5*y)+U*(5*x)+L*(5*w),u+=F>>>13,F&=8191;let $=u+m*w+k*b+P*h+A*l+v*c;u=$>>>13,$&=8191,$+=S*i+K*(5*d)+E*(5*p)+U*(5*y)+L*(5*x),u+=$>>>13,$&=8191;let q=u+m*x+k*w+P*b+A*h+v*l;u=q>>>13,q&=8191,q+=S*c+K*i+E*(5*d)+U*(5*p)+L*(5*y),u+=q>>>13,q&=8191;let Y=u+m*y+k*x+P*w+A*b+v*h;u=Y>>>13,Y&=8191,Y+=S*l+K*c+E*i+U*(5*d)+L*(5*p),u+=Y>>>13,Y&=8191;let X=u+m*p+k*y+P*x+A*w+v*b;u=X>>>13,X&=8191,X+=S*h+K*l+E*c+U*i+L*(5*d),u+=X>>>13,X&=8191;let Z=u+m*d+k*p+P*y+A*x+v*w;u=Z>>>13,Z&=8191,Z+=S*b+K*h+E*l+U*c+L*i,u+=Z>>>13,Z&=8191,u=(u<<2)+u|0,u=u+O|0,O=u&8191,u=u>>>13,z+=u,n[0]=O,n[1]=z,n[2]=I,n[3]=R,n[4]=F,n[5]=$,n[6]=q,n[7]=Y,n[8]=X,n[9]=Z}finalize(){let{h:e,pad:s}=this,t=new Uint16Array(10),o=e[1]>>>13;e[1]&=8191;for(let i=2;i<10;i++)e[i]+=o,o=e[i]>>>13,e[i]&=8191;e[0]+=o*5,o=e[0]>>>13,e[0]&=8191,e[1]+=o,o=e[1]>>>13,e[1]&=8191,e[2]+=o,t[0]=e[0]+5,o=t[0]>>>13,t[0]&=8191;for(let i=1;i<10;i++)t[i]=e[i]+o,o=t[i]>>>13,t[i]&=8191;t[9]-=8192;let n=(o^1)-1;for(let i=0;i<10;i++)t[i]&=n;n=~n;for(let i=0;i<10;i++)e[i]=e[i]&n|t[i];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+s[0];e[0]=a&65535;for(let i=1;i<8;i++)a=(e[i]+s[i]|0)+(a>>>16)|0,e[i]=a&65535}update(e){ne(this);let{buffer:s,blockLen:t}=this;e=Q(e);let o=e.length;for(let n=0;n<o;){let a=Math.min(t-this.pos,o-n);if(a===t){for(;t<=o-n;n+=t)this.process(e,n);continue}s.set(e.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===t&&(this.process(s,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){ne(this),be(e,this),this.finished=!0;let{buffer:s,h:t}=this,{pos:o}=this;if(o){for(s[o++]=1;o<16;o++)s[o]=0;this.process(s,0,!0)}this.finalize();let n=0;for(let a=0;a<8;a++)e[n++]=t[a]>>>0,e[n++]=t[a]>>>8;return e}digest(){let{buffer:e,outputLen:s}=this;this.digestInto(e);let t=e.slice(0,s);return this.destroy(),t}};function je(r){let e=(t,o)=>r(o).update(Q(t)).digest(),s=r(new Uint8Array(32));return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=t=>r(t),e}var _e=je(r=>new oe(r));var ke=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),ze=ke("expand 16-byte k"),He=ke("expand 32-byte k"),Te=G(ze),Pe=G(He),ut=Pe.slice();function f(r,e){return r<<e|r>>>32-e}function ae(r){return r.byteOffset%4===0}var ee=64,Ne=16,Ae=2**32-1,me=new Uint32Array;function Be(r,e,s,t,o,n,a,i){let c=o.length,l=new Uint8Array(ee),h=G(l),b=ae(o)&&ae(n),w=b?G(o):me,x=b?G(n):me;for(let y=0;y<c;a++){if(r(e,s,t,h,a,i),a>=Ae)throw new Error("arx: counter overflow");let p=Math.min(ee,c-y);if(b&&p===ee){let d=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let g=0,_;g<Ne;g++)_=d+g,x[_]=w[_]^h[g];y+=ee;continue}for(let d=0,g;d<p;d++)g=y+d,n[g]=o[g]^l[d];y+=p}}function fe(r,e){let{allowShortKeys:s,extendNonceFn:t,counterLength:o,counterRight:n,rounds:a}=we({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return J(o),J(a),te(n),te(s),(i,c,l,h,b=0)=>{D(i),D(c),D(l);let w=l.length;if(h||(h=new Uint8Array(w)),D(h),J(b),b<0||b>=Ae)throw new Error("arx: counter overflow");if(h.length<w)throw new Error(`arx: output (${h.length}) is shorter than data (${w})`);let x=[],y=i.length,p,d;if(y===32)p=i.slice(),x.push(p),d=Pe;else if(y===16&&s)p=new Uint8Array(32),p.set(i),p.set(i,16),d=Te,x.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);ae(c)||(c=c.slice(),x.push(c));let g=G(p);if(t){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");t(d,g,G(c.subarray(0,16)),g),c=c.subarray(16)}let _=16-o;if(_!==c.length)throw new Error(`arx: nonce must be ${_} or 16 bytes`);if(_!==12){let H=new Uint8Array(12);H.set(c,n?0:12-c.length),c=H,x.push(c)}let j=G(c);for(Be(r,d,g,j,l,h,b,a);x.length>0;)x.pop().fill(0);return h}}function Ke(r,e,s,t,o,n=20){let a=r[0],i=r[1],c=r[2],l=r[3],h=e[0],b=e[1],w=e[2],x=e[3],y=e[4],p=e[5],d=e[6],g=e[7],_=o,j=s[0],H=s[1],M=s[2],N=a,B=i,C=c,m=l,k=h,P=b,A=w,v=x,S=y,K=p,E=d,U=g,L=_,u=j,O=H,z=M;for(let R=0;R<n;R+=2)N=N+k|0,L=f(L^N,16),S=S+L|0,k=f(k^S,12),N=N+k|0,L=f(L^N,8),S=S+L|0,k=f(k^S,7),B=B+P|0,u=f(u^B,16),K=K+u|0,P=f(P^K,12),B=B+P|0,u=f(u^B,8),K=K+u|0,P=f(P^K,7),C=C+A|0,O=f(O^C,16),E=E+O|0,A=f(A^E,12),C=C+A|0,O=f(O^C,8),E=E+O|0,A=f(A^E,7),m=m+v|0,z=f(z^m,16),U=U+z|0,v=f(v^U,12),m=m+v|0,z=f(z^m,8),U=U+z|0,v=f(v^U,7),N=N+P|0,z=f(z^N,16),E=E+z|0,P=f(P^E,12),N=N+P|0,z=f(z^N,8),E=E+z|0,P=f(P^E,7),B=B+A|0,L=f(L^B,16),U=U+L|0,A=f(A^U,12),B=B+A|0,L=f(L^B,8),U=U+L|0,A=f(A^U,7),C=C+v|0,u=f(u^C,16),S=S+u|0,v=f(v^S,12),C=C+v|0,u=f(u^C,8),S=S+u|0,v=f(v^S,7),m=m+k|0,O=f(O^m,16),K=K+O|0,k=f(k^K,12),m=m+k|0,O=f(O^m,8),K=K+O|0,k=f(k^K,7);let I=0;t[I++]=a+N|0,t[I++]=i+B|0,t[I++]=c+C|0,t[I++]=l+m|0,t[I++]=h+k|0,t[I++]=b+P|0,t[I++]=w+A|0,t[I++]=x+v|0,t[I++]=y+S|0,t[I++]=p+K|0,t[I++]=d+E|0,t[I++]=g+U|0,t[I++]=_+L|0,t[I++]=j+u|0,t[I++]=H+O|0,t[I++]=M+z|0}function Ce(r,e,s,t){let o=r[0],n=r[1],a=r[2],i=r[3],c=e[0],l=e[1],h=e[2],b=e[3],w=e[4],x=e[5],y=e[6],p=e[7],d=s[0],g=s[1],_=s[2],j=s[3];for(let M=0;M<20;M+=2)o=o+c|0,d=f(d^o,16),w=w+d|0,c=f(c^w,12),o=o+c|0,d=f(d^o,8),w=w+d|0,c=f(c^w,7),n=n+l|0,g=f(g^n,16),x=x+g|0,l=f(l^x,12),n=n+l|0,g=f(g^n,8),x=x+g|0,l=f(l^x,7),a=a+h|0,_=f(_^a,16),y=y+_|0,h=f(h^y,12),a=a+h|0,_=f(_^a,8),y=y+_|0,h=f(h^y,7),i=i+b|0,j=f(j^i,16),p=p+j|0,b=f(b^p,12),i=i+b|0,j=f(j^i,8),p=p+j|0,b=f(b^p,7),o=o+l|0,j=f(j^o,16),y=y+j|0,l=f(l^y,12),o=o+l|0,j=f(j^o,8),y=y+j|0,l=f(l^y,7),n=n+h|0,d=f(d^n,16),p=p+d|0,h=f(h^p,12),n=n+h|0,d=f(d^n,8),p=p+d|0,h=f(h^p,7),a=a+b|0,g=f(g^a,16),w=w+g|0,b=f(b^w,12),a=a+b|0,g=f(g^a,8),w=w+g|0,b=f(b^w,7),i=i+c|0,_=f(_^i,16),x=x+_|0,c=f(c^x,12),i=i+c|0,_=f(_^i,8),x=x+_|0,c=f(c^x,7);let H=0;t[H++]=o,t[H++]=n,t[H++]=a,t[H++]=i,t[H++]=d,t[H++]=g,t[H++]=_,t[H++]=j}var De=fe(Ke,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Me=fe(Ke,{counterRight:!1,counterLength:8,extendNonceFn:Ce,allowShortKeys:!1});var Re=new Uint8Array(16),ve=(r,e)=>{r.update(e);let s=e.length%16;s&&r.update(Re.subarray(s))},Ge=new Uint8Array(32);function Se(r,e,s,t,o){let n=r(e,s,Ge),a=_e.create(n);o&&ve(a,o),ve(a,t);let i=new Uint8Array(16),c=xe(i);se(c,0,BigInt(o?o.length:0),!0),se(c,8,BigInt(t.length),!0),a.update(i);let l=a.digest();return n.fill(0),l}var Ee=r=>(e,s,t)=>(D(e,32),D(s),{encrypt:(n,a)=>{let i=n.length,c=i+16;a?D(a,c):a=new Uint8Array(c),r(e,s,n,a,1);let l=Se(r,e,s,a.subarray(0,-16),t);return a.set(l,i),a},decrypt:(n,a)=>{let i=n.length,c=i-16;if(i<16)throw new Error("encrypted data must be at least 16 bytes");a?D(a,c):a=new Uint8Array(c);let l=n.subarray(0,-16),h=n.subarray(-16),b=Se(r,e,s,l,t);if(!ge(h,b))throw new Error("invalid tag");return r(e,s,l,a,1),a}}),ce=ie({blockSize:64,nonceLength:12,tagLength:16},Ee(De)),bt=ie({blockSize:64,nonceLength:24,tagLength:16},Ee(Me));var Fe={},$e=qe(globalThis,Fe);function qe(r,e){return new Proxy(r,{get(s,t,o){return t in e?e[t]:r[t]},set(s,t,o){return t in e&&delete e[t],r[t]=o,!0},deleteProperty(s,t){let o=!1;return t in e&&(delete e[t],o=!0),t in r&&(delete r[t],o=!0),o},ownKeys(s){let t=Reflect.ownKeys(r),o=Reflect.ownKeys(e),n=new Set(o);return[...t.filter(a=>!n.has(a)),...o]},defineProperty(s,t,o){return t in e&&delete e[t],Reflect.defineProperty(r,t,o),!0},getOwnPropertyDescriptor(s,t){return t in e?Reflect.getOwnPropertyDescriptor(e,t):Reflect.getOwnPropertyDescriptor(r,t)},has(s,t){return t in e||t in r}})}var Xe={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535},V=Xe;var W=new Uint8Array(0);var Ct=new Uint8Array([115,101,99]);var wr=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),gr=new Uint8Array([101,120,112]),_r=new Uint8Array([105,110,102,111,95,104,97,115,104]),mr=new Uint8Array([107,101,121]),kr=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),Pr=new Uint8Array([115,101,99,114,101,116]),Ar=new Uint8Array([72,80,75,69,0,0,0,0,0,0]);var Lr=new Uint8Array([72,80,75,69,45,118,49]);var We=new Uint8Array([75,69,77,0,0]);var Mr=new Uint8Array([101,97,101,95,112,114,107]),Rr=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var Je=new Uint8Array([100,107,112,95,112,114,107]),Fr=new Uint8Array([115,107]);var an=new Uint8Array([99,97,110,100,105,100,97,116,101]),fn=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),cn=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),un=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),ln=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),hn=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),dn=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var ye=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,s,t){return await this._seal(e,s,t)}async open(e,s,t){return await this._open(e,s,t)}_seal(e,s,t){return new Promise(o=>{let n=ce(this._key,new Uint8Array(e),new Uint8Array(t)).encrypt(new Uint8Array(s));o(n.buffer)})}_open(e,s,t){return new Promise(o=>{let n=ce(this._key,new Uint8Array(e),new Uint8Array(t)).decrypt(new Uint8Array(s));o(n.buffer)})}},pe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:V.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new ye(e)}};export{pe as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
