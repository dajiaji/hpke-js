function Ge(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ee(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function te(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function I(t,e,n=""){let r=Ge(t),i=t?.length,o=e!==void 0;if(!r||o&&i!==e){let s=n&&`"${n}" `,a=o?` of length ${e}`:"",u=r?`length=${i}`:`type=${typeof t}`;throw new Error(s+"expected Uint8Array"+a+", got "+u)}return t}function ae(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function we(t,e){I(t,void 0,"output");let n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function M(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function G(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Ne(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}var Re=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ge(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function me(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}var _e=(t,e)=>{function n(r,...i){if(I(r,void 0,"key"),!Re)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){let f=i[0];I(f,t.varSizeNonce?void 0:t.nonceLength,"nonce")}let o=t.tagLength;o&&i[1]!==void 0&&I(i[1],void 0,"AAD");let s=e(r,...i),a=(f,h)=>{if(h!==void 0){if(f!==2)throw new Error("cipher output not supported");I(h,void 0,"output")}},u=!1;return{encrypt(f,h){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,I(f),a(s.encrypt.length,h),s.encrypt(f,h)},decrypt(f,h){if(I(f),o&&f.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return a(s.decrypt.length,h),s.decrypt(f,h)}}}return Object.assign(n,t),n};function se(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error('"output" expected Uint8Array of length '+t+", got: "+e.length);if(n&&!Fe(e))throw new Error("invalid output, must be aligned");return e}function Pe(t,e,n){ee(n);let r=new Uint8Array(16),i=Ne(r);return i.setBigUint64(0,BigInt(e),n),i.setBigUint64(8,BigInt(t),n),r}function Fe(t){return t.byteOffset%4===0}function Z(t){return Uint8Array.from(t)}var ve=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),$e=ve("expand 16-byte k"),Ve=ve("expand 32-byte k"),We=M($e),Xe=M(Ve);function l(t,e){return t<<e|t>>>32-e}function ce(t){return t.byteOffset%4===0}var re=64,Ye=16,Ke=2**32-1,Ae=Uint32Array.of();function Je(t,e,n,r,i,o,s,a){let u=i.length,b=new Uint8Array(re),f=M(b),h=ce(i)&&ce(o),H=h?M(i):Ae,U=h?M(o):Ae;for(let y=0;y<u;s++){if(t(e,n,r,f,s,a),s>=Ke)throw new Error("arx: counter overflow");let p=Math.min(re,u-y);if(h&&p===re){let d=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let O=0,T;O<Ye;O++)T=d+O,U[T]=H[T]^f[O];y+=re;continue}for(let d=0,O;d<p;d++)O=y+d,o[O]=i[O]^b[d];y+=p}}function Ee(t,e){let{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:o,rounds:s}=ge({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return te(i),te(s),ee(o),ee(n),(a,u,b,f,h=0)=>{I(a,void 0,"key"),I(u,void 0,"nonce"),I(b,void 0,"data");let H=b.length;if(f===void 0&&(f=new Uint8Array(H)),I(f,void 0,"output"),te(h),h<0||h>=Ke)throw new Error("arx: counter overflow");if(f.length<H)throw new Error(`arx: output (${f.length}) is shorter than data (${H})`);let U=[],y=a.length,p,d;if(y===32)U.push(p=Z(a)),d=Xe;else if(y===16&&n)p=new Uint8Array(32),p.set(a),p.set(a,16),d=We,U.push(p);else throw I(a,32,"arx key"),new Error("invalid key size");ce(u)||U.push(u=Z(u));let O=M(p);if(r){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(d,O,M(u.subarray(0,16)),O),u=u.subarray(16)}let T=16-i;if(T!==u.length)throw new Error(`arx: nonce must be ${T} or 16 bytes`);if(T!==12){let N=new Uint8Array(12);N.set(u,o?0:12-u.length),u=N,U.push(u)}let R=M(u);return Je(t,d,O,R,b,f,h,s),G(...U),f}}function B(t,e){return t[e++]&255|(t[e++]&255)<<8}var ue=class{constructor(e){Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:new Uint8Array(16)}),Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(10)}),Object.defineProperty(this,"h",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(10)}),Object.defineProperty(this,"pad",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(8)}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e=Z(I(e,32,"key"));let n=B(e,0),r=B(e,2),i=B(e,4),o=B(e,6),s=B(e,8),a=B(e,10),u=B(e,12),b=B(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|u<<5)&8065,this.r[8]=(u>>>8|b<<8)&8191,this.r[9]=b>>>5&127;for(let f=0;f<8;f++)this.pad[f]=B(e,16+2*f)}process(e,n,r=!1){let i=r?0:2048,{h:o,r:s}=this,a=s[0],u=s[1],b=s[2],f=s[3],h=s[4],H=s[5],U=s[6],y=s[7],p=s[8],d=s[9],O=B(e,n+0),T=B(e,n+2),R=B(e,n+4),N=B(e,n+6),F=B(e,n+8),j=B(e,n+10),z=B(e,n+12),C=B(e,n+14),x=o[0]+(O&8191),w=o[1]+((O>>>13|T<<3)&8191),g=o[2]+((T>>>10|R<<6)&8191),m=o[3]+((R>>>7|N<<9)&8191),_=o[4]+((N>>>4|F<<12)&8191),P=o[5]+(F>>>1&8191),A=o[6]+((F>>>14|j<<2)&8191),v=o[7]+((j>>>11|z<<5)&8191),K=o[8]+((z>>>8|C<<8)&8191),E=o[9]+(C>>>5|i),c=0,S=c+x*a+w*(5*d)+g*(5*p)+m*(5*y)+_*(5*U);c=S>>>13,S&=8191,S+=P*(5*H)+A*(5*h)+v*(5*f)+K*(5*b)+E*(5*u),c+=S>>>13,S&=8191;let k=c+x*u+w*a+g*(5*d)+m*(5*p)+_*(5*y);c=k>>>13,k&=8191,k+=P*(5*U)+A*(5*H)+v*(5*h)+K*(5*f)+E*(5*b),c+=k>>>13,k&=8191;let L=c+x*b+w*u+g*a+m*(5*d)+_*(5*p);c=L>>>13,L&=8191,L+=P*(5*y)+A*(5*U)+v*(5*H)+K*(5*h)+E*(5*f),c+=L>>>13,L&=8191;let D=c+x*f+w*b+g*u+m*a+_*(5*d);c=D>>>13,D&=8191,D+=P*(5*p)+A*(5*y)+v*(5*U)+K*(5*H)+E*(5*h),c+=D>>>13,D&=8191;let $=c+x*h+w*f+g*b+m*u+_*a;c=$>>>13,$&=8191,$+=P*(5*d)+A*(5*p)+v*(5*y)+K*(5*U)+E*(5*H),c+=$>>>13,$&=8191;let V=c+x*H+w*h+g*f+m*b+_*u;c=V>>>13,V&=8191,V+=P*a+A*(5*d)+v*(5*p)+K*(5*y)+E*(5*U),c+=V>>>13,V&=8191;let W=c+x*U+w*H+g*h+m*f+_*b;c=W>>>13,W&=8191,W+=P*u+A*a+v*(5*d)+K*(5*p)+E*(5*y),c+=W>>>13,W&=8191;let X=c+x*y+w*U+g*H+m*h+_*f;c=X>>>13,X&=8191,X+=P*b+A*u+v*a+K*(5*d)+E*(5*p),c+=X>>>13,X&=8191;let Y=c+x*p+w*y+g*U+m*H+_*h;c=Y>>>13,Y&=8191,Y+=P*f+A*b+v*u+K*a+E*(5*d),c+=Y>>>13,Y&=8191;let J=c+x*d+w*p+g*y+m*U+_*H;c=J>>>13,J&=8191,J+=P*h+A*f+v*b+K*u+E*a,c+=J>>>13,J&=8191,c=(c<<2)+c|0,c=c+S|0,S=c&8191,c=c>>>13,k+=c,o[0]=S,o[1]=k,o[2]=L,o[3]=D,o[4]=$,o[5]=V,o[6]=W,o[7]=X,o[8]=Y,o[9]=J}finalize(){let{h:e,pad:n}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+i,i=r[a]>>>13,r[a]&=8191;r[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)r[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+n[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+n[a]|0)+(s>>>16)|0,e[a]=s&65535;G(r)}update(e){ae(this),I(e),e=Z(e);let{buffer:n,blockLen:r}=this,i=e.length;for(let o=0;o<i;){let s=Math.min(r-this.pos,i-o);if(s===r){for(;r<=i-o;o+=r)this.process(e,o);continue}n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){G(this.h,this.r,this.buffer,this.pad)}digestInto(e){ae(this),we(e,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:i}=this;if(i){for(n[i++]=1;i<16;i++)n[i]=0;this.process(n,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=r[s]>>>0,e[o++]=r[s]>>>8;return e}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}};function Ze(t){let e=(r,i)=>t(i).update(r).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}var Le=Ze(t=>new ue(t));function qe(t,e,n,r,i,o=20){let s=t[0],a=t[1],u=t[2],b=t[3],f=e[0],h=e[1],H=e[2],U=e[3],y=e[4],p=e[5],d=e[6],O=e[7],T=i,R=n[0],N=n[1],F=n[2],j=s,z=a,C=u,x=b,w=f,g=h,m=H,_=U,P=y,A=p,v=d,K=O,E=T,c=R,S=N,k=F;for(let D=0;D<o;D+=2)j=j+w|0,E=l(E^j,16),P=P+E|0,w=l(w^P,12),j=j+w|0,E=l(E^j,8),P=P+E|0,w=l(w^P,7),z=z+g|0,c=l(c^z,16),A=A+c|0,g=l(g^A,12),z=z+g|0,c=l(c^z,8),A=A+c|0,g=l(g^A,7),C=C+m|0,S=l(S^C,16),v=v+S|0,m=l(m^v,12),C=C+m|0,S=l(S^C,8),v=v+S|0,m=l(m^v,7),x=x+_|0,k=l(k^x,16),K=K+k|0,_=l(_^K,12),x=x+_|0,k=l(k^x,8),K=K+k|0,_=l(_^K,7),j=j+g|0,k=l(k^j,16),v=v+k|0,g=l(g^v,12),j=j+g|0,k=l(k^j,8),v=v+k|0,g=l(g^v,7),z=z+m|0,E=l(E^z,16),K=K+E|0,m=l(m^K,12),z=z+m|0,E=l(E^z,8),K=K+E|0,m=l(m^K,7),C=C+_|0,c=l(c^C,16),P=P+c|0,_=l(_^P,12),C=C+_|0,c=l(c^C,8),P=P+c|0,_=l(_^P,7),x=x+w|0,S=l(S^x,16),A=A+S|0,w=l(w^A,12),x=x+w|0,S=l(S^x,8),A=A+S|0,w=l(w^A,7);let L=0;r[L++]=s+j|0,r[L++]=a+z|0,r[L++]=u+C|0,r[L++]=b+x|0,r[L++]=f+w|0,r[L++]=h+g|0,r[L++]=H+m|0,r[L++]=U+_|0,r[L++]=y+P|0,r[L++]=p+A|0,r[L++]=d+v|0,r[L++]=O+K|0,r[L++]=T+E|0,r[L++]=R+c|0,r[L++]=N+S|0,r[L++]=F+k|0}var Qe=Ee(qe,{counterRight:!1,counterLength:4,allowShortKeys:!1}),et=new Uint8Array(16),Se=(t,e)=>{t.update(e);let n=e.length%16;n&&t.update(et.subarray(n))},tt=new Uint8Array(32);function Ue(t,e,n,r,i){i!==void 0&&I(i,void 0,"AAD");let o=t(e,n,tt),s=Pe(r.length,i?i.length:0,!0),a=Le.create(o);i&&Se(a,i),Se(a,r),a.update(s);let u=a.digest();return G(o,s),u}var rt=t=>(e,n,r)=>({encrypt(o,s){let a=o.length;s=se(a+16,s,!1),s.set(o);let u=s.subarray(0,-16);t(e,n,u,u,1);let b=Ue(t,e,n,u,r);return s.set(b,a),G(b),s},decrypt(o,s){s=se(o.length-16,s,!1);let a=o.subarray(0,-16),u=o.subarray(-16),b=Ue(t,e,n,a,r);if(!me(u,b))throw new Error("invalid tag");return s.set(o.subarray(0,-16)),t(e,n,s,s,1),G(b),s}}),fe=_e({blockSize:64,nonceLength:12,tagLength:16},rt(Qe));var nt={},ke=it(globalThis,nt);function it(t,e){return new Proxy(t,{get(n,r,i){return r in e?e[r]:t[r]},set(n,r,i){return r in e&&delete e[r],t[r]=i,!0},deleteProperty(n,r){let i=!1;return r in e&&(delete e[r],i=!0),r in t&&(delete t[r],i=!0),i},ownKeys(n){let r=Reflect.ownKeys(t),i=Reflect.ownKeys(e),o=new Set(i);return[...r.filter(s=>!o.has(s)),...i]},defineProperty(n,r,i){return r in e&&delete e[r],Reflect.defineProperty(t,r,i),!0},getOwnPropertyDescriptor(n,r){return r in e?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(t,r)},has(n,r){return r in e||r in t}})}var le={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var q=new Uint8Array(0);var he=new Uint8Array([75,69,77,0,0]);var Dt=new Uint8Array([101,97,101,95,112,114,107]),Mt=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var ye=new Uint8Array([100,107,112,95,112,114,107]),ze=new Uint8Array([115,107]);var Qt=new Uint8Array([99,97,110,100,105,100,97,116,101]),er=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),tr=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),rr=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),nr=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),ir=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),or=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var mr=new Uint8Array([72,80,75,69,45,118,49]);function bt(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Q(t,e,n=""){let r=bt(t),i=t?.length,o=e!==void 0;if(!r||o&&i!==e){let s=n&&`"${n}" `,a=o?` of length ${e}`:"",u=r?`length=${i}`:`type=${typeof t}`;throw new Error(s+"expected Uint8Array"+a+", got "+u)}return t}function De(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Te(t.outputLen),Te(t.blockLen)}function ne(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Te(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ie(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}var oe=class{constructor(e,n){if(Object.defineProperty(this,"oHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),De(e),Q(n,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),ie(i)}update(e){return ne(this),this.iHash.update(e),this}digestInto(e){ne(this),Q(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});let{oHash:n,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Me=(t,e,n)=>new oe(t,e).update(n).digest();Me.create=(t,e)=>new oe(t,e);var pn=BigInt(0),xn=BigInt(1),wn=BigInt(2);var pe=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,n,r){return await this._seal(e,n,r)}async open(e,n,r){return await this._open(e,n,r)}_seal(e,n,r){return new Promise(i=>{let o=fe(this._key,new Uint8Array(e),new Uint8Array(r)).encrypt(new Uint8Array(n));i(o.buffer)})}_open(e,n,r){return new Promise(i=>{let o=fe(this._key,new Uint8Array(e),new Uint8Array(r)).decrypt(new Uint8Array(n));i(o.buffer)})}},xe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:le.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new pe(e)}};export{xe as Chacha20Poly1305};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
