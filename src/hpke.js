var Pa=Object.create;var nf=Object.defineProperty;var ka=Object.getOwnPropertyDescriptor;var Ia=Object.getOwnPropertyNames;var La=Object.getPrototypeOf,Ta=Object.prototype.hasOwnProperty;var Ut=(f=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(f,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):f)(function(f){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+f+'" is not supported')});var Ze=(f,t)=>()=>(t||f((t={exports:{}}).exports,t),t.exports);var za=(f,t,i,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ia(t))!Ta.call(f,n)&&n!==i&&nf(f,n,{get:()=>t[n],enumerable:!(e=ka(t,n))||e.enumerable});return f};var qt=(f,t,i)=>(i=f!=null?Pa(La(f)):{},za(t||!f||!f.__esModule?nf(i,"default",{value:f,enumerable:!0}):i,f));var Pf=Ze(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});function Ra(f,t){var i=f>>>16&65535,e=f&65535,n=t>>>16&65535,y=t&65535;return e*y+(i*y+e*n<<16>>>0)|0}ft.mul=Math.imul||Ra;function Ua(f,t){return f+t|0}ft.add=Ua;function Oa(f,t){return f-t|0}ft.sub=Oa;function Ha(f,t){return f<<t|f>>>32-t}ft.rotl=Ha;function Da(f,t){return f<<32-t|f>>>t}ft.rotr=Da;function Na(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}ft.isInteger=Number.isInteger||Na;ft.MAX_SAFE_INTEGER=9007199254740991;ft.isSafeInteger=function(f){return ft.isInteger(f)&&f>=-ft.MAX_SAFE_INTEGER&&f<=ft.MAX_SAFE_INTEGER}});var Xt=Ze(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var kf=Pf();function Ca(f,t){return t===void 0&&(t=0),(f[t+0]<<8|f[t+1])<<16>>16}ie.readInt16BE=Ca;function qa(f,t){return t===void 0&&(t=0),(f[t+0]<<8|f[t+1])>>>0}ie.readUint16BE=qa;function ja(f,t){return t===void 0&&(t=0),(f[t+1]<<8|f[t])<<16>>16}ie.readInt16LE=ja;function Fa(f,t){return t===void 0&&(t=0),(f[t+1]<<8|f[t])>>>0}ie.readUint16LE=Fa;function If(f,t,i){return t===void 0&&(t=new Uint8Array(2)),i===void 0&&(i=0),t[i+0]=f>>>8,t[i+1]=f>>>0,t}ie.writeUint16BE=If;ie.writeInt16BE=If;function Lf(f,t,i){return t===void 0&&(t=new Uint8Array(2)),i===void 0&&(i=0),t[i+0]=f>>>0,t[i+1]=f>>>8,t}ie.writeUint16LE=Lf;ie.writeInt16LE=Lf;function Hi(f,t){return t===void 0&&(t=0),f[t]<<24|f[t+1]<<16|f[t+2]<<8|f[t+3]}ie.readInt32BE=Hi;function Di(f,t){return t===void 0&&(t=0),(f[t]<<24|f[t+1]<<16|f[t+2]<<8|f[t+3])>>>0}ie.readUint32BE=Di;function Ni(f,t){return t===void 0&&(t=0),f[t+3]<<24|f[t+2]<<16|f[t+1]<<8|f[t]}ie.readInt32LE=Ni;function Ci(f,t){return t===void 0&&(t=0),(f[t+3]<<24|f[t+2]<<16|f[t+1]<<8|f[t])>>>0}ie.readUint32LE=Ci;function $r(f,t,i){return t===void 0&&(t=new Uint8Array(4)),i===void 0&&(i=0),t[i+0]=f>>>24,t[i+1]=f>>>16,t[i+2]=f>>>8,t[i+3]=f>>>0,t}ie.writeUint32BE=$r;ie.writeInt32BE=$r;function Qr(f,t,i){return t===void 0&&(t=new Uint8Array(4)),i===void 0&&(i=0),t[i+0]=f>>>0,t[i+1]=f>>>8,t[i+2]=f>>>16,t[i+3]=f>>>24,t}ie.writeUint32LE=Qr;ie.writeInt32LE=Qr;function Ga(f,t){t===void 0&&(t=0);var i=Hi(f,t),e=Hi(f,t+4);return i*4294967296+e-(e>>31)*4294967296}ie.readInt64BE=Ga;function Va(f,t){t===void 0&&(t=0);var i=Di(f,t),e=Di(f,t+4);return i*4294967296+e}ie.readUint64BE=Va;function Xa(f,t){t===void 0&&(t=0);var i=Ni(f,t),e=Ni(f,t+4);return e*4294967296+i-(i>>31)*4294967296}ie.readInt64LE=Xa;function Ya(f,t){t===void 0&&(t=0);var i=Ci(f,t),e=Ci(f,t+4);return e*4294967296+i}ie.readUint64LE=Ya;function Tf(f,t,i){return t===void 0&&(t=new Uint8Array(8)),i===void 0&&(i=0),$r(f/4294967296>>>0,t,i),$r(f>>>0,t,i+4),t}ie.writeUint64BE=Tf;ie.writeInt64BE=Tf;function zf(f,t,i){return t===void 0&&(t=new Uint8Array(8)),i===void 0&&(i=0),Qr(f>>>0,t,i),Qr(f/4294967296>>>0,t,i+4),t}ie.writeUint64LE=zf;ie.writeInt64LE=zf;function Za(f,t,i){if(i===void 0&&(i=0),f%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(f/8>t.length-i)throw new Error("readUintBE: array is too short for the given bitLength");for(var e=0,n=1,y=f/8+i-1;y>=i;y--)e+=t[y]*n,n*=256;return e}ie.readUintBE=Za;function Ja(f,t,i){if(i===void 0&&(i=0),f%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(f/8>t.length-i)throw new Error("readUintLE: array is too short for the given bitLength");for(var e=0,n=1,y=i;y<i+f/8;y++)e+=t[y]*n,n*=256;return e}ie.readUintLE=Ja;function Wa(f,t,i,e){if(i===void 0&&(i=new Uint8Array(f/8)),e===void 0&&(e=0),f%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!kf.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var n=1,y=f/8+e-1;y>=e;y--)i[y]=t/n&255,n*=256;return i}ie.writeUintBE=Wa;function $a(f,t,i,e){if(i===void 0&&(i=new Uint8Array(f/8)),e===void 0&&(e=0),f%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!kf.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var n=1,y=e;y<e+f/8;y++)i[y]=t/n&255,n*=256;return i}ie.writeUintLE=$a;function Qa(f,t){t===void 0&&(t=0);var i=new DataView(f.buffer,f.byteOffset,f.byteLength);return i.getFloat32(t)}ie.readFloat32BE=Qa;function en(f,t){t===void 0&&(t=0);var i=new DataView(f.buffer,f.byteOffset,f.byteLength);return i.getFloat32(t,!0)}ie.readFloat32LE=en;function tn(f,t){t===void 0&&(t=0);var i=new DataView(f.buffer,f.byteOffset,f.byteLength);return i.getFloat64(t)}ie.readFloat64BE=tn;function rn(f,t){t===void 0&&(t=0);var i=new DataView(f.buffer,f.byteOffset,f.byteLength);return i.getFloat64(t,!0)}ie.readFloat64LE=rn;function fn(f,t,i){t===void 0&&(t=new Uint8Array(4)),i===void 0&&(i=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat32(i,f),t}ie.writeFloat32BE=fn;function an(f,t,i){t===void 0&&(t=new Uint8Array(4)),i===void 0&&(i=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat32(i,f,!0),t}ie.writeFloat32LE=an;function nn(f,t,i){t===void 0&&(t=new Uint8Array(8)),i===void 0&&(i=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat64(i,f),t}ie.writeFloat64BE=nn;function sn(f,t,i){t===void 0&&(t=new Uint8Array(8)),i===void 0&&(i=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat64(i,f,!0),t}ie.writeFloat64LE=sn});var bt=Ze(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});function hn(f){for(var t=0;t<f.length;t++)f[t]=0;return f}qi.wipe=hn});var Kf=Ze(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});var Je=Xt(),ji=bt(),on=20;function dn(f,t,i){for(var e=1634760805,n=857760878,y=2036477234,I=1797285236,s=i[3]<<24|i[2]<<16|i[1]<<8|i[0],S=i[7]<<24|i[6]<<16|i[5]<<8|i[4],E=i[11]<<24|i[10]<<16|i[9]<<8|i[8],_=i[15]<<24|i[14]<<16|i[13]<<8|i[12],v=i[19]<<24|i[18]<<16|i[17]<<8|i[16],d=i[23]<<24|i[22]<<16|i[21]<<8|i[20],u=i[27]<<24|i[26]<<16|i[25]<<8|i[24],M=i[31]<<24|i[30]<<16|i[29]<<8|i[28],k=t[3]<<24|t[2]<<16|t[1]<<8|t[0],T=t[7]<<24|t[6]<<16|t[5]<<8|t[4],L=t[11]<<24|t[10]<<16|t[9]<<8|t[8],z=t[15]<<24|t[14]<<16|t[13]<<8|t[12],R=e,U=n,H=y,D=I,K=s,B=S,N=E,q=_,C=v,x=d,r=u,h=M,o=k,c=T,l=L,g=z,P=0;P<on;P+=2)R=R+K|0,o^=R,o=o>>>32-16|o<<16,C=C+o|0,K^=C,K=K>>>32-12|K<<12,U=U+B|0,c^=U,c=c>>>32-16|c<<16,x=x+c|0,B^=x,B=B>>>32-12|B<<12,H=H+N|0,l^=H,l=l>>>32-16|l<<16,r=r+l|0,N^=r,N=N>>>32-12|N<<12,D=D+q|0,g^=D,g=g>>>32-16|g<<16,h=h+g|0,q^=h,q=q>>>32-12|q<<12,H=H+N|0,l^=H,l=l>>>32-8|l<<8,r=r+l|0,N^=r,N=N>>>32-7|N<<7,D=D+q|0,g^=D,g=g>>>32-8|g<<8,h=h+g|0,q^=h,q=q>>>32-7|q<<7,U=U+B|0,c^=U,c=c>>>32-8|c<<8,x=x+c|0,B^=x,B=B>>>32-7|B<<7,R=R+K|0,o^=R,o=o>>>32-8|o<<8,C=C+o|0,K^=C,K=K>>>32-7|K<<7,R=R+B|0,g^=R,g=g>>>32-16|g<<16,r=r+g|0,B^=r,B=B>>>32-12|B<<12,U=U+N|0,o^=U,o=o>>>32-16|o<<16,h=h+o|0,N^=h,N=N>>>32-12|N<<12,H=H+q|0,c^=H,c=c>>>32-16|c<<16,C=C+c|0,q^=C,q=q>>>32-12|q<<12,D=D+K|0,l^=D,l=l>>>32-16|l<<16,x=x+l|0,K^=x,K=K>>>32-12|K<<12,H=H+q|0,c^=H,c=c>>>32-8|c<<8,C=C+c|0,q^=C,q=q>>>32-7|q<<7,D=D+K|0,l^=D,l=l>>>32-8|l<<8,x=x+l|0,K^=x,K=K>>>32-7|K<<7,U=U+N|0,o^=U,o=o>>>32-8|o<<8,h=h+o|0,N^=h,N=N>>>32-7|N<<7,R=R+B|0,g^=R,g=g>>>32-8|g<<8,r=r+g|0,B^=r,B=B>>>32-7|B<<7;Je.writeUint32LE(R+e|0,f,0),Je.writeUint32LE(U+n|0,f,4),Je.writeUint32LE(H+y|0,f,8),Je.writeUint32LE(D+I|0,f,12),Je.writeUint32LE(K+s|0,f,16),Je.writeUint32LE(B+S|0,f,20),Je.writeUint32LE(N+E|0,f,24),Je.writeUint32LE(q+_|0,f,28),Je.writeUint32LE(C+v|0,f,32),Je.writeUint32LE(x+d|0,f,36),Je.writeUint32LE(r+u|0,f,40),Je.writeUint32LE(h+M|0,f,44),Je.writeUint32LE(o+k|0,f,48),Je.writeUint32LE(c+T|0,f,52),Je.writeUint32LE(l+L|0,f,56),Je.writeUint32LE(g+z|0,f,60)}function Bf(f,t,i,e,n){if(n===void 0&&(n=0),f.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(e.length<i.length)throw new Error("ChaCha: destination is shorter than source");var y,I;if(n===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");y=new Uint8Array(16),I=y.length-t.length,y.set(t,I)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");y=t,I=n}for(var s=new Uint8Array(64),S=0;S<i.length;S+=64){dn(s,y,f);for(var E=S;E<S+64&&E<i.length;E++)e[E]=i[E]^s[E-S];un(y,0,I)}return ji.wipe(s),n===0&&ji.wipe(y),e}ei.streamXOR=Bf;function cn(f,t,i,e){return e===void 0&&(e=0),ji.wipe(i),Bf(f,t,i,i,e)}ei.stream=cn;function un(f,t,i){for(var e=1;i--;)e=e+(f[t]&255)|0,f[t]=e&255,e>>>=8,t++;if(e>0)throw new Error("ChaCha: counter overflow")}});var ti=Ze(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});function ln(f,t,i){return~(f-1)&t|f-1&i}Yt.select=ln;function bn(f,t){return(f|0)-(t|0)-1>>>31&1}Yt.lessOrEqual=bn;function Rf(f,t){if(f.length!==t.length)return 0;for(var i=0,e=0;e<f.length;e++)i|=f[e]^t[e];return 1&i-1>>>8}Yt.compare=Rf;function vn(f,t){return f.length===0||t.length===0?!1:Rf(f,t)!==0}Yt.equal=vn});var Of=Ze(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});var pn=ti(),ri=bt();xt.DIGEST_LENGTH=16;var Uf=function(){function f(t){this.digestLength=xt.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var i=t[0]|t[1]<<8;this._r[0]=i&8191;var e=t[2]|t[3]<<8;this._r[1]=(i>>>13|e<<3)&8191;var n=t[4]|t[5]<<8;this._r[2]=(e>>>10|n<<6)&7939;var y=t[6]|t[7]<<8;this._r[3]=(n>>>7|y<<9)&8191;var I=t[8]|t[9]<<8;this._r[4]=(y>>>4|I<<12)&255,this._r[5]=I>>>1&8190;var s=t[10]|t[11]<<8;this._r[6]=(I>>>14|s<<2)&8191;var S=t[12]|t[13]<<8;this._r[7]=(s>>>11|S<<5)&8065;var E=t[14]|t[15]<<8;this._r[8]=(S>>>8|E<<8)&8191,this._r[9]=E>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return f.prototype._blocks=function(t,i,e){for(var n=this._fin?0:2048,y=this._h[0],I=this._h[1],s=this._h[2],S=this._h[3],E=this._h[4],_=this._h[5],v=this._h[6],d=this._h[7],u=this._h[8],M=this._h[9],k=this._r[0],T=this._r[1],L=this._r[2],z=this._r[3],R=this._r[4],U=this._r[5],H=this._r[6],D=this._r[7],K=this._r[8],B=this._r[9];e>=16;){var N=t[i+0]|t[i+1]<<8;y+=N&8191;var q=t[i+2]|t[i+3]<<8;I+=(N>>>13|q<<3)&8191;var C=t[i+4]|t[i+5]<<8;s+=(q>>>10|C<<6)&8191;var x=t[i+6]|t[i+7]<<8;S+=(C>>>7|x<<9)&8191;var r=t[i+8]|t[i+9]<<8;E+=(x>>>4|r<<12)&8191,_+=r>>>1&8191;var h=t[i+10]|t[i+11]<<8;v+=(r>>>14|h<<2)&8191;var o=t[i+12]|t[i+13]<<8;d+=(h>>>11|o<<5)&8191;var c=t[i+14]|t[i+15]<<8;u+=(o>>>8|c<<8)&8191,M+=c>>>5|n;var l=0,g=l;g+=y*k,g+=I*(5*B),g+=s*(5*K),g+=S*(5*D),g+=E*(5*H),l=g>>>13,g&=8191,g+=_*(5*U),g+=v*(5*R),g+=d*(5*z),g+=u*(5*L),g+=M*(5*T),l+=g>>>13,g&=8191;var P=l;P+=y*T,P+=I*k,P+=s*(5*B),P+=S*(5*K),P+=E*(5*D),l=P>>>13,P&=8191,P+=_*(5*H),P+=v*(5*U),P+=d*(5*R),P+=u*(5*z),P+=M*(5*L),l+=P>>>13,P&=8191;var p=l;p+=y*L,p+=I*T,p+=s*k,p+=S*(5*B),p+=E*(5*K),l=p>>>13,p&=8191,p+=_*(5*D),p+=v*(5*H),p+=d*(5*U),p+=u*(5*R),p+=M*(5*z),l+=p>>>13,p&=8191;var a=l;a+=y*z,a+=I*L,a+=s*T,a+=S*k,a+=E*(5*B),l=a>>>13,a&=8191,a+=_*(5*K),a+=v*(5*D),a+=d*(5*H),a+=u*(5*U),a+=M*(5*R),l+=a>>>13,a&=8191;var w=l;w+=y*R,w+=I*z,w+=s*L,w+=S*T,w+=E*k,l=w>>>13,w&=8191,w+=_*(5*B),w+=v*(5*K),w+=d*(5*D),w+=u*(5*H),w+=M*(5*U),l+=w>>>13,w&=8191;var j=l;j+=y*U,j+=I*R,j+=s*z,j+=S*L,j+=E*T,l=j>>>13,j&=8191,j+=_*k,j+=v*(5*B),j+=d*(5*K),j+=u*(5*D),j+=M*(5*H),l+=j>>>13,j&=8191;var F=l;F+=y*H,F+=I*U,F+=s*R,F+=S*z,F+=E*L,l=F>>>13,F&=8191,F+=_*T,F+=v*k,F+=d*(5*B),F+=u*(5*K),F+=M*(5*D),l+=F>>>13,F&=8191;var G=l;G+=y*D,G+=I*H,G+=s*U,G+=S*R,G+=E*z,l=G>>>13,G&=8191,G+=_*L,G+=v*T,G+=d*k,G+=u*(5*B),G+=M*(5*K),l+=G>>>13,G&=8191;var X=l;X+=y*K,X+=I*D,X+=s*H,X+=S*U,X+=E*R,l=X>>>13,X&=8191,X+=_*z,X+=v*L,X+=d*T,X+=u*k,X+=M*(5*B),l+=X>>>13,X&=8191;var Z=l;Z+=y*B,Z+=I*K,Z+=s*D,Z+=S*H,Z+=E*U,l=Z>>>13,Z&=8191,Z+=_*R,Z+=v*z,Z+=d*L,Z+=u*T,Z+=M*k,l+=Z>>>13,Z&=8191,l=(l<<2)+l|0,l=l+g|0,g=l&8191,l=l>>>13,P+=l,y=g,I=P,s=p,S=a,E=w,_=j,v=F,d=G,u=X,M=Z,i+=16,e-=16}this._h[0]=y,this._h[1]=I,this._h[2]=s,this._h[3]=S,this._h[4]=E,this._h[5]=_,this._h[6]=v,this._h[7]=d,this._h[8]=u,this._h[9]=M},f.prototype.finish=function(t,i){i===void 0&&(i=0);var e=new Uint16Array(10),n,y,I,s;if(this._leftover){for(s=this._leftover,this._buffer[s++]=1;s<16;s++)this._buffer[s]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,s=2;s<10;s++)this._h[s]+=n,n=this._h[s]>>>13,this._h[s]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,e[0]=this._h[0]+5,n=e[0]>>>13,e[0]&=8191,s=1;s<10;s++)e[s]=this._h[s]+n,n=e[s]>>>13,e[s]&=8191;for(e[9]-=1<<13,y=(n^1)-1,s=0;s<10;s++)e[s]&=y;for(y=~y,s=0;s<10;s++)this._h[s]=this._h[s]&y|e[s];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,I=this._h[0]+this._pad[0],this._h[0]=I&65535,s=1;s<8;s++)I=(this._h[s]+this._pad[s]|0)+(I>>>16)|0,this._h[s]=I&65535;return t[i+0]=this._h[0]>>>0,t[i+1]=this._h[0]>>>8,t[i+2]=this._h[1]>>>0,t[i+3]=this._h[1]>>>8,t[i+4]=this._h[2]>>>0,t[i+5]=this._h[2]>>>8,t[i+6]=this._h[3]>>>0,t[i+7]=this._h[3]>>>8,t[i+8]=this._h[4]>>>0,t[i+9]=this._h[4]>>>8,t[i+10]=this._h[5]>>>0,t[i+11]=this._h[5]>>>8,t[i+12]=this._h[6]>>>0,t[i+13]=this._h[6]>>>8,t[i+14]=this._h[7]>>>0,t[i+15]=this._h[7]>>>8,this._finished=!0,this},f.prototype.update=function(t){var i=0,e=t.length,n;if(this._leftover){n=16-this._leftover,n>e&&(n=e);for(var y=0;y<n;y++)this._buffer[this._leftover+y]=t[i+y];if(e-=n,i+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(e>=16&&(n=e-e%16,this._blocks(t,i,n),i+=n,e-=n),e){for(var y=0;y<e;y++)this._buffer[this._leftover+y]=t[i+y];this._leftover+=e}return this},f.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},f.prototype.clean=function(){return ri.wipe(this._buffer),ri.wipe(this._r),ri.wipe(this._h),ri.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},f}();xt.Poly1305=Uf;function mn(f,t){var i=new Uf(f);i.update(t);var e=i.digest();return i.clean(),e}xt.oneTimeAuth=mn;function yn(f,t){return f.length!==xt.DIGEST_LENGTH||t.length!==xt.DIGEST_LENGTH?!1:pn.equal(f,t)}xt.equal=yn});var Nf=Ze(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});var ii=Kf(),xn=Of(),_r=bt(),Hf=Xt(),wn=ti();wt.KEY_LENGTH=32;wt.NONCE_LENGTH=12;wt.TAG_LENGTH=16;var Df=new Uint8Array(16),gn=function(){function f(t){if(this.nonceLength=wt.NONCE_LENGTH,this.tagLength=wt.TAG_LENGTH,t.length!==wt.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return f.prototype.seal=function(t,i,e,n){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var y=new Uint8Array(16);y.set(t,y.length-t.length);var I=new Uint8Array(32);ii.stream(this._key,y,I,4);var s=i.length+this.tagLength,S;if(n){if(n.length!==s)throw new Error("ChaCha20Poly1305: incorrect destination length");S=n}else S=new Uint8Array(s);return ii.streamXOR(this._key,y,i,S,4),this._authenticate(S.subarray(S.length-this.tagLength,S.length),I,S.subarray(0,S.length-this.tagLength),e),_r.wipe(y),S},f.prototype.open=function(t,i,e,n){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(i.length<this.tagLength)return null;var y=new Uint8Array(16);y.set(t,y.length-t.length);var I=new Uint8Array(32);ii.stream(this._key,y,I,4);var s=new Uint8Array(this.tagLength);if(this._authenticate(s,I,i.subarray(0,i.length-this.tagLength),e),!wn.equal(s,i.subarray(i.length-this.tagLength,i.length)))return null;var S=i.length-this.tagLength,E;if(n){if(n.length!==S)throw new Error("ChaCha20Poly1305: incorrect destination length");E=n}else E=new Uint8Array(S);return ii.streamXOR(this._key,y,i.subarray(0,i.length-this.tagLength),E,4),_r.wipe(y),E},f.prototype.clean=function(){return _r.wipe(this._key),this},f.prototype._authenticate=function(t,i,e,n){var y=new xn.Poly1305(i);n&&(y.update(n),n.length%16>0&&y.update(Df.subarray(n.length%16))),y.update(e),e.length%16>0&&y.update(Df.subarray(e.length%16));var I=new Uint8Array(8);n&&Hf.writeUint64LE(n.length,I),y.update(I),Hf.writeUint64LE(e.length,I),y.update(I);for(var s=y.digest(),S=0;S<s.length;S++)t[S]=s[S];y.clean(),_r.wipe(s),_r.wipe(I)},f}();wt.ChaCha20Poly1305=gn});var qf=Ze(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});function _n(f){return typeof f.saveState<"u"&&typeof f.restoreState<"u"&&typeof f.cleanSavedState<"u"}Fi.isSerializableHash=_n});var Ff=Ze(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});var vt=qf(),Sn=ti(),Mn=bt(),jf=function(){function f(t,i){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var e=new Uint8Array(this.blockSize);i.length>this.blockSize?this._inner.update(i).finish(e).clean():e.set(i);for(var n=0;n<e.length;n++)e[n]^=54;this._inner.update(e);for(var n=0;n<e.length;n++)e[n]^=106;this._outer.update(e),vt.isSerializableHash(this._inner)&&vt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Mn.wipe(e)}return f.prototype.reset=function(){if(!vt.isSerializableHash(this._inner)||!vt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},f.prototype.clean=function(){vt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),vt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},f.prototype.update=function(t){return this._inner.update(t),this},f.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},f.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},f.prototype.saveState=function(){if(!vt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},f.prototype.restoreState=function(t){if(!vt.isSerializableHash(this._inner)||!vt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},f.prototype.cleanSavedState=function(t){if(!vt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},f}();Sr.HMAC=jf;function An(f,t,i){var e=new jf(f,t);e.update(i);var n=e.digest();return e.clean(),n}Sr.hmac=An;Sr.equal=Sn.equal});var Vf=Ze(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});var si=Xt(),ni=bt();Lt.DIGEST_LENGTH=32;Lt.BLOCK_SIZE=64;var Gf=function(){function f(){this.digestLength=Lt.DIGEST_LENGTH,this.blockSize=Lt.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){ni.wipe(this._buffer),ni.wipe(this._temp),this.reset()},f.prototype.update=function(t,i){if(i===void 0&&(i=t.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var e=0;if(this._bytesHashed+=i,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&i>0;)this._buffer[this._bufferLength++]=t[e++],i--;this._bufferLength===this.blockSize&&(Gi(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(i>=this.blockSize&&(e=Gi(this._temp,this._state,t,e,i),i%=this.blockSize);i>0;)this._buffer[this._bufferLength++]=t[e++],i--;return this},f.prototype.finish=function(t){if(!this._finished){var i=this._bytesHashed,e=this._bufferLength,n=i/536870912|0,y=i<<3,I=i%64<56?64:128;this._buffer[e]=128;for(var s=e+1;s<I-8;s++)this._buffer[s]=0;si.writeUint32BE(n,this._buffer,I-8),si.writeUint32BE(y,this._buffer,I-4),Gi(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var s=0;s<this.digestLength/4;s++)si.writeUint32BE(this._state[s],t,s*4);return this},f.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(t){return this._state.set(t.state),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(t){ni.wipe(t.state),t.buffer&&ni.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},f}();Lt.SHA256=Gf;var En=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Gi(f,t,i,e,n){for(;n>=64;){for(var y=t[0],I=t[1],s=t[2],S=t[3],E=t[4],_=t[5],v=t[6],d=t[7],u=0;u<16;u++){var M=e+u*4;f[u]=si.readUint32BE(i,M)}for(var u=16;u<64;u++){var k=f[u-2],T=(k>>>17|k<<32-17)^(k>>>19|k<<32-19)^k>>>10;k=f[u-15];var L=(k>>>7|k<<32-7)^(k>>>18|k<<32-18)^k>>>3;f[u]=(T+f[u-7]|0)+(L+f[u-16]|0)}for(var u=0;u<64;u++){var T=(((E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7))+(E&_^~E&v)|0)+(d+(En[u]+f[u]|0)|0)|0,L=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&I^y&s^I&s)|0;d=v,v=_,_=E,E=S+T|0,S=s,s=I,I=y,y=T+L|0}t[0]+=y,t[1]+=I,t[2]+=s,t[3]+=S,t[4]+=E,t[5]+=_,t[6]+=v,t[7]+=d,e+=64,n-=64}return e}function Pn(f){var t=new Gf;t.update(f);var i=t.digest();return t.clean(),i}Lt.hash=Pn});var Zf=Ze(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});var Wt=Xt(),Jt=bt();gt.DIGEST_LENGTH=64;gt.BLOCK_SIZE=128;var Yf=function(){function f(){this.digestLength=gt.DIGEST_LENGTH,this.blockSize=gt.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){Jt.wipe(this._buffer),Jt.wipe(this._tempHi),Jt.wipe(this._tempLo),this.reset()},f.prototype.update=function(t,i){if(i===void 0&&(i=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var e=0;if(this._bytesHashed+=i,this._bufferLength>0){for(;this._bufferLength<gt.BLOCK_SIZE&&i>0;)this._buffer[this._bufferLength++]=t[e++],i--;this._bufferLength===this.blockSize&&(Vi(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(i>=this.blockSize&&(e=Vi(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,e,i),i%=this.blockSize);i>0;)this._buffer[this._bufferLength++]=t[e++],i--;return this},f.prototype.finish=function(t){if(!this._finished){var i=this._bytesHashed,e=this._bufferLength,n=i/536870912|0,y=i<<3,I=i%128<112?128:256;this._buffer[e]=128;for(var s=e+1;s<I-8;s++)this._buffer[s]=0;Wt.writeUint32BE(n,this._buffer,I-8),Wt.writeUint32BE(y,this._buffer,I-4),Vi(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,I),this._finished=!0}for(var s=0;s<this.digestLength/8;s++)Wt.writeUint32BE(this._stateHi[s],t,s*8),Wt.writeUint32BE(this._stateLo[s],t,s*8+4);return this},f.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(t){Jt.wipe(t.stateHi),Jt.wipe(t.stateLo),t.buffer&&Jt.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},f}();gt.SHA512=Yf;var Xf=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function Vi(f,t,i,e,n,y,I){for(var s=i[0],S=i[1],E=i[2],_=i[3],v=i[4],d=i[5],u=i[6],M=i[7],k=e[0],T=e[1],L=e[2],z=e[3],R=e[4],U=e[5],H=e[6],D=e[7],K,B,N,q,C,x,r,h;I>=128;){for(var o=0;o<16;o++){var c=8*o+y;f[o]=Wt.readUint32BE(n,c),t[o]=Wt.readUint32BE(n,c+4)}for(var o=0;o<80;o++){var l=s,g=S,P=E,p=_,a=v,w=d,j=u,F=M,G=k,X=T,Z=L,$=z,fe=R,Q=U,ee=H,se=D;if(K=M,B=D,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=(v>>>14|R<<32-14)^(v>>>18|R<<32-18)^(R>>>41-32|v<<32-(41-32)),B=(R>>>14|v<<32-14)^(R>>>18|v<<32-18)^(v>>>41-32|R<<32-(41-32)),C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,K=v&d^~v&u,B=R&U^~R&H,C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,K=Xf[o*2],B=Xf[o*2+1],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,K=f[o%16],B=t[o%16],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,N=r&65535|h<<16,q=C&65535|x<<16,K=N,B=q,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=(s>>>28|k<<32-28)^(k>>>34-32|s<<32-(34-32))^(k>>>39-32|s<<32-(39-32)),B=(k>>>28|s<<32-28)^(s>>>34-32|k<<32-(34-32))^(s>>>39-32|k<<32-(39-32)),C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,K=s&S^s&E^S&E,B=k&T^k&L^T&L,C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,F=r&65535|h<<16,se=C&65535|x<<16,K=p,B=$,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=N,B=q,C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,p=r&65535|h<<16,$=C&65535|x<<16,S=l,E=g,_=P,v=p,d=a,u=w,M=j,s=F,T=G,L=X,z=Z,R=$,U=fe,H=Q,D=ee,k=se,o%16===15)for(var c=0;c<16;c++)K=f[c],B=t[c],C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=f[(c+9)%16],B=t[(c+9)%16],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,N=f[(c+1)%16],q=t[(c+1)%16],K=(N>>>1|q<<32-1)^(N>>>8|q<<32-8)^N>>>7,B=(q>>>1|N<<32-1)^(q>>>8|N<<32-8)^(q>>>7|N<<32-7),C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,N=f[(c+14)%16],q=t[(c+14)%16],K=(N>>>19|q<<32-19)^(q>>>61-32|N<<32-(61-32))^N>>>6,B=(q>>>19|N<<32-19)^(N>>>61-32|q<<32-(61-32))^(q>>>6|N<<32-6),C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,f[c]=r&65535|h<<16,t[c]=C&65535|x<<16}K=s,B=k,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[0],B=e[0],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[0]=s=r&65535|h<<16,e[0]=k=C&65535|x<<16,K=S,B=T,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[1],B=e[1],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[1]=S=r&65535|h<<16,e[1]=T=C&65535|x<<16,K=E,B=L,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[2],B=e[2],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[2]=E=r&65535|h<<16,e[2]=L=C&65535|x<<16,K=_,B=z,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[3],B=e[3],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[3]=_=r&65535|h<<16,e[3]=z=C&65535|x<<16,K=v,B=R,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[4],B=e[4],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[4]=v=r&65535|h<<16,e[4]=R=C&65535|x<<16,K=d,B=U,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[5],B=e[5],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[5]=d=r&65535|h<<16,e[5]=U=C&65535|x<<16,K=u,B=H,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[6],B=e[6],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[6]=u=r&65535|h<<16,e[6]=H=C&65535|x<<16,K=M,B=D,C=B&65535,x=B>>>16,r=K&65535,h=K>>>16,K=i[7],B=e[7],C+=B&65535,x+=B>>>16,r+=K&65535,h+=K>>>16,x+=C>>>16,r+=x>>>16,h+=r>>>16,i[7]=M=r&65535|h<<16,e[7]=D=C&65535|x<<16,y+=128,I-=128}return y}function kn(f){var t=new Yf;t.update(f);var i=t.digest();return t.clean(),i}gt.hash=kn});var ea=Ze(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.BrowserRandomSource=void 0;var Qf=65536,Yi=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let i=new Uint8Array(t);for(let e=0;e<i.length;e+=Qf)this._crypto.getRandomValues(i.subarray(e,e+Math.min(i.length-e,Qf)));return i}};ui.BrowserRandomSource=Yi});var ta=Ze(()=>{});var ra=Ze(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.NodeRandomSource=void 0;var Bn=bt(),Zi=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ut<"u"){let t=ta();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let i=this._crypto.randomBytes(t);if(i.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let e=new Uint8Array(t);for(let n=0;n<e.length;n++)e[n]=i[n];return(0,Bn.wipe)(i),e}};li.NodeRandomSource=Zi});var ia=Ze(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.SystemRandomSource=void 0;var Kn=ea(),Rn=ra(),Ji=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Kn.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Rn.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};bi.SystemRandomSource=Ji});var sa=Ze(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.randomStringForEntropy=We.randomString=We.randomUint32=We.randomBytes=We.defaultRandomSource=void 0;var Un=ia(),On=Xt(),fa=bt();We.defaultRandomSource=new Un.SystemRandomSource;function Wi(f,t=We.defaultRandomSource){return t.randomBytes(f)}We.randomBytes=Wi;function Hn(f=We.defaultRandomSource){let t=Wi(4,f),i=(0,On.readUint32LE)(t);return(0,fa.wipe)(t),i}We.randomUint32=Hn;var aa="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function na(f,t=aa,i=We.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let e="",n=t.length,y=256-256%n;for(;f>0;){let I=Wi(Math.ceil(f*256/y),i);for(let s=0;s<I.length&&f>0;s++){let S=I[s];S<y&&(e+=t.charAt(S%n),f--)}(0,fa.wipe)(I)}return e}We.randomString=na;function Dn(f,t=aa,i=We.defaultRandomSource){let e=Math.ceil(f/(Math.log(t.length)/Math.LN2));return na(e,t,i)}We.randomStringForEntropy=Dn});var ca=Ze(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.sharedKey=je.generateKeyPair=je.generateKeyPairFromSeed=je.scalarMultBase=je.scalarMult=je.SHARED_KEY_LENGTH=je.SECRET_KEY_LENGTH=je.PUBLIC_KEY_LENGTH=void 0;var Nn=sa(),Cn=bt();je.PUBLIC_KEY_LENGTH=32;je.SECRET_KEY_LENGTH=32;je.SHARED_KEY_LENGTH=32;function pt(f){let t=new Float64Array(16);if(f)for(let i=0;i<f.length;i++)t[i]=f[i];return t}var ha=new Uint8Array(32);ha[0]=9;var qn=pt([56129,1]);function $i(f){let t=1;for(let i=0;i<16;i++){let e=f[i]+t+65535;t=Math.floor(e/65536),f[i]=e-t*65536}f[0]+=t-1+37*(t-1)}function Er(f,t,i){let e=~(i-1);for(let n=0;n<16;n++){let y=e&(f[n]^t[n]);f[n]^=y,t[n]^=y}}function jn(f,t){let i=pt(),e=pt();for(let n=0;n<16;n++)e[n]=t[n];$i(e),$i(e),$i(e);for(let n=0;n<2;n++){i[0]=e[0]-65517;for(let I=1;I<15;I++)i[I]=e[I]-65535-(i[I-1]>>16&1),i[I-1]&=65535;i[15]=e[15]-32767-(i[14]>>16&1);let y=i[15]>>16&1;i[14]&=65535,Er(e,i,1-y)}for(let n=0;n<16;n++)f[2*n]=e[n]&255,f[2*n+1]=e[n]>>8}function Fn(f,t){for(let i=0;i<16;i++)f[i]=t[2*i]+(t[2*i+1]<<8);f[15]&=32767}function vi(f,t,i){for(let e=0;e<16;e++)f[e]=t[e]+i[e]}function pi(f,t,i){for(let e=0;e<16;e++)f[e]=t[e]-i[e]}function _t(f,t,i){let e,n,y=0,I=0,s=0,S=0,E=0,_=0,v=0,d=0,u=0,M=0,k=0,T=0,L=0,z=0,R=0,U=0,H=0,D=0,K=0,B=0,N=0,q=0,C=0,x=0,r=0,h=0,o=0,c=0,l=0,g=0,P=0,p=i[0],a=i[1],w=i[2],j=i[3],F=i[4],G=i[5],X=i[6],Z=i[7],$=i[8],fe=i[9],Q=i[10],ee=i[11],se=i[12],te=i[13],re=i[14],le=i[15];e=t[0],y+=e*p,I+=e*a,s+=e*w,S+=e*j,E+=e*F,_+=e*G,v+=e*X,d+=e*Z,u+=e*$,M+=e*fe,k+=e*Q,T+=e*ee,L+=e*se,z+=e*te,R+=e*re,U+=e*le,e=t[1],I+=e*p,s+=e*a,S+=e*w,E+=e*j,_+=e*F,v+=e*G,d+=e*X,u+=e*Z,M+=e*$,k+=e*fe,T+=e*Q,L+=e*ee,z+=e*se,R+=e*te,U+=e*re,H+=e*le,e=t[2],s+=e*p,S+=e*a,E+=e*w,_+=e*j,v+=e*F,d+=e*G,u+=e*X,M+=e*Z,k+=e*$,T+=e*fe,L+=e*Q,z+=e*ee,R+=e*se,U+=e*te,H+=e*re,D+=e*le,e=t[3],S+=e*p,E+=e*a,_+=e*w,v+=e*j,d+=e*F,u+=e*G,M+=e*X,k+=e*Z,T+=e*$,L+=e*fe,z+=e*Q,R+=e*ee,U+=e*se,H+=e*te,D+=e*re,K+=e*le,e=t[4],E+=e*p,_+=e*a,v+=e*w,d+=e*j,u+=e*F,M+=e*G,k+=e*X,T+=e*Z,L+=e*$,z+=e*fe,R+=e*Q,U+=e*ee,H+=e*se,D+=e*te,K+=e*re,B+=e*le,e=t[5],_+=e*p,v+=e*a,d+=e*w,u+=e*j,M+=e*F,k+=e*G,T+=e*X,L+=e*Z,z+=e*$,R+=e*fe,U+=e*Q,H+=e*ee,D+=e*se,K+=e*te,B+=e*re,N+=e*le,e=t[6],v+=e*p,d+=e*a,u+=e*w,M+=e*j,k+=e*F,T+=e*G,L+=e*X,z+=e*Z,R+=e*$,U+=e*fe,H+=e*Q,D+=e*ee,K+=e*se,B+=e*te,N+=e*re,q+=e*le,e=t[7],d+=e*p,u+=e*a,M+=e*w,k+=e*j,T+=e*F,L+=e*G,z+=e*X,R+=e*Z,U+=e*$,H+=e*fe,D+=e*Q,K+=e*ee,B+=e*se,N+=e*te,q+=e*re,C+=e*le,e=t[8],u+=e*p,M+=e*a,k+=e*w,T+=e*j,L+=e*F,z+=e*G,R+=e*X,U+=e*Z,H+=e*$,D+=e*fe,K+=e*Q,B+=e*ee,N+=e*se,q+=e*te,C+=e*re,x+=e*le,e=t[9],M+=e*p,k+=e*a,T+=e*w,L+=e*j,z+=e*F,R+=e*G,U+=e*X,H+=e*Z,D+=e*$,K+=e*fe,B+=e*Q,N+=e*ee,q+=e*se,C+=e*te,x+=e*re,r+=e*le,e=t[10],k+=e*p,T+=e*a,L+=e*w,z+=e*j,R+=e*F,U+=e*G,H+=e*X,D+=e*Z,K+=e*$,B+=e*fe,N+=e*Q,q+=e*ee,C+=e*se,x+=e*te,r+=e*re,h+=e*le,e=t[11],T+=e*p,L+=e*a,z+=e*w,R+=e*j,U+=e*F,H+=e*G,D+=e*X,K+=e*Z,B+=e*$,N+=e*fe,q+=e*Q,C+=e*ee,x+=e*se,r+=e*te,h+=e*re,o+=e*le,e=t[12],L+=e*p,z+=e*a,R+=e*w,U+=e*j,H+=e*F,D+=e*G,K+=e*X,B+=e*Z,N+=e*$,q+=e*fe,C+=e*Q,x+=e*ee,r+=e*se,h+=e*te,o+=e*re,c+=e*le,e=t[13],z+=e*p,R+=e*a,U+=e*w,H+=e*j,D+=e*F,K+=e*G,B+=e*X,N+=e*Z,q+=e*$,C+=e*fe,x+=e*Q,r+=e*ee,h+=e*se,o+=e*te,c+=e*re,l+=e*le,e=t[14],R+=e*p,U+=e*a,H+=e*w,D+=e*j,K+=e*F,B+=e*G,N+=e*X,q+=e*Z,C+=e*$,x+=e*fe,r+=e*Q,h+=e*ee,o+=e*se,c+=e*te,l+=e*re,g+=e*le,e=t[15],U+=e*p,H+=e*a,D+=e*w,K+=e*j,B+=e*F,N+=e*G,q+=e*X,C+=e*Z,x+=e*$,r+=e*fe,h+=e*Q,o+=e*ee,c+=e*se,l+=e*te,g+=e*re,P+=e*le,y+=38*H,I+=38*D,s+=38*K,S+=38*B,E+=38*N,_+=38*q,v+=38*C,d+=38*x,u+=38*r,M+=38*h,k+=38*o,T+=38*c,L+=38*l,z+=38*g,R+=38*P,n=1,e=y+n+65535,n=Math.floor(e/65536),y=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=s+n+65535,n=Math.floor(e/65536),s=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=E+n+65535,n=Math.floor(e/65536),E=e-n*65536,e=_+n+65535,n=Math.floor(e/65536),_=e-n*65536,e=v+n+65535,n=Math.floor(e/65536),v=e-n*65536,e=d+n+65535,n=Math.floor(e/65536),d=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=M+n+65535,n=Math.floor(e/65536),M=e-n*65536,e=k+n+65535,n=Math.floor(e/65536),k=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=L+n+65535,n=Math.floor(e/65536),L=e-n*65536,e=z+n+65535,n=Math.floor(e/65536),z=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=U+n+65535,n=Math.floor(e/65536),U=e-n*65536,y+=n-1+37*(n-1),n=1,e=y+n+65535,n=Math.floor(e/65536),y=e-n*65536,e=I+n+65535,n=Math.floor(e/65536),I=e-n*65536,e=s+n+65535,n=Math.floor(e/65536),s=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=E+n+65535,n=Math.floor(e/65536),E=e-n*65536,e=_+n+65535,n=Math.floor(e/65536),_=e-n*65536,e=v+n+65535,n=Math.floor(e/65536),v=e-n*65536,e=d+n+65535,n=Math.floor(e/65536),d=e-n*65536,e=u+n+65535,n=Math.floor(e/65536),u=e-n*65536,e=M+n+65535,n=Math.floor(e/65536),M=e-n*65536,e=k+n+65535,n=Math.floor(e/65536),k=e-n*65536,e=T+n+65535,n=Math.floor(e/65536),T=e-n*65536,e=L+n+65535,n=Math.floor(e/65536),L=e-n*65536,e=z+n+65535,n=Math.floor(e/65536),z=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=U+n+65535,n=Math.floor(e/65536),U=e-n*65536,y+=n-1+37*(n-1),f[0]=y,f[1]=I,f[2]=s,f[3]=S,f[4]=E,f[5]=_,f[6]=v,f[7]=d,f[8]=u,f[9]=M,f[10]=k,f[11]=T,f[12]=L,f[13]=z,f[14]=R,f[15]=U}function Pr(f,t){_t(f,t,t)}function Gn(f,t){let i=pt();for(let e=0;e<16;e++)i[e]=t[e];for(let e=253;e>=0;e--)Pr(i,i),e!==2&&e!==4&&_t(i,i,t);for(let e=0;e<16;e++)f[e]=i[e]}function Qi(f,t){let i=new Uint8Array(32),e=new Float64Array(80),n=pt(),y=pt(),I=pt(),s=pt(),S=pt(),E=pt();for(let u=0;u<31;u++)i[u]=f[u];i[31]=f[31]&127|64,i[0]&=248,Fn(e,t);for(let u=0;u<16;u++)y[u]=e[u];n[0]=s[0]=1;for(let u=254;u>=0;--u){let M=i[u>>>3]>>>(u&7)&1;Er(n,y,M),Er(I,s,M),vi(S,n,I),pi(n,n,I),vi(I,y,s),pi(y,y,s),Pr(s,S),Pr(E,n),_t(n,I,n),_t(I,y,S),vi(S,n,I),pi(n,n,I),Pr(y,n),pi(I,s,E),_t(n,I,qn),vi(n,n,s),_t(I,I,n),_t(n,s,E),_t(s,y,e),Pr(y,S),Er(n,y,M),Er(I,s,M)}for(let u=0;u<16;u++)e[u+16]=n[u],e[u+32]=I[u],e[u+48]=y[u],e[u+64]=s[u];let _=e.subarray(32),v=e.subarray(16);Gn(_,_),_t(v,v,_);let d=new Uint8Array(32);return jn(d,v),d}je.scalarMult=Qi;function oa(f){return Qi(f,ha)}je.scalarMultBase=oa;function da(f){if(f.length!==je.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${je.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(f);return{publicKey:oa(t),secretKey:t}}je.generateKeyPairFromSeed=da;function Vn(f){let t=(0,Nn.randomBytes)(32,f),i=da(t);return(0,Cn.wipe)(t),i}je.generateKeyPair=Vn;function Xn(f,t,i=!1){if(f.length!==je.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(t.length!==je.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let e=Qi(f,t);if(i){let n=0;for(let y=0;y<e.length;y++)n|=e[y];if(n===0)throw new Error("X25519: invalid shared key")}return e}je.sharedKey=Xn});var la=Ze((yi,ua)=>{(function(){var f,t=0xdeadbeefcafe,i=(t&16777215)==15715070;function e(b,m,A){b!=null&&(typeof b=="number"?this.fromNumber(b,m,A):m==null&&typeof b!="string"?this.fromString(b,256):this.fromString(b,m))}function n(){return new e(null)}function y(b,m,A,O,V,Y){for(;--Y>=0;){var J=m*this[b++]+A[O]+V;V=Math.floor(J/67108864),A[O++]=J&67108863}return V}function I(b,m,A,O,V,Y){for(var J=m&32767,W=m>>15;--Y>=0;){var xe=this[b]&32767,Ye=this[b++]>>15,at=W*xe+Ye*J;xe=J*xe+((at&32767)<<15)+A[O]+(V&1073741823),V=(xe>>>30)+(at>>>15)+W*Ye+(V>>>30),A[O++]=xe&1073741823}return V}function s(b,m,A,O,V,Y){for(var J=m&16383,W=m>>14;--Y>=0;){var xe=this[b]&16383,Ye=this[b++]>>14,at=W*xe+Ye*J;xe=J*xe+((at&16383)<<14)+A[O]+V,V=(xe>>28)+(at>>14)+W*Ye,A[O++]=xe&268435455}return V}var S=typeof navigator<"u";S&&i&&navigator.appName=="Microsoft Internet Explorer"?(e.prototype.am=I,f=30):S&&i&&navigator.appName!="Netscape"?(e.prototype.am=y,f=26):(e.prototype.am=s,f=28),e.prototype.DB=f,e.prototype.DM=(1<<f)-1,e.prototype.DV=1<<f;var E=52;e.prototype.FV=Math.pow(2,E),e.prototype.F1=E-f,e.prototype.F2=2*f-E;var _="0123456789abcdefghijklmnopqrstuvwxyz",v=new Array,d,u;for(d="0".charCodeAt(0),u=0;u<=9;++u)v[d++]=u;for(d="a".charCodeAt(0),u=10;u<36;++u)v[d++]=u;for(d="A".charCodeAt(0),u=10;u<36;++u)v[d++]=u;function M(b){return _.charAt(b)}function k(b,m){var A=v[b.charCodeAt(m)];return A??-1}function T(b){for(var m=this.t-1;m>=0;--m)b[m]=this[m];b.t=this.t,b.s=this.s}function L(b){this.t=1,this.s=b<0?-1:0,b>0?this[0]=b:b<-1?this[0]=b+this.DV:this.t=0}function z(b){var m=n();return m.fromInt(b),m}function R(b,m){var A;if(m==16)A=4;else if(m==8)A=3;else if(m==256)A=8;else if(m==2)A=1;else if(m==32)A=5;else if(m==4)A=2;else{this.fromRadix(b,m);return}this.t=0,this.s=0;for(var O=b.length,V=!1,Y=0;--O>=0;){var J=A==8?b[O]&255:k(b,O);if(J<0){b.charAt(O)=="-"&&(V=!0);continue}V=!1,Y==0?this[this.t++]=J:Y+A>this.DB?(this[this.t-1]|=(J&(1<<this.DB-Y)-1)<<Y,this[this.t++]=J>>this.DB-Y):this[this.t-1]|=J<<Y,Y+=A,Y>=this.DB&&(Y-=this.DB)}A==8&&b[0]&128&&(this.s=-1,Y>0&&(this[this.t-1]|=(1<<this.DB-Y)-1<<Y)),this.clamp(),V&&e.ZERO.subTo(this,this)}function U(){for(var b=this.s&this.DM;this.t>0&&this[this.t-1]==b;)--this.t}function H(b){if(this.s<0)return"-"+this.negate().toString(b);var m;if(b==16)m=4;else if(b==8)m=3;else if(b==2)m=1;else if(b==32)m=5;else if(b==4)m=2;else return this.toRadix(b);var A=(1<<m)-1,O,V=!1,Y="",J=this.t,W=this.DB-J*this.DB%m;if(J-- >0)for(W<this.DB&&(O=this[J]>>W)>0&&(V=!0,Y=M(O));J>=0;)W<m?(O=(this[J]&(1<<W)-1)<<m-W,O|=this[--J]>>(W+=this.DB-m)):(O=this[J]>>(W-=m)&A,W<=0&&(W+=this.DB,--J)),O>0&&(V=!0),V&&(Y+=M(O));return V?Y:"0"}function D(){var b=n();return e.ZERO.subTo(this,b),b}function K(){return this.s<0?this.negate():this}function B(b){var m=this.s-b.s;if(m!=0)return m;var A=this.t;if(m=A-b.t,m!=0)return this.s<0?-m:m;for(;--A>=0;)if((m=this[A]-b[A])!=0)return m;return 0}function N(b){var m=1,A;return(A=b>>>16)!=0&&(b=A,m+=16),(A=b>>8)!=0&&(b=A,m+=8),(A=b>>4)!=0&&(b=A,m+=4),(A=b>>2)!=0&&(b=A,m+=2),(A=b>>1)!=0&&(b=A,m+=1),m}function q(){return this.t<=0?0:this.DB*(this.t-1)+N(this[this.t-1]^this.s&this.DM)}function C(b,m){var A;for(A=this.t-1;A>=0;--A)m[A+b]=this[A];for(A=b-1;A>=0;--A)m[A]=0;m.t=this.t+b,m.s=this.s}function x(b,m){for(var A=b;A<this.t;++A)m[A-b]=this[A];m.t=Math.max(this.t-b,0),m.s=this.s}function r(b,m){var A=b%this.DB,O=this.DB-A,V=(1<<O)-1,Y=Math.floor(b/this.DB),J=this.s<<A&this.DM,W;for(W=this.t-1;W>=0;--W)m[W+Y+1]=this[W]>>O|J,J=(this[W]&V)<<A;for(W=Y-1;W>=0;--W)m[W]=0;m[Y]=J,m.t=this.t+Y+1,m.s=this.s,m.clamp()}function h(b,m){m.s=this.s;var A=Math.floor(b/this.DB);if(A>=this.t){m.t=0;return}var O=b%this.DB,V=this.DB-O,Y=(1<<O)-1;m[0]=this[A]>>O;for(var J=A+1;J<this.t;++J)m[J-A-1]|=(this[J]&Y)<<V,m[J-A]=this[J]>>O;O>0&&(m[this.t-A-1]|=(this.s&Y)<<V),m.t=this.t-A,m.clamp()}function o(b,m){for(var A=0,O=0,V=Math.min(b.t,this.t);A<V;)O+=this[A]-b[A],m[A++]=O&this.DM,O>>=this.DB;if(b.t<this.t){for(O-=b.s;A<this.t;)O+=this[A],m[A++]=O&this.DM,O>>=this.DB;O+=this.s}else{for(O+=this.s;A<b.t;)O-=b[A],m[A++]=O&this.DM,O>>=this.DB;O-=b.s}m.s=O<0?-1:0,O<-1?m[A++]=this.DV+O:O>0&&(m[A++]=O),m.t=A,m.clamp()}function c(b,m){var A=this.abs(),O=b.abs(),V=A.t;for(m.t=V+O.t;--V>=0;)m[V]=0;for(V=0;V<O.t;++V)m[V+A.t]=A.am(0,O[V],m,V,0,A.t);m.s=0,m.clamp(),this.s!=b.s&&e.ZERO.subTo(m,m)}function l(b){for(var m=this.abs(),A=b.t=2*m.t;--A>=0;)b[A]=0;for(A=0;A<m.t-1;++A){var O=m.am(A,m[A],b,2*A,0,1);(b[A+m.t]+=m.am(A+1,2*m[A],b,2*A+1,O,m.t-A-1))>=m.DV&&(b[A+m.t]-=m.DV,b[A+m.t+1]=1)}b.t>0&&(b[b.t-1]+=m.am(A,m[A],b,2*A,0,1)),b.s=0,b.clamp()}function g(b,m,A){var O=b.abs();if(!(O.t<=0)){var V=this.abs();if(V.t<O.t){m?.fromInt(0),A!=null&&this.copyTo(A);return}A==null&&(A=n());var Y=n(),J=this.s,W=b.s,xe=this.DB-N(O[O.t-1]);xe>0?(O.lShiftTo(xe,Y),V.lShiftTo(xe,A)):(O.copyTo(Y),V.copyTo(A));var Ye=Y.t,at=Y[Ye-1];if(at!=0){var tt=at*(1<<this.F1)+(Ye>1?Y[Ye-2]>>this.F2:0),yt=this.FV/tt,Ur=(1<<this.F1)/tt,ot=1<<this.F2,dt=A.t,Or=dt-Ye,At=m??n();for(Y.dlShiftTo(Or,At),A.compareTo(At)>=0&&(A[A.t++]=1,A.subTo(At,A)),e.ONE.dlShiftTo(Ye,At),At.subTo(Y,Y);Y.t<Ye;)Y[Y.t++]=0;for(;--Or>=0;){var Bi=A[--dt]==at?this.DM:Math.floor(A[dt]*yt+(A[dt-1]+ot)*Ur);if((A[dt]+=Y.am(0,Bi,A,Or,0,Ye))<Bi)for(Y.dlShiftTo(Or,At),A.subTo(At,A);A[dt]<--Bi;)A.subTo(At,A)}m!=null&&(A.drShiftTo(Ye,m),J!=W&&e.ZERO.subTo(m,m)),A.t=Ye,A.clamp(),xe>0&&A.rShiftTo(xe,A),J<0&&e.ZERO.subTo(A,A)}}}function P(b){var m=n();return this.abs().divRemTo(b,null,m),this.s<0&&m.compareTo(e.ZERO)>0&&b.subTo(m,m),m}function p(b){this.m=b}function a(b){return b.s<0||b.compareTo(this.m)>=0?b.mod(this.m):b}function w(b){return b}function j(b){b.divRemTo(this.m,null,b)}function F(b,m,A){b.multiplyTo(m,A),this.reduce(A)}function G(b,m){b.squareTo(m),this.reduce(m)}p.prototype.convert=a,p.prototype.revert=w,p.prototype.reduce=j,p.prototype.mulTo=F,p.prototype.sqrTo=G;function X(){if(this.t<1)return 0;var b=this[0];if(!(b&1))return 0;var m=b&3;return m=m*(2-(b&15)*m)&15,m=m*(2-(b&255)*m)&255,m=m*(2-((b&65535)*m&65535))&65535,m=m*(2-b*m%this.DV)%this.DV,m>0?this.DV-m:-m}function Z(b){this.m=b,this.mp=b.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<b.DB-15)-1,this.mt2=2*b.t}function $(b){var m=n();return b.abs().dlShiftTo(this.m.t,m),m.divRemTo(this.m,null,m),b.s<0&&m.compareTo(e.ZERO)>0&&this.m.subTo(m,m),m}function fe(b){var m=n();return b.copyTo(m),this.reduce(m),m}function Q(b){for(;b.t<=this.mt2;)b[b.t++]=0;for(var m=0;m<this.m.t;++m){var A=b[m]&32767,O=A*this.mpl+((A*this.mph+(b[m]>>15)*this.mpl&this.um)<<15)&b.DM;for(A=m+this.m.t,b[A]+=this.m.am(0,O,b,m,0,this.m.t);b[A]>=b.DV;)b[A]-=b.DV,b[++A]++}b.clamp(),b.drShiftTo(this.m.t,b),b.compareTo(this.m)>=0&&b.subTo(this.m,b)}function ee(b,m){b.squareTo(m),this.reduce(m)}function se(b,m,A){b.multiplyTo(m,A),this.reduce(A)}Z.prototype.convert=$,Z.prototype.revert=fe,Z.prototype.reduce=Q,Z.prototype.mulTo=se,Z.prototype.sqrTo=ee;function te(){return(this.t>0?this[0]&1:this.s)==0}function re(b,m){if(b>4294967295||b<1)return e.ONE;var A=n(),O=n(),V=m.convert(this),Y=N(b)-1;for(V.copyTo(A);--Y>=0;)if(m.sqrTo(A,O),(b&1<<Y)>0)m.mulTo(O,V,A);else{var J=A;A=O,O=J}return m.revert(A)}function le(b,m){var A;return b<256||m.isEven()?A=new p(m):A=new Z(m),this.exp(b,A)}e.prototype.copyTo=T,e.prototype.fromInt=L,e.prototype.fromString=R,e.prototype.clamp=U,e.prototype.dlShiftTo=C,e.prototype.drShiftTo=x,e.prototype.lShiftTo=r,e.prototype.rShiftTo=h,e.prototype.subTo=o,e.prototype.multiplyTo=c,e.prototype.squareTo=l,e.prototype.divRemTo=g,e.prototype.invDigit=X,e.prototype.isEven=te,e.prototype.exp=re,e.prototype.toString=H,e.prototype.negate=D,e.prototype.abs=K,e.prototype.compareTo=B,e.prototype.bitLength=q,e.prototype.mod=P,e.prototype.modPowInt=le,e.ZERO=z(0),e.ONE=z(1);function he(){var b=n();return this.copyTo(b),b}function oe(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function lt(){return this.t==0?this.s:this[0]<<24>>24}function de(){return this.t==0?this.s:this[0]<<16>>16}function ce(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function Bt(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function be(b){if(b==null&&(b=10),this.signum()==0||b<2||b>36)return"0";var m=this.chunkSize(b),A=Math.pow(b,m),O=z(A),V=n(),Y=n(),J="";for(this.divRemTo(O,V,Y);V.signum()>0;)J=(A+Y.intValue()).toString(b).substr(1)+J,V.divRemTo(O,V,Y);return Y.intValue().toString(b)+J}function ve(b,m){this.fromInt(0),m==null&&(m=10);for(var A=this.chunkSize(m),O=Math.pow(m,A),V=!1,Y=0,J=0,W=0;W<b.length;++W){var xe=k(b,W);if(xe<0){b.charAt(W)=="-"&&this.signum()==0&&(V=!0);continue}J=m*J+xe,++Y>=A&&(this.dMultiply(O),this.dAddOffset(J,0),Y=0,J=0)}Y>0&&(this.dMultiply(Math.pow(m,Y)),this.dAddOffset(J,0)),V&&e.ZERO.subTo(this,this)}function Kt(b,m,A){if(typeof m=="number")if(b<2)this.fromInt(1);else for(this.fromNumber(b,A),this.testBit(b-1)||this.bitwiseTo(e.ONE.shiftLeft(b-1),we,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(m);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(e.ONE.shiftLeft(b-1),this);else{var O=new Array,V=b&7;O.length=(b>>3)+1,m.nextBytes(O),V>0?O[0]&=(1<<V)-1:O[0]=0,this.fromString(O,256)}}function pe(){var b=this.t,m=new Array;m[0]=this.s;var A=this.DB-b*this.DB%8,O,V=0;if(b-- >0)for(A<this.DB&&(O=this[b]>>A)!=(this.s&this.DM)>>A&&(m[V++]=O|this.s<<this.DB-A);b>=0;)A<8?(O=(this[b]&(1<<A)-1)<<8-A,O|=this[--b]>>(A+=this.DB-8)):(O=this[b]>>(A-=8)&255,A<=0&&(A+=this.DB,--b)),O&128&&(O|=-256),V==0&&(this.s&128)!=(O&128)&&++V,(V>0||O!=this.s)&&(m[V++]=O);return m}function me(b){return this.compareTo(b)==0}function mt(b){return this.compareTo(b)<0?this:b}function ue(b){return this.compareTo(b)>0?this:b}function ye(b,m,A){var O,V,Y=Math.min(b.t,this.t);for(O=0;O<Y;++O)A[O]=m(this[O],b[O]);if(b.t<this.t){for(V=b.s&this.DM,O=Y;O<this.t;++O)A[O]=m(this[O],V);A.t=this.t}else{for(V=this.s&this.DM,O=Y;O<b.t;++O)A[O]=m(V,b[O]);A.t=b.t}A.s=m(this.s,b.s),A.clamp()}function Rt(b,m){return b&m}function Me(b){var m=n();return this.bitwiseTo(b,Rt,m),m}function we(b,m){return b|m}function kr(b){var m=n();return this.bitwiseTo(b,we,m),m}function ge(b,m){return b^m}function Ae(b){var m=n();return this.bitwiseTo(b,ge,m),m}function ir(b,m){return b&~m}function Ee(b){var m=n();return this.bitwiseTo(b,ir,m),m}function Pe(){for(var b=n(),m=0;m<this.t;++m)b[m]=this.DM&~this[m];return b.t=this.t,b.s=~this.s,b}function Ir(b){var m=n();return b<0?this.rShiftTo(-b,m):this.lShiftTo(b,m),m}function ke(b){var m=n();return b<0?this.lShiftTo(-b,m):this.rShiftTo(b,m),m}function Ie(b){if(b==0)return-1;var m=0;return b&65535||(b>>=16,m+=16),b&255||(b>>=8,m+=8),b&15||(b>>=4,m+=4),b&3||(b>>=2,m+=2),b&1||++m,m}function Lr(){for(var b=0;b<this.t;++b)if(this[b]!=0)return b*this.DB+Ie(this[b]);return this.s<0?this.t*this.DB:-1}function Le(b){for(var m=0;b!=0;)b&=b-1,++m;return m}function Te(){for(var b=0,m=this.s&this.DM,A=0;A<this.t;++A)b+=Le(this[A]^m);return b}function Tr(b){var m=Math.floor(b/this.DB);return m>=this.t?this.s!=0:(this[m]&1<<b%this.DB)!=0}function ze(b,m){var A=e.ONE.shiftLeft(b);return this.bitwiseTo(A,m,A),A}function Be(b){return this.changeBit(b,we)}function zr(b){return this.changeBit(b,ir)}function Ke(b){return this.changeBit(b,ge)}function Re(b,m){for(var A=0,O=0,V=Math.min(b.t,this.t);A<V;)O+=this[A]+b[A],m[A++]=O&this.DM,O>>=this.DB;if(b.t<this.t){for(O+=b.s;A<this.t;)O+=this[A],m[A++]=O&this.DM,O>>=this.DB;O+=this.s}else{for(O+=this.s;A<b.t;)O+=b[A],m[A++]=O&this.DM,O>>=this.DB;O+=b.s}m.s=O<0?-1:0,O>0?m[A++]=O:O<-1&&(m[A++]=this.DV+O),m.t=A,m.clamp()}function Br(b){var m=n();return this.addTo(b,m),m}function Ue(b){var m=n();return this.subTo(b,m),m}function Oe(b){var m=n();return this.multiplyTo(b,m),m}function Kr(){var b=n();return this.squareTo(b),b}function He(b){var m=n();return this.divRemTo(b,m,null),m}function De(b){var m=n();return this.divRemTo(b,null,m),m}function Rr(b){var m=n(),A=n();return this.divRemTo(b,m,A),new Array(m,A)}function Ne(b){this[this.t]=this.am(0,b-1,this,0,0,this.t),++this.t,this.clamp()}function Ce(b,m){if(b!=0){for(;this.t<=m;)this[this.t++]=0;for(this[m]+=b;this[m]>=this.DV;)this[m]-=this.DV,++m>=this.t&&(this[this.t++]=0),++this[m]}}function St(){}function _e(b){return b}function qe(b,m,A){b.multiplyTo(m,A)}function fr(b,m){b.squareTo(m)}St.prototype.convert=_e,St.prototype.revert=_e,St.prototype.mulTo=qe,St.prototype.sqrTo=fr;function ar(b){return this.exp(b,new St)}function nr(b,m,A){var O=Math.min(this.t+b.t,m);for(A.s=0,A.t=O;O>0;)A[--O]=0;var V;for(V=A.t-this.t;O<V;++O)A[O+this.t]=this.am(0,b[O],A,O,0,this.t);for(V=Math.min(b.t,m);O<V;++O)this.am(0,b[O],A,O,0,m-O);A.clamp()}function sr(b,m,A){--m;var O=A.t=this.t+b.t-m;for(A.s=0;--O>=0;)A[O]=0;for(O=Math.max(m-this.t,0);O<b.t;++O)A[this.t+O-m]=this.am(m-O,b[O],A,0,0,this.t+O-m);A.clamp(),A.drShiftTo(1,A)}function st(b){this.r2=n(),this.q3=n(),e.ONE.dlShiftTo(2*b.t,this.r2),this.mu=this.r2.divide(b),this.m=b}function hr(b){if(b.s<0||b.t>2*this.m.t)return b.mod(this.m);if(b.compareTo(this.m)<0)return b;var m=n();return b.copyTo(m),this.reduce(m),m}function or(b){return b}function dr(b){for(b.drShiftTo(this.m.t-1,this.r2),b.t>this.m.t+1&&(b.t=this.m.t+1,b.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);b.compareTo(this.r2)<0;)b.dAddOffset(1,this.m.t+1);for(b.subTo(this.r2,b);b.compareTo(this.m)>=0;)b.subTo(this.m,b)}function cr(b,m){b.squareTo(m),this.reduce(m)}function ur(b,m,A){b.multiplyTo(m,A),this.reduce(A)}st.prototype.convert=hr,st.prototype.revert=or,st.prototype.reduce=dr,st.prototype.mulTo=ur,st.prototype.sqrTo=cr;function lr(b,m){var A=b.bitLength(),O,V=z(1),Y;if(A<=0)return V;A<18?O=1:A<48?O=3:A<144?O=4:A<768?O=5:O=6,A<8?Y=new p(m):m.isEven()?Y=new st(m):Y=new Z(m);var J=new Array,W=3,xe=O-1,Ye=(1<<O)-1;if(J[1]=Y.convert(this),O>1){var at=n();for(Y.sqrTo(J[1],at);W<=Ye;)J[W]=n(),Y.mulTo(at,J[W-2],J[W]),W+=2}var tt=b.t-1,yt,Ur=!0,ot=n(),dt;for(A=N(b[tt])-1;tt>=0;){for(A>=xe?yt=b[tt]>>A-xe&Ye:(yt=(b[tt]&(1<<A+1)-1)<<xe-A,tt>0&&(yt|=b[tt-1]>>this.DB+A-xe)),W=O;!(yt&1);)yt>>=1,--W;if((A-=W)<0&&(A+=this.DB,--tt),Ur)J[yt].copyTo(V),Ur=!1;else{for(;W>1;)Y.sqrTo(V,ot),Y.sqrTo(ot,V),W-=2;W>0?Y.sqrTo(V,ot):(dt=V,V=ot,ot=dt),Y.mulTo(ot,J[yt],V)}for(;tt>=0&&!(b[tt]&1<<A);)Y.sqrTo(V,ot),dt=V,V=ot,ot=dt,--A<0&&(A=this.DB-1,--tt)}return Y.revert(V)}function br(b){var m=this.s<0?this.negate():this.clone(),A=b.s<0?b.negate():b.clone();if(m.compareTo(A)<0){var O=m;m=A,A=O}var V=m.getLowestSetBit(),Y=A.getLowestSetBit();if(Y<0)return m;for(V<Y&&(Y=V),Y>0&&(m.rShiftTo(Y,m),A.rShiftTo(Y,A));m.signum()>0;)(V=m.getLowestSetBit())>0&&m.rShiftTo(V,m),(V=A.getLowestSetBit())>0&&A.rShiftTo(V,A),m.compareTo(A)>=0?(m.subTo(A,m),m.rShiftTo(1,m)):(A.subTo(m,A),A.rShiftTo(1,A));return Y>0&&A.lShiftTo(Y,A),A}function vr(b){if(b<=0)return 0;var m=this.DV%b,A=this.s<0?b-1:0;if(this.t>0)if(m==0)A=this[0]%b;else for(var O=this.t-1;O>=0;--O)A=(m*A+this[O])%b;return A}function pr(b){var m=b.isEven();if(this.isEven()&&m||b.signum()==0)return e.ZERO;for(var A=b.clone(),O=this.clone(),V=z(1),Y=z(0),J=z(0),W=z(1);A.signum()!=0;){for(;A.isEven();)A.rShiftTo(1,A),m?((!V.isEven()||!Y.isEven())&&(V.addTo(this,V),Y.subTo(b,Y)),V.rShiftTo(1,V)):Y.isEven()||Y.subTo(b,Y),Y.rShiftTo(1,Y);for(;O.isEven();)O.rShiftTo(1,O),m?((!J.isEven()||!W.isEven())&&(J.addTo(this,J),W.subTo(b,W)),J.rShiftTo(1,J)):W.isEven()||W.subTo(b,W),W.rShiftTo(1,W);A.compareTo(O)>=0?(A.subTo(O,A),m&&V.subTo(J,V),Y.subTo(W,Y)):(O.subTo(A,O),m&&J.subTo(V,J),W.subTo(Y,W))}if(O.compareTo(e.ONE)!=0)return e.ZERO;if(W.compareTo(b)>=0)return W.subtract(b);if(W.signum()<0)W.addTo(b,W);else return W;return W.signum()<0?W.add(b):W}var Ve=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],mr=(1<<26)/Ve[Ve.length-1];function yr(b){var m,A=this.abs();if(A.t==1&&A[0]<=Ve[Ve.length-1]){for(m=0;m<Ve.length;++m)if(A[0]==Ve[m])return!0;return!1}if(A.isEven())return!1;for(m=1;m<Ve.length;){for(var O=Ve[m],V=m+1;V<Ve.length&&O<mr;)O*=Ve[V++];for(O=A.modInt(O);m<V;)if(O%Ve[m++]==0)return!1}return A.millerRabin(b)}function xr(b){var m=this.subtract(e.ONE),A=m.getLowestSetBit();if(A<=0)return!1;var O=m.shiftRight(A);b=b+1>>1,b>Ve.length&&(b=Ve.length);for(var V=n(),Y=0;Y<b;++Y){V.fromInt(Ve[Math.floor(Math.random()*Ve.length)]);var J=V.modPow(O,this);if(J.compareTo(e.ONE)!=0&&J.compareTo(m)!=0){for(var W=1;W++<A&&J.compareTo(m)!=0;)if(J=J.modPowInt(2,this),J.compareTo(e.ONE)==0)return!1;if(J.compareTo(m)!=0)return!1}}return!0}e.prototype.chunkSize=ce,e.prototype.toRadix=be,e.prototype.fromRadix=ve,e.prototype.fromNumber=Kt,e.prototype.bitwiseTo=ye,e.prototype.changeBit=ze,e.prototype.addTo=Re,e.prototype.dMultiply=Ne,e.prototype.dAddOffset=Ce,e.prototype.multiplyLowerTo=nr,e.prototype.multiplyUpperTo=sr,e.prototype.modInt=vr,e.prototype.millerRabin=xr,e.prototype.clone=he,e.prototype.intValue=oe,e.prototype.byteValue=lt,e.prototype.shortValue=de,e.prototype.signum=Bt,e.prototype.toByteArray=pe,e.prototype.equals=me,e.prototype.min=mt,e.prototype.max=ue,e.prototype.and=Me,e.prototype.or=kr,e.prototype.xor=Ae,e.prototype.andNot=Ee,e.prototype.not=Pe,e.prototype.shiftLeft=Ir,e.prototype.shiftRight=ke,e.prototype.getLowestSetBit=Lr,e.prototype.bitCount=Te,e.prototype.testBit=Tr,e.prototype.setBit=Be,e.prototype.clearBit=zr,e.prototype.flipBit=Ke,e.prototype.add=Br,e.prototype.subtract=Ue,e.prototype.multiply=Oe,e.prototype.divide=He,e.prototype.remainder=De,e.prototype.divideAndRemainder=Rr,e.prototype.modPow=lr,e.prototype.modInverse=pr,e.prototype.pow=ar,e.prototype.gcd=br,e.prototype.isProbablePrime=yr,e.prototype.square=Kr,e.prototype.Barrett=st;var Mt,et,Xe;function ga(b){et[Xe++]^=b&255,et[Xe++]^=b>>8&255,et[Xe++]^=b>>16&255,et[Xe++]^=b>>24&255,Xe>=zi&&(Xe-=zi)}function rf(){ga(new Date().getTime())}if(et==null){et=new Array,Xe=0;var ht;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var ff=new Uint8Array(32);for(window.crypto.getRandomValues(ff),ht=0;ht<32;++ht)et[Xe++]=ff[ht]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var af=window.crypto.random(32);for(ht=0;ht<af.length;++ht)et[Xe++]=af.charCodeAt(ht)&255}}for(;Xe<zi;)ht=Math.floor(65536*Math.random()),et[Xe++]=ht>>>8,et[Xe++]=ht&255;Xe=0,rf()}function _a(){if(Mt==null){for(rf(),Mt=Ea(),Mt.init(et),Xe=0;Xe<et.length;++Xe)et[Xe]=0;Xe=0}return Mt.next()}function Sa(b){var m;for(m=0;m<b.length;++m)b[m]=_a()}function Li(){}Li.prototype.nextBytes=Sa;function Ti(){this.i=0,this.j=0,this.S=new Array}function Ma(b){var m,A,O;for(m=0;m<256;++m)this.S[m]=m;for(A=0,m=0;m<256;++m)A=A+this.S[m]+b[m%b.length]&255,O=this.S[m],this.S[m]=this.S[A],this.S[A]=O;this.i=0,this.j=0}function Aa(){var b;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,b=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=b,this.S[b+this.S[this.i]&255]}Ti.prototype.init=Ma,Ti.prototype.next=Aa;function Ea(){return new Ti}var zi=256;typeof yi<"u"?yi=ua.exports={default:e,BigInteger:e,SecureRandom:Li}:this.jsbn={BigInteger:e,SecureRandom:Li}}).call(yi)});var Qe=class extends Error{constructor(t){let i;t instanceof Error?i=t.message:typeof t=="string"?i=t:i="",super(i),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}},rt=class extends Qe{},sf=class extends Qe{},Hr=class extends Qe{},jt=class extends Qe{},Dr=class extends Qe{},Nr=class extends Qe{},Cr=class extends Qe{},Ot=class extends Qe{},Ht=class extends Qe{},qr=class extends Qe{},jr=class extends Qe{},nt=class extends Qe{};var ct;(function(f){f[f.Base=0]="Base",f[f.Psk=1]="Psk",f[f.Auth=2]="Auth",f[f.AuthPsk=3]="AuthPsk"})(ct||(ct={}));var ae;(function(f){f[f.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",f[f.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",f[f.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",f[f.DhkemSecp256K1HkdfSha256=19]="DhkemSecp256K1HkdfSha256",f[f.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",f[f.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512"})(ae||(ae={}));var it;(function(f){f[f.HkdfSha256=1]="HkdfSha256",f[f.HkdfSha384=2]="HkdfSha384",f[f.HkdfSha512=3]="HkdfSha512"})(it||(it={}));var Fe;(function(f){f[f.Aes128Gcm=1]="Aes128Gcm",f[f.Aes256Gcm=2]="Aes256Gcm",f[f.Chacha20Poly1305=3]="Chacha20Poly1305",f[f.ExportOnly=65535]="ExportOnly"})(Fe||(Fe={}));var Ba={},Fr=Ka(globalThis,Ba);function Ka(f,t){return new Proxy(f,{get(i,e,n){return e in t?t[e]:f[e]},set(i,e,n){return e in t&&delete t[e],f[e]=n,!0},deleteProperty(i,e){let n=!1;return e in t&&(delete t[e],n=!0),e in f&&(delete f[e],n=!0),n},ownKeys(i){let e=Reflect.ownKeys(f),n=Reflect.ownKeys(t),y=new Set(n);return[...e.filter(I=>!y.has(I)),...n]},defineProperty(i,e,n){return e in t&&delete t[e],Reflect.defineProperty(f,e,n),!0},getOwnPropertyDescriptor(i,e){return e in t?Reflect.getOwnPropertyDescriptor(t,e):Reflect.getOwnPropertyDescriptor(f,e)},has(i,e){return e in t||e in f}})}var Ki=()=>typeof Fr<"u",Ri=()=>typeof caches<"u";var wr=f=>typeof f=="object"&&f!==null&&typeof f.privateKey=="object"&&typeof f.publicKey=="object";function $e(f,t){if(t<=0)throw new Error("i2Osp: too small size");if(f>=256**t)throw new Error("i2Osp: too large integer");let i=new Uint8Array(t);for(let e=0;e<t&&f;e++)i[t-(e+1)]=f%256,f=f>>8;return i}function of(f,t){if(f.byteLength!==t.byteLength)throw new Error("xor: different length inputs");let i=new Uint8Array(f.byteLength);for(let e=0;e<f.byteLength;e++)i[e]=f[e]^t[e];return i}function gr(f,t){let i=new Uint8Array(f.length+t.length);return i.set(f,0),i.set(t,f.length),i}function df(f,t,i){let e=new Uint8Array(f.length+t.length+i.length);return e.set(f,0),e.set(t,f.length),e.set(i,f.length+t.length),e}function Ui(f){if(f.length===0)return new Uint8Array([]);let t=f.match(/[\da-f]{2}/gi);if(t==null)throw new Error("hexToBytes: not hex string");return new Uint8Array(t.map(function(i){return parseInt(i,16)}))}function Gr(f){return[...f].map(t=>t.toString(16).padStart(2,"0")).join("")}var Pt=class{constructor(t){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=t}};async function Vr(){if((Ki()||Ri())&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:f}=await import("crypto");return f}catch{throw new nt("Web Cryptograph API not supported")}}async function cf(){if((Ki()||Ri())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:f}=await import("crypto");return f.subtle}catch{throw new nt("Web Cryptograph API not supported")}}var kt=["deriveBits"],uf=["encrypt","decrypt"];var ne=new Uint8Array(0),Oi=new Uint8Array([72,80,75,69,45,118,49]),lf=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),Dt=new Uint8Array([75,69,77,0,0]),It=new Uint8Array([100,107,112,95,112,114,107]),bf=new Uint8Array([101,97,101,95,112,114,107]),vf=new Uint8Array([105,110,102,111,95,104,97,115,104]),pf=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),mf=new Uint8Array([115,101,99,114,101,116]),yf=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),xf=new Uint8Array([107,101,121]),wf=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),gf=new Uint8Array([101,120,112]),_f=new Uint8Array([115,101,99]),Sf=new Uint8Array([99,97,110,100,105,100,97,116,101]),Ft=new Uint8Array([115,107]),Mf=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Af=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),Ef=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var Gt=class extends Pt{constructor(t,i,e){super(t),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=i,this.exporterSecret=e}async seal(t,i){return await this._emitError1()}async open(t,i){return await this._emitError1()}async setupBidirectional(t,i){return await this._emitError2()}async export(t,i){if(t.byteLength>128)throw new rt("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,_f,new Uint8Array(t),i)}catch(e){throw new Cr(e)}}_emitError1(){return new Promise((t,i)=>{i(new nt("Not available on export-only mode"))})}_emitError2(){return new Promise((t,i)=>{i(new nt("Not available on export-only mode"))})}},Xr=class extends Gt{},Yr=class extends Gt{constructor(t,i,e,n){super(t,i,e),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}};var Zr=class{constructor(t,i){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=t,this._api=i}async seal(t,i,e){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let n={name:"AES-GCM",iv:t,additionalData:e};return await this._api.encrypt(n,this._key,i)}async open(t,i,e){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let n={name:"AES-GCM",iv:t,additionalData:e};return await this._api.decrypt(n,this._key,i)}async importKey(t){return await this._api.importKey("raw",t,{name:"AES-GCM"},!0,uf)}},Jr=class extends Zr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Fe.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}},Wr=class extends Zr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Fe.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var Cf=qt(Nf(),1);var fi=class{constructor(t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Fe.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Cf.ChaCha20Poly1305(new Uint8Array(t))}async seal(t,i,e){return await this._seal(t,i,e)}async open(t,i,e){return await this._open(t,i,e)}_seal(t,i,e){return new Promise(n=>{let y=this._key.seal(new Uint8Array(t),new Uint8Array(i),new Uint8Array(e));n(y.buffer)})}_open(t,i,e){return new Promise((n,y)=>{let I=this._key.open(new Uint8Array(t),new Uint8Array(i),new Uint8Array(e));I instanceof Uint8Array?n(I.buffer):y(new Error("failed to open."))})}};var Zt=class extends Gt{constructor(t,i,e){if(super(t,i,e.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.key===void 0||e.baseNonce===void 0||e.seq===void 0)throw new Error("Required parameters are missing");switch(this._aead=e.aead,this._aead){case Fe.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case Fe.Aes256Gcm:this._nK=32,this._nN=12,this._nT=16;break;case Fe.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0;break}let n=ai(this._aead,e.key,this._api);this._f={key:n,baseNonce:e.baseNonce,seq:e.seq},this._r={key:n,baseNonce:ne,seq:0}}computeNonce(t){let i=$e(t.seq,t.baseNonce.byteLength);return of(t.baseNonce,i)}incrementSeq(t){if(t.seq>Number.MAX_SAFE_INTEGER)throw new qr("Message limit reached");t.seq+=1}async setupBidirectional(t,i){try{this._r.baseNonce=new Uint8Array(await this.export(i,this._nN));let e=await this.export(t,this._nK);this._r.key=ai(this._aead,e,this._api),this._r.seq=0}catch(e){throw this._r.baseNonce=ne,e}}};function ai(f,t,i){switch(f){case Fe.Aes128Gcm:return new Jr(t,i);case Fe.Aes256Gcm:return new Wr(t,i);case Fe.Chacha20Poly1305:return new fi(t);default:throw new Error("Invalid or unsupported AEAD id")}}var Xi=qt(Ff(),1),Jf=qt(Vf(),1),Wf=qt(Zf(),1);var Mr=class extends Pt{constructor(t,i){super(t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=i}buildLabeledIkm(t,i){let e=new Uint8Array(7+this.suiteId.byteLength+t.byteLength+i.byteLength);return e.set(Oi,0),e.set(this.suiteId,7),e.set(t,7+this.suiteId.byteLength),e.set(i,7+this.suiteId.byteLength+t.byteLength),e}buildLabeledInfo(t,i,e){let n=new Uint8Array(9+this.suiteId.byteLength+t.byteLength+i.byteLength);return n.set(new Uint8Array([0,e]),0),n.set(Oi,2),n.set(this.suiteId,9),n.set(t,9+this.suiteId.byteLength),n.set(i,9+this.suiteId.byteLength+t.byteLength),n}async extract(t,i){if(t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return(0,Xi.hmac)(Jf.SHA256,new Uint8Array(t),new Uint8Array(i));case"SHA-512":return(0,Xi.hmac)(Wf.SHA512,new Uint8Array(t),new Uint8Array(i));default:throw new nt(`${this.algHash.hash} key length should be ${this.hashSize}.`)}let e=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",e,i)}async expand(t,i,e){let n=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),y=new ArrayBuffer(e),I=new Uint8Array(y),s=ne,S=new Uint8Array(i),E=new Uint8Array(1);if(e>255*this.hashSize)throw new Error("Entropy limit reached");let _=new Uint8Array(this.hashSize+S.length+1);for(let v=1,d=0;d<I.length;v++)E[0]=v,_.set(s,0),_.set(S,s.length),_.set(E,s.length+S.length),s=new Uint8Array(await this._api.sign("HMAC",n,_.slice(0,s.length+S.length+1))),I.length-d>=s.length?(I.set(s,d),d+=s.length):(I.set(s.slice(0,I.length-d),d),d+=I.length-d);return y}async extractAndExpand(t,i,e,n){let y=await this._api.importKey("raw",i,"HKDF",!1,kt);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:e},y,n*8)}async labeledExtract(t,i,e){return await this.extract(t,this.buildLabeledIkm(i,e))}async labeledExpand(t,i,e,n){return await this.expand(t,this.buildLabeledInfo(i,e,n),n)}},Tt=class extends Mr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:it.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},$t=class extends Mr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:it.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},Nt=class extends Mr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:it.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var hi=class extends Zt{async seal(t,i=ne){if(this._r.baseNonce.length===0)throw new Ot("Bidirectional encryption is not setup");let e;try{e=await this._r.key.seal(this.computeNonce(this._r),t,i)}catch(n){throw new Ot(n)}return this.incrementSeq(this._r),e}async open(t,i=ne){let e;try{e=await this._f.key.open(this.computeNonce(this._f),t,i)}catch(n){throw new Ht(n)}return this.incrementSeq(this._f),e}};var oi=class extends Zt{constructor(t,i,e,n){super(t,i,e),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}async seal(t,i=ne){let e;try{e=await this._f.key.seal(this.computeNonce(this._f),t,i)}catch(n){throw new Ot(n)}return this.incrementSeq(this._f),e}async open(t,i=ne){if(this._r.baseNonce.length===0)throw new Ht("Bidirectional encryption is not setup");let e;try{e=await this._r.key.open(this.computeNonce(this._r),t,i)}catch(n){throw new Ht(n)}return this.incrementSeq(this._r),e}};var di=class{constructor(t){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(t)}val(){return this._num}reset(){this._num.fill(0)}set(t){if(t.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(t)}isZero(){for(let t=0;t<this._num.length;t++)if(this._num[t]!==0)return!1;return!0}lessThan(t){if(t.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let i=0;i<this._num.length;i++){if(this._num[i]<t[i])return!0;if(this._num[i]>t[i])return!1}return!1}};var In=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),Ln=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Tn=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),Qt=class{constructor(t,i,e){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=i,this._api=e,t){case ae.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=Mf,this._bitmask=255,this._pkcs8AlgId=In;break;case ae.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=Af,this._bitmask=255,this._pkcs8AlgId=Ln;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=Ef,this._bitmask=1,this._pkcs8AlgId=Tn;break}}async serializePublicKey(t){let i=await this._api.exportKey("raw",t);if(i.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");return i}async deserializePublicKey(t){if(t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",t,this._alg,!0,[])}catch{throw new Error("Invalid public key for the ciphersuite")}}async importKey(t,i,e){if(t!=="raw")throw new Error("Unsupported format");if(e&&i.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!e&&i.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");try{if(e)return await this._api.importKey(t,i,this._alg,!0,[]);let n=new Uint8Array(i),y=new Uint8Array(this._pkcs8AlgId.length+n.length);return y.set(this._pkcs8AlgId,0),y.set(n,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",y,this._alg,!0,kt)}catch{throw new Error("Invalid key for the ciphersuite")}}async derivePublicKey(t){let i=await this._api.exportKey("jwk",t);return delete i.d,delete i.key_ops,await this._api.importKey("jwk",i,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,kt)}async deriveKeyPair(t){let i=await this._hkdf.labeledExtract(ne,It,new Uint8Array(t)),e=new di(this._nSk);for(let I=0;e.isZero()||!e.lessThan(this._order);I++){if(I>255)throw new Error("Faild to derive a key pair");let s=new Uint8Array(await this._hkdf.labeledExpand(i,Sf,$e(I,1),this._nSk));s[0]=s[0]&this._bitmask,e.set(s)}let n=new Uint8Array(this._pkcs8AlgId.length+e.val().length);n.set(this._pkcs8AlgId,0),n.set(e.val(),this._pkcs8AlgId.length);let y=await this._api.importKey("pkcs8",n,this._alg,!0,kt);return e.reset(),{privateKey:y,publicKey:await this.derivePublicKey(y)}}async dh(t,i){return await this._api.deriveBits({name:"ECDH",public:i},t,this._nDh*8)}};var{version:V0,utils:X0,rand:Y0,curve:Z0,curves:J0,ec:W0,ec:$f,eddsa:$0,eddsa:Q0}=function(){return function(){function f(t,i,e){function n(s,S){if(!i[s]){if(!t[s]){var E=typeof Ut=="function"&&Ut;if(!S&&E)return E(s,!0);if(y)return y(s,!0);var _=new Error("Cannot find module '"+s+"'");throw _.code="MODULE_NOT_FOUND",_}var v=i[s]={exports:{}};t[s][0].call(v.exports,function(d){var u=t[s][1][d];return n(u||d)},v,v.exports,f,t,i,e)}return i[s].exports}for(var y=typeof Ut=="function"&&Ut,I=0;I<e.length;I++)n(e[I]);return n}return f}()({1:[function(f,t,i){"use strict";var e=i;e.version=f("../package.json").version,e.utils=f("./elliptic/utils"),e.rand=f("brorand"),e.curve=f("./elliptic/curve"),e.curves=f("./elliptic/curves"),e.ec=f("./elliptic/ec"),e.eddsa=f("./elliptic/eddsa")},{"../package.json":35,"./elliptic/curve":4,"./elliptic/curves":7,"./elliptic/ec":8,"./elliptic/eddsa":11,"./elliptic/utils":15,brorand:17}],2:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("../utils"),y=n.getNAF,I=n.getJSF,s=n.assert;function S(_,v){this.type=_,this.p=new e(v.p,16),this.red=v.prime?e.red(v.prime):e.mont(this.p),this.zero=new e(0).toRed(this.red),this.one=new e(1).toRed(this.red),this.two=new e(2).toRed(this.red),this.n=v.n&&new e(v.n,16),this.g=v.g&&this.pointFromJSON(v.g,v.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var d=this.n&&this.p.div(this.n);!d||d.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}t.exports=S,S.prototype.point=function(){throw new Error("Not implemented")},S.prototype.validate=function(){throw new Error("Not implemented")},S.prototype._fixedNafMul=function(v,d){s(v.precomputed);var u=v._getDoubles(),M=y(d,1,this._bitLength),k=(1<<u.step+1)-(u.step%2===0?2:1);k/=3;var T=[],L,z;for(L=0;L<M.length;L+=u.step){z=0;for(var R=L+u.step-1;R>=L;R--)z=(z<<1)+M[R];T.push(z)}for(var U=this.jpoint(null,null,null),H=this.jpoint(null,null,null),D=k;D>0;D--){for(L=0;L<T.length;L++)z=T[L],z===D?H=H.mixedAdd(u.points[L]):z===-D&&(H=H.mixedAdd(u.points[L].neg()));U=U.add(H)}return U.toP()},S.prototype._wnafMul=function(v,d){var u=4,M=v._getNAFPoints(u);u=M.wnd;for(var k=M.points,T=y(d,u,this._bitLength),L=this.jpoint(null,null,null),z=T.length-1;z>=0;z--){for(var R=0;z>=0&&T[z]===0;z--)R++;if(z>=0&&R++,L=L.dblp(R),z<0)break;var U=T[z];s(U!==0),v.type==="affine"?U>0?L=L.mixedAdd(k[U-1>>1]):L=L.mixedAdd(k[-U-1>>1].neg()):U>0?L=L.add(k[U-1>>1]):L=L.add(k[-U-1>>1].neg())}return v.type==="affine"?L.toP():L},S.prototype._wnafMulAdd=function(v,d,u,M,k){var T=this._wnafT1,L=this._wnafT2,z=this._wnafT3,R=0,U,H,D;for(U=0;U<M;U++){D=d[U];var K=D._getNAFPoints(v);T[U]=K.wnd,L[U]=K.points}for(U=M-1;U>=1;U-=2){var B=U-1,N=U;if(T[B]!==1||T[N]!==1){z[B]=y(u[B],T[B],this._bitLength),z[N]=y(u[N],T[N],this._bitLength),R=Math.max(z[B].length,R),R=Math.max(z[N].length,R);continue}var q=[d[B],null,null,d[N]];d[B].y.cmp(d[N].y)===0?(q[1]=d[B].add(d[N]),q[2]=d[B].toJ().mixedAdd(d[N].neg())):d[B].y.cmp(d[N].y.redNeg())===0?(q[1]=d[B].toJ().mixedAdd(d[N]),q[2]=d[B].add(d[N].neg())):(q[1]=d[B].toJ().mixedAdd(d[N]),q[2]=d[B].toJ().mixedAdd(d[N].neg()));var C=[-3,-1,-5,-7,0,7,5,1,3],x=I(u[B],u[N]);for(R=Math.max(x[0].length,R),z[B]=new Array(R),z[N]=new Array(R),H=0;H<R;H++){var r=x[0][H]|0,h=x[1][H]|0;z[B][H]=C[(r+1)*3+(h+1)],z[N][H]=0,L[B]=q}}var o=this.jpoint(null,null,null),c=this._wnafT4;for(U=R;U>=0;U--){for(var l=0;U>=0;){var g=!0;for(H=0;H<M;H++)c[H]=z[H][U]|0,c[H]!==0&&(g=!1);if(!g)break;l++,U--}if(U>=0&&l++,o=o.dblp(l),U<0)break;for(H=0;H<M;H++){var P=c[H];P!==0&&(P>0?D=L[H][P-1>>1]:P<0&&(D=L[H][-P-1>>1].neg()),D.type==="affine"?o=o.mixedAdd(D):o=o.add(D))}}for(U=0;U<M;U++)L[U]=null;return k?o:o.toP()};function E(_,v){this.curve=_,this.type=v,this.precomputed=null}S.BasePoint=E,E.prototype.eq=function(){throw new Error("Not implemented")},E.prototype.validate=function(){return this.curve.validate(this)},S.prototype.decodePoint=function(v,d){v=n.toArray(v,d);var u=this.p.byteLength();if((v[0]===4||v[0]===6||v[0]===7)&&v.length-1===2*u){v[0]===6?s(v[v.length-1]%2===0):v[0]===7&&s(v[v.length-1]%2===1);var M=this.point(v.slice(1,1+u),v.slice(1+u,1+2*u));return M}else if((v[0]===2||v[0]===3)&&v.length-1===u)return this.pointFromX(v.slice(1,1+u),v[0]===3);throw new Error("Unknown point format")},E.prototype.encodeCompressed=function(v){return this.encode(v,!0)},E.prototype._encode=function(v){var d=this.curve.p.byteLength(),u=this.getX().toArray("be",d);return v?[this.getY().isEven()?2:3].concat(u):[4].concat(u,this.getY().toArray("be",d))},E.prototype.encode=function(v,d){return n.encode(this._encode(d),v)},E.prototype.precompute=function(v){if(this.precomputed)return this;var d={doubles:null,naf:null,beta:null};return d.naf=this._getNAFPoints(8),d.doubles=this._getDoubles(4,v),d.beta=this._getBeta(),this.precomputed=d,this},E.prototype._hasDoubles=function(v){if(!this.precomputed)return!1;var d=this.precomputed.doubles;return d?d.points.length>=Math.ceil((v.bitLength()+1)/d.step):!1},E.prototype._getDoubles=function(v,d){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var u=[this],M=this,k=0;k<d;k+=v){for(var T=0;T<v;T++)M=M.dbl();u.push(M)}return{step:v,points:u}},E.prototype._getNAFPoints=function(v){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var d=[this],u=(1<<v)-1,M=u===1?null:this.dbl(),k=1;k<u;k++)d[k]=d[k-1].add(M);return{wnd:v,points:d}},E.prototype._getBeta=function(){return null},E.prototype.dblp=function(v){for(var d=this,u=0;u<v;u++)d=d.dbl();return d}},{"../utils":15,"bn.js":16}],3:[function(f,t,i){"use strict";var e=f("../utils"),n=f("bn.js"),y=f("inherits"),I=f("./base"),s=e.assert;function S(_){this.twisted=(_.a|0)!==1,this.mOneA=this.twisted&&(_.a|0)===-1,this.extended=this.mOneA,I.call(this,"edwards",_),this.a=new n(_.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(_.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(_.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),s(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(_.c|0)===1}y(S,I),t.exports=S,S.prototype._mulA=function(v){return this.mOneA?v.redNeg():this.a.redMul(v)},S.prototype._mulC=function(v){return this.oneC?v:this.c.redMul(v)},S.prototype.jpoint=function(v,d,u,M){return this.point(v,d,u,M)},S.prototype.pointFromX=function(v,d){v=new n(v,16),v.red||(v=v.toRed(this.red));var u=v.redSqr(),M=this.c2.redSub(this.a.redMul(u)),k=this.one.redSub(this.c2.redMul(this.d).redMul(u)),T=M.redMul(k.redInvm()),L=T.redSqrt();if(L.redSqr().redSub(T).cmp(this.zero)!==0)throw new Error("invalid point");var z=L.fromRed().isOdd();return(d&&!z||!d&&z)&&(L=L.redNeg()),this.point(v,L)},S.prototype.pointFromY=function(v,d){v=new n(v,16),v.red||(v=v.toRed(this.red));var u=v.redSqr(),M=u.redSub(this.c2),k=u.redMul(this.d).redMul(this.c2).redSub(this.a),T=M.redMul(k.redInvm());if(T.cmp(this.zero)===0){if(d)throw new Error("invalid point");return this.point(this.zero,v)}var L=T.redSqrt();if(L.redSqr().redSub(T).cmp(this.zero)!==0)throw new Error("invalid point");return L.fromRed().isOdd()!==d&&(L=L.redNeg()),this.point(L,v)},S.prototype.validate=function(v){if(v.isInfinity())return!0;v.normalize();var d=v.x.redSqr(),u=v.y.redSqr(),M=d.redMul(this.a).redAdd(u),k=this.c2.redMul(this.one.redAdd(this.d.redMul(d).redMul(u)));return M.cmp(k)===0};function E(_,v,d,u,M){I.BasePoint.call(this,_,"projective"),v===null&&d===null&&u===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(v,16),this.y=new n(d,16),this.z=u?new n(u,16):this.curve.one,this.t=M&&new n(M,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}y(E,I.BasePoint),S.prototype.pointFromJSON=function(v){return E.fromJSON(this,v)},S.prototype.point=function(v,d,u,M){return new E(this,v,d,u,M)},E.fromJSON=function(v,d){return new E(v,d[0],d[1],d[2])},E.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},E.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},E.prototype._extDbl=function(){var v=this.x.redSqr(),d=this.y.redSqr(),u=this.z.redSqr();u=u.redIAdd(u);var M=this.curve._mulA(v),k=this.x.redAdd(this.y).redSqr().redISub(v).redISub(d),T=M.redAdd(d),L=T.redSub(u),z=M.redSub(d),R=k.redMul(L),U=T.redMul(z),H=k.redMul(z),D=L.redMul(T);return this.curve.point(R,U,D,H)},E.prototype._projDbl=function(){var v=this.x.redAdd(this.y).redSqr(),d=this.x.redSqr(),u=this.y.redSqr(),M,k,T,L,z,R;if(this.curve.twisted){L=this.curve._mulA(d);var U=L.redAdd(u);this.zOne?(M=v.redSub(d).redSub(u).redMul(U.redSub(this.curve.two)),k=U.redMul(L.redSub(u)),T=U.redSqr().redSub(U).redSub(U)):(z=this.z.redSqr(),R=U.redSub(z).redISub(z),M=v.redSub(d).redISub(u).redMul(R),k=U.redMul(L.redSub(u)),T=U.redMul(R))}else L=d.redAdd(u),z=this.curve._mulC(this.z).redSqr(),R=L.redSub(z).redSub(z),M=this.curve._mulC(v.redISub(L)).redMul(R),k=this.curve._mulC(L).redMul(d.redISub(u)),T=L.redMul(R);return this.curve.point(M,k,T)},E.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},E.prototype._extAdd=function(v){var d=this.y.redSub(this.x).redMul(v.y.redSub(v.x)),u=this.y.redAdd(this.x).redMul(v.y.redAdd(v.x)),M=this.t.redMul(this.curve.dd).redMul(v.t),k=this.z.redMul(v.z.redAdd(v.z)),T=u.redSub(d),L=k.redSub(M),z=k.redAdd(M),R=u.redAdd(d),U=T.redMul(L),H=z.redMul(R),D=T.redMul(R),K=L.redMul(z);return this.curve.point(U,H,K,D)},E.prototype._projAdd=function(v){var d=this.z.redMul(v.z),u=d.redSqr(),M=this.x.redMul(v.x),k=this.y.redMul(v.y),T=this.curve.d.redMul(M).redMul(k),L=u.redSub(T),z=u.redAdd(T),R=this.x.redAdd(this.y).redMul(v.x.redAdd(v.y)).redISub(M).redISub(k),U=d.redMul(L).redMul(R),H,D;return this.curve.twisted?(H=d.redMul(z).redMul(k.redSub(this.curve._mulA(M))),D=L.redMul(z)):(H=d.redMul(z).redMul(k.redSub(M)),D=this.curve._mulC(L).redMul(z)),this.curve.point(U,H,D)},E.prototype.add=function(v){return this.isInfinity()?v:v.isInfinity()?this:this.curve.extended?this._extAdd(v):this._projAdd(v)},E.prototype.mul=function(v){return this._hasDoubles(v)?this.curve._fixedNafMul(this,v):this.curve._wnafMul(this,v)},E.prototype.mulAdd=function(v,d,u){return this.curve._wnafMulAdd(1,[this,d],[v,u],2,!1)},E.prototype.jmulAdd=function(v,d,u){return this.curve._wnafMulAdd(1,[this,d],[v,u],2,!0)},E.prototype.normalize=function(){if(this.zOne)return this;var v=this.z.redInvm();return this.x=this.x.redMul(v),this.y=this.y.redMul(v),this.t&&(this.t=this.t.redMul(v)),this.z=this.curve.one,this.zOne=!0,this},E.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},E.prototype.getX=function(){return this.normalize(),this.x.fromRed()},E.prototype.getY=function(){return this.normalize(),this.y.fromRed()},E.prototype.eq=function(v){return this===v||this.getX().cmp(v.getX())===0&&this.getY().cmp(v.getY())===0},E.prototype.eqXToP=function(v){var d=v.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(d)===0)return!0;for(var u=v.clone(),M=this.curve.redN.redMul(this.z);;){if(u.iadd(this.curve.n),u.cmp(this.curve.p)>=0)return!1;if(d.redIAdd(M),this.x.cmp(d)===0)return!0}},E.prototype.toP=E.prototype.normalize,E.prototype.mixedAdd=E.prototype.add},{"../utils":15,"./base":2,"bn.js":16,inherits:32}],4:[function(f,t,i){"use strict";var e=i;e.base=f("./base"),e.short=f("./short"),e.mont=f("./mont"),e.edwards=f("./edwards")},{"./base":2,"./edwards":3,"./mont":5,"./short":6}],5:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("inherits"),y=f("./base"),I=f("../utils");function s(E){y.call(this,"mont",E),this.a=new e(E.a,16).toRed(this.red),this.b=new e(E.b,16).toRed(this.red),this.i4=new e(4).toRed(this.red).redInvm(),this.two=new e(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}n(s,y),t.exports=s,s.prototype.validate=function(_){var v=_.normalize().x,d=v.redSqr(),u=d.redMul(v).redAdd(d.redMul(this.a)).redAdd(v),M=u.redSqrt();return M.redSqr().cmp(u)===0};function S(E,_,v){y.BasePoint.call(this,E,"projective"),_===null&&v===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new e(_,16),this.z=new e(v,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}n(S,y.BasePoint),s.prototype.decodePoint=function(_,v){return this.point(I.toArray(_,v),1)},s.prototype.point=function(_,v){return new S(this,_,v)},s.prototype.pointFromJSON=function(_){return S.fromJSON(this,_)},S.prototype.precompute=function(){},S.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},S.fromJSON=function(_,v){return new S(_,v[0],v[1]||_.one)},S.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},S.prototype.isInfinity=function(){return this.z.cmpn(0)===0},S.prototype.dbl=function(){var _=this.x.redAdd(this.z),v=_.redSqr(),d=this.x.redSub(this.z),u=d.redSqr(),M=v.redSub(u),k=v.redMul(u),T=M.redMul(u.redAdd(this.curve.a24.redMul(M)));return this.curve.point(k,T)},S.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},S.prototype.diffAdd=function(_,v){var d=this.x.redAdd(this.z),u=this.x.redSub(this.z),M=_.x.redAdd(_.z),k=_.x.redSub(_.z),T=k.redMul(d),L=M.redMul(u),z=v.z.redMul(T.redAdd(L).redSqr()),R=v.x.redMul(T.redISub(L).redSqr());return this.curve.point(z,R)},S.prototype.mul=function(_){for(var v=_.clone(),d=this,u=this.curve.point(null,null),M=this,k=[];v.cmpn(0)!==0;v.iushrn(1))k.push(v.andln(1));for(var T=k.length-1;T>=0;T--)k[T]===0?(d=d.diffAdd(u,M),u=u.dbl()):(u=d.diffAdd(u,M),d=d.dbl());return u},S.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},S.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},S.prototype.eq=function(_){return this.getX().cmp(_.getX())===0},S.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},S.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":15,"./base":2,"bn.js":16,inherits:32}],6:[function(f,t,i){"use strict";var e=f("../utils"),n=f("bn.js"),y=f("inherits"),I=f("./base"),s=e.assert;function S(v){I.call(this,"short",v),this.a=new n(v.a,16).toRed(this.red),this.b=new n(v.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(v),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}y(S,I),t.exports=S,S.prototype._getEndomorphism=function(d){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var u,M;if(d.beta)u=new n(d.beta,16).toRed(this.red);else{var k=this._getEndoRoots(this.p);u=k[0].cmp(k[1])<0?k[0]:k[1],u=u.toRed(this.red)}if(d.lambda)M=new n(d.lambda,16);else{var T=this._getEndoRoots(this.n);this.g.mul(T[0]).x.cmp(this.g.x.redMul(u))===0?M=T[0]:(M=T[1],s(this.g.mul(M).x.cmp(this.g.x.redMul(u))===0))}var L;return d.basis?L=d.basis.map(function(z){return{a:new n(z.a,16),b:new n(z.b,16)}}):L=this._getEndoBasis(M),{beta:u,lambda:M,basis:L}}},S.prototype._getEndoRoots=function(d){var u=d===this.p?this.red:n.mont(d),M=new n(2).toRed(u).redInvm(),k=M.redNeg(),T=new n(3).toRed(u).redNeg().redSqrt().redMul(M),L=k.redAdd(T).fromRed(),z=k.redSub(T).fromRed();return[L,z]},S.prototype._getEndoBasis=function(d){for(var u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),M=d,k=this.n.clone(),T=new n(1),L=new n(0),z=new n(0),R=new n(1),U,H,D,K,B,N,q,C=0,x,r;M.cmpn(0)!==0;){var h=k.div(M);x=k.sub(h.mul(M)),r=z.sub(h.mul(T));var o=R.sub(h.mul(L));if(!D&&x.cmp(u)<0)U=q.neg(),H=T,D=x.neg(),K=r;else if(D&&++C===2)break;q=x,k=M,M=x,z=T,T=r,R=L,L=o}B=x.neg(),N=r;var c=D.sqr().add(K.sqr()),l=B.sqr().add(N.sqr());return l.cmp(c)>=0&&(B=U,N=H),D.negative&&(D=D.neg(),K=K.neg()),B.negative&&(B=B.neg(),N=N.neg()),[{a:D,b:K},{a:B,b:N}]},S.prototype._endoSplit=function(d){var u=this.endo.basis,M=u[0],k=u[1],T=k.b.mul(d).divRound(this.n),L=M.b.neg().mul(d).divRound(this.n),z=T.mul(M.a),R=L.mul(k.a),U=T.mul(M.b),H=L.mul(k.b),D=d.sub(z).sub(R),K=U.add(H).neg();return{k1:D,k2:K}},S.prototype.pointFromX=function(d,u){d=new n(d,16),d.red||(d=d.toRed(this.red));var M=d.redSqr().redMul(d).redIAdd(d.redMul(this.a)).redIAdd(this.b),k=M.redSqrt();if(k.redSqr().redSub(M).cmp(this.zero)!==0)throw new Error("invalid point");var T=k.fromRed().isOdd();return(u&&!T||!u&&T)&&(k=k.redNeg()),this.point(d,k)},S.prototype.validate=function(d){if(d.inf)return!0;var u=d.x,M=d.y,k=this.a.redMul(u),T=u.redSqr().redMul(u).redIAdd(k).redIAdd(this.b);return M.redSqr().redISub(T).cmpn(0)===0},S.prototype._endoWnafMulAdd=function(d,u,M){for(var k=this._endoWnafT1,T=this._endoWnafT2,L=0;L<d.length;L++){var z=this._endoSplit(u[L]),R=d[L],U=R._getBeta();z.k1.negative&&(z.k1.ineg(),R=R.neg(!0)),z.k2.negative&&(z.k2.ineg(),U=U.neg(!0)),k[L*2]=R,k[L*2+1]=U,T[L*2]=z.k1,T[L*2+1]=z.k2}for(var H=this._wnafMulAdd(1,k,T,L*2,M),D=0;D<L*2;D++)k[D]=null,T[D]=null;return H};function E(v,d,u,M){I.BasePoint.call(this,v,"affine"),d===null&&u===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new n(d,16),this.y=new n(u,16),M&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}y(E,I.BasePoint),S.prototype.point=function(d,u,M){return new E(this,d,u,M)},S.prototype.pointFromJSON=function(d,u){return E.fromJSON(this,d,u)},E.prototype._getBeta=function(){if(this.curve.endo){var d=this.precomputed;if(d&&d.beta)return d.beta;var u=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(d){var M=this.curve,k=function(T){return M.point(T.x.redMul(M.endo.beta),T.y)};d.beta=u,u.precomputed={beta:null,naf:d.naf&&{wnd:d.naf.wnd,points:d.naf.points.map(k)},doubles:d.doubles&&{step:d.doubles.step,points:d.doubles.points.map(k)}}}return u}},E.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},E.fromJSON=function(d,u,M){typeof u=="string"&&(u=JSON.parse(u));var k=d.point(u[0],u[1],M);if(!u[2])return k;function T(z){return d.point(z[0],z[1],M)}var L=u[2];return k.precomputed={beta:null,doubles:L.doubles&&{step:L.doubles.step,points:[k].concat(L.doubles.points.map(T))},naf:L.naf&&{wnd:L.naf.wnd,points:[k].concat(L.naf.points.map(T))}},k},E.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},E.prototype.isInfinity=function(){return this.inf},E.prototype.add=function(d){if(this.inf)return d;if(d.inf)return this;if(this.eq(d))return this.dbl();if(this.neg().eq(d))return this.curve.point(null,null);if(this.x.cmp(d.x)===0)return this.curve.point(null,null);var u=this.y.redSub(d.y);u.cmpn(0)!==0&&(u=u.redMul(this.x.redSub(d.x).redInvm()));var M=u.redSqr().redISub(this.x).redISub(d.x),k=u.redMul(this.x.redSub(M)).redISub(this.y);return this.curve.point(M,k)},E.prototype.dbl=function(){if(this.inf)return this;var d=this.y.redAdd(this.y);if(d.cmpn(0)===0)return this.curve.point(null,null);var u=this.curve.a,M=this.x.redSqr(),k=d.redInvm(),T=M.redAdd(M).redIAdd(M).redIAdd(u).redMul(k),L=T.redSqr().redISub(this.x.redAdd(this.x)),z=T.redMul(this.x.redSub(L)).redISub(this.y);return this.curve.point(L,z)},E.prototype.getX=function(){return this.x.fromRed()},E.prototype.getY=function(){return this.y.fromRed()},E.prototype.mul=function(d){return d=new n(d,16),this.isInfinity()?this:this._hasDoubles(d)?this.curve._fixedNafMul(this,d):this.curve.endo?this.curve._endoWnafMulAdd([this],[d]):this.curve._wnafMul(this,d)},E.prototype.mulAdd=function(d,u,M){var k=[this,u],T=[d,M];return this.curve.endo?this.curve._endoWnafMulAdd(k,T):this.curve._wnafMulAdd(1,k,T,2)},E.prototype.jmulAdd=function(d,u,M){var k=[this,u],T=[d,M];return this.curve.endo?this.curve._endoWnafMulAdd(k,T,!0):this.curve._wnafMulAdd(1,k,T,2,!0)},E.prototype.eq=function(d){return this===d||this.inf===d.inf&&(this.inf||this.x.cmp(d.x)===0&&this.y.cmp(d.y)===0)},E.prototype.neg=function(d){if(this.inf)return this;var u=this.curve.point(this.x,this.y.redNeg());if(d&&this.precomputed){var M=this.precomputed,k=function(T){return T.neg()};u.precomputed={naf:M.naf&&{wnd:M.naf.wnd,points:M.naf.points.map(k)},doubles:M.doubles&&{step:M.doubles.step,points:M.doubles.points.map(k)}}}return u},E.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var d=this.curve.jpoint(this.x,this.y,this.curve.one);return d};function _(v,d,u,M){I.BasePoint.call(this,v,"jacobian"),d===null&&u===null&&M===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n(0)):(this.x=new n(d,16),this.y=new n(u,16),this.z=new n(M,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}y(_,I.BasePoint),S.prototype.jpoint=function(d,u,M){return new _(this,d,u,M)},_.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var d=this.z.redInvm(),u=d.redSqr(),M=this.x.redMul(u),k=this.y.redMul(u).redMul(d);return this.curve.point(M,k)},_.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},_.prototype.add=function(d){if(this.isInfinity())return d;if(d.isInfinity())return this;var u=d.z.redSqr(),M=this.z.redSqr(),k=this.x.redMul(u),T=d.x.redMul(M),L=this.y.redMul(u.redMul(d.z)),z=d.y.redMul(M.redMul(this.z)),R=k.redSub(T),U=L.redSub(z);if(R.cmpn(0)===0)return U.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var H=R.redSqr(),D=H.redMul(R),K=k.redMul(H),B=U.redSqr().redIAdd(D).redISub(K).redISub(K),N=U.redMul(K.redISub(B)).redISub(L.redMul(D)),q=this.z.redMul(d.z).redMul(R);return this.curve.jpoint(B,N,q)},_.prototype.mixedAdd=function(d){if(this.isInfinity())return d.toJ();if(d.isInfinity())return this;var u=this.z.redSqr(),M=this.x,k=d.x.redMul(u),T=this.y,L=d.y.redMul(u).redMul(this.z),z=M.redSub(k),R=T.redSub(L);if(z.cmpn(0)===0)return R.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var U=z.redSqr(),H=U.redMul(z),D=M.redMul(U),K=R.redSqr().redIAdd(H).redISub(D).redISub(D),B=R.redMul(D.redISub(K)).redISub(T.redMul(H)),N=this.z.redMul(z);return this.curve.jpoint(K,B,N)},_.prototype.dblp=function(d){if(d===0)return this;if(this.isInfinity())return this;if(!d)return this.dbl();var u;if(this.curve.zeroA||this.curve.threeA){var M=this;for(u=0;u<d;u++)M=M.dbl();return M}var k=this.curve.a,T=this.curve.tinv,L=this.x,z=this.y,R=this.z,U=R.redSqr().redSqr(),H=z.redAdd(z);for(u=0;u<d;u++){var D=L.redSqr(),K=H.redSqr(),B=K.redSqr(),N=D.redAdd(D).redIAdd(D).redIAdd(k.redMul(U)),q=L.redMul(K),C=N.redSqr().redISub(q.redAdd(q)),x=q.redISub(C),r=N.redMul(x);r=r.redIAdd(r).redISub(B);var h=H.redMul(R);u+1<d&&(U=U.redMul(B)),L=C,R=h,H=r}return this.curve.jpoint(L,H.redMul(T),R)},_.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},_.prototype._zeroDbl=function(){var d,u,M;if(this.zOne){var k=this.x.redSqr(),T=this.y.redSqr(),L=T.redSqr(),z=this.x.redAdd(T).redSqr().redISub(k).redISub(L);z=z.redIAdd(z);var R=k.redAdd(k).redIAdd(k),U=R.redSqr().redISub(z).redISub(z),H=L.redIAdd(L);H=H.redIAdd(H),H=H.redIAdd(H),d=U,u=R.redMul(z.redISub(U)).redISub(H),M=this.y.redAdd(this.y)}else{var D=this.x.redSqr(),K=this.y.redSqr(),B=K.redSqr(),N=this.x.redAdd(K).redSqr().redISub(D).redISub(B);N=N.redIAdd(N);var q=D.redAdd(D).redIAdd(D),C=q.redSqr(),x=B.redIAdd(B);x=x.redIAdd(x),x=x.redIAdd(x),d=C.redISub(N).redISub(N),u=q.redMul(N.redISub(d)).redISub(x),M=this.y.redMul(this.z),M=M.redIAdd(M)}return this.curve.jpoint(d,u,M)},_.prototype._threeDbl=function(){var d,u,M;if(this.zOne){var k=this.x.redSqr(),T=this.y.redSqr(),L=T.redSqr(),z=this.x.redAdd(T).redSqr().redISub(k).redISub(L);z=z.redIAdd(z);var R=k.redAdd(k).redIAdd(k).redIAdd(this.curve.a),U=R.redSqr().redISub(z).redISub(z);d=U;var H=L.redIAdd(L);H=H.redIAdd(H),H=H.redIAdd(H),u=R.redMul(z.redISub(U)).redISub(H),M=this.y.redAdd(this.y)}else{var D=this.z.redSqr(),K=this.y.redSqr(),B=this.x.redMul(K),N=this.x.redSub(D).redMul(this.x.redAdd(D));N=N.redAdd(N).redIAdd(N);var q=B.redIAdd(B);q=q.redIAdd(q);var C=q.redAdd(q);d=N.redSqr().redISub(C),M=this.y.redAdd(this.z).redSqr().redISub(K).redISub(D);var x=K.redSqr();x=x.redIAdd(x),x=x.redIAdd(x),x=x.redIAdd(x),u=N.redMul(q.redISub(d)).redISub(x)}return this.curve.jpoint(d,u,M)},_.prototype._dbl=function(){var d=this.curve.a,u=this.x,M=this.y,k=this.z,T=k.redSqr().redSqr(),L=u.redSqr(),z=M.redSqr(),R=L.redAdd(L).redIAdd(L).redIAdd(d.redMul(T)),U=u.redAdd(u);U=U.redIAdd(U);var H=U.redMul(z),D=R.redSqr().redISub(H.redAdd(H)),K=H.redISub(D),B=z.redSqr();B=B.redIAdd(B),B=B.redIAdd(B),B=B.redIAdd(B);var N=R.redMul(K).redISub(B),q=M.redAdd(M).redMul(k);return this.curve.jpoint(D,N,q)},_.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var d=this.x.redSqr(),u=this.y.redSqr(),M=this.z.redSqr(),k=u.redSqr(),T=d.redAdd(d).redIAdd(d),L=T.redSqr(),z=this.x.redAdd(u).redSqr().redISub(d).redISub(k);z=z.redIAdd(z),z=z.redAdd(z).redIAdd(z),z=z.redISub(L);var R=z.redSqr(),U=k.redIAdd(k);U=U.redIAdd(U),U=U.redIAdd(U),U=U.redIAdd(U);var H=T.redIAdd(z).redSqr().redISub(L).redISub(R).redISub(U),D=u.redMul(H);D=D.redIAdd(D),D=D.redIAdd(D);var K=this.x.redMul(R).redISub(D);K=K.redIAdd(K),K=K.redIAdd(K);var B=this.y.redMul(H.redMul(U.redISub(H)).redISub(z.redMul(R)));B=B.redIAdd(B),B=B.redIAdd(B),B=B.redIAdd(B);var N=this.z.redAdd(z).redSqr().redISub(M).redISub(R);return this.curve.jpoint(K,B,N)},_.prototype.mul=function(d,u){return d=new n(d,u),this.curve._wnafMul(this,d)},_.prototype.eq=function(d){if(d.type==="affine")return this.eq(d.toJ());if(this===d)return!0;var u=this.z.redSqr(),M=d.z.redSqr();if(this.x.redMul(M).redISub(d.x.redMul(u)).cmpn(0)!==0)return!1;var k=u.redMul(this.z),T=M.redMul(d.z);return this.y.redMul(T).redISub(d.y.redMul(k)).cmpn(0)===0},_.prototype.eqXToP=function(d){var u=this.z.redSqr(),M=d.toRed(this.curve.red).redMul(u);if(this.x.cmp(M)===0)return!0;for(var k=d.clone(),T=this.curve.redN.redMul(u);;){if(k.iadd(this.curve.n),k.cmp(this.curve.p)>=0)return!1;if(M.redIAdd(T),this.x.cmp(M)===0)return!0}},_.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},_.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":15,"./base":2,"bn.js":16,inherits:32}],7:[function(f,t,i){"use strict";var e=i,n=f("hash.js"),y=f("./curve"),I=f("./utils"),s=I.assert;function S(v){v.type==="short"?this.curve=new y.short(v):v.type==="edwards"?this.curve=new y.edwards(v):this.curve=new y.mont(v),this.g=this.curve.g,this.n=this.curve.n,this.hash=v.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=S;function E(v,d){Object.defineProperty(e,v,{configurable:!0,enumerable:!0,get:function(){var u=new S(d);return Object.defineProperty(e,v,{configurable:!0,enumerable:!0,value:u}),u}})}E("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),E("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),E("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),E("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),E("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),E("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),E("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var _;try{_=f("./precomputed/secp256k1")}catch{_=void 0}E("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",_]})},{"./curve":4,"./precomputed/secp256k1":14,"./utils":15,"hash.js":19}],8:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("hmac-drbg"),y=f("../utils"),I=f("../curves"),s=f("brorand"),S=y.assert,E=f("./key"),_=f("./signature");function v(d){if(!(this instanceof v))return new v(d);typeof d=="string"&&(S(Object.prototype.hasOwnProperty.call(I,d),"Unknown curve "+d),d=I[d]),d instanceof I.PresetCurve&&(d={curve:d}),this.curve=d.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=d.curve.g,this.g.precompute(d.curve.n.bitLength()+1),this.hash=d.hash||d.curve.hash}t.exports=v,v.prototype.keyPair=function(u){return new E(this,u)},v.prototype.keyFromPrivate=function(u,M){return E.fromPrivate(this,u,M)},v.prototype.keyFromPublic=function(u,M){return E.fromPublic(this,u,M)},v.prototype.genKeyPair=function(u){u||(u={});for(var M=new n({hash:this.hash,pers:u.pers,persEnc:u.persEnc||"utf8",entropy:u.entropy||s(this.hash.hmacStrength),entropyEnc:u.entropy&&u.entropyEnc||"utf8",nonce:this.n.toArray()}),k=this.n.byteLength(),T=this.n.sub(new e(2));;){var L=new e(M.generate(k));if(!(L.cmp(T)>0))return L.iaddn(1),this.keyFromPrivate(L)}},v.prototype._truncateToN=function(u,M){var k=u.byteLength()*8-this.n.bitLength();return k>0&&(u=u.ushrn(k)),!M&&u.cmp(this.n)>=0?u.sub(this.n):u},v.prototype.sign=function(u,M,k,T){typeof k=="object"&&(T=k,k=null),T||(T={}),M=this.keyFromPrivate(M,k),u=this._truncateToN(new e(u,16));for(var L=this.n.byteLength(),z=M.getPrivate().toArray("be",L),R=u.toArray("be",L),U=new n({hash:this.hash,entropy:z,nonce:R,pers:T.pers,persEnc:T.persEnc||"utf8"}),H=this.n.sub(new e(1)),D=0;;D++){var K=T.k?T.k(D):new e(U.generate(this.n.byteLength()));if(K=this._truncateToN(K,!0),!(K.cmpn(1)<=0||K.cmp(H)>=0)){var B=this.g.mul(K);if(!B.isInfinity()){var N=B.getX(),q=N.umod(this.n);if(q.cmpn(0)!==0){var C=K.invm(this.n).mul(q.mul(M.getPrivate()).iadd(u));if(C=C.umod(this.n),C.cmpn(0)!==0){var x=(B.getY().isOdd()?1:0)|(N.cmp(q)!==0?2:0);return T.canonical&&C.cmp(this.nh)>0&&(C=this.n.sub(C),x^=1),new _({r:q,s:C,recoveryParam:x})}}}}}},v.prototype.verify=function(u,M,k,T){u=this._truncateToN(new e(u,16)),k=this.keyFromPublic(k,T),M=new _(M,"hex");var L=M.r,z=M.s;if(L.cmpn(1)<0||L.cmp(this.n)>=0||z.cmpn(1)<0||z.cmp(this.n)>=0)return!1;var R=z.invm(this.n),U=R.mul(u).umod(this.n),H=R.mul(L).umod(this.n),D;return this.curve._maxwellTrick?(D=this.g.jmulAdd(U,k.getPublic(),H),D.isInfinity()?!1:D.eqXToP(L)):(D=this.g.mulAdd(U,k.getPublic(),H),D.isInfinity()?!1:D.getX().umod(this.n).cmp(L)===0)},v.prototype.recoverPubKey=function(d,u,M,k){S((3&M)===M,"The recovery param is more than two bits"),u=new _(u,k);var T=this.n,L=new e(d),z=u.r,R=u.s,U=M&1,H=M>>1;if(z.cmp(this.curve.p.umod(this.curve.n))>=0&&H)throw new Error("Unable to find sencond key candinate");H?z=this.curve.pointFromX(z.add(this.curve.n),U):z=this.curve.pointFromX(z,U);var D=u.r.invm(T),K=T.sub(L).mul(D).umod(T),B=R.mul(D).umod(T);return this.g.mulAdd(K,z,B)},v.prototype.getKeyRecoveryParam=function(d,u,M,k){if(u=new _(u,k),u.recoveryParam!==null)return u.recoveryParam;for(var T=0;T<4;T++){var L;try{L=this.recoverPubKey(d,u,T)}catch{continue}if(L.eq(M))return T}throw new Error("Unable to find valid recovery factor")}},{"../curves":7,"../utils":15,"./key":9,"./signature":10,"bn.js":16,brorand:17,"hmac-drbg":31}],9:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("../utils"),y=n.assert;function I(s,S){this.ec=s,this.priv=null,this.pub=null,S.priv&&this._importPrivate(S.priv,S.privEnc),S.pub&&this._importPublic(S.pub,S.pubEnc)}t.exports=I,I.fromPublic=function(S,E,_){return E instanceof I?E:new I(S,{pub:E,pubEnc:_})},I.fromPrivate=function(S,E,_){return E instanceof I?E:new I(S,{priv:E,privEnc:_})},I.prototype.validate=function(){var S=this.getPublic();return S.isInfinity()?{result:!1,reason:"Invalid public key"}:S.validate()?S.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},I.prototype.getPublic=function(S,E){return typeof S=="string"&&(E=S,S=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),E?this.pub.encode(E,S):this.pub},I.prototype.getPrivate=function(S){return S==="hex"?this.priv.toString(16,2):this.priv},I.prototype._importPrivate=function(S,E){this.priv=new e(S,E||16),this.priv=this.priv.umod(this.ec.curve.n)},I.prototype._importPublic=function(S,E){if(S.x||S.y){this.ec.curve.type==="mont"?y(S.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&y(S.x&&S.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(S.x,S.y);return}this.pub=this.ec.curve.decodePoint(S,E)},I.prototype.derive=function(S){return S.validate()||y(S.validate(),"public point not validated"),S.mul(this.priv).getX()},I.prototype.sign=function(S,E,_){return this.ec.sign(S,this,E,_)},I.prototype.verify=function(S,E){return this.ec.verify(S,E,this)},I.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":15,"bn.js":16}],10:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("../utils"),y=n.assert;function I(v,d){if(v instanceof I)return v;this._importDER(v,d)||(y(v.r&&v.s,"Signature without r or s"),this.r=new e(v.r,16),this.s=new e(v.s,16),v.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=v.recoveryParam)}t.exports=I;function s(){this.place=0}function S(v,d){var u=v[d.place++];if(!(u&128))return u;var M=u&15;if(M===0||M>4)return!1;for(var k=0,T=0,L=d.place;T<M;T++,L++)k<<=8,k|=v[L],k>>>=0;return k<=127?!1:(d.place=L,k)}function E(v){for(var d=0,u=v.length-1;!v[d]&&!(v[d+1]&128)&&d<u;)d++;return d===0?v:v.slice(d)}I.prototype._importDER=function(d,u){d=n.toArray(d,u);var M=new s;if(d[M.place++]!==48)return!1;var k=S(d,M);if(k===!1||k+M.place!==d.length||d[M.place++]!==2)return!1;var T=S(d,M);if(T===!1)return!1;var L=d.slice(M.place,T+M.place);if(M.place+=T,d[M.place++]!==2)return!1;var z=S(d,M);if(z===!1||d.length!==z+M.place)return!1;var R=d.slice(M.place,z+M.place);if(L[0]===0)if(L[1]&128)L=L.slice(1);else return!1;if(R[0]===0)if(R[1]&128)R=R.slice(1);else return!1;return this.r=new e(L),this.s=new e(R),this.recoveryParam=null,!0};function _(v,d){if(d<128){v.push(d);return}var u=1+(Math.log(d)/Math.LN2>>>3);for(v.push(u|128);--u;)v.push(d>>>(u<<3)&255);v.push(d)}I.prototype.toDER=function(d){var u=this.r.toArray(),M=this.s.toArray();for(u[0]&128&&(u=[0].concat(u)),M[0]&128&&(M=[0].concat(M)),u=E(u),M=E(M);!M[0]&&!(M[1]&128);)M=M.slice(1);var k=[2];_(k,u.length),k=k.concat(u),k.push(2),_(k,M.length);var T=k.concat(M),L=[48];return _(L,T.length),L=L.concat(T),n.encode(L,d)}},{"../utils":15,"bn.js":16}],11:[function(f,t,i){"use strict";var e=f("hash.js"),n=f("../curves"),y=f("../utils"),I=y.assert,s=y.parseBytes,S=f("./key"),E=f("./signature");function _(v){if(I(v==="ed25519","only tested with ed25519 so far"),!(this instanceof _))return new _(v);v=n[v].curve,this.curve=v,this.g=v.g,this.g.precompute(v.n.bitLength()+1),this.pointClass=v.point().constructor,this.encodingLength=Math.ceil(v.n.bitLength()/8),this.hash=e.sha512}t.exports=_,_.prototype.sign=function(d,u){d=s(d);var M=this.keyFromSecret(u),k=this.hashInt(M.messagePrefix(),d),T=this.g.mul(k),L=this.encodePoint(T),z=this.hashInt(L,M.pubBytes(),d).mul(M.priv()),R=k.add(z).umod(this.curve.n);return this.makeSignature({R:T,S:R,Rencoded:L})},_.prototype.verify=function(d,u,M){d=s(d),u=this.makeSignature(u);var k=this.keyFromPublic(M),T=this.hashInt(u.Rencoded(),k.pubBytes(),d),L=this.g.mul(u.S()),z=u.R().add(k.pub().mul(T));return z.eq(L)},_.prototype.hashInt=function(){for(var d=this.hash(),u=0;u<arguments.length;u++)d.update(arguments[u]);return y.intFromLE(d.digest()).umod(this.curve.n)},_.prototype.keyFromPublic=function(d){return S.fromPublic(this,d)},_.prototype.keyFromSecret=function(d){return S.fromSecret(this,d)},_.prototype.makeSignature=function(d){return d instanceof E?d:new E(this,d)},_.prototype.encodePoint=function(d){var u=d.getY().toArray("le",this.encodingLength);return u[this.encodingLength-1]|=d.getX().isOdd()?128:0,u},_.prototype.decodePoint=function(d){d=y.parseBytes(d);var u=d.length-1,M=d.slice(0,u).concat(d[u]&-129),k=(d[u]&128)!==0,T=y.intFromLE(M);return this.curve.pointFromY(T,k)},_.prototype.encodeInt=function(d){return d.toArray("le",this.encodingLength)},_.prototype.decodeInt=function(d){return y.intFromLE(d)},_.prototype.isPoint=function(d){return d instanceof this.pointClass}},{"../curves":7,"../utils":15,"./key":12,"./signature":13,"hash.js":19}],12:[function(f,t,i){"use strict";var e=f("../utils"),n=e.assert,y=e.parseBytes,I=e.cachedProperty;function s(S,E){this.eddsa=S,this._secret=y(E.secret),S.isPoint(E.pub)?this._pub=E.pub:this._pubBytes=y(E.pub)}s.fromPublic=function(E,_){return _ instanceof s?_:new s(E,{pub:_})},s.fromSecret=function(E,_){return _ instanceof s?_:new s(E,{secret:_})},s.prototype.secret=function(){return this._secret},I(s,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),I(s,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),I(s,"privBytes",function(){var E=this.eddsa,_=this.hash(),v=E.encodingLength-1,d=_.slice(0,E.encodingLength);return d[0]&=248,d[v]&=127,d[v]|=64,d}),I(s,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),I(s,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),I(s,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),s.prototype.sign=function(E){return n(this._secret,"KeyPair can only verify"),this.eddsa.sign(E,this)},s.prototype.verify=function(E,_){return this.eddsa.verify(E,_,this)},s.prototype.getSecret=function(E){return n(this._secret,"KeyPair is public only"),e.encode(this.secret(),E)},s.prototype.getPublic=function(E){return e.encode(this.pubBytes(),E)},t.exports=s},{"../utils":15}],13:[function(f,t,i){"use strict";var e=f("bn.js"),n=f("../utils"),y=n.assert,I=n.cachedProperty,s=n.parseBytes;function S(E,_){this.eddsa=E,typeof _!="object"&&(_=s(_)),Array.isArray(_)&&(_={R:_.slice(0,E.encodingLength),S:_.slice(E.encodingLength)}),y(_.R&&_.S,"Signature without R or S"),E.isPoint(_.R)&&(this._R=_.R),_.S instanceof e&&(this._S=_.S),this._Rencoded=Array.isArray(_.R)?_.R:_.Rencoded,this._Sencoded=Array.isArray(_.S)?_.S:_.Sencoded}I(S,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),I(S,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),I(S,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),I(S,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),S.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},S.prototype.toHex=function(){return n.encode(this.toBytes(),"hex").toUpperCase()},t.exports=S},{"../utils":15,"bn.js":16}],14:[function(f,t,i){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],15:[function(f,t,i){"use strict";var e=i,n=f("bn.js"),y=f("minimalistic-assert"),I=f("minimalistic-crypto-utils");e.assert=y,e.toArray=I.toArray,e.zero2=I.zero2,e.toHex=I.toHex,e.encode=I.encode;function s(d,u,M){var k=new Array(Math.max(d.bitLength(),M)+1);k.fill(0);for(var T=1<<u+1,L=d.clone(),z=0;z<k.length;z++){var R,U=L.andln(T-1);L.isOdd()?(U>(T>>1)-1?R=(T>>1)-U:R=U,L.isubn(R)):R=0,k[z]=R,L.iushrn(1)}return k}e.getNAF=s;function S(d,u){var M=[[],[]];d=d.clone(),u=u.clone();for(var k=0,T=0,L;d.cmpn(-k)>0||u.cmpn(-T)>0;){var z=d.andln(3)+k&3,R=u.andln(3)+T&3;z===3&&(z=-1),R===3&&(R=-1);var U;z&1?(L=d.andln(7)+k&7,(L===3||L===5)&&R===2?U=-z:U=z):U=0,M[0].push(U);var H;R&1?(L=u.andln(7)+T&7,(L===3||L===5)&&z===2?H=-R:H=R):H=0,M[1].push(H),2*k===U+1&&(k=1-k),2*T===H+1&&(T=1-T),d.iushrn(1),u.iushrn(1)}return M}e.getJSF=S;function E(d,u,M){var k="_"+u;d.prototype[u]=function(){return this[k]!==void 0?this[k]:this[k]=M.call(this)}}e.cachedProperty=E;function _(d){return typeof d=="string"?e.toArray(d,"hex"):d}e.parseBytes=_;function v(d){return new n(d,"hex","le")}e.intFromLE=v},{"bn.js":16,"minimalistic-assert":33,"minimalistic-crypto-utils":34}],16:[function(f,t,i){(function(e,n){"use strict";function y(x,r){if(!x)throw new Error(r||"Assertion failed")}function I(x,r){x.super_=r;var h=function(){};h.prototype=r.prototype,x.prototype=new h,x.prototype.constructor=x}function s(x,r,h){if(s.isBN(x))return x;this.negative=0,this.words=null,this.length=0,this.red=null,x!==null&&((r==="le"||r==="be")&&(h=r,r=10),this._init(x||0,r||10,h||"be"))}typeof e=="object"?e.exports=s:n.BN=s,s.BN=s,s.wordSize=26;var S;try{S=f("buffer").Buffer}catch{}s.isBN=function(r){return r instanceof s?!0:r!==null&&typeof r=="object"&&r.constructor.wordSize===s.wordSize&&Array.isArray(r.words)},s.max=function(r,h){return r.cmp(h)>0?r:h},s.min=function(r,h){return r.cmp(h)<0?r:h},s.prototype._init=function(r,h,o){if(typeof r=="number")return this._initNumber(r,h,o);if(typeof r=="object")return this._initArray(r,h,o);h==="hex"&&(h=16),y(h===(h|0)&&h>=2&&h<=36),r=r.toString().replace(/\s+/g,"");var c=0;r[0]==="-"&&c++,h===16?this._parseHex(r,c):this._parseBase(r,h,c),r[0]==="-"&&(this.negative=1),this.strip(),o==="le"&&this._initArray(this.toArray(),h,o)},s.prototype._initNumber=function(r,h,o){r<0&&(this.negative=1,r=-r),r<67108864?(this.words=[r&67108863],this.length=1):r<4503599627370496?(this.words=[r&67108863,r/67108864&67108863],this.length=2):(y(r<9007199254740992),this.words=[r&67108863,r/67108864&67108863,1],this.length=3),o==="le"&&this._initArray(this.toArray(),h,o)},s.prototype._initArray=function(r,h,o){if(y(typeof r.length=="number"),r.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(r.length/3),this.words=new Array(this.length);for(var c=0;c<this.length;c++)this.words[c]=0;var l,g,P=0;if(o==="be")for(c=r.length-1,l=0;c>=0;c-=3)g=r[c]|r[c-1]<<8|r[c-2]<<16,this.words[l]|=g<<P&67108863,this.words[l+1]=g>>>26-P&67108863,P+=24,P>=26&&(P-=26,l++);else if(o==="le")for(c=0,l=0;c<r.length;c+=3)g=r[c]|r[c+1]<<8|r[c+2]<<16,this.words[l]|=g<<P&67108863,this.words[l+1]=g>>>26-P&67108863,P+=24,P>=26&&(P-=26,l++);return this.strip()};function E(x,r,h){for(var o=0,c=Math.min(x.length,h),l=r;l<c;l++){var g=x.charCodeAt(l)-48;o<<=4,g>=49&&g<=54?o|=g-49+10:g>=17&&g<=22?o|=g-17+10:o|=g&15}return o}s.prototype._parseHex=function(r,h){this.length=Math.ceil((r.length-h)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var c,l,g=0;for(o=r.length-6,c=0;o>=h;o-=6)l=E(r,o,o+6),this.words[c]|=l<<g&67108863,this.words[c+1]|=l>>>26-g&4194303,g+=24,g>=26&&(g-=26,c++);o+6!==h&&(l=E(r,h,o+6),this.words[c]|=l<<g&67108863,this.words[c+1]|=l>>>26-g&4194303),this.strip()};function _(x,r,h,o){for(var c=0,l=Math.min(x.length,h),g=r;g<l;g++){var P=x.charCodeAt(g)-48;c*=o,P>=49?c+=P-49+10:P>=17?c+=P-17+10:c+=P}return c}s.prototype._parseBase=function(r,h,o){this.words=[0],this.length=1;for(var c=0,l=1;l<=67108863;l*=h)c++;c--,l=l/h|0;for(var g=r.length-o,P=g%c,p=Math.min(g,g-P)+o,a=0,w=o;w<p;w+=c)a=_(r,w,w+c,h),this.imuln(l),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(P!==0){var j=1;for(a=_(r,w,r.length,h),w=0;w<P;w++)j*=h;this.imuln(j),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}},s.prototype.copy=function(r){r.words=new Array(this.length);for(var h=0;h<this.length;h++)r.words[h]=this.words[h];r.length=this.length,r.negative=this.negative,r.red=this.red},s.prototype.clone=function(){var r=new s(null);return this.copy(r),r},s.prototype._expand=function(r){for(;this.length<r;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],u=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(r,h){r=r||10,h=h|0||1;var o;if(r===16||r==="hex"){o="";for(var c=0,l=0,g=0;g<this.length;g++){var P=this.words[g],p=((P<<c|l)&16777215).toString(16);l=P>>>24-c&16777215,l!==0||g!==this.length-1?o=v[6-p.length]+p+o:o=p+o,c+=2,c>=26&&(c-=26,g--)}for(l!==0&&(o=l.toString(16)+o);o.length%h!==0;)o="0"+o;return this.negative!==0&&(o="-"+o),o}if(r===(r|0)&&r>=2&&r<=36){var a=d[r],w=u[r];o="";var j=this.clone();for(j.negative=0;!j.isZero();){var F=j.modn(w).toString(r);j=j.idivn(w),j.isZero()?o=F+o:o=v[a-F.length]+F+o}for(this.isZero()&&(o="0"+o);o.length%h!==0;)o="0"+o;return this.negative!==0&&(o="-"+o),o}y(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var r=this.words[0];return this.length===2?r+=this.words[1]*67108864:this.length===3&&this.words[2]===1?r+=4503599627370496+this.words[1]*67108864:this.length>2&&y(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-r:r},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(r,h){return y(typeof S<"u"),this.toArrayLike(S,r,h)},s.prototype.toArray=function(r,h){return this.toArrayLike(Array,r,h)},s.prototype.toArrayLike=function(r,h,o){var c=this.byteLength(),l=o||Math.max(1,c);y(c<=l,"byte array longer than desired length"),y(l>0,"Requested array length <= 0"),this.strip();var g=h==="le",P=new r(l),p,a,w=this.clone();if(g){for(a=0;!w.isZero();a++)p=w.andln(255),w.iushrn(8),P[a]=p;for(;a<l;a++)P[a]=0}else{for(a=0;a<l-c;a++)P[a]=0;for(a=0;!w.isZero();a++)p=w.andln(255),w.iushrn(8),P[l-a-1]=p}return P},Math.clz32?s.prototype._countBits=function(r){return 32-Math.clz32(r)}:s.prototype._countBits=function(r){var h=r,o=0;return h>=4096&&(o+=13,h>>>=13),h>=64&&(o+=7,h>>>=7),h>=8&&(o+=4,h>>>=4),h>=2&&(o+=2,h>>>=2),o+h},s.prototype._zeroBits=function(r){if(r===0)return 26;var h=r,o=0;return h&8191||(o+=13,h>>>=13),h&127||(o+=7,h>>>=7),h&15||(o+=4,h>>>=4),h&3||(o+=2,h>>>=2),h&1||o++,o},s.prototype.bitLength=function(){var r=this.words[this.length-1],h=this._countBits(r);return(this.length-1)*26+h};function M(x){for(var r=new Array(x.bitLength()),h=0;h<r.length;h++){var o=h/26|0,c=h%26;r[h]=(x.words[o]&1<<c)>>>c}return r}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,h=0;h<this.length;h++){var o=this._zeroBits(this.words[h]);if(r+=o,o!==26)break}return r},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(r){return this.negative!==0?this.abs().inotn(r).iaddn(1):this.clone()},s.prototype.fromTwos=function(r){return this.testn(r-1)?this.notn(r).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(r){for(;this.length<r.length;)this.words[this.length++]=0;for(var h=0;h<r.length;h++)this.words[h]=this.words[h]|r.words[h];return this.strip()},s.prototype.ior=function(r){return y((this.negative|r.negative)===0),this.iuor(r)},s.prototype.or=function(r){return this.length>r.length?this.clone().ior(r):r.clone().ior(this)},s.prototype.uor=function(r){return this.length>r.length?this.clone().iuor(r):r.clone().iuor(this)},s.prototype.iuand=function(r){var h;this.length>r.length?h=r:h=this;for(var o=0;o<h.length;o++)this.words[o]=this.words[o]&r.words[o];return this.length=h.length,this.strip()},s.prototype.iand=function(r){return y((this.negative|r.negative)===0),this.iuand(r)},s.prototype.and=function(r){return this.length>r.length?this.clone().iand(r):r.clone().iand(this)},s.prototype.uand=function(r){return this.length>r.length?this.clone().iuand(r):r.clone().iuand(this)},s.prototype.iuxor=function(r){var h,o;this.length>r.length?(h=this,o=r):(h=r,o=this);for(var c=0;c<o.length;c++)this.words[c]=h.words[c]^o.words[c];if(this!==h)for(;c<h.length;c++)this.words[c]=h.words[c];return this.length=h.length,this.strip()},s.prototype.ixor=function(r){return y((this.negative|r.negative)===0),this.iuxor(r)},s.prototype.xor=function(r){return this.length>r.length?this.clone().ixor(r):r.clone().ixor(this)},s.prototype.uxor=function(r){return this.length>r.length?this.clone().iuxor(r):r.clone().iuxor(this)},s.prototype.inotn=function(r){y(typeof r=="number"&&r>=0);var h=Math.ceil(r/26)|0,o=r%26;this._expand(h),o>0&&h--;for(var c=0;c<h;c++)this.words[c]=~this.words[c]&67108863;return o>0&&(this.words[c]=~this.words[c]&67108863>>26-o),this.strip()},s.prototype.notn=function(r){return this.clone().inotn(r)},s.prototype.setn=function(r,h){y(typeof r=="number"&&r>=0);var o=r/26|0,c=r%26;return this._expand(o+1),h?this.words[o]=this.words[o]|1<<c:this.words[o]=this.words[o]&~(1<<c),this.strip()},s.prototype.iadd=function(r){var h;if(this.negative!==0&&r.negative===0)return this.negative=0,h=this.isub(r),this.negative^=1,this._normSign();if(this.negative===0&&r.negative!==0)return r.negative=0,h=this.isub(r),r.negative=1,h._normSign();var o,c;this.length>r.length?(o=this,c=r):(o=r,c=this);for(var l=0,g=0;g<c.length;g++)h=(o.words[g]|0)+(c.words[g]|0)+l,this.words[g]=h&67108863,l=h>>>26;for(;l!==0&&g<o.length;g++)h=(o.words[g]|0)+l,this.words[g]=h&67108863,l=h>>>26;if(this.length=o.length,l!==0)this.words[this.length]=l,this.length++;else if(o!==this)for(;g<o.length;g++)this.words[g]=o.words[g];return this},s.prototype.add=function(r){var h;return r.negative!==0&&this.negative===0?(r.negative=0,h=this.sub(r),r.negative^=1,h):r.negative===0&&this.negative!==0?(this.negative=0,h=r.sub(this),this.negative=1,h):this.length>r.length?this.clone().iadd(r):r.clone().iadd(this)},s.prototype.isub=function(r){if(r.negative!==0){r.negative=0;var h=this.iadd(r);return r.negative=1,h._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(r),this.negative=1,this._normSign();var o=this.cmp(r);if(o===0)return this.negative=0,this.length=1,this.words[0]=0,this;var c,l;o>0?(c=this,l=r):(c=r,l=this);for(var g=0,P=0;P<l.length;P++)h=(c.words[P]|0)-(l.words[P]|0)+g,g=h>>26,this.words[P]=h&67108863;for(;g!==0&&P<c.length;P++)h=(c.words[P]|0)+g,g=h>>26,this.words[P]=h&67108863;if(g===0&&P<c.length&&c!==this)for(;P<c.length;P++)this.words[P]=c.words[P];return this.length=Math.max(this.length,P),c!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(r){return this.clone().isub(r)};function k(x,r,h){h.negative=r.negative^x.negative;var o=x.length+r.length|0;h.length=o,o=o-1|0;var c=x.words[0]|0,l=r.words[0]|0,g=c*l,P=g&67108863,p=g/67108864|0;h.words[0]=P;for(var a=1;a<o;a++){for(var w=p>>>26,j=p&67108863,F=Math.min(a,r.length-1),G=Math.max(0,a-x.length+1);G<=F;G++){var X=a-G|0;c=x.words[X]|0,l=r.words[G]|0,g=c*l+j,w+=g/67108864|0,j=g&67108863}h.words[a]=j|0,p=w|0}return p!==0?h.words[a]=p|0:h.length--,h.strip()}var T=function(r,h,o){var c=r.words,l=h.words,g=o.words,P=0,p,a,w,j=c[0]|0,F=j&8191,G=j>>>13,X=c[1]|0,Z=X&8191,$=X>>>13,fe=c[2]|0,Q=fe&8191,ee=fe>>>13,se=c[3]|0,te=se&8191,re=se>>>13,le=c[4]|0,he=le&8191,oe=le>>>13,lt=c[5]|0,de=lt&8191,ce=lt>>>13,Bt=c[6]|0,be=Bt&8191,ve=Bt>>>13,Kt=c[7]|0,pe=Kt&8191,me=Kt>>>13,mt=c[8]|0,ue=mt&8191,ye=mt>>>13,Rt=c[9]|0,Me=Rt&8191,we=Rt>>>13,kr=l[0]|0,ge=kr&8191,Ae=kr>>>13,ir=l[1]|0,Ee=ir&8191,Pe=ir>>>13,Ir=l[2]|0,ke=Ir&8191,Ie=Ir>>>13,Lr=l[3]|0,Le=Lr&8191,Te=Lr>>>13,Tr=l[4]|0,ze=Tr&8191,Be=Tr>>>13,zr=l[5]|0,Ke=zr&8191,Re=zr>>>13,Br=l[6]|0,Ue=Br&8191,Oe=Br>>>13,Kr=l[7]|0,He=Kr&8191,De=Kr>>>13,Rr=l[8]|0,Ne=Rr&8191,Ce=Rr>>>13,St=l[9]|0,_e=St&8191,qe=St>>>13;o.negative=r.negative^h.negative,o.length=19,p=Math.imul(F,ge),a=Math.imul(F,Ae),a=a+Math.imul(G,ge)|0,w=Math.imul(G,Ae);var fr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(fr>>>26)|0,fr&=67108863,p=Math.imul(Z,ge),a=Math.imul(Z,Ae),a=a+Math.imul($,ge)|0,w=Math.imul($,Ae),p=p+Math.imul(F,Ee)|0,a=a+Math.imul(F,Pe)|0,a=a+Math.imul(G,Ee)|0,w=w+Math.imul(G,Pe)|0;var ar=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(ar>>>26)|0,ar&=67108863,p=Math.imul(Q,ge),a=Math.imul(Q,Ae),a=a+Math.imul(ee,ge)|0,w=Math.imul(ee,Ae),p=p+Math.imul(Z,Ee)|0,a=a+Math.imul(Z,Pe)|0,a=a+Math.imul($,Ee)|0,w=w+Math.imul($,Pe)|0,p=p+Math.imul(F,ke)|0,a=a+Math.imul(F,Ie)|0,a=a+Math.imul(G,ke)|0,w=w+Math.imul(G,Ie)|0;var nr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(nr>>>26)|0,nr&=67108863,p=Math.imul(te,ge),a=Math.imul(te,Ae),a=a+Math.imul(re,ge)|0,w=Math.imul(re,Ae),p=p+Math.imul(Q,Ee)|0,a=a+Math.imul(Q,Pe)|0,a=a+Math.imul(ee,Ee)|0,w=w+Math.imul(ee,Pe)|0,p=p+Math.imul(Z,ke)|0,a=a+Math.imul(Z,Ie)|0,a=a+Math.imul($,ke)|0,w=w+Math.imul($,Ie)|0,p=p+Math.imul(F,Le)|0,a=a+Math.imul(F,Te)|0,a=a+Math.imul(G,Le)|0,w=w+Math.imul(G,Te)|0;var sr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(sr>>>26)|0,sr&=67108863,p=Math.imul(he,ge),a=Math.imul(he,Ae),a=a+Math.imul(oe,ge)|0,w=Math.imul(oe,Ae),p=p+Math.imul(te,Ee)|0,a=a+Math.imul(te,Pe)|0,a=a+Math.imul(re,Ee)|0,w=w+Math.imul(re,Pe)|0,p=p+Math.imul(Q,ke)|0,a=a+Math.imul(Q,Ie)|0,a=a+Math.imul(ee,ke)|0,w=w+Math.imul(ee,Ie)|0,p=p+Math.imul(Z,Le)|0,a=a+Math.imul(Z,Te)|0,a=a+Math.imul($,Le)|0,w=w+Math.imul($,Te)|0,p=p+Math.imul(F,ze)|0,a=a+Math.imul(F,Be)|0,a=a+Math.imul(G,ze)|0,w=w+Math.imul(G,Be)|0;var st=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(st>>>26)|0,st&=67108863,p=Math.imul(de,ge),a=Math.imul(de,Ae),a=a+Math.imul(ce,ge)|0,w=Math.imul(ce,Ae),p=p+Math.imul(he,Ee)|0,a=a+Math.imul(he,Pe)|0,a=a+Math.imul(oe,Ee)|0,w=w+Math.imul(oe,Pe)|0,p=p+Math.imul(te,ke)|0,a=a+Math.imul(te,Ie)|0,a=a+Math.imul(re,ke)|0,w=w+Math.imul(re,Ie)|0,p=p+Math.imul(Q,Le)|0,a=a+Math.imul(Q,Te)|0,a=a+Math.imul(ee,Le)|0,w=w+Math.imul(ee,Te)|0,p=p+Math.imul(Z,ze)|0,a=a+Math.imul(Z,Be)|0,a=a+Math.imul($,ze)|0,w=w+Math.imul($,Be)|0,p=p+Math.imul(F,Ke)|0,a=a+Math.imul(F,Re)|0,a=a+Math.imul(G,Ke)|0,w=w+Math.imul(G,Re)|0;var hr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(hr>>>26)|0,hr&=67108863,p=Math.imul(be,ge),a=Math.imul(be,Ae),a=a+Math.imul(ve,ge)|0,w=Math.imul(ve,Ae),p=p+Math.imul(de,Ee)|0,a=a+Math.imul(de,Pe)|0,a=a+Math.imul(ce,Ee)|0,w=w+Math.imul(ce,Pe)|0,p=p+Math.imul(he,ke)|0,a=a+Math.imul(he,Ie)|0,a=a+Math.imul(oe,ke)|0,w=w+Math.imul(oe,Ie)|0,p=p+Math.imul(te,Le)|0,a=a+Math.imul(te,Te)|0,a=a+Math.imul(re,Le)|0,w=w+Math.imul(re,Te)|0,p=p+Math.imul(Q,ze)|0,a=a+Math.imul(Q,Be)|0,a=a+Math.imul(ee,ze)|0,w=w+Math.imul(ee,Be)|0,p=p+Math.imul(Z,Ke)|0,a=a+Math.imul(Z,Re)|0,a=a+Math.imul($,Ke)|0,w=w+Math.imul($,Re)|0,p=p+Math.imul(F,Ue)|0,a=a+Math.imul(F,Oe)|0,a=a+Math.imul(G,Ue)|0,w=w+Math.imul(G,Oe)|0;var or=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(or>>>26)|0,or&=67108863,p=Math.imul(pe,ge),a=Math.imul(pe,Ae),a=a+Math.imul(me,ge)|0,w=Math.imul(me,Ae),p=p+Math.imul(be,Ee)|0,a=a+Math.imul(be,Pe)|0,a=a+Math.imul(ve,Ee)|0,w=w+Math.imul(ve,Pe)|0,p=p+Math.imul(de,ke)|0,a=a+Math.imul(de,Ie)|0,a=a+Math.imul(ce,ke)|0,w=w+Math.imul(ce,Ie)|0,p=p+Math.imul(he,Le)|0,a=a+Math.imul(he,Te)|0,a=a+Math.imul(oe,Le)|0,w=w+Math.imul(oe,Te)|0,p=p+Math.imul(te,ze)|0,a=a+Math.imul(te,Be)|0,a=a+Math.imul(re,ze)|0,w=w+Math.imul(re,Be)|0,p=p+Math.imul(Q,Ke)|0,a=a+Math.imul(Q,Re)|0,a=a+Math.imul(ee,Ke)|0,w=w+Math.imul(ee,Re)|0,p=p+Math.imul(Z,Ue)|0,a=a+Math.imul(Z,Oe)|0,a=a+Math.imul($,Ue)|0,w=w+Math.imul($,Oe)|0,p=p+Math.imul(F,He)|0,a=a+Math.imul(F,De)|0,a=a+Math.imul(G,He)|0,w=w+Math.imul(G,De)|0;var dr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(dr>>>26)|0,dr&=67108863,p=Math.imul(ue,ge),a=Math.imul(ue,Ae),a=a+Math.imul(ye,ge)|0,w=Math.imul(ye,Ae),p=p+Math.imul(pe,Ee)|0,a=a+Math.imul(pe,Pe)|0,a=a+Math.imul(me,Ee)|0,w=w+Math.imul(me,Pe)|0,p=p+Math.imul(be,ke)|0,a=a+Math.imul(be,Ie)|0,a=a+Math.imul(ve,ke)|0,w=w+Math.imul(ve,Ie)|0,p=p+Math.imul(de,Le)|0,a=a+Math.imul(de,Te)|0,a=a+Math.imul(ce,Le)|0,w=w+Math.imul(ce,Te)|0,p=p+Math.imul(he,ze)|0,a=a+Math.imul(he,Be)|0,a=a+Math.imul(oe,ze)|0,w=w+Math.imul(oe,Be)|0,p=p+Math.imul(te,Ke)|0,a=a+Math.imul(te,Re)|0,a=a+Math.imul(re,Ke)|0,w=w+Math.imul(re,Re)|0,p=p+Math.imul(Q,Ue)|0,a=a+Math.imul(Q,Oe)|0,a=a+Math.imul(ee,Ue)|0,w=w+Math.imul(ee,Oe)|0,p=p+Math.imul(Z,He)|0,a=a+Math.imul(Z,De)|0,a=a+Math.imul($,He)|0,w=w+Math.imul($,De)|0,p=p+Math.imul(F,Ne)|0,a=a+Math.imul(F,Ce)|0,a=a+Math.imul(G,Ne)|0,w=w+Math.imul(G,Ce)|0;var cr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(cr>>>26)|0,cr&=67108863,p=Math.imul(Me,ge),a=Math.imul(Me,Ae),a=a+Math.imul(we,ge)|0,w=Math.imul(we,Ae),p=p+Math.imul(ue,Ee)|0,a=a+Math.imul(ue,Pe)|0,a=a+Math.imul(ye,Ee)|0,w=w+Math.imul(ye,Pe)|0,p=p+Math.imul(pe,ke)|0,a=a+Math.imul(pe,Ie)|0,a=a+Math.imul(me,ke)|0,w=w+Math.imul(me,Ie)|0,p=p+Math.imul(be,Le)|0,a=a+Math.imul(be,Te)|0,a=a+Math.imul(ve,Le)|0,w=w+Math.imul(ve,Te)|0,p=p+Math.imul(de,ze)|0,a=a+Math.imul(de,Be)|0,a=a+Math.imul(ce,ze)|0,w=w+Math.imul(ce,Be)|0,p=p+Math.imul(he,Ke)|0,a=a+Math.imul(he,Re)|0,a=a+Math.imul(oe,Ke)|0,w=w+Math.imul(oe,Re)|0,p=p+Math.imul(te,Ue)|0,a=a+Math.imul(te,Oe)|0,a=a+Math.imul(re,Ue)|0,w=w+Math.imul(re,Oe)|0,p=p+Math.imul(Q,He)|0,a=a+Math.imul(Q,De)|0,a=a+Math.imul(ee,He)|0,w=w+Math.imul(ee,De)|0,p=p+Math.imul(Z,Ne)|0,a=a+Math.imul(Z,Ce)|0,a=a+Math.imul($,Ne)|0,w=w+Math.imul($,Ce)|0,p=p+Math.imul(F,_e)|0,a=a+Math.imul(F,qe)|0,a=a+Math.imul(G,_e)|0,w=w+Math.imul(G,qe)|0;var ur=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(ur>>>26)|0,ur&=67108863,p=Math.imul(Me,Ee),a=Math.imul(Me,Pe),a=a+Math.imul(we,Ee)|0,w=Math.imul(we,Pe),p=p+Math.imul(ue,ke)|0,a=a+Math.imul(ue,Ie)|0,a=a+Math.imul(ye,ke)|0,w=w+Math.imul(ye,Ie)|0,p=p+Math.imul(pe,Le)|0,a=a+Math.imul(pe,Te)|0,a=a+Math.imul(me,Le)|0,w=w+Math.imul(me,Te)|0,p=p+Math.imul(be,ze)|0,a=a+Math.imul(be,Be)|0,a=a+Math.imul(ve,ze)|0,w=w+Math.imul(ve,Be)|0,p=p+Math.imul(de,Ke)|0,a=a+Math.imul(de,Re)|0,a=a+Math.imul(ce,Ke)|0,w=w+Math.imul(ce,Re)|0,p=p+Math.imul(he,Ue)|0,a=a+Math.imul(he,Oe)|0,a=a+Math.imul(oe,Ue)|0,w=w+Math.imul(oe,Oe)|0,p=p+Math.imul(te,He)|0,a=a+Math.imul(te,De)|0,a=a+Math.imul(re,He)|0,w=w+Math.imul(re,De)|0,p=p+Math.imul(Q,Ne)|0,a=a+Math.imul(Q,Ce)|0,a=a+Math.imul(ee,Ne)|0,w=w+Math.imul(ee,Ce)|0,p=p+Math.imul(Z,_e)|0,a=a+Math.imul(Z,qe)|0,a=a+Math.imul($,_e)|0,w=w+Math.imul($,qe)|0;var lr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(lr>>>26)|0,lr&=67108863,p=Math.imul(Me,ke),a=Math.imul(Me,Ie),a=a+Math.imul(we,ke)|0,w=Math.imul(we,Ie),p=p+Math.imul(ue,Le)|0,a=a+Math.imul(ue,Te)|0,a=a+Math.imul(ye,Le)|0,w=w+Math.imul(ye,Te)|0,p=p+Math.imul(pe,ze)|0,a=a+Math.imul(pe,Be)|0,a=a+Math.imul(me,ze)|0,w=w+Math.imul(me,Be)|0,p=p+Math.imul(be,Ke)|0,a=a+Math.imul(be,Re)|0,a=a+Math.imul(ve,Ke)|0,w=w+Math.imul(ve,Re)|0,p=p+Math.imul(de,Ue)|0,a=a+Math.imul(de,Oe)|0,a=a+Math.imul(ce,Ue)|0,w=w+Math.imul(ce,Oe)|0,p=p+Math.imul(he,He)|0,a=a+Math.imul(he,De)|0,a=a+Math.imul(oe,He)|0,w=w+Math.imul(oe,De)|0,p=p+Math.imul(te,Ne)|0,a=a+Math.imul(te,Ce)|0,a=a+Math.imul(re,Ne)|0,w=w+Math.imul(re,Ce)|0,p=p+Math.imul(Q,_e)|0,a=a+Math.imul(Q,qe)|0,a=a+Math.imul(ee,_e)|0,w=w+Math.imul(ee,qe)|0;var br=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(br>>>26)|0,br&=67108863,p=Math.imul(Me,Le),a=Math.imul(Me,Te),a=a+Math.imul(we,Le)|0,w=Math.imul(we,Te),p=p+Math.imul(ue,ze)|0,a=a+Math.imul(ue,Be)|0,a=a+Math.imul(ye,ze)|0,w=w+Math.imul(ye,Be)|0,p=p+Math.imul(pe,Ke)|0,a=a+Math.imul(pe,Re)|0,a=a+Math.imul(me,Ke)|0,w=w+Math.imul(me,Re)|0,p=p+Math.imul(be,Ue)|0,a=a+Math.imul(be,Oe)|0,a=a+Math.imul(ve,Ue)|0,w=w+Math.imul(ve,Oe)|0,p=p+Math.imul(de,He)|0,a=a+Math.imul(de,De)|0,a=a+Math.imul(ce,He)|0,w=w+Math.imul(ce,De)|0,p=p+Math.imul(he,Ne)|0,a=a+Math.imul(he,Ce)|0,a=a+Math.imul(oe,Ne)|0,w=w+Math.imul(oe,Ce)|0,p=p+Math.imul(te,_e)|0,a=a+Math.imul(te,qe)|0,a=a+Math.imul(re,_e)|0,w=w+Math.imul(re,qe)|0;var vr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(vr>>>26)|0,vr&=67108863,p=Math.imul(Me,ze),a=Math.imul(Me,Be),a=a+Math.imul(we,ze)|0,w=Math.imul(we,Be),p=p+Math.imul(ue,Ke)|0,a=a+Math.imul(ue,Re)|0,a=a+Math.imul(ye,Ke)|0,w=w+Math.imul(ye,Re)|0,p=p+Math.imul(pe,Ue)|0,a=a+Math.imul(pe,Oe)|0,a=a+Math.imul(me,Ue)|0,w=w+Math.imul(me,Oe)|0,p=p+Math.imul(be,He)|0,a=a+Math.imul(be,De)|0,a=a+Math.imul(ve,He)|0,w=w+Math.imul(ve,De)|0,p=p+Math.imul(de,Ne)|0,a=a+Math.imul(de,Ce)|0,a=a+Math.imul(ce,Ne)|0,w=w+Math.imul(ce,Ce)|0,p=p+Math.imul(he,_e)|0,a=a+Math.imul(he,qe)|0,a=a+Math.imul(oe,_e)|0,w=w+Math.imul(oe,qe)|0;var pr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(pr>>>26)|0,pr&=67108863,p=Math.imul(Me,Ke),a=Math.imul(Me,Re),a=a+Math.imul(we,Ke)|0,w=Math.imul(we,Re),p=p+Math.imul(ue,Ue)|0,a=a+Math.imul(ue,Oe)|0,a=a+Math.imul(ye,Ue)|0,w=w+Math.imul(ye,Oe)|0,p=p+Math.imul(pe,He)|0,a=a+Math.imul(pe,De)|0,a=a+Math.imul(me,He)|0,w=w+Math.imul(me,De)|0,p=p+Math.imul(be,Ne)|0,a=a+Math.imul(be,Ce)|0,a=a+Math.imul(ve,Ne)|0,w=w+Math.imul(ve,Ce)|0,p=p+Math.imul(de,_e)|0,a=a+Math.imul(de,qe)|0,a=a+Math.imul(ce,_e)|0,w=w+Math.imul(ce,qe)|0;var Ve=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,p=Math.imul(Me,Ue),a=Math.imul(Me,Oe),a=a+Math.imul(we,Ue)|0,w=Math.imul(we,Oe),p=p+Math.imul(ue,He)|0,a=a+Math.imul(ue,De)|0,a=a+Math.imul(ye,He)|0,w=w+Math.imul(ye,De)|0,p=p+Math.imul(pe,Ne)|0,a=a+Math.imul(pe,Ce)|0,a=a+Math.imul(me,Ne)|0,w=w+Math.imul(me,Ce)|0,p=p+Math.imul(be,_e)|0,a=a+Math.imul(be,qe)|0,a=a+Math.imul(ve,_e)|0,w=w+Math.imul(ve,qe)|0;var mr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(mr>>>26)|0,mr&=67108863,p=Math.imul(Me,He),a=Math.imul(Me,De),a=a+Math.imul(we,He)|0,w=Math.imul(we,De),p=p+Math.imul(ue,Ne)|0,a=a+Math.imul(ue,Ce)|0,a=a+Math.imul(ye,Ne)|0,w=w+Math.imul(ye,Ce)|0,p=p+Math.imul(pe,_e)|0,a=a+Math.imul(pe,qe)|0,a=a+Math.imul(me,_e)|0,w=w+Math.imul(me,qe)|0;var yr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(yr>>>26)|0,yr&=67108863,p=Math.imul(Me,Ne),a=Math.imul(Me,Ce),a=a+Math.imul(we,Ne)|0,w=Math.imul(we,Ce),p=p+Math.imul(ue,_e)|0,a=a+Math.imul(ue,qe)|0,a=a+Math.imul(ye,_e)|0,w=w+Math.imul(ye,qe)|0;var xr=(P+p|0)+((a&8191)<<13)|0;P=(w+(a>>>13)|0)+(xr>>>26)|0,xr&=67108863,p=Math.imul(Me,_e),a=Math.imul(Me,qe),a=a+Math.imul(we,_e)|0,w=Math.imul(we,qe);var Mt=(P+p|0)+((a&8191)<<13)|0;return P=(w+(a>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,g[0]=fr,g[1]=ar,g[2]=nr,g[3]=sr,g[4]=st,g[5]=hr,g[6]=or,g[7]=dr,g[8]=cr,g[9]=ur,g[10]=lr,g[11]=br,g[12]=vr,g[13]=pr,g[14]=Ve,g[15]=mr,g[16]=yr,g[17]=xr,g[18]=Mt,P!==0&&(g[19]=P,o.length++),o};Math.imul||(T=k);function L(x,r,h){h.negative=r.negative^x.negative,h.length=x.length+r.length;for(var o=0,c=0,l=0;l<h.length-1;l++){var g=c;c=0;for(var P=o&67108863,p=Math.min(l,r.length-1),a=Math.max(0,l-x.length+1);a<=p;a++){var w=l-a,j=x.words[w]|0,F=r.words[a]|0,G=j*F,X=G&67108863;g=g+(G/67108864|0)|0,X=X+P|0,P=X&67108863,g=g+(X>>>26)|0,c+=g>>>26,g&=67108863}h.words[l]=P,o=g,g=c}return o!==0?h.words[l]=o:h.length--,h.strip()}function z(x,r,h){var o=new R;return o.mulp(x,r,h)}s.prototype.mulTo=function(r,h){var o,c=this.length+r.length;return this.length===10&&r.length===10?o=T(this,r,h):c<63?o=k(this,r,h):c<1024?o=L(this,r,h):o=z(this,r,h),o};function R(x,r){this.x=x,this.y=r}R.prototype.makeRBT=function(r){for(var h=new Array(r),o=s.prototype._countBits(r)-1,c=0;c<r;c++)h[c]=this.revBin(c,o,r);return h},R.prototype.revBin=function(r,h,o){if(r===0||r===o-1)return r;for(var c=0,l=0;l<h;l++)c|=(r&1)<<h-l-1,r>>=1;return c},R.prototype.permute=function(r,h,o,c,l,g){for(var P=0;P<g;P++)c[P]=h[r[P]],l[P]=o[r[P]]},R.prototype.transform=function(r,h,o,c,l,g){this.permute(g,r,h,o,c,l);for(var P=1;P<l;P<<=1)for(var p=P<<1,a=Math.cos(2*Math.PI/p),w=Math.sin(2*Math.PI/p),j=0;j<l;j+=p)for(var F=a,G=w,X=0;X<P;X++){var Z=o[j+X],$=c[j+X],fe=o[j+X+P],Q=c[j+X+P],ee=F*fe-G*Q;Q=F*Q+G*fe,fe=ee,o[j+X]=Z+fe,c[j+X]=$+Q,o[j+X+P]=Z-fe,c[j+X+P]=$-Q,X!==p&&(ee=a*F-w*G,G=a*G+w*F,F=ee)}},R.prototype.guessLen13b=function(r,h){var o=Math.max(h,r)|1,c=o&1,l=0;for(o=o/2|0;o;o=o>>>1)l++;return 1<<l+1+c},R.prototype.conjugate=function(r,h,o){if(!(o<=1))for(var c=0;c<o/2;c++){var l=r[c];r[c]=r[o-c-1],r[o-c-1]=l,l=h[c],h[c]=-h[o-c-1],h[o-c-1]=-l}},R.prototype.normalize13b=function(r,h){for(var o=0,c=0;c<h/2;c++){var l=Math.round(r[2*c+1]/h)*8192+Math.round(r[2*c]/h)+o;r[c]=l&67108863,l<67108864?o=0:o=l/67108864|0}return r},R.prototype.convert13b=function(r,h,o,c){for(var l=0,g=0;g<h;g++)l=l+(r[g]|0),o[2*g]=l&8191,l=l>>>13,o[2*g+1]=l&8191,l=l>>>13;for(g=2*h;g<c;++g)o[g]=0;y(l===0),y((l&-8192)===0)},R.prototype.stub=function(r){for(var h=new Array(r),o=0;o<r;o++)h[o]=0;return h},R.prototype.mulp=function(r,h,o){var c=2*this.guessLen13b(r.length,h.length),l=this.makeRBT(c),g=this.stub(c),P=new Array(c),p=new Array(c),a=new Array(c),w=new Array(c),j=new Array(c),F=new Array(c),G=o.words;G.length=c,this.convert13b(r.words,r.length,P,c),this.convert13b(h.words,h.length,w,c),this.transform(P,g,p,a,c,l),this.transform(w,g,j,F,c,l);for(var X=0;X<c;X++){var Z=p[X]*j[X]-a[X]*F[X];a[X]=p[X]*F[X]+a[X]*j[X],p[X]=Z}return this.conjugate(p,a,c),this.transform(p,a,G,g,c,l),this.conjugate(G,g,c),this.normalize13b(G,c),o.negative=r.negative^h.negative,o.length=r.length+h.length,o.strip()},s.prototype.mul=function(r){var h=new s(null);return h.words=new Array(this.length+r.length),this.mulTo(r,h)},s.prototype.mulf=function(r){var h=new s(null);return h.words=new Array(this.length+r.length),z(this,r,h)},s.prototype.imul=function(r){return this.clone().mulTo(r,this)},s.prototype.imuln=function(r){y(typeof r=="number"),y(r<67108864);for(var h=0,o=0;o<this.length;o++){var c=(this.words[o]|0)*r,l=(c&67108863)+(h&67108863);h>>=26,h+=c/67108864|0,h+=l>>>26,this.words[o]=l&67108863}return h!==0&&(this.words[o]=h,this.length++),this},s.prototype.muln=function(r){return this.clone().imuln(r)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(r){var h=M(r);if(h.length===0)return new s(1);for(var o=this,c=0;c<h.length&&h[c]===0;c++,o=o.sqr());if(++c<h.length)for(var l=o.sqr();c<h.length;c++,l=l.sqr())h[c]!==0&&(o=o.mul(l));return o},s.prototype.iushln=function(r){y(typeof r=="number"&&r>=0);var h=r%26,o=(r-h)/26,c=67108863>>>26-h<<26-h,l;if(h!==0){var g=0;for(l=0;l<this.length;l++){var P=this.words[l]&c,p=(this.words[l]|0)-P<<h;this.words[l]=p|g,g=P>>>26-h}g&&(this.words[l]=g,this.length++)}if(o!==0){for(l=this.length-1;l>=0;l--)this.words[l+o]=this.words[l];for(l=0;l<o;l++)this.words[l]=0;this.length+=o}return this.strip()},s.prototype.ishln=function(r){return y(this.negative===0),this.iushln(r)},s.prototype.iushrn=function(r,h,o){y(typeof r=="number"&&r>=0);var c;h?c=(h-h%26)/26:c=0;var l=r%26,g=Math.min((r-l)/26,this.length),P=67108863^67108863>>>l<<l,p=o;if(c-=g,c=Math.max(0,c),p){for(var a=0;a<g;a++)p.words[a]=this.words[a];p.length=g}if(g!==0)if(this.length>g)for(this.length-=g,a=0;a<this.length;a++)this.words[a]=this.words[a+g];else this.words[0]=0,this.length=1;var w=0;for(a=this.length-1;a>=0&&(w!==0||a>=c);a--){var j=this.words[a]|0;this.words[a]=w<<26-l|j>>>l,w=j&P}return p&&w!==0&&(p.words[p.length++]=w),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(r,h,o){return y(this.negative===0),this.iushrn(r,h,o)},s.prototype.shln=function(r){return this.clone().ishln(r)},s.prototype.ushln=function(r){return this.clone().iushln(r)},s.prototype.shrn=function(r){return this.clone().ishrn(r)},s.prototype.ushrn=function(r){return this.clone().iushrn(r)},s.prototype.testn=function(r){y(typeof r=="number"&&r>=0);var h=r%26,o=(r-h)/26,c=1<<h;if(this.length<=o)return!1;var l=this.words[o];return!!(l&c)},s.prototype.imaskn=function(r){y(typeof r=="number"&&r>=0);var h=r%26,o=(r-h)/26;if(y(this.negative===0,"imaskn works only with positive numbers"),this.length<=o)return this;if(h!==0&&o++,this.length=Math.min(o,this.length),h!==0){var c=67108863^67108863>>>h<<h;this.words[this.length-1]&=c}return this.strip()},s.prototype.maskn=function(r){return this.clone().imaskn(r)},s.prototype.iaddn=function(r){return y(typeof r=="number"),y(r<67108864),r<0?this.isubn(-r):this.negative!==0?this.length===1&&(this.words[0]|0)<r?(this.words[0]=r-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(r),this.negative=1,this):this._iaddn(r)},s.prototype._iaddn=function(r){this.words[0]+=r;for(var h=0;h<this.length&&this.words[h]>=67108864;h++)this.words[h]-=67108864,h===this.length-1?this.words[h+1]=1:this.words[h+1]++;return this.length=Math.max(this.length,h+1),this},s.prototype.isubn=function(r){if(y(typeof r=="number"),y(r<67108864),r<0)return this.iaddn(-r);if(this.negative!==0)return this.negative=0,this.iaddn(r),this.negative=1,this;if(this.words[0]-=r,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var h=0;h<this.length&&this.words[h]<0;h++)this.words[h]+=67108864,this.words[h+1]-=1;return this.strip()},s.prototype.addn=function(r){return this.clone().iaddn(r)},s.prototype.subn=function(r){return this.clone().isubn(r)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(r,h,o){var c=r.length+o,l;this._expand(c);var g,P=0;for(l=0;l<r.length;l++){g=(this.words[l+o]|0)+P;var p=(r.words[l]|0)*h;g-=p&67108863,P=(g>>26)-(p/67108864|0),this.words[l+o]=g&67108863}for(;l<this.length-o;l++)g=(this.words[l+o]|0)+P,P=g>>26,this.words[l+o]=g&67108863;if(P===0)return this.strip();for(y(P===-1),P=0,l=0;l<this.length;l++)g=-(this.words[l]|0)+P,P=g>>26,this.words[l]=g&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(r,h){var o=this.length-r.length,c=this.clone(),l=r,g=l.words[l.length-1]|0,P=this._countBits(g);o=26-P,o!==0&&(l=l.ushln(o),c.iushln(o),g=l.words[l.length-1]|0);var p=c.length-l.length,a;if(h!=="mod"){a=new s(null),a.length=p+1,a.words=new Array(a.length);for(var w=0;w<a.length;w++)a.words[w]=0}var j=c.clone()._ishlnsubmul(l,1,p);j.negative===0&&(c=j,a&&(a.words[p]=1));for(var F=p-1;F>=0;F--){var G=(c.words[l.length+F]|0)*67108864+(c.words[l.length+F-1]|0);for(G=Math.min(G/g|0,67108863),c._ishlnsubmul(l,G,F);c.negative!==0;)G--,c.negative=0,c._ishlnsubmul(l,1,F),c.isZero()||(c.negative^=1);a&&(a.words[F]=G)}return a&&a.strip(),c.strip(),h!=="div"&&o!==0&&c.iushrn(o),{div:a||null,mod:c}},s.prototype.divmod=function(r,h,o){if(y(!r.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var c,l,g;return this.negative!==0&&r.negative===0?(g=this.neg().divmod(r,h),h!=="mod"&&(c=g.div.neg()),h!=="div"&&(l=g.mod.neg(),o&&l.negative!==0&&l.iadd(r)),{div:c,mod:l}):this.negative===0&&r.negative!==0?(g=this.divmod(r.neg(),h),h!=="mod"&&(c=g.div.neg()),{div:c,mod:g.mod}):this.negative&r.negative?(g=this.neg().divmod(r.neg(),h),h!=="div"&&(l=g.mod.neg(),o&&l.negative!==0&&l.isub(r)),{div:g.div,mod:l}):r.length>this.length||this.cmp(r)<0?{div:new s(0),mod:this}:r.length===1?h==="div"?{div:this.divn(r.words[0]),mod:null}:h==="mod"?{div:null,mod:new s(this.modn(r.words[0]))}:{div:this.divn(r.words[0]),mod:new s(this.modn(r.words[0]))}:this._wordDiv(r,h)},s.prototype.div=function(r){return this.divmod(r,"div",!1).div},s.prototype.mod=function(r){return this.divmod(r,"mod",!1).mod},s.prototype.umod=function(r){return this.divmod(r,"mod",!0).mod},s.prototype.divRound=function(r){var h=this.divmod(r);if(h.mod.isZero())return h.div;var o=h.div.negative!==0?h.mod.isub(r):h.mod,c=r.ushrn(1),l=r.andln(1),g=o.cmp(c);return g<0||l===1&&g===0?h.div:h.div.negative!==0?h.div.isubn(1):h.div.iaddn(1)},s.prototype.modn=function(r){y(r<=67108863);for(var h=(1<<26)%r,o=0,c=this.length-1;c>=0;c--)o=(h*o+(this.words[c]|0))%r;return o},s.prototype.idivn=function(r){y(r<=67108863);for(var h=0,o=this.length-1;o>=0;o--){var c=(this.words[o]|0)+h*67108864;this.words[o]=c/r|0,h=c%r}return this.strip()},s.prototype.divn=function(r){return this.clone().idivn(r)},s.prototype.egcd=function(r){y(r.negative===0),y(!r.isZero());var h=this,o=r.clone();h.negative!==0?h=h.umod(r):h=h.clone();for(var c=new s(1),l=new s(0),g=new s(0),P=new s(1),p=0;h.isEven()&&o.isEven();)h.iushrn(1),o.iushrn(1),++p;for(var a=o.clone(),w=h.clone();!h.isZero();){for(var j=0,F=1;!(h.words[0]&F)&&j<26;++j,F<<=1);if(j>0)for(h.iushrn(j);j-- >0;)(c.isOdd()||l.isOdd())&&(c.iadd(a),l.isub(w)),c.iushrn(1),l.iushrn(1);for(var G=0,X=1;!(o.words[0]&X)&&G<26;++G,X<<=1);if(G>0)for(o.iushrn(G);G-- >0;)(g.isOdd()||P.isOdd())&&(g.iadd(a),P.isub(w)),g.iushrn(1),P.iushrn(1);h.cmp(o)>=0?(h.isub(o),c.isub(g),l.isub(P)):(o.isub(h),g.isub(c),P.isub(l))}return{a:g,b:P,gcd:o.iushln(p)}},s.prototype._invmp=function(r){y(r.negative===0),y(!r.isZero());var h=this,o=r.clone();h.negative!==0?h=h.umod(r):h=h.clone();for(var c=new s(1),l=new s(0),g=o.clone();h.cmpn(1)>0&&o.cmpn(1)>0;){for(var P=0,p=1;!(h.words[0]&p)&&P<26;++P,p<<=1);if(P>0)for(h.iushrn(P);P-- >0;)c.isOdd()&&c.iadd(g),c.iushrn(1);for(var a=0,w=1;!(o.words[0]&w)&&a<26;++a,w<<=1);if(a>0)for(o.iushrn(a);a-- >0;)l.isOdd()&&l.iadd(g),l.iushrn(1);h.cmp(o)>=0?(h.isub(o),c.isub(l)):(o.isub(h),l.isub(c))}var j;return h.cmpn(1)===0?j=c:j=l,j.cmpn(0)<0&&j.iadd(r),j},s.prototype.gcd=function(r){if(this.isZero())return r.abs();if(r.isZero())return this.abs();var h=this.clone(),o=r.clone();h.negative=0,o.negative=0;for(var c=0;h.isEven()&&o.isEven();c++)h.iushrn(1),o.iushrn(1);do{for(;h.isEven();)h.iushrn(1);for(;o.isEven();)o.iushrn(1);var l=h.cmp(o);if(l<0){var g=h;h=o,o=g}else if(l===0||o.cmpn(1)===0)break;h.isub(o)}while(!0);return o.iushln(c)},s.prototype.invm=function(r){return this.egcd(r).a.umod(r)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(r){return this.words[0]&r},s.prototype.bincn=function(r){y(typeof r=="number");var h=r%26,o=(r-h)/26,c=1<<h;if(this.length<=o)return this._expand(o+1),this.words[o]|=c,this;for(var l=c,g=o;l!==0&&g<this.length;g++){var P=this.words[g]|0;P+=l,l=P>>>26,P&=67108863,this.words[g]=P}return l!==0&&(this.words[g]=l,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(r){var h=r<0;if(this.negative!==0&&!h)return-1;if(this.negative===0&&h)return 1;this.strip();var o;if(this.length>1)o=1;else{h&&(r=-r),y(r<=67108863,"Number is too big");var c=this.words[0]|0;o=c===r?0:c<r?-1:1}return this.negative!==0?-o|0:o},s.prototype.cmp=function(r){if(this.negative!==0&&r.negative===0)return-1;if(this.negative===0&&r.negative!==0)return 1;var h=this.ucmp(r);return this.negative!==0?-h|0:h},s.prototype.ucmp=function(r){if(this.length>r.length)return 1;if(this.length<r.length)return-1;for(var h=0,o=this.length-1;o>=0;o--){var c=this.words[o]|0,l=r.words[o]|0;if(c!==l){c<l?h=-1:c>l&&(h=1);break}}return h},s.prototype.gtn=function(r){return this.cmpn(r)===1},s.prototype.gt=function(r){return this.cmp(r)===1},s.prototype.gten=function(r){return this.cmpn(r)>=0},s.prototype.gte=function(r){return this.cmp(r)>=0},s.prototype.ltn=function(r){return this.cmpn(r)===-1},s.prototype.lt=function(r){return this.cmp(r)===-1},s.prototype.lten=function(r){return this.cmpn(r)<=0},s.prototype.lte=function(r){return this.cmp(r)<=0},s.prototype.eqn=function(r){return this.cmpn(r)===0},s.prototype.eq=function(r){return this.cmp(r)===0},s.red=function(r){return new q(r)},s.prototype.toRed=function(r){return y(!this.red,"Already a number in reduction context"),y(this.negative===0,"red works only with positives"),r.convertTo(this)._forceRed(r)},s.prototype.fromRed=function(){return y(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(r){return this.red=r,this},s.prototype.forceRed=function(r){return y(!this.red,"Already a number in reduction context"),this._forceRed(r)},s.prototype.redAdd=function(r){return y(this.red,"redAdd works only with red numbers"),this.red.add(this,r)},s.prototype.redIAdd=function(r){return y(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,r)},s.prototype.redSub=function(r){return y(this.red,"redSub works only with red numbers"),this.red.sub(this,r)},s.prototype.redISub=function(r){return y(this.red,"redISub works only with red numbers"),this.red.isub(this,r)},s.prototype.redShl=function(r){return y(this.red,"redShl works only with red numbers"),this.red.shl(this,r)},s.prototype.redMul=function(r){return y(this.red,"redMul works only with red numbers"),this.red._verify2(this,r),this.red.mul(this,r)},s.prototype.redIMul=function(r){return y(this.red,"redMul works only with red numbers"),this.red._verify2(this,r),this.red.imul(this,r)},s.prototype.redSqr=function(){return y(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return y(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return y(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return y(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return y(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(r){return y(this.red&&!r.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,r)};var U={k256:null,p224:null,p192:null,p25519:null};function H(x,r){this.name=x,this.p=new s(r,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}H.prototype._tmp=function(){var r=new s(null);return r.words=new Array(Math.ceil(this.n/13)),r},H.prototype.ireduce=function(r){var h=r,o;do this.split(h,this.tmp),h=this.imulK(h),h=h.iadd(this.tmp),o=h.bitLength();while(o>this.n);var c=o<this.n?-1:h.ucmp(this.p);return c===0?(h.words[0]=0,h.length=1):c>0?h.isub(this.p):h.strip!==void 0?h.strip():h._strip(),h},H.prototype.split=function(r,h){r.iushrn(this.n,0,h)},H.prototype.imulK=function(r){return r.imul(this.k)};function D(){H.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}I(D,H),D.prototype.split=function(r,h){for(var o=4194303,c=Math.min(r.length,9),l=0;l<c;l++)h.words[l]=r.words[l];if(h.length=c,r.length<=9){r.words[0]=0,r.length=1;return}var g=r.words[9];for(h.words[h.length++]=g&o,l=10;l<r.length;l++){var P=r.words[l]|0;r.words[l-10]=(P&o)<<4|g>>>22,g=P}g>>>=22,r.words[l-10]=g,g===0&&r.length>10?r.length-=10:r.length-=9},D.prototype.imulK=function(r){r.words[r.length]=0,r.words[r.length+1]=0,r.length+=2;for(var h=0,o=0;o<r.length;o++){var c=r.words[o]|0;h+=c*977,r.words[o]=h&67108863,h=c*64+(h/67108864|0)}return r.words[r.length-1]===0&&(r.length--,r.words[r.length-1]===0&&r.length--),r};function K(){H.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}I(K,H);function B(){H.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}I(B,H);function N(){H.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}I(N,H),N.prototype.imulK=function(r){for(var h=0,o=0;o<r.length;o++){var c=(r.words[o]|0)*19+h,l=c&67108863;c>>>=26,r.words[o]=l,h=c}return h!==0&&(r.words[r.length++]=h),r},s._prime=function(r){if(U[r])return U[r];var h;if(r==="k256")h=new D;else if(r==="p224")h=new K;else if(r==="p192")h=new B;else if(r==="p25519")h=new N;else throw new Error("Unknown prime "+r);return U[r]=h,h};function q(x){if(typeof x=="string"){var r=s._prime(x);this.m=r.p,this.prime=r}else y(x.gtn(1),"modulus must be greater than 1"),this.m=x,this.prime=null}q.prototype._verify1=function(r){y(r.negative===0,"red works only with positives"),y(r.red,"red works only with red numbers")},q.prototype._verify2=function(r,h){y((r.negative|h.negative)===0,"red works only with positives"),y(r.red&&r.red===h.red,"red works only with red numbers")},q.prototype.imod=function(r){return this.prime?this.prime.ireduce(r)._forceRed(this):r.umod(this.m)._forceRed(this)},q.prototype.neg=function(r){return r.isZero()?r.clone():this.m.sub(r)._forceRed(this)},q.prototype.add=function(r,h){this._verify2(r,h);var o=r.add(h);return o.cmp(this.m)>=0&&o.isub(this.m),o._forceRed(this)},q.prototype.iadd=function(r,h){this._verify2(r,h);var o=r.iadd(h);return o.cmp(this.m)>=0&&o.isub(this.m),o},q.prototype.sub=function(r,h){this._verify2(r,h);var o=r.sub(h);return o.cmpn(0)<0&&o.iadd(this.m),o._forceRed(this)},q.prototype.isub=function(r,h){this._verify2(r,h);var o=r.isub(h);return o.cmpn(0)<0&&o.iadd(this.m),o},q.prototype.shl=function(r,h){return this._verify1(r),this.imod(r.ushln(h))},q.prototype.imul=function(r,h){return this._verify2(r,h),this.imod(r.imul(h))},q.prototype.mul=function(r,h){return this._verify2(r,h),this.imod(r.mul(h))},q.prototype.isqr=function(r){return this.imul(r,r.clone())},q.prototype.sqr=function(r){return this.mul(r,r)},q.prototype.sqrt=function(r){if(r.isZero())return r.clone();var h=this.m.andln(3);if(y(h%2===1),h===3){var o=this.m.add(new s(1)).iushrn(2);return this.pow(r,o)}for(var c=this.m.subn(1),l=0;!c.isZero()&&c.andln(1)===0;)l++,c.iushrn(1);y(!c.isZero());var g=new s(1).toRed(this),P=g.redNeg(),p=this.m.subn(1).iushrn(1),a=this.m.bitLength();for(a=new s(2*a*a).toRed(this);this.pow(a,p).cmp(P)!==0;)a.redIAdd(P);for(var w=this.pow(a,c),j=this.pow(r,c.addn(1).iushrn(1)),F=this.pow(r,c),G=l;F.cmp(g)!==0;){for(var X=F,Z=0;X.cmp(g)!==0;Z++)X=X.redSqr();y(Z<G);var $=this.pow(w,new s(1).iushln(G-Z-1));j=j.redMul($),w=$.redSqr(),F=F.redMul(w),G=Z}return j},q.prototype.invm=function(r){var h=r._invmp(this.m);return h.negative!==0?(h.negative=0,this.imod(h).redNeg()):this.imod(h)},q.prototype.pow=function(r,h){if(h.isZero())return new s(1).toRed(this);if(h.cmpn(1)===0)return r.clone();var o=4,c=new Array(1<<o);c[0]=new s(1).toRed(this),c[1]=r;for(var l=2;l<c.length;l++)c[l]=this.mul(c[l-1],r);var g=c[0],P=0,p=0,a=h.bitLength()%26;for(a===0&&(a=26),l=h.length-1;l>=0;l--){for(var w=h.words[l],j=a-1;j>=0;j--){var F=w>>j&1;if(g!==c[0]&&(g=this.sqr(g)),F===0&&P===0){p=0;continue}P<<=1,P|=F,p++,!(p!==o&&(l!==0||j!==0))&&(g=this.mul(g,c[P]),p=0,P=0)}a=26}return g},q.prototype.convertTo=function(r){var h=r.umod(this.m);return h===r?h.clone():h},q.prototype.convertFrom=function(r){var h=r.clone();return h.red=null,h},s.mont=function(r){return new C(r)};function C(x){q.call(this,x),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}I(C,q),C.prototype.convertTo=function(r){return this.imod(r.ushln(this.shift))},C.prototype.convertFrom=function(r){var h=this.imod(r.mul(this.rinv));return h.red=null,h},C.prototype.imul=function(r,h){if(r.isZero()||h.isZero())return r.words[0]=0,r.length=1,r;var o=r.imul(h),c=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=o.isub(c).iushrn(this.shift),g=l;return l.cmp(this.m)>=0?g=l.isub(this.m):l.cmpn(0)<0&&(g=l.iadd(this.m)),g._forceRed(this)},C.prototype.mul=function(r,h){if(r.isZero()||h.isZero())return new s(0)._forceRed(this);var o=r.mul(h),c=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),l=o.isub(c).iushrn(this.shift),g=l;return l.cmp(this.m)>=0?g=l.isub(this.m):l.cmpn(0)<0&&(g=l.iadd(this.m)),g._forceRed(this)},C.prototype.invm=function(r){var h=this.imod(r._invmp(this.m).mul(this.r2));return h._forceRed(this)}})(typeof t>"u"||t,this)},{buffer:18}],17:[function(f,t,i){var e;t.exports=function(s){return e||(e=new n(null)),e.generate(s)};function n(I){this.rand=I}if(t.exports.Rand=n,n.prototype.generate=function(s){return this._rand(s)},n.prototype._rand=function(s){if(this.rand.getBytes)return this.rand.getBytes(s);for(var S=new Uint8Array(s),E=0;E<S.length;E++)S[E]=this.rand.getByte();return S},typeof self=="object")self.crypto&&self.crypto.getRandomValues?n.prototype._rand=function(s){var S=new Uint8Array(s);return self.crypto.getRandomValues(S),S}:self.msCrypto&&self.msCrypto.getRandomValues?n.prototype._rand=function(s){var S=new Uint8Array(s);return self.msCrypto.getRandomValues(S),S}:typeof Fr=="object"&&(n.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var y=f("crypto");if(typeof y.randomBytes!="function")throw new Error("Not supported");n.prototype._rand=function(s){return y.randomBytes(s)}}catch{}},{crypto:18}],18:[function(f,t,i){},{}],19:[function(f,t,i){var e=i;e.utils=f("./hash/utils"),e.common=f("./hash/common"),e.sha=f("./hash/sha"),e.ripemd=f("./hash/ripemd"),e.hmac=f("./hash/hmac"),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160},{"./hash/common":20,"./hash/hmac":21,"./hash/ripemd":22,"./hash/sha":23,"./hash/utils":30}],20:[function(f,t,i){"use strict";var e=f("./utils"),n=f("minimalistic-assert");function y(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i.BlockHash=y,y.prototype.update=function(s,S){if(s=e.toArray(s,S),this.pending?this.pending=this.pending.concat(s):this.pending=s,this.pendingTotal+=s.length,this.pending.length>=this._delta8){s=this.pending;var E=s.length%this._delta8;this.pending=s.slice(s.length-E,s.length),this.pending.length===0&&(this.pending=null),s=e.join32(s,0,s.length-E,this.endian);for(var _=0;_<s.length;_+=this._delta32)this._update(s,_,_+this._delta32)}return this},y.prototype.digest=function(s){return this.update(this._pad()),n(this.pending===null),this._digest(s)},y.prototype._pad=function(){var s=this.pendingTotal,S=this._delta8,E=S-(s+this.padLength)%S,_=new Array(E+this.padLength);_[0]=128;for(var v=1;v<E;v++)_[v]=0;if(s<<=3,this.endian==="big"){for(var d=8;d<this.padLength;d++)_[v++]=0;_[v++]=0,_[v++]=0,_[v++]=0,_[v++]=0,_[v++]=s>>>24&255,_[v++]=s>>>16&255,_[v++]=s>>>8&255,_[v++]=s&255}else for(_[v++]=s&255,_[v++]=s>>>8&255,_[v++]=s>>>16&255,_[v++]=s>>>24&255,_[v++]=0,_[v++]=0,_[v++]=0,_[v++]=0,d=8;d<this.padLength;d++)_[v++]=0;return _}},{"./utils":30,"minimalistic-assert":33}],21:[function(f,t,i){"use strict";var e=f("./utils"),n=f("minimalistic-assert");function y(I,s,S){if(!(this instanceof y))return new y(I,s,S);this.Hash=I,this.blockSize=I.blockSize/8,this.outSize=I.outSize/8,this.inner=null,this.outer=null,this._init(e.toArray(s,S))}t.exports=y,y.prototype._init=function(s){s.length>this.blockSize&&(s=new this.Hash().update(s).digest()),n(s.length<=this.blockSize);for(var S=s.length;S<this.blockSize;S++)s.push(0);for(S=0;S<s.length;S++)s[S]^=54;for(this.inner=new this.Hash().update(s),S=0;S<s.length;S++)s[S]^=106;this.outer=new this.Hash().update(s)},y.prototype.update=function(s,S){return this.inner.update(s,S),this},y.prototype.digest=function(s){return this.outer.update(this.inner.digest()),this.outer.digest(s)}},{"./utils":30,"minimalistic-assert":33}],22:[function(f,t,i){"use strict";var e=f("./utils"),n=f("./common"),y=e.rotl32,I=e.sum32,s=e.sum32_3,S=e.sum32_4,E=n.BlockHash;function _(){if(!(this instanceof _))return new _;E.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}e.inherits(_,E),i.ripemd160=_,_.blockSize=512,_.outSize=160,_.hmacStrength=192,_.padLength=64,_.prototype._update=function(R,U){for(var H=this.h[0],D=this.h[1],K=this.h[2],B=this.h[3],N=this.h[4],q=H,C=D,x=K,r=B,h=N,o=0;o<80;o++){var c=I(y(S(H,v(o,D,K,B),R[M[o]+U],d(o)),T[o]),N);H=N,N=B,B=y(K,10),K=D,D=c,c=I(y(S(q,v(79-o,C,x,r),R[k[o]+U],u(o)),L[o]),h),q=h,h=r,r=y(x,10),x=C,C=c}c=s(this.h[1],K,r),this.h[1]=s(this.h[2],B,h),this.h[2]=s(this.h[3],N,q),this.h[3]=s(this.h[4],H,C),this.h[4]=s(this.h[0],D,x),this.h[0]=c},_.prototype._digest=function(R){return R==="hex"?e.toHex32(this.h,"little"):e.split32(this.h,"little")};function v(z,R,U,H){return z<=15?R^U^H:z<=31?R&U|~R&H:z<=47?(R|~U)^H:z<=63?R&H|U&~H:R^(U|~H)}function d(z){return z<=15?0:z<=31?1518500249:z<=47?1859775393:z<=63?2400959708:2840853838}function u(z){return z<=15?1352829926:z<=31?1548603684:z<=47?1836072691:z<=63?2053994217:0}var M=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],k=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],T=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],L=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":20,"./utils":30}],23:[function(f,t,i){"use strict";i.sha1=f("./sha/1"),i.sha224=f("./sha/224"),i.sha256=f("./sha/256"),i.sha384=f("./sha/384"),i.sha512=f("./sha/512")},{"./sha/1":24,"./sha/224":25,"./sha/256":26,"./sha/384":27,"./sha/512":28}],24:[function(f,t,i){"use strict";var e=f("../utils"),n=f("../common"),y=f("./common"),I=e.rotl32,s=e.sum32,S=e.sum32_5,E=y.ft_1,_=n.BlockHash,v=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;_.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}e.inherits(d,_),t.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(M,k){for(var T=this.W,L=0;L<16;L++)T[L]=M[k+L];for(;L<T.length;L++)T[L]=I(T[L-3]^T[L-8]^T[L-14]^T[L-16],1);var z=this.h[0],R=this.h[1],U=this.h[2],H=this.h[3],D=this.h[4];for(L=0;L<T.length;L++){var K=~~(L/20),B=S(I(z,5),E(K,R,U,H),D,T[L],v[K]);D=H,H=U,U=I(R,30),R=z,z=B}this.h[0]=s(this.h[0],z),this.h[1]=s(this.h[1],R),this.h[2]=s(this.h[2],U),this.h[3]=s(this.h[3],H),this.h[4]=s(this.h[4],D)},d.prototype._digest=function(M){return M==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":20,"../utils":30,"./common":29}],25:[function(f,t,i){"use strict";var e=f("../utils"),n=f("./256");function y(){if(!(this instanceof y))return new y;n.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}e.inherits(y,n),t.exports=y,y.blockSize=512,y.outSize=224,y.hmacStrength=192,y.padLength=64,y.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,7),"big"):e.split32(this.h.slice(0,7),"big")}},{"../utils":30,"./256":26}],26:[function(f,t,i){"use strict";var e=f("../utils"),n=f("../common"),y=f("./common"),I=f("minimalistic-assert"),s=e.sum32,S=e.sum32_4,E=e.sum32_5,_=y.ch32,v=y.maj32,d=y.s0_256,u=y.s1_256,M=y.g0_256,k=y.g1_256,T=n.BlockHash,L=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function z(){if(!(this instanceof z))return new z;T.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=L,this.W=new Array(64)}e.inherits(z,T),t.exports=z,z.blockSize=512,z.outSize=256,z.hmacStrength=192,z.padLength=64,z.prototype._update=function(U,H){for(var D=this.W,K=0;K<16;K++)D[K]=U[H+K];for(;K<D.length;K++)D[K]=S(k(D[K-2]),D[K-7],M(D[K-15]),D[K-16]);var B=this.h[0],N=this.h[1],q=this.h[2],C=this.h[3],x=this.h[4],r=this.h[5],h=this.h[6],o=this.h[7];for(I(this.k.length===D.length),K=0;K<D.length;K++){var c=E(o,u(x),_(x,r,h),this.k[K],D[K]),l=s(d(B),v(B,N,q));o=h,h=r,r=x,x=s(C,c),C=q,q=N,N=B,B=s(c,l)}this.h[0]=s(this.h[0],B),this.h[1]=s(this.h[1],N),this.h[2]=s(this.h[2],q),this.h[3]=s(this.h[3],C),this.h[4]=s(this.h[4],x),this.h[5]=s(this.h[5],r),this.h[6]=s(this.h[6],h),this.h[7]=s(this.h[7],o)},z.prototype._digest=function(U){return U==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")}},{"../common":20,"../utils":30,"./common":29,"minimalistic-assert":33}],27:[function(f,t,i){"use strict";var e=f("../utils"),n=f("./512");function y(){if(!(this instanceof y))return new y;n.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}e.inherits(y,n),t.exports=y,y.blockSize=1024,y.outSize=384,y.hmacStrength=192,y.padLength=128,y.prototype._digest=function(s){return s==="hex"?e.toHex32(this.h.slice(0,12),"big"):e.split32(this.h.slice(0,12),"big")}},{"../utils":30,"./512":28}],28:[function(f,t,i){"use strict";var e=f("../utils"),n=f("../common"),y=f("minimalistic-assert"),I=e.rotr64_hi,s=e.rotr64_lo,S=e.shr64_hi,E=e.shr64_lo,_=e.sum64,v=e.sum64_hi,d=e.sum64_lo,u=e.sum64_4_hi,M=e.sum64_4_lo,k=e.sum64_5_hi,T=e.sum64_5_lo,L=n.BlockHash,z=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function R(){if(!(this instanceof R))return new R;L.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=z,this.W=new Array(160)}e.inherits(R,L),t.exports=R,R.blockSize=1024,R.outSize=512,R.hmacStrength=192,R.padLength=128,R.prototype._prepareBlock=function(l,g){for(var P=this.W,p=0;p<32;p++)P[p]=l[g+p];for(;p<P.length;p+=2){var a=h(P[p-4],P[p-3]),w=o(P[p-4],P[p-3]),j=P[p-14],F=P[p-13],G=x(P[p-30],P[p-29]),X=r(P[p-30],P[p-29]),Z=P[p-32],$=P[p-31];P[p]=u(a,w,j,F,G,X,Z,$),P[p+1]=M(a,w,j,F,G,X,Z,$)}},R.prototype._update=function(l,g){this._prepareBlock(l,g);var P=this.W,p=this.h[0],a=this.h[1],w=this.h[2],j=this.h[3],F=this.h[4],G=this.h[5],X=this.h[6],Z=this.h[7],$=this.h[8],fe=this.h[9],Q=this.h[10],ee=this.h[11],se=this.h[12],te=this.h[13],re=this.h[14],le=this.h[15];y(this.k.length===P.length);for(var he=0;he<P.length;he+=2){var oe=re,lt=le,de=q($,fe),ce=C($,fe),Bt=U($,fe,Q,ee,se,te),be=H($,fe,Q,ee,se,te),ve=this.k[he],Kt=this.k[he+1],pe=P[he],me=P[he+1],mt=k(oe,lt,de,ce,Bt,be,ve,Kt,pe,me),ue=T(oe,lt,de,ce,Bt,be,ve,Kt,pe,me);oe=B(p,a),lt=N(p,a),de=D(p,a,w,j,F,G),ce=K(p,a,w,j,F,G);var ye=v(oe,lt,de,ce),Rt=d(oe,lt,de,ce);re=se,le=te,se=Q,te=ee,Q=$,ee=fe,$=v(X,Z,mt,ue),fe=d(Z,Z,mt,ue),X=F,Z=G,F=w,G=j,w=p,j=a,p=v(mt,ue,ye,Rt),a=d(mt,ue,ye,Rt)}_(this.h,0,p,a),_(this.h,2,w,j),_(this.h,4,F,G),_(this.h,6,X,Z),_(this.h,8,$,fe),_(this.h,10,Q,ee),_(this.h,12,se,te),_(this.h,14,re,le)},R.prototype._digest=function(l){return l==="hex"?e.toHex32(this.h,"big"):e.split32(this.h,"big")};function U(c,l,g,P,p){var a=c&g^~c&p;return a<0&&(a+=4294967296),a}function H(c,l,g,P,p,a){var w=l&P^~l&a;return w<0&&(w+=4294967296),w}function D(c,l,g,P,p){var a=c&g^c&p^g&p;return a<0&&(a+=4294967296),a}function K(c,l,g,P,p,a){var w=l&P^l&a^P&a;return w<0&&(w+=4294967296),w}function B(c,l){var g=I(c,l,28),P=I(l,c,2),p=I(l,c,7),a=g^P^p;return a<0&&(a+=4294967296),a}function N(c,l){var g=s(c,l,28),P=s(l,c,2),p=s(l,c,7),a=g^P^p;return a<0&&(a+=4294967296),a}function q(c,l){var g=I(c,l,14),P=I(c,l,18),p=I(l,c,9),a=g^P^p;return a<0&&(a+=4294967296),a}function C(c,l){var g=s(c,l,14),P=s(c,l,18),p=s(l,c,9),a=g^P^p;return a<0&&(a+=4294967296),a}function x(c,l){var g=I(c,l,1),P=I(c,l,8),p=S(c,l,7),a=g^P^p;return a<0&&(a+=4294967296),a}function r(c,l){var g=s(c,l,1),P=s(c,l,8),p=E(c,l,7),a=g^P^p;return a<0&&(a+=4294967296),a}function h(c,l){var g=I(c,l,19),P=I(l,c,29),p=S(c,l,6),a=g^P^p;return a<0&&(a+=4294967296),a}function o(c,l){var g=s(c,l,19),P=s(l,c,29),p=E(c,l,6),a=g^P^p;return a<0&&(a+=4294967296),a}},{"../common":20,"../utils":30,"minimalistic-assert":33}],29:[function(f,t,i){"use strict";var e=f("../utils"),n=e.rotr32;function y(u,M,k,T){if(u===0)return I(M,k,T);if(u===1||u===3)return S(M,k,T);if(u===2)return s(M,k,T)}i.ft_1=y;function I(u,M,k){return u&M^~u&k}i.ch32=I;function s(u,M,k){return u&M^u&k^M&k}i.maj32=s;function S(u,M,k){return u^M^k}i.p32=S;function E(u){return n(u,2)^n(u,13)^n(u,22)}i.s0_256=E;function _(u){return n(u,6)^n(u,11)^n(u,25)}i.s1_256=_;function v(u){return n(u,7)^n(u,18)^u>>>3}i.g0_256=v;function d(u){return n(u,17)^n(u,19)^u>>>10}i.g1_256=d},{"../utils":30}],30:[function(f,t,i){"use strict";var e=f("minimalistic-assert"),n=f("inherits");i.inherits=n;function y(o,c){return(o.charCodeAt(c)&64512)!==55296||c<0||c+1>=o.length?!1:(o.charCodeAt(c+1)&64512)===56320}function I(o,c){if(Array.isArray(o))return o.slice();if(!o)return[];var l=[];if(typeof o=="string")if(c){if(c==="hex")for(o=o.replace(/[^a-z0-9]+/ig,""),o.length%2!==0&&(o="0"+o),P=0;P<o.length;P+=2)l.push(parseInt(o[P]+o[P+1],16))}else for(var g=0,P=0;P<o.length;P++){var p=o.charCodeAt(P);p<128?l[g++]=p:p<2048?(l[g++]=p>>6|192,l[g++]=p&63|128):y(o,P)?(p=65536+((p&1023)<<10)+(o.charCodeAt(++P)&1023),l[g++]=p>>18|240,l[g++]=p>>12&63|128,l[g++]=p>>6&63|128,l[g++]=p&63|128):(l[g++]=p>>12|224,l[g++]=p>>6&63|128,l[g++]=p&63|128)}else for(P=0;P<o.length;P++)l[P]=o[P]|0;return l}i.toArray=I;function s(o){for(var c="",l=0;l<o.length;l++)c+=_(o[l].toString(16));return c}i.toHex=s;function S(o){var c=o>>>24|o>>>8&65280|o<<8&16711680|(o&255)<<24;return c>>>0}i.htonl=S;function E(o,c){for(var l="",g=0;g<o.length;g++){var P=o[g];c==="little"&&(P=S(P)),l+=v(P.toString(16))}return l}i.toHex32=E;function _(o){return o.length===1?"0"+o:o}i.zero2=_;function v(o){return o.length===7?"0"+o:o.length===6?"00"+o:o.length===5?"000"+o:o.length===4?"0000"+o:o.length===3?"00000"+o:o.length===2?"000000"+o:o.length===1?"0000000"+o:o}i.zero8=v;function d(o,c,l,g){var P=l-c;e(P%4===0);for(var p=new Array(P/4),a=0,w=c;a<p.length;a++,w+=4){var j;g==="big"?j=o[w]<<24|o[w+1]<<16|o[w+2]<<8|o[w+3]:j=o[w+3]<<24|o[w+2]<<16|o[w+1]<<8|o[w],p[a]=j>>>0}return p}i.join32=d;function u(o,c){for(var l=new Array(o.length*4),g=0,P=0;g<o.length;g++,P+=4){var p=o[g];c==="big"?(l[P]=p>>>24,l[P+1]=p>>>16&255,l[P+2]=p>>>8&255,l[P+3]=p&255):(l[P+3]=p>>>24,l[P+2]=p>>>16&255,l[P+1]=p>>>8&255,l[P]=p&255)}return l}i.split32=u;function M(o,c){return o>>>c|o<<32-c}i.rotr32=M;function k(o,c){return o<<c|o>>>32-c}i.rotl32=k;function T(o,c){return o+c>>>0}i.sum32=T;function L(o,c,l){return o+c+l>>>0}i.sum32_3=L;function z(o,c,l,g){return o+c+l+g>>>0}i.sum32_4=z;function R(o,c,l,g,P){return o+c+l+g+P>>>0}i.sum32_5=R;function U(o,c,l,g){var P=o[c],p=o[c+1],a=g+p>>>0,w=(a<g?1:0)+l+P;o[c]=w>>>0,o[c+1]=a}i.sum64=U;function H(o,c,l,g){var P=c+g>>>0,p=(P<c?1:0)+o+l;return p>>>0}i.sum64_hi=H;function D(o,c,l,g){var P=c+g;return P>>>0}i.sum64_lo=D;function K(o,c,l,g,P,p,a,w){var j=0,F=c;F=F+g>>>0,j+=F<c?1:0,F=F+p>>>0,j+=F<p?1:0,F=F+w>>>0,j+=F<w?1:0;var G=o+l+P+a+j;return G>>>0}i.sum64_4_hi=K;function B(o,c,l,g,P,p,a,w){var j=c+g+p+w;return j>>>0}i.sum64_4_lo=B;function N(o,c,l,g,P,p,a,w,j,F){var G=0,X=c;X=X+g>>>0,G+=X<c?1:0,X=X+p>>>0,G+=X<p?1:0,X=X+w>>>0,G+=X<w?1:0,X=X+F>>>0,G+=X<F?1:0;var Z=o+l+P+a+j+G;return Z>>>0}i.sum64_5_hi=N;function q(o,c,l,g,P,p,a,w,j,F){var G=c+g+p+w+F;return G>>>0}i.sum64_5_lo=q;function C(o,c,l){var g=c<<32-l|o>>>l;return g>>>0}i.rotr64_hi=C;function x(o,c,l){var g=o<<32-l|c>>>l;return g>>>0}i.rotr64_lo=x;function r(o,c,l){return o>>>l}i.shr64_hi=r;function h(o,c,l){var g=o<<32-l|c>>>l;return g>>>0}i.shr64_lo=h},{inherits:32,"minimalistic-assert":33}],31:[function(f,t,i){"use strict";var e=f("hash.js"),n=f("minimalistic-crypto-utils"),y=f("minimalistic-assert");function I(s){if(!(this instanceof I))return new I(s);this.hash=s.hash,this.predResist=!!s.predResist,this.outLen=this.hash.outSize,this.minEntropy=s.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var S=n.toArray(s.entropy,s.entropyEnc||"hex"),E=n.toArray(s.nonce,s.nonceEnc||"hex"),_=n.toArray(s.pers,s.persEnc||"hex");y(S.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(S,E,_)}t.exports=I,I.prototype._init=function(S,E,_){var v=S.concat(E).concat(_);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var d=0;d<this.V.length;d++)this.K[d]=0,this.V[d]=1;this._update(v),this._reseed=1,this.reseedInterval=281474976710656},I.prototype._hmac=function(){return new e.hmac(this.hash,this.K)},I.prototype._update=function(S){var E=this._hmac().update(this.V).update([0]);S&&(E=E.update(S)),this.K=E.digest(),this.V=this._hmac().update(this.V).digest(),S&&(this.K=this._hmac().update(this.V).update([1]).update(S).digest(),this.V=this._hmac().update(this.V).digest())},I.prototype.reseed=function(S,E,_,v){typeof E!="string"&&(v=_,_=E,E=null),S=n.toArray(S,E),_=n.toArray(_,v),y(S.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(S.concat(_||[])),this._reseed=1},I.prototype.generate=function(S,E,_,v){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof E!="string"&&(v=_,_=E,E=null),_&&(_=n.toArray(_,v||"hex"),this._update(_));for(var d=[];d.length<S;)this.V=this._hmac().update(this.V).digest(),d=d.concat(this.V);var u=d.slice(0,S);return this._update(_),this._reseed++,n.encode(u,E)}},{"hash.js":19,"minimalistic-assert":33,"minimalistic-crypto-utils":34}],32:[function(f,t,i){typeof Object.create=="function"?t.exports=function(n,y){y&&(n.super_=y,n.prototype=Object.create(y.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(n,y){if(y){n.super_=y;var I=function(){};I.prototype=y.prototype,n.prototype=new I,n.prototype.constructor=n}}},{}],33:[function(f,t,i){t.exports=e;function e(n,y){if(!n)throw new Error(y||"Assertion failed")}e.equal=function(y,I,s){if(y!=I)throw new Error(s||"Assertion failed: "+y+" != "+I)}},{}],34:[function(f,t,i){"use strict";var e=i;function n(s,S){if(Array.isArray(s))return s.slice();if(!s)return[];var E=[];if(typeof s!="string"){for(var _=0;_<s.length;_++)E[_]=s[_]|0;return E}if(S==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var _=0;_<s.length;_+=2)E.push(parseInt(s[_]+s[_+1],16))}else for(var _=0;_<s.length;_++){var v=s.charCodeAt(_),d=v>>8,u=v&255;d?E.push(d,u):E.push(u)}return E}e.toArray=n;function y(s){return s.length===1?"0"+s:s}e.zero2=y;function I(s){for(var S="",E=0;E<s.length;E++)S+=y(s[E].toString(16));return S}e.toHex=I,e.encode=function(S,E){return E==="hex"?I(S):S}},{}],35:[function(f,t,i){t.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}]},{},[1])(1)}();var Ge=class{constructor(t,i,e){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:kt}),this.key=i,this.type=e,this.algorithm={name:t}}};var Ar="ECDH",ci=class{constructor(t){Object.defineProperty(this,"_ec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._ec=new $f("secp256k1"),this._hkdf=t,this._nPk=65,this._nSk=32}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,i,e){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(i,e)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=new Uint8Array(32);(await Vr()).getRandomValues(t);let e=new Ge(Ar,t,"private");return{publicKey:await this.derivePublicKey(e),privateKey:e}}async deriveKeyPair(t){let i=await this._hkdf.labeledExtract(ne,It,new Uint8Array(t)),e=await this._hkdf.labeledExpand(i,Ft,ne,this._nSk),n=new Ge(Ar,new Uint8Array(e),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(t,i){return await this._dh(t,i)}_serializePublicKey(t){return new Promise(i=>{i(t.key.buffer)})}_deserializePublicKey(t){return new Promise((i,e)=>{t.byteLength!==this._nPk?e(new Error("Invalid public key for the ciphersuite")):i(new Ge(Ar,new Uint8Array(t),"public"))})}_importKey(t,i){return new Promise((e,n)=>{i&&t.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!i&&t.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),e(new Ge(Ar,new Uint8Array(t),i?"public":"private"))})}_derivePublicKey(t){return new Promise(i=>{let e=this._ec.keyFromPrivate(Gr(t.key),"hex");i(new Ge(Ar,Ui(e.getPublic("hex")),"public"))})}_dh(t,i){return new Promise((e,n)=>{try{let y=this._ec.keyFromPrivate(Gr(t.key),"hex"),I=this._ec.keyFromPublic(Gr(i.key),"hex"),s=y.derive(I.getPublic());e(Ui(s.toString(16,2)))}catch(y){n(y)}})}};var tr=qt(ca(),1);var er="X25519",mi=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=32,this._nSk=32}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,i,e){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(i,e)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=await(0,tr.generateKeyPair)();return{publicKey:new Ge(er,t.publicKey,"public"),privateKey:new Ge(er,t.secretKey,"private")}}async deriveKeyPair(t){let i=await this._hkdf.labeledExtract(ne,It,new Uint8Array(t)),e=await this._hkdf.labeledExpand(i,Ft,ne,this._nSk),n=new Ge(er,new Uint8Array(e),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(t,i){return await this._dh(t,i)}_serializePublicKey(t){return new Promise(i=>{i(t.key.buffer)})}_deserializePublicKey(t){return new Promise((i,e)=>{t.byteLength!==this._nPk?e(new Error("Invalid public key for the ciphersuite")):i(new Ge(er,new Uint8Array(t),"public"))})}_importKey(t,i){return new Promise((e,n)=>{i&&t.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!i&&t.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),e(new Ge(er,new Uint8Array(t),i?"public":"private"))})}_derivePublicKey(t){return new Promise(i=>{i(new Ge(er,(0,tr.scalarMultBase)(t.key),"public"))})}_dh(t,i){return new Promise((e,n)=>{try{e((0,tr.sharedKey)(t.key,i.key,!0))}catch(y){n(y)}})}};var rr=qt(la());function Ct(f){return new rr.BigInteger(f.toString(10))}var gi=rr.BigInteger.ZERO,ef=rr.BigInteger.ONE,Yn=Ct(2),Zn=Ct(3),Jn=Ct(5),Wn=Ct(128),$n=Ct(255);function xi(f){return f.multiply(f)}var Se=new rr.BigInteger("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439"),Qn=new rr.BigInteger("39081");function wi(f,t,i){var e=f.multiply(t.subtract(i)).mod(Se);return[t.subtract(e).mod(Se),i.add(e).mod(Se)]}function ba(f,t){for(var i=t,e=ef,n=gi,y=t,I=ef,s=gi,S=448-1;S>=0;--S){var E=f.shiftRight(S).and(ef);s=s.xor(E);{var _=wi(s,e,y),v=_[0],d=_[1];e=v,y=d}{var u=wi(s,n,I),M=u[0],k=u[1];n=M,I=k}s=E;var T=e.add(n).mod(Se),L=xi(T).mod(Se),z=e.subtract(n).mod(Se),R=xi(z).mod(Se),U=L.subtract(R).mod(Se),H=y.add(I).mod(Se),D=y.subtract(I).mod(Se),K=D.multiply(T).mod(Se),B=H.multiply(z).mod(Se);y=xi(K.add(B).mod(Se)).mod(Se),I=i.multiply(xi(K.subtract(B).mod(Se))).mod(Se),e=L.multiply(R).mod(Se),n=U.multiply(L.add(Qn.multiply(U).mod(Se)).mod(Se)).mod(Se)}var N=wi(s,e,y),q=N[0],C=wi(s,n,I),x=C[0];return q.multiply(x.modPow(Se.subtract(Yn),Se)).mod(Se)}function e0(f){return f.map(function(t,i){return Ct(t).shiftLeft(8*i)}).reduce(function(t,i){return t.add(i)},gi)}function va(f){var t=[].concat(f);return t[0]&=252,t[55]|=128,e0(t)}function t0(f){if(f.length!==56)throw new Error("Invalid Curve448 scalar (len="+f.length+")");return f.map(function(t,i){return Ct(t).shiftLeft(8*i)}).reduce(function(t,i){return t.add(i)},gi)}function pa(f){return Array.from({length:56},function(t,i){return f.shiftRight(8*i).and($n).intValue()})}function ma(f){return f.andNot(Zn).or(Wn.shiftLeft(8*55))}function r0(f,t){var i=ma(va(f)),e=t0(t);return pa(ba(i,e))}function i0(f){var t=ma(va(f));return pa(ba(t,Jn))}function ya(f){if(!f)throw new Error("Missing private key");if(f.length!==56)throw new Error("Invalid Curve448 private key (len="+f.length+")");return i0(Array.from(f))}function xa(f,t){if(!f)throw new Error("Missing private key");if(!t)throw new Error("Missing public key");if(f.length!==56)throw new Error("Invalid Curve448 private key (len="+f.length+")");var i=r0(Array.from(f),Array.from(t));if(!i.some(function(e){return e}))throw new Error("Invalid Curve448 public key");return i}var _i="X448",Si=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=56,this._nSk=56}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,i,e){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(i,e)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=new Uint8Array(56);return(await Vr()).getRandomValues(t),await this.deriveKeyPair(t)}async deriveKeyPair(t){let i=await this._hkdf.labeledExtract(ne,It,new Uint8Array(t)),e=await this._hkdf.labeledExpand(i,Ft,ne,this._nSk),n=new Ge(_i,new Uint8Array(e),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(t,i){return await this._dh(t,i)}_serializePublicKey(t){return new Promise(i=>{i(t.key.buffer)})}_deserializePublicKey(t){return new Promise((i,e)=>{t.byteLength!==this._nPk?e(new Error("Invalid public key for the ciphersuite")):i(new Ge(_i,new Uint8Array(t),"public"))})}_importKey(t,i){return new Promise((e,n)=>{i&&t.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!i&&t.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),e(new Ge(_i,new Uint8Array(t),i?"public":"private"))})}_derivePublicKey(t){return new Promise(i=>{i(new Ge(_i,Uint8Array.from(ya(t.key)),"public"))})}_dh(t,i){return new Promise((e,n)=>{try{e(Uint8Array.from(xa(t.key,i.key)))}catch(y){n(y)}})}};var zt=class extends Pt{constructor(t,i,e){super(t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=i,this._kdf=e}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(t){throw new nt(t)}}async deriveKeyPair(t){try{return await this._prim.deriveKeyPair(t)}catch(i){throw new jr(i)}}async serializePublicKey(t){try{return await this._prim.serializePublicKey(t)}catch(i){throw new Hr(i)}}async deserializePublicKey(t){try{return await this._prim.deserializePublicKey(t)}catch(i){throw new jt(i)}}async importKey(t,i,e){try{return await this._prim.importKey(t,i,e)}catch(n){throw new jt(n)}}async encap(t){try{let i=t.nonEphemeralKeyPair===void 0?await this.generateKeyPair():t.nonEphemeralKeyPair,e=await this._prim.serializePublicKey(i.publicKey),n=await this._prim.serializePublicKey(t.recipientPublicKey),y;if(t.senderKey===void 0)y=new Uint8Array(await this._prim.dh(i.privateKey,t.recipientPublicKey));else{let S=wr(t.senderKey)?t.senderKey.privateKey:t.senderKey,E=new Uint8Array(await this._prim.dh(i.privateKey,t.recipientPublicKey)),_=new Uint8Array(await this._prim.dh(S,t.recipientPublicKey));y=gr(E,_)}let I;if(t.senderKey===void 0)I=gr(new Uint8Array(e),new Uint8Array(n));else{let S=wr(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),E=await this._prim.serializePublicKey(S);I=df(new Uint8Array(e),new Uint8Array(n),new Uint8Array(E))}let s=await this.generateSharedSecret(y,I);return{enc:e,sharedSecret:s}}catch(i){throw new Dr(i)}}async decap(t){let i;try{i=await this._prim.deserializePublicKey(t.enc)}catch(e){throw new jt(e)}try{let e=wr(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,n=wr(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),y=await this._prim.serializePublicKey(n),I;if(t.senderPublicKey===void 0)I=new Uint8Array(await this._prim.dh(e,i));else{let S=new Uint8Array(await this._prim.dh(e,i)),E=new Uint8Array(await this._prim.dh(e,t.senderPublicKey));I=gr(S,E)}let s;if(t.senderPublicKey===void 0)s=gr(new Uint8Array(t.enc),new Uint8Array(y));else{let S=await this._prim.serializePublicKey(t.senderPublicKey);s=new Uint8Array(t.enc.byteLength+y.byteLength+S.byteLength),s.set(new Uint8Array(t.enc),0),s.set(new Uint8Array(y),t.enc.byteLength),s.set(new Uint8Array(S),t.enc.byteLength+y.byteLength)}return await this.generateSharedSecret(I,s)}catch(e){throw new Nr(e)}}async generateSharedSecret(t,i){let e=this._kdf.buildLabeledIkm(bf,t),n=this._kdf.buildLabeledInfo(yf,i,this.secretSize);return await this._kdf.extractAndExpand(ne,e,n,this.secretSize)}},Mi=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemP256HkdfSha256,2),3);let e=new Tt(t,i),n=new Qt(ae.DhkemP256HkdfSha256,e,t);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Ai=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemP384HkdfSha384,2),3);let e=new $t(t,i),n=new Qt(ae.DhkemP384HkdfSha384,e,t);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},Ei=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemP521HkdfSha512,2),3);let e=new Nt(t,i),n=new Qt(ae.DhkemP521HkdfSha512,e,t);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}},Pi=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemSecp256K1HkdfSha256,2),3);let e=new Tt(t,i),n=new ci(e);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},ki=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemX25519HkdfSha256,2),3);let e=new Tt(t,i),n=new mi(e);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Ii=class extends zt{constructor(t){let i=new Uint8Array(Dt);i.set($e(ae.DhkemX448HkdfSha512,2),3);let e=new Nt(t,i),n=new Si(e);super(t,n,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};var tf=class{constructor(t){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.kem){case ae.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case ae.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case ae.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case ae.DhkemSecp256K1HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case ae.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case ae.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new rt("Invalid KEM id")}switch(this.kem=t.kem,t.kdf){case it.HkdfSha256:case it.HkdfSha384:case it.HkdfSha512:break;default:throw new rt("Invalid KDF id")}switch(this.kdf=t.kdf,t.aead){case Fe.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case Fe.Aes256Gcm:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case Fe.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case Fe.ExportOnly:break;default:throw new rt("Invalid AEAD id")}this.aead=t.aead,this._suiteId=new Uint8Array(lf),this._suiteId.set($e(this.kem,2),4),this._suiteId.set($e(this.kdf,2),6),this._suiteId.set($e(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(t){return await this.setup(),ai(this.aead,t,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>128)throw new rt("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(t)}async importKey(t,i,e=!0){return await this.setup(),await this._kem.importKey(t,i,e)}async createSenderContext(t){this.validateInputLength(t),await this.setup();let i=await this._kem.encap(t),e;return t.psk!==void 0?e=t.senderKey!==void 0?ct.AuthPsk:ct.Psk:e=t.senderKey!==void 0?ct.Auth:ct.Base,await this.keyScheduleS(e,i.sharedSecret,i.enc,t)}async createRecipientContext(t){this.validateInputLength(t),await this.setup();let i=await this._kem.decap(t),e;return t.psk!==void 0?e=t.senderPublicKey!==void 0?ct.AuthPsk:ct.Psk:e=t.senderPublicKey!==void 0?ct.Auth:ct.Base,await this.keyScheduleR(e,i,t)}async seal(t,i,e=ne){let n=await this.createSenderContext(t);return{ct:await n.seal(i,e),enc:n.enc}}async open(t,i,e=ne){return await(await this.createRecipientContext(t)).open(i,e)}async setup(){this._api=await cf(),(this._kem===void 0||this._kdf===void 0)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(t,i,e){let n=this.createKdfContext(),y=e.psk===void 0?ne:new Uint8Array(e.psk.id),I=await n.labeledExtract(ne,pf,y),s=e.info===void 0?ne:new Uint8Array(e.info),S=await n.labeledExtract(ne,vf,s),E=new Uint8Array(1+I.byteLength+S.byteLength);E.set(new Uint8Array([t]),0),E.set(new Uint8Array(I),1),E.set(new Uint8Array(S),1+I.byteLength);let _=e.psk===void 0?ne:new Uint8Array(e.psk.key),v=n.buildLabeledIkm(mf,_),d=n.buildLabeledInfo(gf,E,n.hashSize),u=await n.extractAndExpand(i,v,d,n.hashSize);if(this.aead===Fe.ExportOnly)return{params:{aead:this.aead,exporterSecret:u},kdf:n};let M=n.buildLabeledInfo(xf,E,this.aeadKeySize),k=await n.extractAndExpand(i,v,M,this.aeadKeySize),T=n.buildLabeledInfo(wf,E,this.aeadNonceSize),L=await n.extractAndExpand(i,v,T,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:u,key:k,baseNonce:new Uint8Array(L),seq:0},kdf:n}}async keyScheduleS(t,i,e,n){let y=await this.keySchedule(t,i,n);return y.params.key===void 0?new Yr(this._api,y.kdf,y.params.exporterSecret,e):new oi(this._api,y.kdf,y.params,e)}async keyScheduleR(t,i,e){let n=await this.keySchedule(t,i,e);return n.params.key===void 0?new Xr(this._api,n.kdf,n.params.exporterSecret):new hi(this._api,n.kdf,n.params)}validateInputLength(t){if(t.info!==void 0&&t.info.byteLength>128)throw new rt("Too long info");if(t.psk!==void 0){if(t.psk.key.byteLength<32)throw new rt(`PSK must have at least ${32} bytes`);if(t.psk.key.byteLength>128)throw new rt("Too long psk.key");if(t.psk.id.byteLength>128)throw new rt("Too long psk.id")}}createKemContext(){switch(this.kem){case ae.DhkemP256HkdfSha256:return new Mi(this._api);case ae.DhkemP384HkdfSha384:return new Ai(this._api);case ae.DhkemP521HkdfSha512:return new Ei(this._api);case ae.DhkemX25519HkdfSha256:return new ki(this._api);case ae.DhkemX448HkdfSha512:return new Ii(this._api);default:return new Pi(this._api)}}createKdfContext(){switch(this.kdf){case it.HkdfSha256:return new Tt(this._api,this._suiteId);case it.HkdfSha384:return new $t(this._api,this._suiteId);default:return new Nt(this._api,this._suiteId)}}};export{Fe as Aead,tf as CipherSuite,Nr as DecapError,jr as DeriveKeyPairError,jt as DeserializeError,Dr as EncapError,Cr as ExportError,rt as InvalidParamError,it as Kdf,ae as Kem,qr as MessageLimitReachedError,nt as NotSupportedError,Ht as OpenError,Ot as SealError,Hr as SerializeError,sf as ValidationError};
