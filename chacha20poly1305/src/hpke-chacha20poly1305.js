function te(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`positive integer expected, not ${r}`)}function se(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function oe(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function C(r,...e){if(!oe(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function ce(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function ge(r,e){C(r);let a=e.outputLen;if(r.length<a)throw new Error(`digestInto() expects output buffer of length at least ${a}`)}var G=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),me=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),De=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!De)throw new Error("Non little-endian hardware is not supported");function Ce(r){if(typeof r!="string")throw new Error(`string expected, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function re(r){if(typeof r=="string")r=Ce(r);else if(oe(r))r=r.slice();else throw new Error(`Uint8Array expected, got ${typeof r}`);return r}function Pe(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function Ke(r,e){if(r.length!==e.length)return!1;let a=0;for(let t=0;t<r.length;t++)a|=r[t]^e[t];return a===0}var ue=(r,e)=>(Object.assign(e,r),e);function fe(r,e,a,t){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,a,t);let s=BigInt(32),i=BigInt(4294967295),o=Number(a>>s&i),n=Number(a&i),u=t?4:0,l=t?0:4;r.setUint32(e+u,o,t),r.setUint32(e+l,n,t)}var B=(r,e)=>r[e++]&255|(r[e++]&255)<<8,le=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=re(e),C(e,32);let a=B(e,0),t=B(e,2),s=B(e,4),i=B(e,6),o=B(e,8),n=B(e,10),u=B(e,12),l=B(e,14);this.r[0]=a&8191,this.r[1]=(a>>>13|t<<3)&8191,this.r[2]=(t>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|n<<2)&8191,this.r[7]=(n>>>11|u<<5)&8065,this.r[8]=(u>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let h=0;h<8;h++)this.pad[h]=B(e,16+2*h)}process(e,a,t=!1){let s=t?0:2048,{h:i,r:o}=this,n=o[0],u=o[1],l=o[2],h=o[3],p=o[4],x=o[5],w=o[6],y=o[7],b=o[8],d=o[9],_=B(e,a+0),g=B(e,a+2),O=B(e,a+4),H=B(e,a+6),R=B(e,a+8),T=B(e,a+10),N=B(e,a+12),D=B(e,a+14),m=i[0]+(_&8191),P=i[1]+((_>>>13|g<<3)&8191),K=i[2]+((g>>>10|O<<6)&8191),k=i[3]+((O>>>7|H<<9)&8191),v=i[4]+((H>>>4|R<<12)&8191),A=i[5]+(R>>>1&8191),S=i[6]+((R>>>14|T<<2)&8191),E=i[7]+((T>>>11|N<<5)&8191),U=i[8]+((N>>>8|D<<8)&8191),L=i[9]+(D>>>5|s),f=0,z=f+m*n+P*(5*d)+K*(5*b)+k*(5*y)+v*(5*w);f=z>>>13,z&=8191,z+=A*(5*x)+S*(5*p)+E*(5*h)+U*(5*l)+L*(5*u),f+=z>>>13,z&=8191;let j=f+m*u+P*n+K*(5*d)+k*(5*b)+v*(5*y);f=j>>>13,j&=8191,j+=A*(5*w)+S*(5*x)+E*(5*p)+U*(5*h)+L*(5*l),f+=j>>>13,j&=8191;let I=f+m*l+P*u+K*n+k*(5*d)+v*(5*b);f=I>>>13,I&=8191,I+=A*(5*y)+S*(5*w)+E*(5*x)+U*(5*p)+L*(5*h),f+=I>>>13,I&=8191;let M=f+m*h+P*l+K*u+k*n+v*(5*d);f=M>>>13,M&=8191,M+=A*(5*b)+S*(5*y)+E*(5*w)+U*(5*x)+L*(5*p),f+=M>>>13,M&=8191;let q=f+m*p+P*h+K*l+k*u+v*n;f=q>>>13,q&=8191,q+=A*(5*d)+S*(5*b)+E*(5*y)+U*(5*w)+L*(5*x),f+=q>>>13,q&=8191;let Y=f+m*x+P*p+K*h+k*l+v*u;f=Y>>>13,Y&=8191,Y+=A*n+S*(5*d)+E*(5*b)+U*(5*y)+L*(5*w),f+=Y>>>13,Y&=8191;let X=f+m*w+P*x+K*p+k*h+v*l;f=X>>>13,X&=8191,X+=A*u+S*n+E*(5*d)+U*(5*b)+L*(5*y),f+=X>>>13,X&=8191;let V=f+m*y+P*w+K*x+k*p+v*h;f=V>>>13,V&=8191,V+=A*l+S*u+E*n+U*(5*d)+L*(5*b),f+=V>>>13,V&=8191;let Z=f+m*b+P*y+K*w+k*x+v*p;f=Z>>>13,Z&=8191,Z+=A*h+S*l+E*u+U*n+L*(5*d),f+=Z>>>13,Z&=8191;let W=f+m*d+P*b+K*y+k*w+v*x;f=W>>>13,W&=8191,W+=A*p+S*h+E*l+U*u+L*n,f+=W>>>13,W&=8191,f=(f<<2)+f|0,f=f+z|0,z=f&8191,f=f>>>13,j+=f,i[0]=z,i[1]=j,i[2]=I,i[3]=M,i[4]=q,i[5]=Y,i[6]=X,i[7]=V,i[8]=Z,i[9]=W}finalize(){let{h:e,pad:a}=this,t=new Uint16Array(10),s=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=s,s=e[n]>>>13,e[n]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,t[0]=e[0]+5,s=t[0]>>>13,t[0]&=8191;for(let n=1;n<10;n++)t[n]=e[n]+s,s=t[n]>>>13,t[n]&=8191;t[9]-=8192;let i=(s^1)-1;for(let n=0;n<10;n++)t[n]&=i;i=~i;for(let n=0;n<10;n++)e[n]=e[n]&i|t[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+a[0];e[0]=o&65535;for(let n=1;n<8;n++)o=(e[n]+a[n]|0)+(o>>>16)|0,e[n]=o&65535}update(e){ce(this);let{buffer:a,blockLen:t}=this;e=re(e);let s=e.length;for(let i=0;i<s;){let o=Math.min(t-this.pos,s-i);if(o===t){for(;t<=s-i;i+=t)this.process(e,i);continue}a.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===t&&(this.process(a,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){ce(this),ge(e,this),this.finished=!0;let{buffer:a,h:t}=this,{pos:s}=this;if(s){for(a[s++]=1;s<16;s++)a[s]=0;this.process(a,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=t[o]>>>0,e[i++]=t[o]>>>8;return e}digest(){let{buffer:e,outputLen:a}=this;this.digestInto(e);let t=e.slice(0,a);return this.destroy(),t}};function Re(r){let e=(t,s)=>r(s).update(re(t)).digest(),a=r(new Uint8Array(32));return e.outputLen=a.outputLen,e.blockLen=a.blockLen,e.create=t=>r(t),e}var ke=Re(r=>new le(r));var Ae=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),Me=Ae("expand 16-byte k"),Ge=Ae("expand 32-byte k"),$e=G(Me),Se=G(Ge),Et=Se.slice();function c(r,e){return r<<e|r>>>32-e}function he(r){return r.byteOffset%4===0}var ie=64,Fe=16,Ee=2**32-1,ve=new Uint32Array;function qe(r,e,a,t,s,i,o,n){let u=s.length,l=new Uint8Array(ie),h=G(l),p=he(s)&&he(i),x=p?G(s):ve,w=p?G(i):ve;for(let y=0;y<u;o++){if(r(e,a,t,h,o,n),o>=Ee)throw new Error("arx: counter overflow");let b=Math.min(ie,u-y);if(p&&b===ie){let d=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let _=0,g;_<Fe;_++)g=d+_,w[g]=x[g]^h[_];y+=ie;continue}for(let d=0,_;d<b;d++)_=y+d,i[_]=s[_]^l[d];y+=b}}function de(r,e){let{allowShortKeys:a,extendNonceFn:t,counterLength:s,counterRight:i,rounds:o}=Pe({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return te(s),te(o),se(i),se(a),(n,u,l,h,p=0)=>{C(n),C(u),C(l);let x=l.length;if(h||(h=new Uint8Array(x)),C(h),te(p),p<0||p>=Ee)throw new Error("arx: counter overflow");if(h.length<x)throw new Error(`arx: output (${h.length}) is shorter than data (${x})`);let w=[],y=n.length,b,d;if(y===32)b=n.slice(),w.push(b),d=Se;else if(y===16&&a)b=new Uint8Array(32),b.set(n),b.set(n,16),d=$e,w.push(b);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);he(u)||(u=u.slice(),w.push(u));let _=G(b);if(t){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");t(d,_,G(u.subarray(0,16)),_),u=u.subarray(16)}let g=16-s;if(g!==u.length)throw new Error(`arx: nonce must be ${g} or 16 bytes`);if(g!==12){let H=new Uint8Array(12);H.set(u,i?0:12-u.length),u=H,w.push(u)}let O=G(u);for(qe(r,d,_,O,l,h,p,o);w.length>0;)w.pop().fill(0);return h}}function Ie(r,e,a,t,s,i=20){let o=r[0],n=r[1],u=r[2],l=r[3],h=e[0],p=e[1],x=e[2],w=e[3],y=e[4],b=e[5],d=e[6],_=e[7],g=s,O=a[0],H=a[1],R=a[2],T=o,N=n,D=u,m=l,P=h,K=p,k=x,v=w,A=y,S=b,E=d,U=_,L=g,f=O,z=H,j=R;for(let M=0;M<i;M+=2)T=T+P|0,L=c(L^T,16),A=A+L|0,P=c(P^A,12),T=T+P|0,L=c(L^T,8),A=A+L|0,P=c(P^A,7),N=N+K|0,f=c(f^N,16),S=S+f|0,K=c(K^S,12),N=N+K|0,f=c(f^N,8),S=S+f|0,K=c(K^S,7),D=D+k|0,z=c(z^D,16),E=E+z|0,k=c(k^E,12),D=D+k|0,z=c(z^D,8),E=E+z|0,k=c(k^E,7),m=m+v|0,j=c(j^m,16),U=U+j|0,v=c(v^U,12),m=m+v|0,j=c(j^m,8),U=U+j|0,v=c(v^U,7),T=T+K|0,j=c(j^T,16),E=E+j|0,K=c(K^E,12),T=T+K|0,j=c(j^T,8),E=E+j|0,K=c(K^E,7),N=N+k|0,L=c(L^N,16),U=U+L|0,k=c(k^U,12),N=N+k|0,L=c(L^N,8),U=U+L|0,k=c(k^U,7),D=D+v|0,f=c(f^D,16),A=A+f|0,v=c(v^A,12),D=D+v|0,f=c(f^D,8),A=A+f|0,v=c(v^A,7),m=m+P|0,z=c(z^m,16),S=S+z|0,P=c(P^S,12),m=m+P|0,z=c(z^m,8),S=S+z|0,P=c(P^S,7);let I=0;t[I++]=o+T|0,t[I++]=n+N|0,t[I++]=u+D|0,t[I++]=l+m|0,t[I++]=h+P|0,t[I++]=p+K|0,t[I++]=x+k|0,t[I++]=w+v|0,t[I++]=y+A|0,t[I++]=b+S|0,t[I++]=d+E|0,t[I++]=_+U|0,t[I++]=g+L|0,t[I++]=O+f|0,t[I++]=H+z|0,t[I++]=R+j|0}function Ye(r,e,a,t){let s=r[0],i=r[1],o=r[2],n=r[3],u=e[0],l=e[1],h=e[2],p=e[3],x=e[4],w=e[5],y=e[6],b=e[7],d=a[0],_=a[1],g=a[2],O=a[3];for(let R=0;R<20;R+=2)s=s+u|0,d=c(d^s,16),x=x+d|0,u=c(u^x,12),s=s+u|0,d=c(d^s,8),x=x+d|0,u=c(u^x,7),i=i+l|0,_=c(_^i,16),w=w+_|0,l=c(l^w,12),i=i+l|0,_=c(_^i,8),w=w+_|0,l=c(l^w,7),o=o+h|0,g=c(g^o,16),y=y+g|0,h=c(h^y,12),o=o+h|0,g=c(g^o,8),y=y+g|0,h=c(h^y,7),n=n+p|0,O=c(O^n,16),b=b+O|0,p=c(p^b,12),n=n+p|0,O=c(O^n,8),b=b+O|0,p=c(p^b,7),s=s+l|0,O=c(O^s,16),y=y+O|0,l=c(l^y,12),s=s+l|0,O=c(O^s,8),y=y+O|0,l=c(l^y,7),i=i+h|0,d=c(d^i,16),b=b+d|0,h=c(h^b,12),i=i+h|0,d=c(d^i,8),b=b+d|0,h=c(h^b,7),o=o+p|0,_=c(_^o,16),x=x+_|0,p=c(p^x,12),o=o+p|0,_=c(_^o,8),x=x+_|0,p=c(p^x,7),n=n+u|0,g=c(g^n,16),w=w+g|0,u=c(u^w,12),n=n+u|0,g=c(g^n,8),w=w+g|0,u=c(u^w,7);let H=0;t[H++]=s,t[H++]=i,t[H++]=o,t[H++]=n,t[H++]=d,t[H++]=_,t[H++]=g,t[H++]=O}var Xe=de(Ie,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Ve=de(Ie,{counterRight:!1,counterLength:8,extendNonceFn:Ye,allowShortKeys:!1});var Ze=new Uint8Array(16),Ue=(r,e)=>{r.update(e);let a=e.length%16;a&&r.update(Ze.subarray(a))},We=new Uint8Array(32);function Le(r,e,a,t,s){let i=r(e,a,We),o=ke.create(i);s&&Ue(o,s),Ue(o,t);let n=new Uint8Array(16),u=me(n);fe(u,0,BigInt(s?s.length:0),!0),fe(u,8,BigInt(t.length),!0),o.update(n);let l=o.digest();return i.fill(0),l}var ze=r=>(e,a,t)=>(C(e,32),C(a),{encrypt:(i,o)=>{let n=i.length,u=n+16;o?C(o,u):o=new Uint8Array(u),r(e,a,i,o,1);let l=Le(r,e,a,o.subarray(0,-16),t);return o.set(l,n),o},decrypt:(i,o)=>{let n=i.length,u=n-16;if(n<16)throw new Error("encrypted data must be at least 16 bytes");o?C(o,u):o=new Uint8Array(u);let l=i.subarray(0,-16),h=i.subarray(-16),p=Le(r,e,a,l,t);if(!Ke(h,p))throw new Error("invalid tag");return r(e,a,l,o,1),o}}),ye=ue({blockSize:64,nonceLength:12,tagLength:16},ze(Xe)),jt=ue({blockSize:64,nonceLength:24,tagLength:16},ze(Ve));var Je={},Qe=et(globalThis,Je);function et(r,e){return new Proxy(r,{get(a,t,s){return t in e?e[t]:r[t]},set(a,t,s){return t in e&&delete e[t],r[t]=s,!0},deleteProperty(a,t){let s=!1;return t in e&&(delete e[t],s=!0),t in r&&(delete r[t],s=!0),s},ownKeys(a){let t=Reflect.ownKeys(r),s=Reflect.ownKeys(e),i=new Set(s);return[...t.filter(o=>!i.has(o)),...s]},defineProperty(a,t,s){return t in e&&delete e[t],Reflect.defineProperty(r,t,s),!0},getOwnPropertyDescriptor(a,t){return t in e?Reflect.getOwnPropertyDescriptor(e,t):Reflect.getOwnPropertyDescriptor(r,t)},has(a,t){return t in e||t in r}})}var F={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var $=new Uint8Array(0);var be=new Uint8Array([75,69,77,0,0]);var Yt=new Uint8Array([101,97,101,95,112,114,107]),Xt=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var we=new Uint8Array([100,107,112,95,112,114,107]),He=new Uint8Array([115,107]);var cr=new Uint8Array([99,97,110,100,105,100,97,116,101]),ur=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),fr=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),lr=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),hr=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),dr=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),yr=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var Wr=new Uint8Array([115,101,99]);var wi=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),xi=new Uint8Array([101,120,112]),_i=new Uint8Array([105,110,102,111,95,104,97,115,104]),gi=new Uint8Array([107,101,121]),mi=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),Pi=new Uint8Array([115,101,99,114,101,116]),Ki=new Uint8Array([72,80,75,69,0,0,0,0,0,0]);var Ai=new Uint8Array([72,80,75,69,45,118,49]);var xe=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,a,t){return await this._seal(e,a,t)}async open(e,a,t){return await this._open(e,a,t)}_seal(e,a,t){return new Promise(s=>{let i=ye(this._key,new Uint8Array(e),new Uint8Array(t)).encrypt(new Uint8Array(a));s(i.buffer)})}_open(e,a,t){return new Promise(s=>{let i=ye(this._key,new Uint8Array(e),new Uint8Array(t)).decrypt(new Uint8Array(a));s(i.buffer)})}},_e=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:F.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new xe(e)}};export{_e as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
