var gt=e=>e instanceof Uint8Array;var v=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ct=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),At=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!At)throw new Error("Non little-endian hardware is not supported");function Q(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function tt(e){if(typeof e=="string"&&(e=Q(e)),!gt(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var Et=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function at(e,t){if(t!==void 0&&(typeof t!="object"||!Et(t)))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Z(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof t=="number"&&e.length!==t)throw new Error(`Uint8Array length ${t} expected`)}function ht(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");let f=!0;for(let r=0;r<e.length;r++)f&&(f=e[r]===t[r]);return f}function rt(e,t,f,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,f,r);let x=BigInt(32),o=BigInt(4294967295),i=Number(f>>x&o),n=Number(f&o),u=r?4:0,h=r?0:4;e.setUint32(t+u,i,r),e.setUint32(t+h,n,r)}function nt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ut(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function lt(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function mt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");nt(e.outputLen),nt(e.blockLen)}function _t(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Lt(e,t){lt(e);let f=t.outputLen;if(e.length<f)throw new Error(`digestInto() expects output buffer of length at least ${f}`)}var St={number:nt,bool:Ut,bytes:lt,hash:mt,exists:_t,output:Lt},$=St;var M=(e,t)=>e[t++]&255|(e[t++]&255)<<8,ft=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=tt(t),Z(t,32);let f=M(t,0),r=M(t,2),x=M(t,4),o=M(t,6),i=M(t,8),n=M(t,10),u=M(t,12),h=M(t,14);this.r[0]=f&8191,this.r[1]=(f>>>13|r<<3)&8191,this.r[2]=(r>>>10|x<<6)&7939,this.r[3]=(x>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|n<<2)&8191,this.r[7]=(n>>>11|u<<5)&8065,this.r[8]=(u>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let a=0;a<8;a++)this.pad[a]=M(t,16+2*a)}process(t,f,r=!1){let x=r?0:2048,{h:o,r:i}=this,n=i[0],u=i[1],h=i[2],a=i[3],w=i[4],p=i[5],A=i[6],d=i[7],y=i[8],E=i[9],H=M(t,f+0),K=M(t,f+2),O=M(t,f+4),N=M(t,f+6),R=M(t,f+8),b=M(t,f+10),T=M(t,f+12),j=M(t,f+14),l=o[0]+(H&8191),m=o[1]+((H>>>13|K<<3)&8191),_=o[2]+((K>>>10|O<<6)&8191),g=o[3]+((O>>>7|N<<9)&8191),U=o[4]+((N>>>4|R<<12)&8191),L=o[5]+(R>>>1&8191),S=o[6]+((R>>>14|b<<2)&8191),B=o[7]+((b>>>11|T<<5)&8191),P=o[8]+((T>>>8|j<<8)&8191),I=o[9]+(j>>>5|x),c=0,D=c+l*n+m*(5*E)+_*(5*y)+g*(5*d)+U*(5*A);c=D>>>13,D&=8191,D+=L*(5*p)+S*(5*w)+B*(5*a)+P*(5*h)+I*(5*u),c+=D>>>13,D&=8191;let k=c+l*u+m*n+_*(5*E)+g*(5*y)+U*(5*d);c=k>>>13,k&=8191,k+=L*(5*A)+S*(5*p)+B*(5*w)+P*(5*a)+I*(5*h),c+=k>>>13,k&=8191;let C=c+l*h+m*u+_*n+g*(5*E)+U*(5*y);c=C>>>13,C&=8191,C+=L*(5*d)+S*(5*A)+B*(5*p)+P*(5*w)+I*(5*a),c+=C>>>13,C&=8191;let z=c+l*a+m*h+_*u+g*n+U*(5*E);c=z>>>13,z&=8191,z+=L*(5*y)+S*(5*d)+B*(5*A)+P*(5*p)+I*(5*w),c+=z>>>13,z&=8191;let F=c+l*w+m*a+_*h+g*u+U*n;c=F>>>13,F&=8191,F+=L*(5*E)+S*(5*y)+B*(5*d)+P*(5*A)+I*(5*p),c+=F>>>13,F&=8191;let G=c+l*p+m*w+_*a+g*h+U*u;c=G>>>13,G&=8191,G+=L*n+S*(5*E)+B*(5*y)+P*(5*d)+I*(5*A),c+=G>>>13,G&=8191;let q=c+l*A+m*p+_*w+g*a+U*h;c=q>>>13,q&=8191,q+=L*u+S*n+B*(5*E)+P*(5*y)+I*(5*d),c+=q>>>13,q&=8191;let V=c+l*d+m*A+_*p+g*w+U*a;c=V>>>13,V&=8191,V+=L*h+S*u+B*n+P*(5*E)+I*(5*y),c+=V>>>13,V&=8191;let W=c+l*y+m*d+_*A+g*p+U*w;c=W>>>13,W&=8191,W+=L*a+S*h+B*u+P*n+I*(5*E),c+=W>>>13,W&=8191;let X=c+l*E+m*y+_*d+g*A+U*p;c=X>>>13,X&=8191,X+=L*w+S*a+B*h+P*u+I*n,c+=X>>>13,X&=8191,c=(c<<2)+c|0,c=c+D|0,D=c&8191,c=c>>>13,k+=c,o[0]=D,o[1]=k,o[2]=C,o[3]=z,o[4]=F,o[5]=G,o[6]=q,o[7]=V,o[8]=W,o[9]=X}finalize(){let{h:t,pad:f}=this,r=new Uint16Array(10),x=t[1]>>>13;t[1]&=8191;for(let n=2;n<10;n++)t[n]+=x,x=t[n]>>>13,t[n]&=8191;t[0]+=x*5,x=t[0]>>>13,t[0]&=8191,t[1]+=x,x=t[1]>>>13,t[1]&=8191,t[2]+=x,r[0]=t[0]+5,x=r[0]>>>13,r[0]&=8191;for(let n=1;n<10;n++)r[n]=t[n]+x,x=r[n]>>>13,r[n]&=8191;r[9]-=8192;let o=(x^1)-1;for(let n=0;n<10;n++)r[n]&=o;o=~o;for(let n=0;n<10;n++)t[n]=t[n]&o|r[n];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+f[0];t[0]=i&65535;for(let n=1;n<8;n++)i=(t[n]+f[n]|0)+(i>>>16)|0,t[n]=i&65535}update(t){$.exists(this);let{buffer:f,blockLen:r}=this;t=tt(t);let x=t.length;for(let o=0;o<x;){let i=Math.min(r-this.pos,x-o);if(i===r){for(;r<=x-o;o+=r)this.process(t,o);continue}f.set(t.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===r&&(this.process(f,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){$.exists(this),$.output(t,this),this.finished=!0;let{buffer:f,h:r}=this,{pos:x}=this;if(x){for(f[x++]=1;x<16;x++)f[x]=0;this.process(f,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)t[o++]=r[i]>>>0,t[o++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:f}=this;this.digestInto(t);let r=t.slice(0,f);return this.destroy(),r}};function Bt(e){let t=(r,x)=>e(x).update(tt(r)).digest(),f=e(new Uint8Array(32));return t.outputLen=f.outputLen,t.blockLen=f.blockLen,t.create=r=>e(r),t}var ut=Bt(e=>new ft(e));var Pt=Q("expand 16-byte k"),It=Q("expand 32-byte k"),Ot=v(Pt),Ct=v(It),pt=e=>!(e.byteOffset%4),Y=e=>{let{core:t,rounds:f,counterRight:r,counterLen:x,allow128bitKeys:o,extendNonceFn:i,blockLen:n}=at({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},e);$.number(x),$.number(f),$.number(n),$.bool(r),$.bool(o);let u=n/4;if(n%4!==0)throw new Error("Salsa/ChaCha: blockLen should be aligned to 4 bytes");return(h,a,w,p,A=0)=>{if($.bytes(h),$.bytes(a),$.bytes(w),p||(p=new Uint8Array(w.length)),$.bytes(p),$.number(A),A<0||A>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(p.length<w.length)throw new Error(`Salsa/ChaCha: output (${p.length}) is shorter than data (${w.length})`);let d=[],y,E;if(h.length===32)y=h,E=Ct;else if(h.length===16&&o)y=new Uint8Array(32),y.set(h),y.set(h,16),E=Ot,d.push(y);else throw new Error(`Salsa/ChaCha: wrong key length=${h.length}, expected`);if(i){if(a.length<=16)throw new Error("Salsa/ChaCha: extended nonce should be bigger than 16 bytes");y=i(E,y,a.subarray(0,16),new Uint8Array(32)),d.push(y),a=a.subarray(16)}let H=16-x;if(a.length!==H)throw new Error(`Salsa/ChaCha: nonce should be ${H} or 16 bytes`);if(H!==12){let l=new Uint8Array(12);l.set(a,r?0:12-a.length),d.push(a=l)}let K=new Uint8Array(n),O=v(K),N=v(y),R=v(a),b=pt(w)&&v(w),T=pt(p)&&v(p);d.push(O);let j=w.length;for(let l=0,m=A;l<j;m++){if(t(E,N,R,O,m,f),m>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let _=Math.min(n,j-l);if(_===n&&T&&b){let g=l/4;if(l%4!==0)throw new Error("Salsa/ChaCha: wrong block position");for(let U=0;U<u;U++)T[g+U]=b[g+U]^O[U];l+=n;continue}for(let g=0;g<_;g++)p[l+g]=w[l+g]^K[g];l+=_}for(let l=0;l<d.length;l++)d[l].fill(0);return p}};var s=(e,t)=>e<<t|e>>>32-t;function J(e,t,f,r,x,o=20){let i=e[0],n=e[1],u=e[2],h=e[3],a=t[0],w=t[1],p=t[2],A=t[3],d=t[4],y=t[5],E=t[6],H=t[7],K=x,O=f[0],N=f[1],R=f[2],b=i,T=n,j=u,l=h,m=a,_=w,g=p,U=A,L=d,S=y,B=E,P=H,I=K,c=O,D=N,k=R;for(let z=0;z<o;z+=2)b=b+m|0,I=s(I^b,16),L=L+I|0,m=s(m^L,12),b=b+m|0,I=s(I^b,8),L=L+I|0,m=s(m^L,7),T=T+_|0,c=s(c^T,16),S=S+c|0,_=s(_^S,12),T=T+_|0,c=s(c^T,8),S=S+c|0,_=s(_^S,7),j=j+g|0,D=s(D^j,16),B=B+D|0,g=s(g^B,12),j=j+g|0,D=s(D^j,8),B=B+D|0,g=s(g^B,7),l=l+U|0,k=s(k^l,16),P=P+k|0,U=s(U^P,12),l=l+U|0,k=s(k^l,8),P=P+k|0,U=s(U^P,7),b=b+_|0,k=s(k^b,16),B=B+k|0,_=s(_^B,12),b=b+_|0,k=s(k^b,8),B=B+k|0,_=s(_^B,7),T=T+g|0,I=s(I^T,16),P=P+I|0,g=s(g^P,12),T=T+g|0,I=s(I^T,8),P=P+I|0,g=s(g^P,7),j=j+U|0,c=s(c^j,16),L=L+c|0,U=s(U^L,12),j=j+U|0,c=s(c^j,8),L=L+c|0,U=s(U^L,7),l=l+m|0,D=s(D^l,16),S=S+D|0,m=s(m^S,12),l=l+m|0,D=s(D^l,8),S=S+D|0,m=s(m^S,7);let C=0;r[C++]=i+b|0,r[C++]=n+T|0,r[C++]=u+j|0,r[C++]=h+l|0,r[C++]=a+m|0,r[C++]=w+_|0,r[C++]=p+g|0,r[C++]=A+U|0,r[C++]=d+L|0,r[C++]=y+S|0,r[C++]=E+B|0,r[C++]=H+P|0,r[C++]=K+I|0,r[C++]=O+c|0,r[C++]=N+D|0,r[C++]=R+k|0}function Ht(e,t,f,r){let x=v(t),o=v(f),i=v(r),n=e[0],u=e[1],h=e[2],a=e[3],w=x[0],p=x[1],A=x[2],d=x[3],y=x[4],E=x[5],H=x[6],K=x[7],O=o[0],N=o[1],R=o[2],b=o[3];for(let T=0;T<20;T+=2)n=n+w|0,O=s(O^n,16),y=y+O|0,w=s(w^y,12),n=n+w|0,O=s(O^n,8),y=y+O|0,w=s(w^y,7),u=u+p|0,N=s(N^u,16),E=E+N|0,p=s(p^E,12),u=u+p|0,N=s(N^u,8),E=E+N|0,p=s(p^E,7),h=h+A|0,R=s(R^h,16),H=H+R|0,A=s(A^H,12),h=h+A|0,R=s(R^h,8),H=H+R|0,A=s(A^H,7),a=a+d|0,b=s(b^a,16),K=K+b|0,d=s(d^K,12),a=a+d|0,b=s(b^a,8),K=K+b|0,d=s(d^K,7),n=n+p|0,b=s(b^n,16),H=H+b|0,p=s(p^H,12),n=n+p|0,b=s(b^n,8),H=H+b|0,p=s(p^H,7),u=u+A|0,O=s(O^u,16),K=K+O|0,A=s(A^K,12),u=u+A|0,O=s(O^u,8),K=K+O|0,A=s(A^K,7),h=h+d|0,N=s(N^h,16),y=y+N|0,d=s(d^y,12),h=h+d|0,N=s(N^h,8),y=y+N|0,d=s(d^y,7),a=a+w|0,R=s(R^a,16),E=E+R|0,w=s(w^E,12),a=a+w|0,R=s(R^a,8),E=E+R|0,w=s(w^E,7);return i[0]=n,i[1]=u,i[2]=h,i[3]=a,i[4]=O,i[5]=N,i[6]=R,i[7]=b,r}var Yt=Y({core:J,counterRight:!1,counterLen:8}),Rt=Y({core:J,counterRight:!1,counterLen:4,allow128bitKeys:!1}),Tt=Y({core:J,counterRight:!1,counterLen:8,extendNonceFn:Ht,allow128bitKeys:!1}),Zt=Y({core:J,counterRight:!1,counterLen:4,rounds:8}),Jt=Y({core:J,counterRight:!1,counterLen:4,rounds:12}),Dt=new Uint8Array(16),yt=(e,t)=>{e.update(t);let f=t.length%16;f&&e.update(Dt.subarray(f))},wt=(e,t,f,r,x)=>{let o=e(t,f,new Uint8Array(32)),i=ut.create(o);x&&yt(i,x),yt(i,r);let n=new Uint8Array(16),u=ct(n);rt(u,0,BigInt(x?x.length:0),!0),rt(u,8,BigInt(r.length),!0),i.update(n);let h=i.digest();return o.fill(0),h},dt=e=>(t,f,r)=>(Z(t,32),Z(f),{tagLength:16,encrypt:o=>{let i=new Uint8Array(o.length+16);e(t,f,o,i,1);let n=wt(e,t,f,i.subarray(0,-16),r);return i.set(n,o.length),i},decrypt:o=>{if(o.length<16)throw new Error("Encrypted data should be at least 16");let i=o.subarray(-16),n=o.subarray(0,-16),u=wt(e,t,f,n,r);if(!ht(i,u))throw new Error("Wrong tag");return e(t,f,n,void 0,1)}}),ot=dt(Rt),Qt=dt(Tt);var Kt=new Uint8Array(0),ee=new Uint8Array([72,80,75,69,45,118,49]),re=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),ne=new Uint8Array([75,69,77,0,0]),fe=new Uint8Array([100,107,112,95,112,114,107]),oe=new Uint8Array([101,97,101,95,112,114,107]),se=new Uint8Array([105,110,102,111,95,104,97,115,104]),ie=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),xe=new Uint8Array([115,101,99,114,101,116]),ce=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),ae=new Uint8Array([107,101,121]),he=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),le=new Uint8Array([101,120,112]),ue=new Uint8Array([115,101,99]),pe=new Uint8Array([99,97,110,100,105,100,97,116,101]),ye=new Uint8Array([115,107]),we=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),de=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),be=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var st=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}checkInit(){if(typeof this._api>"u")throw new Error("Not initialized. Call init()")}},et=class extends st{constructor(){super()}init(t){this._api=t}};var kt={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535},bt=kt;var it=class{constructor(t,f){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=t,this._key=new Uint8Array(f)}async seal(t,f,r){return await this._seal(t,f,r)}async open(t,f,r){return await this._open(t,f,r)}_seal(t,f,r){return new Promise(x=>{let o=ot(this._key,new Uint8Array(t),new Uint8Array(r)).encrypt(new Uint8Array(f));x(o.buffer)})}_open(t,f,r){return new Promise(x=>{let o=ot(this._key,new Uint8Array(t),new Uint8Array(r)).decrypt(new Uint8Array(f));x(o.buffer)})}},xt=class extends et{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:bt.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(t){return new it(this._api,t)}};export{xt as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
