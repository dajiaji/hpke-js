<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>hpke-js </title><meta name="description" content="Documentation for hpke-js "/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">hpke-js </a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>hpke-js </h2></div><div class="tsd-panel tsd-typography"><h1 align="center">hpke-js</h1>
<div align="center">
<a href="https://jsr.io/@dajiaji/hpke"><img src="https://jsr.io/badges/@dajiaji/bhttp" alt="JSR"/></a>
<a href="https://doc.deno.land/https/deno.land/x/hpke/mod.ts"><img src="https://doc.deno.land/badge.svg" alt="deno doc"/></a>
<img src="https://github.com/dajiaji/hpke-js/actions/workflows/ci_browsers.yml/badge.svg" alt="Browser CI" />
<img src="https://github.com/dajiaji/hpke-js/actions/workflows/ci_node.yml/badge.svg" alt="Node.js CI" />
<img src="https://github.com/dajiaji/hpke-js/actions/workflows/ci.yml/badge.svg" alt="Deno CI" />
<img src="https://github.com/dajiaji/hpke-js/actions/workflows/ci_cloudflare.yml/badge.svg" alt="Cloudflare Workers CI" />
<img src="https://github.com/dajiaji/hpke-js/actions/workflows/ci_bun.yml/badge.svg" alt="bun CI" />
<a href="https://codecov.io/gh/dajiaji/hpke-js">
  <img src="https://codecov.io/gh/dajiaji/hpke-js/branch/main/graph/badge.svg?token=7I7JGKDDJ2" alt="codecov" />
</a>
</div>
<div align="center">
A TypeScript <a href="https://datatracker.ietf.org/doc/html/rfc9180">Hybrid Public Key Encryption (HPKE)</a>
implementation build on top of <a href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a>.
This module works on web browsers, Node.js, Deno and various other JavaScript runtimes.
</div>
<p></p>
<div align="center">
<p>Documentation:
<a href="https://doc.deno.land/https://deno.land/x/hpke/mod.ts">deno.land</a> |
<a href="https://dajiaji.github.io/hpke-js/docs/">pages (only for the latest ver.)</a></p>
</div>
<p>For Node.js, you can install <code>hpke-js</code> via npm/yarn:</p>
<pre><code class="sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/core</span><br/><span class="hl-3"># if necessary...</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x25519</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x448</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/chacha20poly1305</span><br/><span class="hl-3"># ...or you can use the v0.x-compatible all-in-one package below.</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">hpke-js</span>
</code><button type="button">Copy</button></pre>

<p>Then, you can use it as follows:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-3">// When using &quot;@hpke/core&quot;, specify the cryptographic algorithm instances</span><br/><span class="hl-1">  </span><span class="hl-3">// as follows, instead of identities above.</span><br/><span class="hl-1">  </span><span class="hl-3">// const suite = new CipherSuite({</span><br/><span class="hl-1">  </span><span class="hl-3">//   kem: new DhkemP256HkdfSha256(),</span><br/><span class="hl-1">  </span><span class="hl-3">//   kdf: new HkdfSha256(),</span><br/><span class="hl-1">  </span><span class="hl-3">//   aead: new Aes128Gcm(),</span><br/><span class="hl-1">  </span><span class="hl-3">// });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A recipient generates a key pair.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A sender encrypts a message with the recipient public key.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// The recipient decrypts it.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">e</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">e</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:index" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Index<a href="#md:index" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#md:packages">Packages</a></li>
<li><a href="#md:supported-features">Supported Features</a></li>
<li><a href="#md:supported-environments">Supported Environments</a></li>
<li><a href="#md:warnings-and-restrictions">Warnings and Restrictions</a></li>
<li><a href="#md:installation">Installation</a>
<ul>
<li><a href="#md:nodejs">Node.js</a></li>
<li><a href="#md:deno">Deno</a></li>
<li><a href="#md:web-browsers">Web Browsers</a></li>
<li><a href="#md:cloudflare-workers">Cloudflare Workers</a></li>
</ul>
</li>
<li><a href="#md:usage">Usage</a>
<ul>
<li><a href="#md:base-mode">Base mode</a> - for web browsers, Node.js and Deno.</li>
<li><a href="#md:base-mode-with-single-shot-apis">Base mode with Single-Shot APIs</a></li>
<li><a href="#md:base-mode-with-export-only-aead">Base mode with export-only AEAD</a></li>
<li><a href="#md:psk-mode">PSK mode</a></li>
<li><a href="#md:auth-mode">Auth mode</a></li>
<li><a href="#md:authpsk-mode">AuthPSK mode</a></li>
</ul>
</li>
<li><a href="#md:contributing">Contributing</a></li>
<li><a href="#md:references">References</a></li>
</ul>
<a id="md:packages" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Packages<a href="#md:packages" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The hpke-js includes the following packages.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>since</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>hpke-js</td>
<td>v0.1.0-</td>
<td>The HPKE module supporting all of the ciphersuites defined in <a href="https://datatracker.ietf.org/doc/html/rfc9180">RFC9180</a>, which consists of the following @hpke/{core, dhkem-x25519, dhkem-x448, chacha20poly1305} internally.</td>
</tr>
<tr>
<td>@hpke/core</td>
<td>v1.0.0-</td>
<td>The HPKE core module implemented using only <a href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a>. It does not support the X25519/X448-based KEMs and the ChaCha20/Poly1305 AEAD, but it has no external module dependencies. It's small in size and tree-shaking friendly. See <a href="https://github.com/dajiaji/hpke-js/blob/main/core/README.md">/core/README</a>.</td>
</tr>
<tr>
<td>@hpke/chacha20poly1305</td>
<td>v1.0.0-</td>
<td>The HPKE module extension for ChaCha20Poly1305 AEAD. See <a href="https://github.com/dajiaji/hpke-js/blob/main/x/chacha20poly1305/README.md">/x/chacha20poly1305/README</a>.</td>
</tr>
<tr>
<td>@hpke/dhkem-x25519</td>
<td>v1.0.0-</td>
<td>The HPKE module extension for DHKEM(X25519, HKDF-SHA256). See <a href="https://github.com/dajiaji/hpke-js/blob/main/x/dhkem-x25519/README.md">/x/dhkem-x25519/README</a>.</td>
</tr>
<tr>
<td>@hpke/dhkem-x448</td>
<td>v1.0.0-</td>
<td>The HPKE module extension for DHKEM(X448, HKDF-SHA512). See <a href="https://github.com/dajiaji/hpke-js/blob/main/x/dhkem-x448/README.md">/x/dhkem-x448/README</a>.</td>
</tr>
<tr>
<td>@hpke/hybridkem-x25519-kyber768</td>
<td>v1.2.1-</td>
<td><strong>EXPERIMENTAL AND NOT STANDARDIZED</strong> The HPKE module extension for the hybrid post-quantum KEM currently named <a href="https://datatracker.ietf.org/doc/draft-westerbaan-cfrg-hpke-xyber768d00/">X25519Kyber768Draft00</a>. See <a href="https://github.com/dajiaji/hpke-js/blob/main/x/hybridkem-x25519-kyber768/README.md">/x/hybridkem-x25519-kyber768/README</a>.</td>
</tr>
<tr>
<td>@hpke/dhkem-secp256k1</td>
<td>v1.0.0-</td>
<td><strong>EXPERIMENTAL AND NOT STANDARDIZED</strong> The HPKE module extension for DHKEM(secp256k1, HKDF-SHA256). See <a href="https://github.com/dajiaji/hpke-js/blob/main/x/dhkem-secp256k1/README.md">/x/dhkem-secp256k1/README</a>.</td>
</tr>
</tbody>
</table>
<a id="md:supported-features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Supported Features<a href="#md:supported-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:hpke-modes" class="tsd-anchor"></a><h3 class="tsd-anchor-link">HPKE Modes<a href="#md:hpke-modes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Base</th>
<th>PSK</th>
<th>Auth</th>
<th>AuthPSK</th>
</tr>
</thead>
<tbody>
<tr>
<td>✅</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
</tbody>
</table>
<a id="md:key-encapsulation-machanisms-kems" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Key Encapsulation Machanisms (KEMs)<a href="#md:key-encapsulation-machanisms-kems" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>KEMs</th>
<th>Browser</th>
<th>Node.js</th>
<th>Deno</th>
<th>Cloudflare<br>Workers</th>
<th>bun</th>
</tr>
</thead>
<tbody>
<tr>
<td>DHKEM (P-256, HKDF-SHA256)</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
<tr>
<td>DHKEM (P-384, HKDF-SHA384)</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
<tr>
<td>DHKEM (P-521, HKDF-SHA512)</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td></td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
<tr>
<td>DHKEM (X25519, HKDF-SHA256)</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x25519</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x25519</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x25519</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x25519</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x25519</td>
</tr>
<tr>
<td>DHKEM (X448, HKDF-SHA512)</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x448</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x448</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x448</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x448</td>
<td>✅<br>hpke-js<br>@hpke/dhkem-x448</td>
</tr>
<tr>
<td>Hybrid KEM (X25519, Kyber768)</td>
<td>✅<br>@hpke/hybridkem-x25519-kyber768</td>
<td>✅<br>@hpke/hybridkem-x25519-kyber768</td>
<td>✅<br>@hpke/hybridkem-x25519-kyber768</td>
<td>✅<br>@hpke/hybridkem-x25519-kyber768</td>
<td>✅<br>@hpke/hybridkem-x25519-kyber768</td>
</tr>
<tr>
<td>DHKEM (secp256k1, HKDF-SHA256)</td>
<td>✅<br>@hpke/dhkem-secp256k1</td>
<td>✅<br>@hpke/dhkem-secp256k1</td>
<td>✅<br>@hpke/dhkem-secp256k1</td>
<td>✅<br>@hpke/dhkem-secp256k1</td>
<td>✅<br>@hpke/dhkem-secp256k1</td>
</tr>
</tbody>
</table>
<a id="md:key-derivation-functions-kdfs" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Key Derivation Functions (KDFs)<a href="#md:key-derivation-functions-kdfs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>KDFs</th>
<th>Browser</th>
<th>Node.js</th>
<th>Deno</th>
<th>Cloudflare<br>Workers</th>
<th>bun</th>
</tr>
</thead>
<tbody>
<tr>
<td>HKDF-SHA256</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
</tr>
<tr>
<td>HKDF-SHA384</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
</tr>
<tr>
<td>HKDF-SHA512</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
<td>✅<br>hpke-js<br>@hpke/core(*1)</td>
</tr>
</tbody>
</table>
<ul>
<li>(*1) The HKDF functions built in <code>@hpke/core</code> can derive keys of the same
length as the hash size. If you want to derive keys longer than the hash size,
use <code>hpke-js</code>.</li>
</ul>
<a id="md:authenticated-encryption-with-associated-data-aead-functions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Authenticated Encryption with Associated Data (AEAD) Functions<a href="#md:authenticated-encryption-with-associated-data-aead-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>AEADs</th>
<th>Browser</th>
<th>Node.js</th>
<th>Deno</th>
<th>Cloudflare<br>Workers</th>
<th>bun</th>
</tr>
</thead>
<tbody>
<tr>
<td>AES-128-GCM</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
<tr>
<td>AES-256-GCM</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
<tr>
<td>ChaCha20<br>Poly1305</td>
<td>✅<br>hpke-js<br>@hpke/chacha<br>20poly1305</td>
<td>✅<br>hpke-js<br>@hpke/chacha<br>20poly1305</td>
<td>✅<br>hpke-js<br>@hpke/chacha<br>20poly1305</td>
<td>✅<br>hpke-js<br>@hpke/chacha<br>20poly1305</td>
<td>✅<br>hpke-js<br>@hpke/chacha<br>20poly1305</td>
</tr>
<tr>
<td>Export Only</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
<td>✅<br>hpke-js<br>@hpke/core</td>
</tr>
</tbody>
</table>
<a id="md:supported-environments" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Supported Environments<a href="#md:supported-environments" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Web Browser</strong>: <a href="https://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a>
supported browsers
<ul>
<li>Confirmed: Chrome, Firefox, Edge, Safari, Opera, Vivaldi, Brave</li>
</ul>
</li>
<li><strong>Node.js</strong>: 16.x, 17.x, 18.x, 19.x, 20.x</li>
<li><strong>Deno</strong>: 1.x (1.25-)</li>
<li><strong>Cloudflare Workers</strong></li>
<li><strong>bun</strong>: 0.x (0.6.0-), 1.x</li>
</ul>
<a id="md:warnings-and-restrictions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Warnings and Restrictions<a href="#md:warnings-and-restrictions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Although this library has been passed the following test vectors, it has not
been formally audited.
<ul>
<li><a href="https://github.com/cfrg/draft-irtf-cfrg-hpke/blob/5f503c564da00b0687b3de75f1dfbdfc4079ad31/test-vectors.json">RFC9180 official test vectors provided on github.com/cfrg/draft-irtf-cfrg-hpke</a></li>
<li><a href="https://github.com/google/wycheproof">ECDH/X25519/X448 test vectors provided on Project Wycheproof</a></li>
</ul>
</li>
<li>The upper limit of the AEAD sequence number is further rounded to JavaScript's
MAX_SAFE_INTEGER (<code>2^53-1</code>).</li>
</ul>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:nodejs" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Node.js<a href="#md:nodejs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Using npm:</p>
<pre><code class="sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/core</span><br/><span class="hl-3"># if necessary...</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x25519</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x448</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@hpke/chacha20poly1305</span><br/><span class="hl-3"># ...or you can use the v0.x-compatible all-in-one package below.</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">hpke-js</span>
</code><button type="button">Copy</button></pre>

<p>Using yarn:</p>
<pre><code class="sh"><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@hpke/core</span><br/><span class="hl-3"># if necessary...</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x25519</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@hpke/dhkem-x448</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@hpke/chacha20poly1305</span><br/><span class="hl-3"># ...or you can use the v0.x-compatible all-in-one package below.</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">hpke-js</span>
</code><button type="button">Copy</button></pre>

<a id="md:deno" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Deno<a href="#md:deno" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Using deno.land:</p>
<pre><code class="js"><span class="hl-3">// use a specific version</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-6">*</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-5">hpke</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;https://deno.land/x/hpke@1.2.9/mod.ts&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// import * as hpke from &quot;https://deno.land/x/hpke@1.2.9/core/mod.ts&quot;;</span><br/><span class="hl-3">// import * as hpke from &quot;https://deno.land/x/hpke@1.2.9/x/dhkem-x25519/mod.ts&quot;;</span><br/><br/><span class="hl-3">// use the latest stable version</span><br/><span class="hl-4">import</span><span class="hl-1"> </span><span class="hl-6">*</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-5">hpke</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;https://deno.land/x/hpke/mod.ts&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// import * as hpke from &quot;https://deno.land/x/hpke/core/mod.ts&quot;;</span><br/><span class="hl-3">// import * as hpke from &quot;https://deno.land/x/hpke/x/dhkem-x25519/mod.ts&quot;;</span>
</code><button type="button">Copy</button></pre>

<a id="md:web-browsers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Web Browsers<a href="#md:web-browsers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Followings are how to use the module with typical CDNs. Other CDNs can be used
as well.</p>
<p>Using <a href="http://esm.sh">esm.sh</a>:</p>
<pre><code class="html"><span class="hl-3">&lt;!-- use a specific version --&gt;</span><br/><span class="hl-8">&lt;</span><span class="hl-9">script</span><span class="hl-10"> </span><span class="hl-11">type</span><span class="hl-10">=</span><span class="hl-12">&quot;module&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-10">  </span><span class="hl-4">import</span><span class="hl-10"> </span><span class="hl-6">*</span><span class="hl-10"> </span><span class="hl-4">as</span><span class="hl-10"> </span><span class="hl-5">hpke</span><span class="hl-10"> </span><span class="hl-4">from</span><span class="hl-10"> </span><span class="hl-2">&quot;https://esm.sh/hpke-js@1.2.9&quot;</span><span class="hl-10">;</span><br/><span class="hl-10">  </span><span class="hl-3">// import * as hpke from &quot;https://esm.sh/@hpke/core@1.2.9&quot;;</span><br/><span class="hl-10">  </span><span class="hl-3">// ...</span><br/><span class="hl-8">&lt;/</span><span class="hl-9">script</span><span class="hl-8">&gt;</span><br/><br/><span class="hl-3">&lt;!-- use the latest stable version --&gt;</span><br/><span class="hl-8">&lt;</span><span class="hl-9">script</span><span class="hl-10"> </span><span class="hl-11">type</span><span class="hl-10">=</span><span class="hl-12">&quot;module&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-10">  </span><span class="hl-4">import</span><span class="hl-10"> </span><span class="hl-6">*</span><span class="hl-10"> </span><span class="hl-4">as</span><span class="hl-10"> </span><span class="hl-5">hpke</span><span class="hl-10"> </span><span class="hl-4">from</span><span class="hl-10"> </span><span class="hl-2">&quot;https://esm.sh/hpke-js&quot;</span><span class="hl-10">;</span><br/><span class="hl-10">  </span><span class="hl-3">// import * as hpke from &quot;https://esm.sh/@hpke/core&quot;;</span><br/><span class="hl-10">  </span><span class="hl-3">// ...</span><br/><span class="hl-8">&lt;/</span><span class="hl-9">script</span><span class="hl-8">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Using unpkg:</p>
<pre><code class="html"><span class="hl-3">&lt;!-- use a specific version --&gt;</span><br/><span class="hl-8">&lt;</span><span class="hl-9">script</span><span class="hl-10"> </span><span class="hl-11">type</span><span class="hl-10">=</span><span class="hl-12">&quot;module&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-10">  </span><span class="hl-4">import</span><span class="hl-10"> </span><span class="hl-6">*</span><span class="hl-10"> </span><span class="hl-4">as</span><span class="hl-10"> </span><span class="hl-5">hpke</span><span class="hl-10"> </span><span class="hl-4">from</span><span class="hl-10"> </span><span class="hl-2">&quot;https://unpkg.com/hpke-js@1.2.9/esm/mod.js&quot;</span><span class="hl-10">;</span><br/><span class="hl-10">  </span><span class="hl-3">// import * as hpke from &quot;https://unpkg.com/@hpke/core@1.2.9/esm/mod.js&quot;;</span><br/><span class="hl-10">  </span><span class="hl-3">// ...</span><br/><span class="hl-8">&lt;/</span><span class="hl-9">script</span><span class="hl-8">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="md:cloudflare-workers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Cloudflare Workers<a href="#md:cloudflare-workers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="sh"><span class="hl-0">git</span><span class="hl-1"> </span><span class="hl-2">clone</span><span class="hl-1"> </span><span class="hl-2">git@github.com:dajiaji/hpke-js.git</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">hpke-js</span><br/><span class="hl-3"># for hpke-js</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-6">-g</span><span class="hl-1"> </span><span class="hl-2">esbuild</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">dnt</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">minify</span><span class="hl-1"> &gt; </span><span class="hl-5">$YOUR_SRC_PATH</span><span class="hl-2">/hpke.js</span><br/><br/><span class="hl-3"># for @hpke/core</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">hpke-js/core</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-6">-g</span><span class="hl-1"> </span><span class="hl-2">esbuild</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">dnt</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">minify</span><span class="hl-1"> &gt; </span><span class="hl-5">$YOUR_SRC_PATH</span><span class="hl-2">/hpke-core.js</span><br/><br/><span class="hl-3"># for @hpke/dhkem-x25519</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">hpke-js/x/dhkem-x25519</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-6">-g</span><span class="hl-1"> </span><span class="hl-2">esbuild</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">dnt</span><br/><span class="hl-0">deno</span><span class="hl-1"> </span><span class="hl-2">task</span><span class="hl-1"> </span><span class="hl-2">minify</span><span class="hl-1"> &gt; </span><span class="hl-5">$YOUR_SRC_PATH</span><span class="hl-2">/hpke-dhkem-x25519.js</span>
</code><button type="button">Copy</button></pre>

<a id="md:usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#md:usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This section shows some typical usage examples.</p>
<a id="md:base-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Base mode<a href="#md:base-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A recipient generates a key pair.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A sender encrypts a message with the recipient public key.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// The recipient decrypts it.</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;decrypted: &quot;</span><span class="hl-1">, </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">e</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">e</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Deno:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;https://deno.land/x/hpke@1.2.9/mod.ts&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;https://deno.land/x/hpke@1.2.9/core/mod.ts&quot;;</span><br/><span class="hl-3">// import { DhkemX25519HkdfSha256 } from &quot;https://deno.land/x/hpke@1.2.9/x/dhkem-x25519/mod.ts&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-3">// When using &quot;https://deno.land/x/hpke/mod.ts&quot; (not &quot;/x/hpke/core/mod.ts&quot;),</span><br/><span class="hl-1">    </span><span class="hl-3">// you can specify the identifier as follows:</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemX25519HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-3">//// When using hpke/core/mod.ts, specify the instances as follows:</span><br/><span class="hl-1">  </span><span class="hl-3">//const suite = new CipherSuite({</span><br/><span class="hl-1">  </span><span class="hl-3">//  kem: new DhkemX25519HkdfSha256(),</span><br/><span class="hl-1">  </span><span class="hl-3">//  kdf: new HkdfSha256(),</span><br/><span class="hl-1">  </span><span class="hl-3">//  aead: new Aes128Gcm(),</span><br/><span class="hl-1">  </span><span class="hl-3">//});</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A JWK-formatted recipient public key can also be used.</span><br/><span class="hl-1">  </span><span class="hl-3">// const jwkPkR = {</span><br/><span class="hl-1">  </span><span class="hl-3">//   kty: &quot;EC&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   crv: &quot;P-256&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   kid: &quot;P-256-01&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   x: &quot;-eZXC6nV-xgthy8zZMCN8pcYSeE2XfWWqckA2fsxHPc&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   y: &quot;BGU5soLgsu_y7GN2I3EPUXS9EZ7Sw0qif-V70JtInFI&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   key_ops: [],</span><br/><span class="hl-1">  </span><span class="hl-3">// };</span><br/><span class="hl-1">  </span><span class="hl-3">// const pkR = await suite.kem.importKey(&quot;jwk&quot;, jwkPkR, true);</span><br/><span class="hl-1">  </span><span class="hl-3">// const sender = await suite.createSenderContext({</span><br/><span class="hl-1">  </span><span class="hl-3">//   recipientPublicKey: pkR,</span><br/><span class="hl-1">  </span><span class="hl-3">// });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// encrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// A JWK-formatted recipient private key can also be used.</span><br/><span class="hl-1">  </span><span class="hl-3">// const jwkSkR = {</span><br/><span class="hl-1">  </span><span class="hl-3">//   kty: &quot;EC&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   crv: &quot;P-256&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   kid: &quot;P-256-01&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   x: &quot;-eZXC6nV-xgthy8zZMCN8pcYSeE2XfWWqckA2fsxHPc&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   y: &quot;BGU5soLgsu_y7GN2I3EPUXS9EZ7Sw0qif-V70JtInFI&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   d: &quot;kwibx3gas6Kz1V2fyQHKSnr-ybflddSjN0eOnbmLmyo&quot;,</span><br/><span class="hl-1">  </span><span class="hl-3">//   key_ops: [&quot;deriveBits&quot;],</span><br/><span class="hl-1">  </span><span class="hl-3">// };</span><br/><span class="hl-1">  </span><span class="hl-3">// const skR = await suite.kem.importKey(&quot;jwk&quot;, jwkSkR, false);</span><br/><span class="hl-1">  </span><span class="hl-3">// const recipient = await suite.createRecipientContext({</span><br/><span class="hl-1">  </span><span class="hl-3">//   recipientKey: skR,</span><br/><span class="hl-1">  </span><span class="hl-3">//   enc: sender.enc,</span><br/><span class="hl-1">  </span><span class="hl-3">// });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// decrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">_err</span><span class="hl-1">: </span><span class="hl-13">unknown</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed.&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Browsers:</p>
<pre><code class="html"><span class="hl-8">&lt;</span><span class="hl-9">html</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  </span><span class="hl-8">&lt;</span><span class="hl-9">head</span><span class="hl-8">&gt;&lt;/</span><span class="hl-9">head</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  </span><span class="hl-8">&lt;</span><span class="hl-9">body</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">script</span><span class="hl-10"> </span><span class="hl-11">type</span><span class="hl-10">=</span><span class="hl-12">&quot;module&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-10">      </span><span class="hl-4">import</span><span class="hl-10"> { </span><span class="hl-5">AeadId</span><span class="hl-10">, </span><span class="hl-5">CipherSuite</span><span class="hl-10">, </span><span class="hl-5">KdfId</span><span class="hl-10">, </span><span class="hl-5">KemId</span><span class="hl-10"> } </span><span class="hl-4">from</span><span class="hl-10"> </span><span class="hl-2">&quot;https://esm.sh/hpke-js@1.2.9&quot;</span><span class="hl-10">;</span><br/><span class="hl-10">      </span><span class="hl-3">// import {</span><br/><span class="hl-10">      </span><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-10">      </span><span class="hl-3">// } from &quot;@hpke/core@1.2.9&quot;;</span><br/><br/><span class="hl-10">      </span><span class="hl-5">globalThis</span><span class="hl-10">.</span><span class="hl-0">doHpke</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-6">async</span><span class="hl-10"> () </span><span class="hl-6">=&gt;</span><span class="hl-10"> {</span><br/><span class="hl-10">        </span><span class="hl-4">try</span><span class="hl-10"> {</span><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">suite</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-6">new</span><span class="hl-10"> </span><span class="hl-0">CipherSuite</span><span class="hl-10">({</span><br/><span class="hl-10">            </span><span class="hl-5">kem:</span><span class="hl-10"> </span><span class="hl-5">KemId</span><span class="hl-10">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-10">,</span><br/><span class="hl-10">            </span><span class="hl-5">kdf:</span><span class="hl-10"> </span><span class="hl-5">KdfId</span><span class="hl-10">.</span><span class="hl-5">HkdfSha256</span><span class="hl-10">,</span><br/><span class="hl-10">            </span><span class="hl-5">aead:</span><span class="hl-10"> </span><span class="hl-5">AeadId</span><span class="hl-10">.</span><span class="hl-5">Aes128Gcm</span><br/><span class="hl-10">          });</span><br/><span class="hl-10"> </span><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">rkp</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-4">await</span><span class="hl-10"> </span><span class="hl-5">suite</span><span class="hl-10">.</span><span class="hl-5">kem</span><span class="hl-10">.</span><span class="hl-0">generateKeyPair</span><span class="hl-10">();</span><br/><span class="hl-10">      </span><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">sender</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-4">await</span><span class="hl-10"> </span><span class="hl-5">suite</span><span class="hl-10">.</span><span class="hl-0">createSenderContext</span><span class="hl-10">({</span><br/><span class="hl-10">            </span><span class="hl-5">recipientPublicKey:</span><span class="hl-10"> </span><span class="hl-5">rkp</span><span class="hl-10">.</span><span class="hl-5">publicKey</span><br/><span class="hl-10">          });</span><br/><span class="hl-10">      </span><br/><span class="hl-10">          </span><span class="hl-3">// encrypt</span><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">ct</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-4">await</span><span class="hl-10"> </span><span class="hl-5">sender</span><span class="hl-10">.</span><span class="hl-0">seal</span><span class="hl-10">(</span><span class="hl-6">new</span><span class="hl-10"> </span><span class="hl-0">TextEncoder</span><span class="hl-10">().</span><span class="hl-0">encode</span><span class="hl-10">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-10">));</span><br/><br/><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">recipient</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-4">await</span><span class="hl-10"> </span><span class="hl-5">suite</span><span class="hl-10">.</span><span class="hl-0">createRecipientContext</span><span class="hl-10">({</span><br/><span class="hl-10">            </span><span class="hl-5">recipientKey:</span><span class="hl-10"> </span><span class="hl-5">rkp</span><span class="hl-10">.</span><span class="hl-5">privateKey</span><span class="hl-10">, </span><span class="hl-3">// rkp (CryptoKeyPair) is also acceptable.</span><br/><span class="hl-10">            </span><span class="hl-5">enc:</span><span class="hl-10"> </span><span class="hl-5">sender</span><span class="hl-10">.</span><span class="hl-5">enc</span><span class="hl-10">,</span><br/><span class="hl-10">          });</span><br/><br/><span class="hl-10">          </span><span class="hl-3">// decrypt</span><br/><span class="hl-10">          </span><span class="hl-6">const</span><span class="hl-10"> </span><span class="hl-7">pt</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-4">await</span><span class="hl-10"> </span><span class="hl-5">recipient</span><span class="hl-10">.</span><span class="hl-0">open</span><span class="hl-10">(</span><span class="hl-5">ct</span><span class="hl-10">);</span><br/><br/><span class="hl-10">          </span><span class="hl-3">// Hello world!</span><br/><span class="hl-10">          </span><span class="hl-0">alert</span><span class="hl-10">(</span><span class="hl-6">new</span><span class="hl-10"> </span><span class="hl-0">TextDecoder</span><span class="hl-10">().</span><span class="hl-0">decode</span><span class="hl-10">(</span><span class="hl-5">pt</span><span class="hl-10">));</span><br/><span class="hl-10">        } </span><span class="hl-4">catch</span><span class="hl-10"> (</span><span class="hl-5">err</span><span class="hl-10">) {</span><br/><span class="hl-10">          </span><span class="hl-0">alert</span><span class="hl-10">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-10">, </span><span class="hl-5">err</span><span class="hl-10">.</span><span class="hl-5">message</span><span class="hl-10">);</span><br/><span class="hl-10">        }</span><br/><span class="hl-10">      }</span><br/><span class="hl-10">      </span><br/><span class="hl-10">    </span><span class="hl-8">&lt;/</span><span class="hl-9">script</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-9">button</span><span class="hl-1"> </span><span class="hl-11">type</span><span class="hl-1">=</span><span class="hl-12">&quot;button&quot;</span><span class="hl-1"> </span><span class="hl-11">onclick</span><span class="hl-1">=</span><span class="hl-12">&quot;</span><span class="hl-0">doHpke</span><span class="hl-12">()&quot;</span><span class="hl-8">&gt;</span><span class="hl-1">do HPKE</span><span class="hl-8">&lt;/</span><span class="hl-9">button</span><span class="hl-8">&gt;</span><br/><span class="hl-1">  </span><span class="hl-8">&lt;/</span><span class="hl-9">body</span><span class="hl-8">&gt;</span><br/><span class="hl-8">&lt;/</span><span class="hl-9">html</span><span class="hl-8">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="md:base-mode-with-single-shot-apis" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Base mode with Single-Shot APIs<a href="#md:base-mode-with-single-shot-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&#39;Hello world!&#39;</span><span class="hl-1">),</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// encrypt</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> { ct, </span><span class="hl-7">enc</span><span class="hl-1"> } = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">({ </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1"> }, </span><span class="hl-5">pt</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// decrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">({ </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">, </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">enc</span><span class="hl-1"> }, </span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">err</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:base-mode-with-export-only-aead" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Base mode with export-only AEAD<a href="#md:base-mode-with-export-only-aead" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   CipherSuite, DhkemP256HkdfSha256, ExportOnly, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">ExportOnly</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-3">// When using &quot;@hpke/core&quot;,</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">DhkemP256HkdfSha256</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">HkdfSha256</span><span class="hl-1">(),</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">ExportOnly</span><span class="hl-1">(),</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">te</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// export</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pskS</span><span class="hl-1"> = </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">export</span><span class="hl-1">(</span><span class="hl-5">te</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemu&quot;</span><span class="hl-1">), </span><span class="hl-14">32</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pskR</span><span class="hl-1"> = </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">export</span><span class="hl-1">(</span><span class="hl-5">te</span><span class="hl-1">.</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemu&quot;</span><span class="hl-1">), </span><span class="hl-14">32</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">// pskR === pskS</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">err</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:psk-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PSK mode<a href="#md:psk-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">psk:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">id:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;our-pre-shared-key-id&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-3">// a PSK MUST have at least 32 bytes.</span><br/><span class="hl-1">      </span><span class="hl-5">key:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemugokounosurikirekaija&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// encrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">psk:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">id:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;our-pre-shared-key-id&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-3">// a PSK MUST have at least 32 bytes.</span><br/><span class="hl-1">      </span><span class="hl-5">key:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemugokounosurikirekaija&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// decrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">err</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:auth-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Auth mode<a href="#md:auth-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">skp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">senderKey:</span><span class="hl-1"> </span><span class="hl-5">skp</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// encrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">senderPublicKey:</span><span class="hl-1"> </span><span class="hl-5">skp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// decrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">err</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:authpsk-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">AuthPSK mode<a href="#md:authpsk-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Node.js:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">AeadId</span><span class="hl-1">, </span><span class="hl-5">CipherSuite</span><span class="hl-1">, </span><span class="hl-5">KdfId</span><span class="hl-1">, </span><span class="hl-5">KemId</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&quot;hpke-js&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">// const { AeadId, CipherSuite, KdfId, KemId } = require(&quot;hpke-js&quot;);</span><br/><span class="hl-3">// import {</span><br/><span class="hl-3">//   Aes128Gcm, CipherSuite, DhkemP256HkdfSha256, HkdfSha256,</span><br/><span class="hl-3">// } from &quot;@hpke/core&quot;;</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">doHpke</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">// setup</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">CipherSuite</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">kem:</span><span class="hl-1"> </span><span class="hl-5">KemId</span><span class="hl-1">.</span><span class="hl-5">DhkemP256HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">kdf:</span><span class="hl-1"> </span><span class="hl-5">KdfId</span><span class="hl-1">.</span><span class="hl-5">HkdfSha256</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">aead:</span><span class="hl-1"> </span><span class="hl-5">AeadId</span><span class="hl-1">.</span><span class="hl-5">Aes128Gcm</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rkp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">skp</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-5">kem</span><span class="hl-1">.</span><span class="hl-0">generateKeyPair</span><span class="hl-1">();</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sender</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createSenderContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientPublicKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">senderKey:</span><span class="hl-1"> </span><span class="hl-5">skp</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">psk:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">id:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;our-pre-shared-key-id&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-3">// a PSK MUST have at least 32 bytes.</span><br/><span class="hl-1">      </span><span class="hl-5">key:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemugokounosurikirekaija&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// encrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ct</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-0">seal</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">));</span><br/><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">recipient</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">suite</span><span class="hl-1">.</span><span class="hl-0">createRecipientContext</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">recipientKey:</span><span class="hl-1"> </span><span class="hl-5">rkp</span><span class="hl-1">.</span><span class="hl-5">privateKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">enc:</span><span class="hl-1"> </span><span class="hl-5">sender</span><span class="hl-1">.</span><span class="hl-5">enc</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">senderPublicKey:</span><span class="hl-1"> </span><span class="hl-5">skp</span><span class="hl-1">.</span><span class="hl-5">publicKey</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">psk:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">id:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;our-pre-shared-key-id&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-3">// a PSK MUST have at least 32 bytes.</span><br/><span class="hl-1">      </span><span class="hl-5">key:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextEncoder</span><span class="hl-1">().</span><span class="hl-0">encode</span><span class="hl-1">(</span><span class="hl-2">&quot;jugemujugemugokounosurikirekaija&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// decrypt</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pt</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">recipient</span><span class="hl-1">.</span><span class="hl-0">open</span><span class="hl-1">(</span><span class="hl-5">ct</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Hello world!</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">TextDecoder</span><span class="hl-1">().</span><span class="hl-0">decode</span><span class="hl-1">(</span><span class="hl-5">pt</span><span class="hl-1">));</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">doHpke</span><span class="hl-1">();</span><br/><span class="hl-1">} </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-5">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;failed:&quot;</span><span class="hl-1">, </span><span class="hl-5">err</span><span class="hl-1">.</span><span class="hl-5">message</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#md:contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>We welcome all kind of contributions, filing issues, suggesting new features or
sending PRs.</p>
<a id="md:references" class="tsd-anchor"></a><h2 class="tsd-anchor-link">References<a href="#md:references" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc9180">RFC9180: Hybrid Public Key Encryption</a></li>
<li><a href="https://wicg.github.io/webcrypto-secure-curves/">W3C/WICG: Secure Curves in the Web Cryptography API</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:index"><span>Index</span></a><a href="#md:packages"><span>Packages</span></a><a href="#md:supported-features"><span>Supported <wbr/>Features</span></a><ul><li><a href="#md:hpke-modes"><span>HPKE <wbr/>Modes</span></a></li><li><a href="#md:key-encapsulation-machanisms-kems"><span>Key <wbr/>Encapsulation <wbr/>Machanisms (KEMs)</span></a></li><li><a href="#md:key-derivation-functions-kdfs"><span>Key <wbr/>Derivation <wbr/>Functions (KDFs)</span></a></li><li><a href="#md:authenticated-encryption-with-associated-data-aead-functions"><span>Authenticated <wbr/>Encryption with <wbr/>Associated <wbr/>Data (AEAD) <wbr/>Functions</span></a></li></ul><a href="#md:supported-environments"><span>Supported <wbr/>Environments</span></a><a href="#md:warnings-and-restrictions"><span>Warnings and <wbr/>Restrictions</span></a><a href="#md:installation"><span>Installation</span></a><ul><li><a href="#md:nodejs"><span>Node.js</span></a></li><li><a href="#md:deno"><span>Deno</span></a></li><li><a href="#md:web-browsers"><span>Web <wbr/>Browsers</span></a></li><li><a href="#md:cloudflare-workers"><span>Cloudflare <wbr/>Workers</span></a></li></ul><a href="#md:usage"><span>Usage</span></a><ul><li><a href="#md:base-mode"><span>Base mode</span></a></li><li><a href="#md:base-mode-with-single-shot-apis"><span>Base mode with <wbr/>Single-<wbr/>Shot APIs</span></a></li><li><a href="#md:base-mode-with-export-only-aead"><span>Base mode with export-<wbr/>only AEAD</span></a></li><li><a href="#md:psk-mode"><span>PSK mode</span></a></li><li><a href="#md:auth-mode"><span>Auth mode</span></a></li><li><a href="#md:authpsk-mode"><span>AuthPSK mode</span></a></li></ul><a href="#md:contributing"><span>Contributing</span></a><a href="#md:references"><span>References</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>hpke-js </span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
