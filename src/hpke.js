var xs=Object.create;var Yr=Object.defineProperty;var ms=Object.getOwnPropertyDescriptor;var gs=Object.getOwnPropertyNames;var Es=Object.getPrototypeOf,Ss=Object.prototype.hasOwnProperty;var Xr=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var pe=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var Ps=(i,t,r,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of gs(t))!Ss.call(i,s)&&s!==r&&Yr(i,s,{get:()=>t[s],enumerable:!(e=ms(t,s))||e.enumerable});return i};var et=(i,t,r)=>(r=i!=null?xs(Es(i)):{},Ps(t||!i||!i.__esModule?Yr(r,"default",{value:i,enumerable:!0}):r,i));var yi=pe(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});function Ts(i,t){var r=i>>>16&65535,e=i&65535,s=t>>>16&65535,f=t&65535;return e*f+(r*f+e*s<<16>>>0)|0}Ae.mul=Math.imul||Ts;function Ks(i,t){return i+t|0}Ae.add=Ks;function Us(i,t){return i-t|0}Ae.sub=Us;function Is(i,t){return i<<t|i>>>32-t}Ae.rotl=Is;function Bs(i,t){return i<<32-t|i>>>t}Ae.rotr=Bs;function Hs(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i}Ae.isInteger=Number.isInteger||Hs;Ae.MAX_SAFE_INTEGER=9007199254740991;Ae.isSafeInteger=function(i){return Ae.isInteger(i)&&i>=-Ae.MAX_SAFE_INTEGER&&i<=Ae.MAX_SAFE_INTEGER}});var at=pe(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});var _i=yi();function Ds(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])<<16>>16}F.readInt16BE=Ds;function Os(i,t){return t===void 0&&(t=0),(i[t+0]<<8|i[t+1])>>>0}F.readUint16BE=Os;function Ms(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])<<16>>16}F.readInt16LE=Ms;function zs(i,t){return t===void 0&&(t=0),(i[t+1]<<8|i[t])>>>0}F.readUint16LE=zs;function wi(i,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=i>>>8,t[r+1]=i>>>0,t}F.writeUint16BE=wi;F.writeInt16BE=wi;function vi(i,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=i>>>0,t[r+1]=i>>>8,t}F.writeUint16LE=vi;F.writeInt16LE=vi;function Er(i,t){return t===void 0&&(t=0),i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3]}F.readInt32BE=Er;function Sr(i,t){return t===void 0&&(t=0),(i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3])>>>0}F.readUint32BE=Sr;function Pr(i,t){return t===void 0&&(t=0),i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t]}F.readInt32LE=Pr;function Ar(i,t){return t===void 0&&(t=0),(i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t])>>>0}F.readUint32LE=Ar;function Nt(i,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=i>>>24,t[r+1]=i>>>16,t[r+2]=i>>>8,t[r+3]=i>>>0,t}F.writeUint32BE=Nt;F.writeInt32BE=Nt;function Rt(i,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=i>>>0,t[r+1]=i>>>8,t[r+2]=i>>>16,t[r+3]=i>>>24,t}F.writeUint32LE=Rt;F.writeInt32LE=Rt;function Ns(i,t){t===void 0&&(t=0);var r=Er(i,t),e=Er(i,t+4);return r*4294967296+e-(e>>31)*4294967296}F.readInt64BE=Ns;function Rs(i,t){t===void 0&&(t=0);var r=Sr(i,t),e=Sr(i,t+4);return r*4294967296+e}F.readUint64BE=Rs;function Cs(i,t){t===void 0&&(t=0);var r=Pr(i,t),e=Pr(i,t+4);return e*4294967296+r-(r>>31)*4294967296}F.readInt64LE=Cs;function js(i,t){t===void 0&&(t=0);var r=Ar(i,t),e=Ar(i,t+4);return e*4294967296+r}F.readUint64LE=js;function xi(i,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Nt(i/4294967296>>>0,t,r),Nt(i>>>0,t,r+4),t}F.writeUint64BE=xi;F.writeInt64BE=xi;function mi(i,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Rt(i>>>0,t,r),Rt(i/4294967296>>>0,t,r+4),t}F.writeUint64LE=mi;F.writeInt64LE=mi;function Gs(i,t,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var e=0,s=1,f=i/8+r-1;f>=r;f--)e+=t[f]*s,s*=256;return e}F.readUintBE=Gs;function qs(i,t,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var e=0,s=1,f=r;f<r+i/8;f++)e+=t[f]*s,s*=256;return e}F.readUintLE=qs;function Fs(i,t,r,e){if(r===void 0&&(r=new Uint8Array(i/8)),e===void 0&&(e=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!_i.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var s=1,f=i/8+e-1;f>=e;f--)r[f]=t/s&255,s*=256;return r}F.writeUintBE=Fs;function Vs(i,t,r,e){if(r===void 0&&(r=new Uint8Array(i/8)),e===void 0&&(e=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!_i.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var s=1,f=e;f<e+i/8;f++)r[f]=t/s&255,s*=256;return r}F.writeUintLE=Vs;function Ys(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(t)}F.readFloat32BE=Ys;function Xs(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(t,!0)}F.readFloat32LE=Xs;function Zs(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(t)}F.readFloat64BE=Zs;function Ws(i,t){t===void 0&&(t=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(t,!0)}F.readFloat64LE=Ws;function $s(i,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat32(r,i),t}F.writeFloat32BE=$s;function Qs(i,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat32(r,i,!0),t}F.writeFloat32LE=Qs;function Js(i,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat64(r,i),t}F.writeFloat64BE=Js;function ea(i,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return e.setFloat64(r,i,!0),t}F.writeFloat64LE=ea});var He=pe(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});function ta(i){for(var t=0;t<i.length;t++)i[t]=0;return i}kr.wipe=ta});var Ei=pe(Ct=>{"use strict";Object.defineProperty(Ct,"__esModule",{value:!0});var ye=at(),Lr=He(),ra=20;function ia(i,t,r){for(var e=1634760805,s=857760878,f=2036477234,b=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],x=r[11]<<24|r[10]<<16|r[9]<<8|r[8],U=r[15]<<24|r[14]<<16|r[13]<<8|r[12],A=r[19]<<24|r[18]<<16|r[17]<<8|r[16],k=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],H=r[31]<<24|r[30]<<16|r[29]<<8|r[28],T=t[3]<<24|t[2]<<16|t[1]<<8|t[0],O=t[7]<<24|t[6]<<16|t[5]<<8|t[4],D=t[11]<<24|t[10]<<16|t[9]<<8|t[8],M=t[15]<<24|t[14]<<16|t[13]<<8|t[12],L=e,I=s,z=f,N=b,c=u,l=y,K=x,B=U,m=A,w=k,v=p,g=H,C=T,R=O,S=D,j=M,ee=0;ee<ra;ee+=2)L=L+c|0,C^=L,C=C>>>32-16|C<<16,m=m+C|0,c^=m,c=c>>>32-12|c<<12,I=I+l|0,R^=I,R=R>>>32-16|R<<16,w=w+R|0,l^=w,l=l>>>32-12|l<<12,z=z+K|0,S^=z,S=S>>>32-16|S<<16,v=v+S|0,K^=v,K=K>>>32-12|K<<12,N=N+B|0,j^=N,j=j>>>32-16|j<<16,g=g+j|0,B^=g,B=B>>>32-12|B<<12,z=z+K|0,S^=z,S=S>>>32-8|S<<8,v=v+S|0,K^=v,K=K>>>32-7|K<<7,N=N+B|0,j^=N,j=j>>>32-8|j<<8,g=g+j|0,B^=g,B=B>>>32-7|B<<7,I=I+l|0,R^=I,R=R>>>32-8|R<<8,w=w+R|0,l^=w,l=l>>>32-7|l<<7,L=L+c|0,C^=L,C=C>>>32-8|C<<8,m=m+C|0,c^=m,c=c>>>32-7|c<<7,L=L+l|0,j^=L,j=j>>>32-16|j<<16,v=v+j|0,l^=v,l=l>>>32-12|l<<12,I=I+K|0,C^=I,C=C>>>32-16|C<<16,g=g+C|0,K^=g,K=K>>>32-12|K<<12,z=z+B|0,R^=z,R=R>>>32-16|R<<16,m=m+R|0,B^=m,B=B>>>32-12|B<<12,N=N+c|0,S^=N,S=S>>>32-16|S<<16,w=w+S|0,c^=w,c=c>>>32-12|c<<12,z=z+B|0,R^=z,R=R>>>32-8|R<<8,m=m+R|0,B^=m,B=B>>>32-7|B<<7,N=N+c|0,S^=N,S=S>>>32-8|S<<8,w=w+S|0,c^=w,c=c>>>32-7|c<<7,I=I+K|0,C^=I,C=C>>>32-8|C<<8,g=g+C|0,K^=g,K=K>>>32-7|K<<7,L=L+l|0,j^=L,j=j>>>32-8|j<<8,v=v+j|0,l^=v,l=l>>>32-7|l<<7;ye.writeUint32LE(L+e|0,i,0),ye.writeUint32LE(I+s|0,i,4),ye.writeUint32LE(z+f|0,i,8),ye.writeUint32LE(N+b|0,i,12),ye.writeUint32LE(c+u|0,i,16),ye.writeUint32LE(l+y|0,i,20),ye.writeUint32LE(K+x|0,i,24),ye.writeUint32LE(B+U|0,i,28),ye.writeUint32LE(m+A|0,i,32),ye.writeUint32LE(w+k|0,i,36),ye.writeUint32LE(v+p|0,i,40),ye.writeUint32LE(g+H|0,i,44),ye.writeUint32LE(C+T|0,i,48),ye.writeUint32LE(R+O|0,i,52),ye.writeUint32LE(S+D|0,i,56),ye.writeUint32LE(j+M|0,i,60)}function gi(i,t,r,e,s){if(s===void 0&&(s=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(e.length<r.length)throw new Error("ChaCha: destination is shorter than source");var f,b;if(s===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");f=new Uint8Array(16),b=f.length-t.length,f.set(t,b)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");f=t,b=s}for(var u=new Uint8Array(64),y=0;y<r.length;y+=64){ia(u,f,i);for(var x=y;x<y+64&&x<r.length;x++)e[x]=r[x]^u[x-y];sa(f,0,b)}return Lr.wipe(u),s===0&&Lr.wipe(f),e}Ct.streamXOR=gi;function na(i,t,r,e){return e===void 0&&(e=0),Lr.wipe(r),gi(i,t,r,r,e)}Ct.stream=na;function sa(i,t,r){for(var e=1;r--;)e=e+(i[t]&255)|0,i[t]=e&255,e>>>=8,t++;if(e>0)throw new Error("ChaCha: counter overflow")}});var jt=pe(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});function aa(i,t,r){return~(i-1)&t|i-1&r}ot.select=aa;function oa(i,t){return(i|0)-(t|0)-1>>>31&1}ot.lessOrEqual=oa;function Si(i,t){if(i.length!==t.length)return 0;for(var r=0,e=0;e<i.length;e++)r|=i[e]^t[e];return 1&r-1>>>8}ot.compare=Si;function fa(i,t){return i.length===0||t.length===0?!1:Si(i,t)!==0}ot.equal=fa});var Ai=pe(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});var ha=jt(),Gt=He();ze.DIGEST_LENGTH=16;var Pi=function(){function i(t){this.digestLength=ze.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=r&8191;var e=t[2]|t[3]<<8;this._r[1]=(r>>>13|e<<3)&8191;var s=t[4]|t[5]<<8;this._r[2]=(e>>>10|s<<6)&7939;var f=t[6]|t[7]<<8;this._r[3]=(s>>>7|f<<9)&8191;var b=t[8]|t[9]<<8;this._r[4]=(f>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var u=t[10]|t[11]<<8;this._r[6]=(b>>>14|u<<2)&8191;var y=t[12]|t[13]<<8;this._r[7]=(u>>>11|y<<5)&8065;var x=t[14]|t[15]<<8;this._r[8]=(y>>>8|x<<8)&8191,this._r[9]=x>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return i.prototype._blocks=function(t,r,e){for(var s=this._fin?0:2048,f=this._h[0],b=this._h[1],u=this._h[2],y=this._h[3],x=this._h[4],U=this._h[5],A=this._h[6],k=this._h[7],p=this._h[8],H=this._h[9],T=this._r[0],O=this._r[1],D=this._r[2],M=this._r[3],L=this._r[4],I=this._r[5],z=this._r[6],N=this._r[7],c=this._r[8],l=this._r[9];e>=16;){var K=t[r+0]|t[r+1]<<8;f+=K&8191;var B=t[r+2]|t[r+3]<<8;b+=(K>>>13|B<<3)&8191;var m=t[r+4]|t[r+5]<<8;u+=(B>>>10|m<<6)&8191;var w=t[r+6]|t[r+7]<<8;y+=(m>>>7|w<<9)&8191;var v=t[r+8]|t[r+9]<<8;x+=(w>>>4|v<<12)&8191,U+=v>>>1&8191;var g=t[r+10]|t[r+11]<<8;A+=(v>>>14|g<<2)&8191;var C=t[r+12]|t[r+13]<<8;k+=(g>>>11|C<<5)&8191;var R=t[r+14]|t[r+15]<<8;p+=(C>>>8|R<<8)&8191,H+=R>>>5|s;var S=0,j=S;j+=f*T,j+=b*(5*l),j+=u*(5*c),j+=y*(5*N),j+=x*(5*z),S=j>>>13,j&=8191,j+=U*(5*I),j+=A*(5*L),j+=k*(5*M),j+=p*(5*D),j+=H*(5*O),S+=j>>>13,j&=8191;var ee=S;ee+=f*O,ee+=b*T,ee+=u*(5*l),ee+=y*(5*c),ee+=x*(5*N),S=ee>>>13,ee&=8191,ee+=U*(5*z),ee+=A*(5*I),ee+=k*(5*L),ee+=p*(5*M),ee+=H*(5*D),S+=ee>>>13,ee&=8191;var G=S;G+=f*D,G+=b*O,G+=u*T,G+=y*(5*l),G+=x*(5*c),S=G>>>13,G&=8191,G+=U*(5*N),G+=A*(5*z),G+=k*(5*I),G+=p*(5*L),G+=H*(5*M),S+=G>>>13,G&=8191;var Y=S;Y+=f*M,Y+=b*D,Y+=u*O,Y+=y*T,Y+=x*(5*l),S=Y>>>13,Y&=8191,Y+=U*(5*c),Y+=A*(5*N),Y+=k*(5*z),Y+=p*(5*I),Y+=H*(5*L),S+=Y>>>13,Y&=8191;var X=S;X+=f*L,X+=b*M,X+=u*D,X+=y*O,X+=x*T,S=X>>>13,X&=8191,X+=U*(5*l),X+=A*(5*c),X+=k*(5*N),X+=p*(5*z),X+=H*(5*I),S+=X>>>13,X&=8191;var Z=S;Z+=f*I,Z+=b*L,Z+=u*M,Z+=y*D,Z+=x*O,S=Z>>>13,Z&=8191,Z+=U*T,Z+=A*(5*l),Z+=k*(5*c),Z+=p*(5*N),Z+=H*(5*z),S+=Z>>>13,Z&=8191;var V=S;V+=f*z,V+=b*I,V+=u*L,V+=y*M,V+=x*D,S=V>>>13,V&=8191,V+=U*O,V+=A*T,V+=k*(5*l),V+=p*(5*c),V+=H*(5*N),S+=V>>>13,V&=8191;var W=S;W+=f*N,W+=b*z,W+=u*I,W+=y*L,W+=x*M,S=W>>>13,W&=8191,W+=U*D,W+=A*O,W+=k*T,W+=p*(5*l),W+=H*(5*c),S+=W>>>13,W&=8191;var $=S;$+=f*c,$+=b*N,$+=u*z,$+=y*I,$+=x*L,S=$>>>13,$&=8191,$+=U*M,$+=A*D,$+=k*O,$+=p*T,$+=H*(5*l),S+=$>>>13,$&=8191;var q=S;q+=f*l,q+=b*c,q+=u*N,q+=y*z,q+=x*I,S=q>>>13,q&=8191,q+=U*L,q+=A*M,q+=k*D,q+=p*O,q+=H*T,S+=q>>>13,q&=8191,S=(S<<2)+S|0,S=S+j|0,j=S&8191,S=S>>>13,ee+=S,f=j,b=ee,u=G,y=Y,x=X,U=Z,A=V,k=W,p=$,H=q,r+=16,e-=16}this._h[0]=f,this._h[1]=b,this._h[2]=u,this._h[3]=y,this._h[4]=x,this._h[5]=U,this._h[6]=A,this._h[7]=k,this._h[8]=p,this._h[9]=H},i.prototype.finish=function(t,r){r===void 0&&(r=0);var e=new Uint16Array(10),s,f,b,u;if(this._leftover){for(u=this._leftover,this._buffer[u++]=1;u<16;u++)this._buffer[u]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(s=this._h[1]>>>13,this._h[1]&=8191,u=2;u<10;u++)this._h[u]+=s,s=this._h[u]>>>13,this._h[u]&=8191;for(this._h[0]+=s*5,s=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=s,s=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=s,e[0]=this._h[0]+5,s=e[0]>>>13,e[0]&=8191,u=1;u<10;u++)e[u]=this._h[u]+s,s=e[u]>>>13,e[u]&=8191;for(e[9]-=1<<13,f=(s^1)-1,u=0;u<10;u++)e[u]&=f;for(f=~f,u=0;u<10;u++)this._h[u]=this._h[u]&f|e[u];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,u=1;u<8;u++)b=(this._h[u]+this._pad[u]|0)+(b>>>16)|0,this._h[u]=b&65535;return t[r+0]=this._h[0]>>>0,t[r+1]=this._h[0]>>>8,t[r+2]=this._h[1]>>>0,t[r+3]=this._h[1]>>>8,t[r+4]=this._h[2]>>>0,t[r+5]=this._h[2]>>>8,t[r+6]=this._h[3]>>>0,t[r+7]=this._h[3]>>>8,t[r+8]=this._h[4]>>>0,t[r+9]=this._h[4]>>>8,t[r+10]=this._h[5]>>>0,t[r+11]=this._h[5]>>>8,t[r+12]=this._h[6]>>>0,t[r+13]=this._h[6]>>>8,t[r+14]=this._h[7]>>>0,t[r+15]=this._h[7]>>>8,this._finished=!0,this},i.prototype.update=function(t){var r=0,e=t.length,s;if(this._leftover){s=16-this._leftover,s>e&&(s=e);for(var f=0;f<s;f++)this._buffer[this._leftover+f]=t[r+f];if(e-=s,r+=s,this._leftover+=s,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(e>=16&&(s=e-e%16,this._blocks(t,r,s),r+=s,e-=s),e){for(var f=0;f<e;f++)this._buffer[this._leftover+f]=t[r+f];this._leftover+=e}return this},i.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},i.prototype.clean=function(){return Gt.wipe(this._buffer),Gt.wipe(this._r),Gt.wipe(this._h),Gt.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},i}();ze.Poly1305=Pi;function ua(i,t){var r=new Pi(i);r.update(t);var e=r.digest();return r.clean(),e}ze.oneTimeAuth=ua;function ca(i,t){return i.length!==ze.DIGEST_LENGTH||t.length!==ze.DIGEST_LENGTH?!1:ha.equal(i,t)}ze.equal=ca});var Ti=pe(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});var qt=Ei(),la=Ai(),vt=He(),ki=at(),ba=jt();Ne.KEY_LENGTH=32;Ne.NONCE_LENGTH=12;Ne.TAG_LENGTH=16;var Li=new Uint8Array(16),da=function(){function i(t){if(this.nonceLength=Ne.NONCE_LENGTH,this.tagLength=Ne.TAG_LENGTH,t.length!==Ne.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return i.prototype.seal=function(t,r,e,s){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var f=new Uint8Array(16);f.set(t,f.length-t.length);var b=new Uint8Array(32);qt.stream(this._key,f,b,4);var u=r.length+this.tagLength,y;if(s){if(s.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");y=s}else y=new Uint8Array(u);return qt.streamXOR(this._key,f,r,y,4),this._authenticate(y.subarray(y.length-this.tagLength,y.length),b,y.subarray(0,y.length-this.tagLength),e),vt.wipe(f),y},i.prototype.open=function(t,r,e,s){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var f=new Uint8Array(16);f.set(t,f.length-t.length);var b=new Uint8Array(32);qt.stream(this._key,f,b,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,b,r.subarray(0,r.length-this.tagLength),e),!ba.equal(u,r.subarray(r.length-this.tagLength,r.length)))return null;var y=r.length-this.tagLength,x;if(s){if(s.length!==y)throw new Error("ChaCha20Poly1305: incorrect destination length");x=s}else x=new Uint8Array(y);return qt.streamXOR(this._key,f,r.subarray(0,r.length-this.tagLength),x,4),vt.wipe(f),x},i.prototype.clean=function(){return vt.wipe(this._key),this},i.prototype._authenticate=function(t,r,e,s){var f=new la.Poly1305(r);s&&(f.update(s),s.length%16>0&&f.update(Li.subarray(s.length%16))),f.update(e),e.length%16>0&&f.update(Li.subarray(e.length%16));var b=new Uint8Array(8);s&&ki.writeUint64LE(s.length,b),f.update(b),ki.writeUint64LE(e.length,b),f.update(b);for(var u=f.digest(),y=0;y<u.length;y++)t[y]=u[y];f.clean(),vt.wipe(u),vt.wipe(b)},i}();Ne.ChaCha20Poly1305=da});var Ui=pe(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});function pa(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Tr.isSerializableHash=pa});var Bi=pe(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});var De=Ui(),ya=jt(),_a=He(),Ii=function(){function i(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var e=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(e).clean():e.set(r);for(var s=0;s<e.length;s++)e[s]^=54;this._inner.update(e);for(var s=0;s<e.length;s++)e[s]^=106;this._outer.update(e),De.isSerializableHash(this._inner)&&De.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),_a.wipe(e)}return i.prototype.reset=function(){if(!De.isSerializableHash(this._inner)||!De.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){De.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),De.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(t){return this._inner.update(t),this},i.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(!De.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(t){if(!De.isSerializableHash(this._inner)||!De.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(t){if(!De.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},i}();xt.HMAC=Ii;function wa(i,t,r){var e=new Ii(i,t);e.update(r);var s=e.digest();return e.clean(),s}xt.hmac=wa;xt.equal=ya.equal});var Di=pe(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});var Xt=at(),Yt=He();Ve.DIGEST_LENGTH=32;Ve.BLOCK_SIZE=64;var Hi=function(){function i(){this.digestLength=Ve.DIGEST_LENGTH,this.blockSize=Ve.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){Yt.wipe(this._buffer),Yt.wipe(this._temp),this.reset()},i.prototype.update=function(t,r){if(r===void 0&&(r=t.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var e=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=t[e++],r--;this._bufferLength===this.blockSize&&(Kr(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(e=Kr(this._temp,this._state,t,e,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[e++],r--;return this},i.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,e=this._bufferLength,s=r/536870912|0,f=r<<3,b=r%64<56?64:128;this._buffer[e]=128;for(var u=e+1;u<b-8;u++)this._buffer[u]=0;Xt.writeUint32BE(s,this._buffer,b-8),Xt.writeUint32BE(f,this._buffer,b-4),Kr(this._temp,this._state,this._buffer,0,b),this._finished=!0}for(var u=0;u<this.digestLength/4;u++)Xt.writeUint32BE(this._state[u],t,u*4);return this},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(t){return this._state.set(t.state),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(t){Yt.wipe(t.state),t.buffer&&Yt.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},i}();Ve.SHA256=Hi;var va=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Kr(i,t,r,e,s){for(;s>=64;){for(var f=t[0],b=t[1],u=t[2],y=t[3],x=t[4],U=t[5],A=t[6],k=t[7],p=0;p<16;p++){var H=e+p*4;i[p]=Xt.readUint32BE(r,H)}for(var p=16;p<64;p++){var T=i[p-2],O=(T>>>17|T<<32-17)^(T>>>19|T<<32-19)^T>>>10;T=i[p-15];var D=(T>>>7|T<<32-7)^(T>>>18|T<<32-18)^T>>>3;i[p]=(O+i[p-7]|0)+(D+i[p-16]|0)}for(var p=0;p<64;p++){var O=(((x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7))+(x&U^~x&A)|0)+(k+(va[p]+i[p]|0)|0)|0,D=((f>>>2|f<<32-2)^(f>>>13|f<<32-13)^(f>>>22|f<<32-22))+(f&b^f&u^b&u)|0;k=A,A=U,U=x,x=y+O|0,y=u,u=b,b=f,f=O+D|0}t[0]+=f,t[1]+=b,t[2]+=u,t[3]+=y,t[4]+=x,t[5]+=U,t[6]+=A,t[7]+=k,e+=64,s-=64}return e}function xa(i){var t=new Hi;t.update(i);var r=t.digest();return t.clean(),r}Ve.hash=xa});var zi=pe(Re=>{"use strict";Object.defineProperty(Re,"__esModule",{value:!0});var ut=at(),ht=He();Re.DIGEST_LENGTH=64;Re.BLOCK_SIZE=128;var Mi=function(){function i(){this.digestLength=Re.DIGEST_LENGTH,this.blockSize=Re.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){ht.wipe(this._buffer),ht.wipe(this._tempHi),ht.wipe(this._tempLo),this.reset()},i.prototype.update=function(t,r){if(r===void 0&&(r=t.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var e=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<Re.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=t[e++],r--;this._bufferLength===this.blockSize&&(Ur(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(e=Ur(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,e,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[e++],r--;return this},i.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,e=this._bufferLength,s=r/536870912|0,f=r<<3,b=r%128<112?128:256;this._buffer[e]=128;for(var u=e+1;u<b-8;u++)this._buffer[u]=0;ut.writeUint32BE(s,this._buffer,b-8),ut.writeUint32BE(f,this._buffer,b-4),Ur(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,b),this._finished=!0}for(var u=0;u<this.digestLength/8;u++)ut.writeUint32BE(this._stateHi[u],t,u*8),ut.writeUint32BE(this._stateLo[u],t,u*8+4);return this},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(t){ht.wipe(t.stateHi),ht.wipe(t.stateLo),t.buffer&&ht.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},i}();Re.SHA512=Mi;var Oi=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function Ur(i,t,r,e,s,f,b){for(var u=r[0],y=r[1],x=r[2],U=r[3],A=r[4],k=r[5],p=r[6],H=r[7],T=e[0],O=e[1],D=e[2],M=e[3],L=e[4],I=e[5],z=e[6],N=e[7],c,l,K,B,m,w,v,g;b>=128;){for(var C=0;C<16;C++){var R=8*C+f;i[C]=ut.readUint32BE(s,R),t[C]=ut.readUint32BE(s,R+4)}for(var C=0;C<80;C++){var S=u,j=y,ee=x,G=U,Y=A,X=k,Z=p,V=H,W=T,$=O,q=D,ie=M,oe=L,fe=I,he=z,se=N;if(c=H,l=N,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=(A>>>14|L<<32-14)^(A>>>18|L<<32-18)^(L>>>41-32|A<<32-(41-32)),l=(L>>>14|A<<32-14)^(L>>>18|A<<32-18)^(A>>>41-32|L<<32-(41-32)),m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,c=A&k^~A&p,l=L&I^~L&z,m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,c=Oi[C*2],l=Oi[C*2+1],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,c=i[C%16],l=t[C%16],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,K=v&65535|g<<16,B=m&65535|w<<16,c=K,l=B,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=(u>>>28|T<<32-28)^(T>>>34-32|u<<32-(34-32))^(T>>>39-32|u<<32-(39-32)),l=(T>>>28|u<<32-28)^(u>>>34-32|T<<32-(34-32))^(u>>>39-32|T<<32-(39-32)),m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,c=u&y^u&x^y&x,l=T&O^T&D^O&D,m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,V=v&65535|g<<16,se=m&65535|w<<16,c=G,l=ie,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=K,l=B,m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,G=v&65535|g<<16,ie=m&65535|w<<16,y=S,x=j,U=ee,A=G,k=Y,p=X,H=Z,u=V,O=W,D=$,M=q,L=ie,I=oe,z=fe,N=he,T=se,C%16===15)for(var R=0;R<16;R++)c=i[R],l=t[R],m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=i[(R+9)%16],l=t[(R+9)%16],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,K=i[(R+1)%16],B=t[(R+1)%16],c=(K>>>1|B<<32-1)^(K>>>8|B<<32-8)^K>>>7,l=(B>>>1|K<<32-1)^(B>>>8|K<<32-8)^(B>>>7|K<<32-7),m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,K=i[(R+14)%16],B=t[(R+14)%16],c=(K>>>19|B<<32-19)^(B>>>61-32|K<<32-(61-32))^K>>>6,l=(B>>>19|K<<32-19)^(K>>>61-32|B<<32-(61-32))^(B>>>6|K<<32-6),m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,i[R]=v&65535|g<<16,t[R]=m&65535|w<<16}c=u,l=T,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[0],l=e[0],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[0]=u=v&65535|g<<16,e[0]=T=m&65535|w<<16,c=y,l=O,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[1],l=e[1],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[1]=y=v&65535|g<<16,e[1]=O=m&65535|w<<16,c=x,l=D,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[2],l=e[2],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[2]=x=v&65535|g<<16,e[2]=D=m&65535|w<<16,c=U,l=M,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[3],l=e[3],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[3]=U=v&65535|g<<16,e[3]=M=m&65535|w<<16,c=A,l=L,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[4],l=e[4],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[4]=A=v&65535|g<<16,e[4]=L=m&65535|w<<16,c=k,l=I,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[5],l=e[5],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[5]=k=v&65535|g<<16,e[5]=I=m&65535|w<<16,c=p,l=z,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[6],l=e[6],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[6]=p=v&65535|g<<16,e[6]=z=m&65535|w<<16,c=H,l=N,m=l&65535,w=l>>>16,v=c&65535,g=c>>>16,c=r[7],l=e[7],m+=l&65535,w+=l>>>16,v+=c&65535,g+=c>>>16,w+=m>>>16,v+=w>>>16,g+=v>>>16,r[7]=H=v&65535|g<<16,e[7]=N=m&65535|w<<16,f+=128,b-=128}return f}function ma(i){var t=new Mi;t.update(i);var r=t.digest();return t.clean(),r}Re.hash=ma});var ji=pe(Qt=>{"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});Qt.BrowserRandomSource=void 0;var Ci=65536,Br=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(t);for(let e=0;e<r.length;e+=Ci)this._crypto.getRandomValues(r.subarray(e,e+Math.min(r.length-e,Ci)));return r}};Qt.BrowserRandomSource=Br});var Gi=pe(()=>{});var qi=pe(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.NodeRandomSource=void 0;var Pa=He(),Hr=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Xr<"u"){let t=Gi();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let e=new Uint8Array(t);for(let s=0;s<e.length;s++)e[s]=r[s];return(0,Pa.wipe)(r),e}};Jt.NodeRandomSource=Hr});var Fi=pe(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.SystemRandomSource=void 0;var Aa=ji(),ka=qi(),Dr=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Aa.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ka.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};er.SystemRandomSource=Dr});var Zi=pe(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.randomStringForEntropy=_e.randomString=_e.randomUint32=_e.randomBytes=_e.defaultRandomSource=void 0;var La=Fi(),Ta=at(),Vi=He();_e.defaultRandomSource=new La.SystemRandomSource;function Or(i,t=_e.defaultRandomSource){return t.randomBytes(i)}_e.randomBytes=Or;function Ka(i=_e.defaultRandomSource){let t=Or(4,i),r=(0,Ta.readUint32LE)(t);return(0,Vi.wipe)(t),r}_e.randomUint32=Ka;var Yi="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Xi(i,t=Yi,r=_e.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let e="",s=t.length,f=256-256%s;for(;i>0;){let b=Or(Math.ceil(i*256/f),r);for(let u=0;u<b.length&&i>0;u++){let y=b[u];y<f&&(e+=t.charAt(y%s),i--)}(0,Vi.wipe)(b)}return e}_e.randomString=Xi;function Ua(i,t=Yi,r=_e.defaultRandomSource){let e=Math.ceil(i/(Math.log(t.length)/Math.LN2));return Xi(e,t,r)}_e.randomStringForEntropy=Ua});var Ji=pe(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.sharedKey=ne.generateKeyPair=ne.generateKeyPairFromSeed=ne.scalarMultBase=ne.scalarMult=ne.SHARED_KEY_LENGTH=ne.SECRET_KEY_LENGTH=ne.PUBLIC_KEY_LENGTH=void 0;var Ia=Zi(),Ba=He();ne.PUBLIC_KEY_LENGTH=32;ne.SECRET_KEY_LENGTH=32;ne.SHARED_KEY_LENGTH=32;function Oe(i){let t=new Float64Array(16);if(i)for(let r=0;r<i.length;r++)t[r]=i[r];return t}var Wi=new Uint8Array(32);Wi[0]=9;var Ha=Oe([56129,1]);function Mr(i){let t=1;for(let r=0;r<16;r++){let e=i[r]+t+65535;t=Math.floor(e/65536),i[r]=e-t*65536}i[0]+=t-1+37*(t-1)}function gt(i,t,r){let e=~(r-1);for(let s=0;s<16;s++){let f=e&(i[s]^t[s]);i[s]^=f,t[s]^=f}}function Da(i,t){let r=Oe(),e=Oe();for(let s=0;s<16;s++)e[s]=t[s];Mr(e),Mr(e),Mr(e);for(let s=0;s<2;s++){r[0]=e[0]-65517;for(let b=1;b<15;b++)r[b]=e[b]-65535-(r[b-1]>>16&1),r[b-1]&=65535;r[15]=e[15]-32767-(r[14]>>16&1);let f=r[15]>>16&1;r[14]&=65535,gt(e,r,1-f)}for(let s=0;s<16;s++)i[2*s]=e[s]&255,i[2*s+1]=e[s]>>8}function Oa(i,t){for(let r=0;r<16;r++)i[r]=t[2*r]+(t[2*r+1]<<8);i[15]&=32767}function tr(i,t,r){for(let e=0;e<16;e++)i[e]=t[e]+r[e]}function rr(i,t,r){for(let e=0;e<16;e++)i[e]=t[e]-r[e]}function Ce(i,t,r){let e,s,f=0,b=0,u=0,y=0,x=0,U=0,A=0,k=0,p=0,H=0,T=0,O=0,D=0,M=0,L=0,I=0,z=0,N=0,c=0,l=0,K=0,B=0,m=0,w=0,v=0,g=0,C=0,R=0,S=0,j=0,ee=0,G=r[0],Y=r[1],X=r[2],Z=r[3],V=r[4],W=r[5],$=r[6],q=r[7],ie=r[8],oe=r[9],fe=r[10],he=r[11],se=r[12],ue=r[13],ce=r[14],le=r[15];e=t[0],f+=e*G,b+=e*Y,u+=e*X,y+=e*Z,x+=e*V,U+=e*W,A+=e*$,k+=e*q,p+=e*ie,H+=e*oe,T+=e*fe,O+=e*he,D+=e*se,M+=e*ue,L+=e*ce,I+=e*le,e=t[1],b+=e*G,u+=e*Y,y+=e*X,x+=e*Z,U+=e*V,A+=e*W,k+=e*$,p+=e*q,H+=e*ie,T+=e*oe,O+=e*fe,D+=e*he,M+=e*se,L+=e*ue,I+=e*ce,z+=e*le,e=t[2],u+=e*G,y+=e*Y,x+=e*X,U+=e*Z,A+=e*V,k+=e*W,p+=e*$,H+=e*q,T+=e*ie,O+=e*oe,D+=e*fe,M+=e*he,L+=e*se,I+=e*ue,z+=e*ce,N+=e*le,e=t[3],y+=e*G,x+=e*Y,U+=e*X,A+=e*Z,k+=e*V,p+=e*W,H+=e*$,T+=e*q,O+=e*ie,D+=e*oe,M+=e*fe,L+=e*he,I+=e*se,z+=e*ue,N+=e*ce,c+=e*le,e=t[4],x+=e*G,U+=e*Y,A+=e*X,k+=e*Z,p+=e*V,H+=e*W,T+=e*$,O+=e*q,D+=e*ie,M+=e*oe,L+=e*fe,I+=e*he,z+=e*se,N+=e*ue,c+=e*ce,l+=e*le,e=t[5],U+=e*G,A+=e*Y,k+=e*X,p+=e*Z,H+=e*V,T+=e*W,O+=e*$,D+=e*q,M+=e*ie,L+=e*oe,I+=e*fe,z+=e*he,N+=e*se,c+=e*ue,l+=e*ce,K+=e*le,e=t[6],A+=e*G,k+=e*Y,p+=e*X,H+=e*Z,T+=e*V,O+=e*W,D+=e*$,M+=e*q,L+=e*ie,I+=e*oe,z+=e*fe,N+=e*he,c+=e*se,l+=e*ue,K+=e*ce,B+=e*le,e=t[7],k+=e*G,p+=e*Y,H+=e*X,T+=e*Z,O+=e*V,D+=e*W,M+=e*$,L+=e*q,I+=e*ie,z+=e*oe,N+=e*fe,c+=e*he,l+=e*se,K+=e*ue,B+=e*ce,m+=e*le,e=t[8],p+=e*G,H+=e*Y,T+=e*X,O+=e*Z,D+=e*V,M+=e*W,L+=e*$,I+=e*q,z+=e*ie,N+=e*oe,c+=e*fe,l+=e*he,K+=e*se,B+=e*ue,m+=e*ce,w+=e*le,e=t[9],H+=e*G,T+=e*Y,O+=e*X,D+=e*Z,M+=e*V,L+=e*W,I+=e*$,z+=e*q,N+=e*ie,c+=e*oe,l+=e*fe,K+=e*he,B+=e*se,m+=e*ue,w+=e*ce,v+=e*le,e=t[10],T+=e*G,O+=e*Y,D+=e*X,M+=e*Z,L+=e*V,I+=e*W,z+=e*$,N+=e*q,c+=e*ie,l+=e*oe,K+=e*fe,B+=e*he,m+=e*se,w+=e*ue,v+=e*ce,g+=e*le,e=t[11],O+=e*G,D+=e*Y,M+=e*X,L+=e*Z,I+=e*V,z+=e*W,N+=e*$,c+=e*q,l+=e*ie,K+=e*oe,B+=e*fe,m+=e*he,w+=e*se,v+=e*ue,g+=e*ce,C+=e*le,e=t[12],D+=e*G,M+=e*Y,L+=e*X,I+=e*Z,z+=e*V,N+=e*W,c+=e*$,l+=e*q,K+=e*ie,B+=e*oe,m+=e*fe,w+=e*he,v+=e*se,g+=e*ue,C+=e*ce,R+=e*le,e=t[13],M+=e*G,L+=e*Y,I+=e*X,z+=e*Z,N+=e*V,c+=e*W,l+=e*$,K+=e*q,B+=e*ie,m+=e*oe,w+=e*fe,v+=e*he,g+=e*se,C+=e*ue,R+=e*ce,S+=e*le,e=t[14],L+=e*G,I+=e*Y,z+=e*X,N+=e*Z,c+=e*V,l+=e*W,K+=e*$,B+=e*q,m+=e*ie,w+=e*oe,v+=e*fe,g+=e*he,C+=e*se,R+=e*ue,S+=e*ce,j+=e*le,e=t[15],I+=e*G,z+=e*Y,N+=e*X,c+=e*Z,l+=e*V,K+=e*W,B+=e*$,m+=e*q,w+=e*ie,v+=e*oe,g+=e*fe,C+=e*he,R+=e*se,S+=e*ue,j+=e*ce,ee+=e*le,f+=38*z,b+=38*N,u+=38*c,y+=38*l,x+=38*K,U+=38*B,A+=38*m,k+=38*w,p+=38*v,H+=38*g,T+=38*C,O+=38*R,D+=38*S,M+=38*j,L+=38*ee,s=1,e=f+s+65535,s=Math.floor(e/65536),f=e-s*65536,e=b+s+65535,s=Math.floor(e/65536),b=e-s*65536,e=u+s+65535,s=Math.floor(e/65536),u=e-s*65536,e=y+s+65535,s=Math.floor(e/65536),y=e-s*65536,e=x+s+65535,s=Math.floor(e/65536),x=e-s*65536,e=U+s+65535,s=Math.floor(e/65536),U=e-s*65536,e=A+s+65535,s=Math.floor(e/65536),A=e-s*65536,e=k+s+65535,s=Math.floor(e/65536),k=e-s*65536,e=p+s+65535,s=Math.floor(e/65536),p=e-s*65536,e=H+s+65535,s=Math.floor(e/65536),H=e-s*65536,e=T+s+65535,s=Math.floor(e/65536),T=e-s*65536,e=O+s+65535,s=Math.floor(e/65536),O=e-s*65536,e=D+s+65535,s=Math.floor(e/65536),D=e-s*65536,e=M+s+65535,s=Math.floor(e/65536),M=e-s*65536,e=L+s+65535,s=Math.floor(e/65536),L=e-s*65536,e=I+s+65535,s=Math.floor(e/65536),I=e-s*65536,f+=s-1+37*(s-1),s=1,e=f+s+65535,s=Math.floor(e/65536),f=e-s*65536,e=b+s+65535,s=Math.floor(e/65536),b=e-s*65536,e=u+s+65535,s=Math.floor(e/65536),u=e-s*65536,e=y+s+65535,s=Math.floor(e/65536),y=e-s*65536,e=x+s+65535,s=Math.floor(e/65536),x=e-s*65536,e=U+s+65535,s=Math.floor(e/65536),U=e-s*65536,e=A+s+65535,s=Math.floor(e/65536),A=e-s*65536,e=k+s+65535,s=Math.floor(e/65536),k=e-s*65536,e=p+s+65535,s=Math.floor(e/65536),p=e-s*65536,e=H+s+65535,s=Math.floor(e/65536),H=e-s*65536,e=T+s+65535,s=Math.floor(e/65536),T=e-s*65536,e=O+s+65535,s=Math.floor(e/65536),O=e-s*65536,e=D+s+65535,s=Math.floor(e/65536),D=e-s*65536,e=M+s+65535,s=Math.floor(e/65536),M=e-s*65536,e=L+s+65535,s=Math.floor(e/65536),L=e-s*65536,e=I+s+65535,s=Math.floor(e/65536),I=e-s*65536,f+=s-1+37*(s-1),i[0]=f,i[1]=b,i[2]=u,i[3]=y,i[4]=x,i[5]=U,i[6]=A,i[7]=k,i[8]=p,i[9]=H,i[10]=T,i[11]=O,i[12]=D,i[13]=M,i[14]=L,i[15]=I}function Et(i,t){Ce(i,t,t)}function Ma(i,t){let r=Oe();for(let e=0;e<16;e++)r[e]=t[e];for(let e=253;e>=0;e--)Et(r,r),e!==2&&e!==4&&Ce(r,r,t);for(let e=0;e<16;e++)i[e]=r[e]}function zr(i,t){let r=new Uint8Array(32),e=new Float64Array(80),s=Oe(),f=Oe(),b=Oe(),u=Oe(),y=Oe(),x=Oe();for(let p=0;p<31;p++)r[p]=i[p];r[31]=i[31]&127|64,r[0]&=248,Oa(e,t);for(let p=0;p<16;p++)f[p]=e[p];s[0]=u[0]=1;for(let p=254;p>=0;--p){let H=r[p>>>3]>>>(p&7)&1;gt(s,f,H),gt(b,u,H),tr(y,s,b),rr(s,s,b),tr(b,f,u),rr(f,f,u),Et(u,y),Et(x,s),Ce(s,b,s),Ce(b,f,y),tr(y,s,b),rr(s,s,b),Et(f,s),rr(b,u,x),Ce(s,b,Ha),tr(s,s,u),Ce(b,b,s),Ce(s,u,x),Ce(u,f,e),Et(f,y),gt(s,f,H),gt(b,u,H)}for(let p=0;p<16;p++)e[p+16]=s[p],e[p+32]=b[p],e[p+48]=f[p],e[p+64]=u[p];let U=e.subarray(32),A=e.subarray(16);Ma(U,U),Ce(A,A,U);let k=new Uint8Array(32);return Da(k,A),k}ne.scalarMult=zr;function $i(i){return zr(i,Wi)}ne.scalarMultBase=$i;function Qi(i){if(i.length!==ne.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${ne.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(i);return{publicKey:$i(t),secretKey:t}}ne.generateKeyPairFromSeed=Qi;function za(i){let t=(0,Ia.randomBytes)(32,i),r=Qi(t);return(0,Ba.wipe)(t),r}ne.generateKeyPair=za;function Na(i,t,r=!1){if(i.length!==ne.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(t.length!==ne.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let e=zr(i,t);if(r){let s=0;for(let f=0;f<e.length;f++)s|=e[f];if(s===0)throw new Error("X25519: invalid shared key")}return e}ne.sharedKey=Na});var tn=pe((nr,en)=>{(function(){var i,t=0xdeadbeefcafe,r=(t&16777215)==15715070;function e(n,a,o){n!=null&&(typeof n=="number"?this.fromNumber(n,a,o):a==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,a))}function s(){return new e(null)}function f(n,a,o,h,d,_){for(;--_>=0;){var E=a*this[n++]+o[h]+d;d=Math.floor(E/67108864),o[h++]=E&67108863}return d}function b(n,a,o,h,d,_){for(var E=a&32767,P=a>>15;--_>=0;){var te=this[n]&32767,de=this[n++]>>15,ke=P*te+de*E;te=E*te+((ke&32767)<<15)+o[h]+(d&1073741823),d=(te>>>30)+(ke>>>15)+P*de+(d>>>30),o[h++]=te&1073741823}return d}function u(n,a,o,h,d,_){for(var E=a&16383,P=a>>14;--_>=0;){var te=this[n]&16383,de=this[n++]>>14,ke=P*te+de*E;te=E*te+((ke&16383)<<14)+o[h]+d,d=(te>>28)+(ke>>14)+P*de,o[h++]=te&268435455}return d}var y=typeof navigator<"u";y&&r&&navigator.appName=="Microsoft Internet Explorer"?(e.prototype.am=b,i=30):y&&r&&navigator.appName!="Netscape"?(e.prototype.am=f,i=26):(e.prototype.am=u,i=28),e.prototype.DB=i,e.prototype.DM=(1<<i)-1,e.prototype.DV=1<<i;var x=52;e.prototype.FV=Math.pow(2,x),e.prototype.F1=x-i,e.prototype.F2=2*i-x;var U="0123456789abcdefghijklmnopqrstuvwxyz",A=new Array,k,p;for(k="0".charCodeAt(0),p=0;p<=9;++p)A[k++]=p;for(k="a".charCodeAt(0),p=10;p<36;++p)A[k++]=p;for(k="A".charCodeAt(0),p=10;p<36;++p)A[k++]=p;function H(n){return U.charAt(n)}function T(n,a){var o=A[n.charCodeAt(a)];return o??-1}function O(n){for(var a=this.t-1;a>=0;--a)n[a]=this[a];n.t=this.t,n.s=this.s}function D(n){this.t=1,this.s=n<0?-1:0,n>0?this[0]=n:n<-1?this[0]=n+this.DV:this.t=0}function M(n){var a=s();return a.fromInt(n),a}function L(n,a){var o;if(a==16)o=4;else if(a==8)o=3;else if(a==256)o=8;else if(a==2)o=1;else if(a==32)o=5;else if(a==4)o=2;else{this.fromRadix(n,a);return}this.t=0,this.s=0;for(var h=n.length,d=!1,_=0;--h>=0;){var E=o==8?n[h]&255:T(n,h);if(E<0){n.charAt(h)=="-"&&(d=!0);continue}d=!1,_==0?this[this.t++]=E:_+o>this.DB?(this[this.t-1]|=(E&(1<<this.DB-_)-1)<<_,this[this.t++]=E>>this.DB-_):this[this.t-1]|=E<<_,_+=o,_>=this.DB&&(_-=this.DB)}o==8&&n[0]&128&&(this.s=-1,_>0&&(this[this.t-1]|=(1<<this.DB-_)-1<<_)),this.clamp(),d&&e.ZERO.subTo(this,this)}function I(){for(var n=this.s&this.DM;this.t>0&&this[this.t-1]==n;)--this.t}function z(n){if(this.s<0)return"-"+this.negate().toString(n);var a;if(n==16)a=4;else if(n==8)a=3;else if(n==2)a=1;else if(n==32)a=5;else if(n==4)a=2;else return this.toRadix(n);var o=(1<<a)-1,h,d=!1,_="",E=this.t,P=this.DB-E*this.DB%a;if(E-- >0)for(P<this.DB&&(h=this[E]>>P)>0&&(d=!0,_=H(h));E>=0;)P<a?(h=(this[E]&(1<<P)-1)<<a-P,h|=this[--E]>>(P+=this.DB-a)):(h=this[E]>>(P-=a)&o,P<=0&&(P+=this.DB,--E)),h>0&&(d=!0),d&&(_+=H(h));return d?_:"0"}function N(){var n=s();return e.ZERO.subTo(this,n),n}function c(){return this.s<0?this.negate():this}function l(n){var a=this.s-n.s;if(a!=0)return a;var o=this.t;if(a=o-n.t,a!=0)return this.s<0?-a:a;for(;--o>=0;)if((a=this[o]-n[o])!=0)return a;return 0}function K(n){var a=1,o;return(o=n>>>16)!=0&&(n=o,a+=16),(o=n>>8)!=0&&(n=o,a+=8),(o=n>>4)!=0&&(n=o,a+=4),(o=n>>2)!=0&&(n=o,a+=2),(o=n>>1)!=0&&(n=o,a+=1),a}function B(){return this.t<=0?0:this.DB*(this.t-1)+K(this[this.t-1]^this.s&this.DM)}function m(n,a){var o;for(o=this.t-1;o>=0;--o)a[o+n]=this[o];for(o=n-1;o>=0;--o)a[o]=0;a.t=this.t+n,a.s=this.s}function w(n,a){for(var o=n;o<this.t;++o)a[o-n]=this[o];a.t=Math.max(this.t-n,0),a.s=this.s}function v(n,a){var o=n%this.DB,h=this.DB-o,d=(1<<h)-1,_=Math.floor(n/this.DB),E=this.s<<o&this.DM,P;for(P=this.t-1;P>=0;--P)a[P+_+1]=this[P]>>h|E,E=(this[P]&d)<<o;for(P=_-1;P>=0;--P)a[P]=0;a[_]=E,a.t=this.t+_+1,a.s=this.s,a.clamp()}function g(n,a){a.s=this.s;var o=Math.floor(n/this.DB);if(o>=this.t){a.t=0;return}var h=n%this.DB,d=this.DB-h,_=(1<<h)-1;a[0]=this[o]>>h;for(var E=o+1;E<this.t;++E)a[E-o-1]|=(this[E]&_)<<d,a[E-o]=this[E]>>h;h>0&&(a[this.t-o-1]|=(this.s&_)<<d),a.t=this.t-o,a.clamp()}function C(n,a){for(var o=0,h=0,d=Math.min(n.t,this.t);o<d;)h+=this[o]-n[o],a[o++]=h&this.DM,h>>=this.DB;if(n.t<this.t){for(h-=n.s;o<this.t;)h+=this[o],a[o++]=h&this.DM,h>>=this.DB;h+=this.s}else{for(h+=this.s;o<n.t;)h-=n[o],a[o++]=h&this.DM,h>>=this.DB;h-=n.s}a.s=h<0?-1:0,h<-1?a[o++]=this.DV+h:h>0&&(a[o++]=h),a.t=o,a.clamp()}function R(n,a){var o=this.abs(),h=n.abs(),d=o.t;for(a.t=d+h.t;--d>=0;)a[d]=0;for(d=0;d<h.t;++d)a[d+o.t]=o.am(0,h[d],a,d,0,o.t);a.s=0,a.clamp(),this.s!=n.s&&e.ZERO.subTo(a,a)}function S(n){for(var a=this.abs(),o=n.t=2*a.t;--o>=0;)n[o]=0;for(o=0;o<a.t-1;++o){var h=a.am(o,a[o],n,2*o,0,1);(n[o+a.t]+=a.am(o+1,2*a[o],n,2*o+1,h,a.t-o-1))>=a.DV&&(n[o+a.t]-=a.DV,n[o+a.t+1]=1)}n.t>0&&(n[n.t-1]+=a.am(o,a[o],n,2*o,0,1)),n.s=0,n.clamp()}function j(n,a,o){var h=n.abs();if(!(h.t<=0)){var d=this.abs();if(d.t<h.t){a?.fromInt(0),o!=null&&this.copyTo(o);return}o==null&&(o=s());var _=s(),E=this.s,P=n.s,te=this.DB-K(h[h.t-1]);te>0?(h.lShiftTo(te,_),d.lShiftTo(te,o)):(h.copyTo(_),d.copyTo(o));var de=_.t,ke=_[de-1];if(ke!=0){var Ee=ke*(1<<this.F1)+(de>1?_[de-2]>>this.F2:0),Me=this.FV/Ee,Pt=(1<<this.F1)/Ee,Ke=1<<this.F2,Ue=o.t,At=Ue-de,je=a??s();for(_.dlShiftTo(At,je),o.compareTo(je)>=0&&(o[o.t++]=1,o.subTo(je,o)),e.ONE.dlShiftTo(de,je),je.subTo(_,_);_.t<de;)_[_.t++]=0;for(;--At>=0;){var vr=o[--Ue]==ke?this.DM:Math.floor(o[Ue]*Me+(o[Ue-1]+Ke)*Pt);if((o[Ue]+=_.am(0,vr,o,At,0,de))<vr)for(_.dlShiftTo(At,je),o.subTo(je,o);o[Ue]<--vr;)o.subTo(je,o)}a!=null&&(o.drShiftTo(de,a),E!=P&&e.ZERO.subTo(a,a)),o.t=de,o.clamp(),te>0&&o.rShiftTo(te,o),E<0&&e.ZERO.subTo(o,o)}}}function ee(n){var a=s();return this.abs().divRemTo(n,null,a),this.s<0&&a.compareTo(e.ZERO)>0&&n.subTo(a,a),a}function G(n){this.m=n}function Y(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function X(n){return n}function Z(n){n.divRemTo(this.m,null,n)}function V(n,a,o){n.multiplyTo(a,o),this.reduce(o)}function W(n,a){n.squareTo(a),this.reduce(a)}G.prototype.convert=Y,G.prototype.revert=X,G.prototype.reduce=Z,G.prototype.mulTo=V,G.prototype.sqrTo=W;function $(){if(this.t<1)return 0;var n=this[0];if(!(n&1))return 0;var a=n&3;return a=a*(2-(n&15)*a)&15,a=a*(2-(n&255)*a)&255,a=a*(2-((n&65535)*a&65535))&65535,a=a*(2-n*a%this.DV)%this.DV,a>0?this.DV-a:-a}function q(n){this.m=n,this.mp=n.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}function ie(n){var a=s();return n.abs().dlShiftTo(this.m.t,a),a.divRemTo(this.m,null,a),n.s<0&&a.compareTo(e.ZERO)>0&&this.m.subTo(a,a),a}function oe(n){var a=s();return n.copyTo(a),this.reduce(a),a}function fe(n){for(;n.t<=this.mt2;)n[n.t++]=0;for(var a=0;a<this.m.t;++a){var o=n[a]&32767,h=o*this.mpl+((o*this.mph+(n[a]>>15)*this.mpl&this.um)<<15)&n.DM;for(o=a+this.m.t,n[o]+=this.m.am(0,h,n,a,0,this.m.t);n[o]>=n.DV;)n[o]-=n.DV,n[++o]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function he(n,a){n.squareTo(a),this.reduce(a)}function se(n,a,o){n.multiplyTo(a,o),this.reduce(o)}q.prototype.convert=ie,q.prototype.revert=oe,q.prototype.reduce=fe,q.prototype.mulTo=se,q.prototype.sqrTo=he;function ue(){return(this.t>0?this[0]&1:this.s)==0}function ce(n,a){if(n>4294967295||n<1)return e.ONE;var o=s(),h=s(),d=a.convert(this),_=K(n)-1;for(d.copyTo(o);--_>=0;)if(a.sqrTo(o,h),(n&1<<_)>0)a.mulTo(h,d,o);else{var E=o;o=h,h=E}return a.revert(o)}function le(n,a){var o;return n<256||a.isEven()?o=new G(a):o=new q(a),this.exp(n,o)}e.prototype.copyTo=O,e.prototype.fromInt=D,e.prototype.fromString=L,e.prototype.clamp=I,e.prototype.dlShiftTo=m,e.prototype.drShiftTo=w,e.prototype.lShiftTo=v,e.prototype.rShiftTo=g,e.prototype.subTo=C,e.prototype.multiplyTo=R,e.prototype.squareTo=S,e.prototype.divRemTo=j,e.prototype.invDigit=$,e.prototype.isEven=ue,e.prototype.exp=ce,e.prototype.toString=z,e.prototype.negate=N,e.prototype.abs=c,e.prototype.compareTo=l,e.prototype.bitLength=B,e.prototype.mod=ee,e.prototype.modPowInt=le,e.ZERO=M(0),e.ONE=M(1);function un(){var n=s();return this.copyTo(n),n}function cn(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ln(){return this.t==0?this.s:this[0]<<24>>24}function bn(){return this.t==0?this.s:this[0]<<16>>16}function dn(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function pn(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function yn(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var a=this.chunkSize(n),o=Math.pow(n,a),h=M(o),d=s(),_=s(),E="";for(this.divRemTo(h,d,_);d.signum()>0;)E=(o+_.intValue()).toString(n).substr(1)+E,d.divRemTo(h,d,_);return _.intValue().toString(n)+E}function _n(n,a){this.fromInt(0),a==null&&(a=10);for(var o=this.chunkSize(a),h=Math.pow(a,o),d=!1,_=0,E=0,P=0;P<n.length;++P){var te=T(n,P);if(te<0){n.charAt(P)=="-"&&this.signum()==0&&(d=!0);continue}E=a*E+te,++_>=o&&(this.dMultiply(h),this.dAddOffset(E,0),_=0,E=0)}_>0&&(this.dMultiply(Math.pow(a,_)),this.dAddOffset(E,0)),d&&e.ZERO.subTo(this,this)}function wn(n,a,o){if(typeof a=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,o),this.testBit(n-1)||this.bitwiseTo(e.ONE.shiftLeft(n-1),pr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(a);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(e.ONE.shiftLeft(n-1),this);else{var h=new Array,d=n&7;h.length=(n>>3)+1,a.nextBytes(h),d>0?h[0]&=(1<<d)-1:h[0]=0,this.fromString(h,256)}}function vn(){var n=this.t,a=new Array;a[0]=this.s;var o=this.DB-n*this.DB%8,h,d=0;if(n-- >0)for(o<this.DB&&(h=this[n]>>o)!=(this.s&this.DM)>>o&&(a[d++]=h|this.s<<this.DB-o);n>=0;)o<8?(h=(this[n]&(1<<o)-1)<<8-o,h|=this[--n]>>(o+=this.DB-8)):(h=this[n]>>(o-=8)&255,o<=0&&(o+=this.DB,--n)),h&128&&(h|=-256),d==0&&(this.s&128)!=(h&128)&&++d,(d>0||h!=this.s)&&(a[d++]=h);return a}function xn(n){return this.compareTo(n)==0}function mn(n){return this.compareTo(n)<0?this:n}function gn(n){return this.compareTo(n)>0?this:n}function En(n,a,o){var h,d,_=Math.min(n.t,this.t);for(h=0;h<_;++h)o[h]=a(this[h],n[h]);if(n.t<this.t){for(d=n.s&this.DM,h=_;h<this.t;++h)o[h]=a(this[h],d);o.t=this.t}else{for(d=this.s&this.DM,h=_;h<n.t;++h)o[h]=a(d,n[h]);o.t=n.t}o.s=a(this.s,n.s),o.clamp()}function Sn(n,a){return n&a}function Pn(n){var a=s();return this.bitwiseTo(n,Sn,a),a}function pr(n,a){return n|a}function An(n){var a=s();return this.bitwiseTo(n,pr,a),a}function Cr(n,a){return n^a}function kn(n){var a=s();return this.bitwiseTo(n,Cr,a),a}function jr(n,a){return n&~a}function Ln(n){var a=s();return this.bitwiseTo(n,jr,a),a}function Tn(){for(var n=s(),a=0;a<this.t;++a)n[a]=this.DM&~this[a];return n.t=this.t,n.s=~this.s,n}function Kn(n){var a=s();return n<0?this.rShiftTo(-n,a):this.lShiftTo(n,a),a}function Un(n){var a=s();return n<0?this.lShiftTo(-n,a):this.rShiftTo(n,a),a}function In(n){if(n==0)return-1;var a=0;return n&65535||(n>>=16,a+=16),n&255||(n>>=8,a+=8),n&15||(n>>=4,a+=4),n&3||(n>>=2,a+=2),n&1||++a,a}function Bn(){for(var n=0;n<this.t;++n)if(this[n]!=0)return n*this.DB+In(this[n]);return this.s<0?this.t*this.DB:-1}function Hn(n){for(var a=0;n!=0;)n&=n-1,++a;return a}function Dn(){for(var n=0,a=this.s&this.DM,o=0;o<this.t;++o)n+=Hn(this[o]^a);return n}function On(n){var a=Math.floor(n/this.DB);return a>=this.t?this.s!=0:(this[a]&1<<n%this.DB)!=0}function Mn(n,a){var o=e.ONE.shiftLeft(n);return this.bitwiseTo(o,a,o),o}function zn(n){return this.changeBit(n,pr)}function Nn(n){return this.changeBit(n,jr)}function Rn(n){return this.changeBit(n,Cr)}function Cn(n,a){for(var o=0,h=0,d=Math.min(n.t,this.t);o<d;)h+=this[o]+n[o],a[o++]=h&this.DM,h>>=this.DB;if(n.t<this.t){for(h+=n.s;o<this.t;)h+=this[o],a[o++]=h&this.DM,h>>=this.DB;h+=this.s}else{for(h+=this.s;o<n.t;)h+=n[o],a[o++]=h&this.DM,h>>=this.DB;h+=n.s}a.s=h<0?-1:0,h>0?a[o++]=h:h<-1&&(a[o++]=this.DV+h),a.t=o,a.clamp()}function jn(n){var a=s();return this.addTo(n,a),a}function Gn(n){var a=s();return this.subTo(n,a),a}function qn(n){var a=s();return this.multiplyTo(n,a),a}function Fn(){var n=s();return this.squareTo(n),n}function Vn(n){var a=s();return this.divRemTo(n,a,null),a}function Yn(n){var a=s();return this.divRemTo(n,null,a),a}function Xn(n){var a=s(),o=s();return this.divRemTo(n,a,o),new Array(a,o)}function Zn(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function Wn(n,a){if(n!=0){for(;this.t<=a;)this[this.t++]=0;for(this[a]+=n;this[a]>=this.DV;)this[a]-=this.DV,++a>=this.t&&(this[this.t++]=0),++this[a]}}function yt(){}function Gr(n){return n}function $n(n,a,o){n.multiplyTo(a,o)}function Qn(n,a){n.squareTo(a)}yt.prototype.convert=Gr,yt.prototype.revert=Gr,yt.prototype.mulTo=$n,yt.prototype.sqrTo=Qn;function Jn(n){return this.exp(n,new yt)}function es(n,a,o){var h=Math.min(this.t+n.t,a);for(o.s=0,o.t=h;h>0;)o[--h]=0;var d;for(d=o.t-this.t;h<d;++h)o[h+this.t]=this.am(0,n[h],o,h,0,this.t);for(d=Math.min(n.t,a);h<d;++h)this.am(0,n[h],o,h,0,a-h);o.clamp()}function ts(n,a,o){--a;var h=o.t=this.t+n.t-a;for(o.s=0;--h>=0;)o[h]=0;for(h=Math.max(a-this.t,0);h<n.t;++h)o[this.t+h-a]=this.am(a-h,n[h],o,0,0,this.t+h-a);o.clamp(),o.drShiftTo(1,o)}function Ye(n){this.r2=s(),this.q3=s(),e.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function rs(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var a=s();return n.copyTo(a),this.reduce(a),a}function is(n){return n}function ns(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function ss(n,a){n.squareTo(a),this.reduce(a)}function as(n,a,o){n.multiplyTo(a,o),this.reduce(o)}Ye.prototype.convert=rs,Ye.prototype.revert=is,Ye.prototype.reduce=ns,Ye.prototype.mulTo=as,Ye.prototype.sqrTo=ss;function os(n,a){var o=n.bitLength(),h,d=M(1),_;if(o<=0)return d;o<18?h=1:o<48?h=3:o<144?h=4:o<768?h=5:h=6,o<8?_=new G(a):a.isEven()?_=new Ye(a):_=new q(a);var E=new Array,P=3,te=h-1,de=(1<<h)-1;if(E[1]=_.convert(this),h>1){var ke=s();for(_.sqrTo(E[1],ke);P<=de;)E[P]=s(),_.mulTo(ke,E[P-2],E[P]),P+=2}var Ee=n.t-1,Me,Pt=!0,Ke=s(),Ue;for(o=K(n[Ee])-1;Ee>=0;){for(o>=te?Me=n[Ee]>>o-te&de:(Me=(n[Ee]&(1<<o+1)-1)<<te-o,Ee>0&&(Me|=n[Ee-1]>>this.DB+o-te)),P=h;!(Me&1);)Me>>=1,--P;if((o-=P)<0&&(o+=this.DB,--Ee),Pt)E[Me].copyTo(d),Pt=!1;else{for(;P>1;)_.sqrTo(d,Ke),_.sqrTo(Ke,d),P-=2;P>0?_.sqrTo(d,Ke):(Ue=d,d=Ke,Ke=Ue),_.mulTo(Ke,E[Me],d)}for(;Ee>=0&&!(n[Ee]&1<<o);)_.sqrTo(d,Ke),Ue=d,d=Ke,Ke=Ue,--o<0&&(o=this.DB-1,--Ee)}return _.revert(d)}function fs(n){var a=this.s<0?this.negate():this.clone(),o=n.s<0?n.negate():n.clone();if(a.compareTo(o)<0){var h=a;a=o,o=h}var d=a.getLowestSetBit(),_=o.getLowestSetBit();if(_<0)return a;for(d<_&&(_=d),_>0&&(a.rShiftTo(_,a),o.rShiftTo(_,o));a.signum()>0;)(d=a.getLowestSetBit())>0&&a.rShiftTo(d,a),(d=o.getLowestSetBit())>0&&o.rShiftTo(d,o),a.compareTo(o)>=0?(a.subTo(o,a),a.rShiftTo(1,a)):(o.subTo(a,o),o.rShiftTo(1,o));return _>0&&o.lShiftTo(_,o),o}function hs(n){if(n<=0)return 0;var a=this.DV%n,o=this.s<0?n-1:0;if(this.t>0)if(a==0)o=this[0]%n;else for(var h=this.t-1;h>=0;--h)o=(a*o+this[h])%n;return o}function us(n){var a=n.isEven();if(this.isEven()&&a||n.signum()==0)return e.ZERO;for(var o=n.clone(),h=this.clone(),d=M(1),_=M(0),E=M(0),P=M(1);o.signum()!=0;){for(;o.isEven();)o.rShiftTo(1,o),a?((!d.isEven()||!_.isEven())&&(d.addTo(this,d),_.subTo(n,_)),d.rShiftTo(1,d)):_.isEven()||_.subTo(n,_),_.rShiftTo(1,_);for(;h.isEven();)h.rShiftTo(1,h),a?((!E.isEven()||!P.isEven())&&(E.addTo(this,E),P.subTo(n,P)),E.rShiftTo(1,E)):P.isEven()||P.subTo(n,P),P.rShiftTo(1,P);o.compareTo(h)>=0?(o.subTo(h,o),a&&d.subTo(E,d),_.subTo(P,_)):(h.subTo(o,h),a&&E.subTo(d,E),P.subTo(_,P))}if(h.compareTo(e.ONE)!=0)return e.ZERO;if(P.compareTo(n)>=0)return P.subtract(n);if(P.signum()<0)P.addTo(n,P);else return P;return P.signum()<0?P.add(n):P}var we=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],cs=(1<<26)/we[we.length-1];function ls(n){var a,o=this.abs();if(o.t==1&&o[0]<=we[we.length-1]){for(a=0;a<we.length;++a)if(o[0]==we[a])return!0;return!1}if(o.isEven())return!1;for(a=1;a<we.length;){for(var h=we[a],d=a+1;d<we.length&&h<cs;)h*=we[d++];for(h=o.modInt(h);a<d;)if(h%we[a++]==0)return!1}return o.millerRabin(n)}function bs(n){var a=this.subtract(e.ONE),o=a.getLowestSetBit();if(o<=0)return!1;var h=a.shiftRight(o);n=n+1>>1,n>we.length&&(n=we.length);for(var d=s(),_=0;_<n;++_){d.fromInt(we[Math.floor(Math.random()*we.length)]);var E=d.modPow(h,this);if(E.compareTo(e.ONE)!=0&&E.compareTo(a)!=0){for(var P=1;P++<o&&E.compareTo(a)!=0;)if(E=E.modPowInt(2,this),E.compareTo(e.ONE)==0)return!1;if(E.compareTo(a)!=0)return!1}}return!0}e.prototype.chunkSize=dn,e.prototype.toRadix=yn,e.prototype.fromRadix=_n,e.prototype.fromNumber=wn,e.prototype.bitwiseTo=En,e.prototype.changeBit=Mn,e.prototype.addTo=Cn,e.prototype.dMultiply=Zn,e.prototype.dAddOffset=Wn,e.prototype.multiplyLowerTo=es,e.prototype.multiplyUpperTo=ts,e.prototype.modInt=hs,e.prototype.millerRabin=bs,e.prototype.clone=un,e.prototype.intValue=cn,e.prototype.byteValue=ln,e.prototype.shortValue=bn,e.prototype.signum=pn,e.prototype.toByteArray=vn,e.prototype.equals=xn,e.prototype.min=mn,e.prototype.max=gn,e.prototype.and=Pn,e.prototype.or=An,e.prototype.xor=kn,e.prototype.andNot=Ln,e.prototype.not=Tn,e.prototype.shiftLeft=Kn,e.prototype.shiftRight=Un,e.prototype.getLowestSetBit=Bn,e.prototype.bitCount=Dn,e.prototype.testBit=On,e.prototype.setBit=zn,e.prototype.clearBit=Nn,e.prototype.flipBit=Rn,e.prototype.add=jn,e.prototype.subtract=Gn,e.prototype.multiply=qn,e.prototype.divide=Vn,e.prototype.remainder=Yn,e.prototype.divideAndRemainder=Xn,e.prototype.modPow=os,e.prototype.modInverse=us,e.prototype.pow=Jn,e.prototype.gcd=fs,e.prototype.isProbablePrime=ls,e.prototype.square=Fn,e.prototype.Barrett=Ye;var St,ge,be;function ds(n){ge[be++]^=n&255,ge[be++]^=n>>8&255,ge[be++]^=n>>16&255,ge[be++]^=n>>24&255,be>=wr&&(be-=wr)}function qr(){ds(new Date().getTime())}if(ge==null){ge=new Array,be=0;var Te;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var Fr=new Uint8Array(32);for(window.crypto.getRandomValues(Fr),Te=0;Te<32;++Te)ge[be++]=Fr[Te]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Vr=window.crypto.random(32);for(Te=0;Te<Vr.length;++Te)ge[be++]=Vr.charCodeAt(Te)&255}}for(;be<wr;)Te=Math.floor(65536*Math.random()),ge[be++]=Te>>>8,ge[be++]=Te&255;be=0,qr()}function ps(){if(St==null){for(qr(),St=vs(),St.init(ge),be=0;be<ge.length;++be)ge[be]=0;be=0}return St.next()}function ys(n){var a;for(a=0;a<n.length;++a)n[a]=ps()}function yr(){}yr.prototype.nextBytes=ys;function _r(){this.i=0,this.j=0,this.S=new Array}function _s(n){var a,o,h;for(a=0;a<256;++a)this.S[a]=a;for(o=0,a=0;a<256;++a)o=o+this.S[a]+n[a%n.length]&255,h=this.S[a],this.S[a]=this.S[o],this.S[o]=h;this.i=0,this.j=0}function ws(){var n;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,n=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=n,this.S[n+this.S[this.i]&255]}_r.prototype.init=_s,_r.prototype.next=ws;function vs(){return new _r}var wr=256;typeof nr<"u"?nr=en.exports={default:e,BigInteger:e,SecureRandom:yr}:this.jsbn={BigInteger:e,SecureRandom:yr}}).call(nr)});var ve=class extends Error{constructor(t){let r;t instanceof Error?r=t.message:typeof t=="string"?r=t:r="",super(r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}},Se=class extends ve{},Zr=class extends ve{},kt=class extends ve{},tt=class extends ve{},Lt=class extends ve{},Tt=class extends ve{},Kt=class extends ve{},Xe=class extends ve{},Ze=class extends ve{},Ut=class extends ve{},It=class extends ve{},Le=class extends ve{};var Ie;(function(i){i[i.Base=0]="Base",i[i.Psk=1]="Psk",i[i.Auth=2]="Auth",i[i.AuthPsk=3]="AuthPsk"})(Ie||(Ie={}));var Q;(function(i){i[i.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",i[i.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",i[i.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",i[i.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",i[i.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512"})(Q||(Q={}));var Pe;(function(i){i[i.HkdfSha256=1]="HkdfSha256",i[i.HkdfSha384=2]="HkdfSha384",i[i.HkdfSha512=3]="HkdfSha512"})(Pe||(Pe={}));var ae;(function(i){i[i.Aes128Gcm=1]="Aes128Gcm",i[i.Aes256Gcm=2]="Aes256Gcm",i[i.Chacha20Poly1305=3]="Chacha20Poly1305",i[i.ExportOnly=65535]="ExportOnly"})(ae||(ae={}));var As={},Wr=ks(globalThis,As);function ks(i,t){return new Proxy(i,{get(r,e,s){return e in t?t[e]:i[e]},set(r,e,s){return e in t&&delete t[e],i[e]=s,!0},deleteProperty(r,e){let s=!1;return e in t&&(delete t[e],s=!0),e in i&&(delete i[e],s=!0),s},ownKeys(r){let e=Reflect.ownKeys(i),s=Reflect.ownKeys(t),f=new Set(s);return[...e.filter(b=>!f.has(b)),...s]},defineProperty(r,e,s){return e in t&&delete t[e],Reflect.defineProperty(i,e,s),!0},getOwnPropertyDescriptor(r,e){return e in t?Reflect.getOwnPropertyDescriptor(t,e):Reflect.getOwnPropertyDescriptor(i,e)},has(r,e){return e in t||e in i}})}var xr=()=>typeof Wr<"u",mr=()=>typeof caches<"u";var _t=i=>typeof i=="object"&&i!==null&&typeof i.privateKey=="object"&&typeof i.publicKey=="object";function xe(i,t){if(t<=0)throw new Error("i2Osp: too small size");if(i>=256**t)throw new Error("i2Osp: too large integer");let r=new Uint8Array(t);for(let e=0;e<t&&i;e++)r[t-(e+1)]=i%256,i=i>>8;return r}function $r(i,t){if(i.byteLength!==t.byteLength)throw new Error("xor: different length inputs");let r=new Uint8Array(i.byteLength);for(let e=0;e<i.byteLength;e++)r[e]=i[e]^t[e];return r}function wt(i,t){let r=new Uint8Array(i.length+t.length);return r.set(i,0),r.set(t,i.length),r}function Qr(i,t,r){let e=new Uint8Array(i.length+t.length+r.length);return e.set(i,0),e.set(t,i.length),e.set(r,i.length+t.length),e}var qe=class{constructor(t){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=t}};async function Jr(){if((xr()||mr())&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:i}=await import("crypto");return i}catch{throw new Le("Web Cryptograph API not supported")}}async function ei(){if((xr()||mr())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:i}=await import("crypto");return i.subtle}catch{throw new Le("Web Cryptograph API not supported")}}var Fe=["deriveBits"],ti=["encrypt","decrypt"];var J=new Uint8Array(0),gr=new Uint8Array([72,80,75,69,45,118,49]),ri=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),rt=new Uint8Array([75,69,77,0,0]),it=new Uint8Array([100,107,112,95,112,114,107]),ii=new Uint8Array([101,97,101,95,112,114,107]),ni=new Uint8Array([105,110,102,111,95,104,97,115,104]),si=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),ai=new Uint8Array([115,101,99,114,101,116]),oi=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),fi=new Uint8Array([107,101,121]),hi=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),ui=new Uint8Array([101,120,112]),ci=new Uint8Array([115,101,99]),li=new Uint8Array([99,97,110,100,105,100,97,116,101]),Bt=new Uint8Array([115,107]),bi=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),di=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),pi=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var nt=class extends qe{constructor(t,r,e){super(t),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=r,this.exporterSecret=e}async seal(t,r){return await this._emitError1()}async open(t,r){return await this._emitError1()}async setupBidirectional(t,r){return await this._emitError2()}async export(t,r){if(t.byteLength>128)throw new Se("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,ci,new Uint8Array(t),r)}catch(e){throw new Kt(e)}}_emitError1(){return new Promise((t,r)=>{r(new Le("Not available on export-only mode"))})}_emitError2(){return new Promise((t,r)=>{r(new Le("Not available on export-only mode"))})}},Ht=class extends nt{},Dt=class extends nt{constructor(t,r,e,s){super(t,r,e),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=s}};var Ot=class{constructor(t,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=t,this._api=r}async seal(t,r,e){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let s={name:"AES-GCM",iv:t,additionalData:e};return await this._api.encrypt(s,this._key,r)}async open(t,r,e){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let s={name:"AES-GCM",iv:t,additionalData:e};return await this._api.decrypt(s,this._key,r)}async importKey(t){return await this._api.importKey("raw",t,{name:"AES-GCM"},!0,ti)}},Mt=class extends Ot{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}},zt=class extends Ot{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var Ki=et(Ti(),1);var Ft=class{constructor(t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ae.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Ki.ChaCha20Poly1305(new Uint8Array(t))}async seal(t,r,e){return await this._seal(t,r,e)}async open(t,r,e){return await this._open(t,r,e)}_seal(t,r,e){return new Promise(s=>{let f=this._key.seal(new Uint8Array(t),new Uint8Array(r),new Uint8Array(e));s(f.buffer)})}_open(t,r,e){return new Promise((s,f)=>{let b=this._key.open(new Uint8Array(t),new Uint8Array(r),new Uint8Array(e));b instanceof Uint8Array?s(b.buffer):f(new Error("failed to open."))})}};var ft=class extends nt{constructor(t,r,e){if(super(t,r,e.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.key===void 0||e.baseNonce===void 0||e.seq===void 0)throw new Error("Required parameters are missing");switch(this._aead=e.aead,this._aead){case ae.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case ae.Aes256Gcm:this._nK=32,this._nN=12,this._nT=16;break;case ae.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0;break}let s=Vt(this._aead,e.key,this._api);this._f={key:s,baseNonce:e.baseNonce,seq:e.seq},this._r={key:s,baseNonce:J,seq:0}}computeNonce(t){let r=xe(t.seq,t.baseNonce.byteLength);return $r(t.baseNonce,r)}incrementSeq(t){if(t.seq>Number.MAX_SAFE_INTEGER)throw new Ut("Message limit reached");t.seq+=1}async setupBidirectional(t,r){try{this._r.baseNonce=new Uint8Array(await this.export(r,this._nN));let e=await this.export(t,this._nK);this._r.key=Vt(this._aead,e,this._api),this._r.seq=0}catch(e){throw this._r.baseNonce=J,e}}};function Vt(i,t,r){switch(i){case ae.Aes128Gcm:return new Mt(t,r);case ae.Aes256Gcm:return new zt(t,r);case ae.Chacha20Poly1305:return new Ft(t);default:throw new Error("Invalid or unsupported AEAD id")}}var Ir=et(Bi(),1),Ni=et(Di(),1),Ri=et(zi(),1);var mt=class extends qe{constructor(t,r){super(t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=r}buildLabeledIkm(t,r){let e=new Uint8Array(7+this.suiteId.byteLength+t.byteLength+r.byteLength);return e.set(gr,0),e.set(this.suiteId,7),e.set(t,7+this.suiteId.byteLength),e.set(r,7+this.suiteId.byteLength+t.byteLength),e}buildLabeledInfo(t,r,e){let s=new Uint8Array(9+this.suiteId.byteLength+t.byteLength+r.byteLength);return s.set(new Uint8Array([0,e]),0),s.set(gr,2),s.set(this.suiteId,9),s.set(t,9+this.suiteId.byteLength),s.set(r,9+this.suiteId.byteLength+t.byteLength),s}async extract(t,r){if(t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return(0,Ir.hmac)(Ni.SHA256,new Uint8Array(t),new Uint8Array(r));case"SHA-512":return(0,Ir.hmac)(Ri.SHA512,new Uint8Array(t),new Uint8Array(r));default:throw new Le(`${this.algHash.hash} key length should be ${this.hashSize}.`)}let e=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",e,r)}async expand(t,r,e){let s=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),f=new ArrayBuffer(e),b=new Uint8Array(f),u=J,y=new Uint8Array(r),x=new Uint8Array(1);if(e>255*this.hashSize)throw new Error("Entropy limit reached");let U=new Uint8Array(this.hashSize+y.length+1);for(let A=1,k=0;k<b.length;A++)x[0]=A,U.set(u,0),U.set(y,u.length),U.set(x,u.length+y.length),u=new Uint8Array(await this._api.sign("HMAC",s,U.slice(0,u.length+y.length+1))),b.length-k>=u.length?(b.set(u,k),k+=u.length):(b.set(u.slice(0,b.length-k),k),k+=b.length-k);return f}async extractAndExpand(t,r,e,s){let f=await this._api.importKey("raw",r,"HKDF",!1,Fe);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:e},f,s*8)}async labeledExtract(t,r,e){return await this.extract(t,this.buildLabeledIkm(r,e))}async labeledExpand(t,r,e,s){return await this.expand(t,this.buildLabeledInfo(r,e,s),s)}},We=class extends mt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Pe.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},ct=class extends mt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Pe.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},$e=class extends mt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Pe.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var Zt=class extends ft{async seal(t,r=J){if(this._r.baseNonce.length===0)throw new Xe("Bidirectional encryption is not setup");let e;try{e=await this._r.key.seal(this.computeNonce(this._r),t,r)}catch(s){throw new Xe(s)}return this.incrementSeq(this._r),e}async open(t,r=J){let e;try{e=await this._f.key.open(this.computeNonce(this._f),t,r)}catch(s){throw new Ze(s)}return this.incrementSeq(this._f),e}};var Wt=class extends ft{constructor(t,r,e,s){super(t,r,e),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=s}async seal(t,r=J){let e;try{e=await this._f.key.seal(this.computeNonce(this._f),t,r)}catch(s){throw new Xe(s)}return this.incrementSeq(this._f),e}async open(t,r=J){if(this._r.baseNonce.length===0)throw new Ze("Bidirectional encryption is not setup");let e;try{e=await this._r.key.open(this.computeNonce(this._r),t,r)}catch(s){throw new Ze(s)}return this.incrementSeq(this._r),e}};var $t=class{constructor(t){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(t)}val(){return this._num}reset(){this._num.fill(0)}set(t){if(t.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(t)}isZero(){for(let t=0;t<this._num.length;t++)if(this._num[t]!==0)return!1;return!0}lessThan(t){if(t.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let r=0;r<this._num.length;r++){if(this._num[r]<t[r])return!0;if(this._num[r]>t[r])return!1}return!1}};var ga=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),Ea=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Sa=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),lt=class{constructor(t,r,e){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=r,this._api=e,t){case Q.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=bi,this._bitmask=255,this._pkcs8AlgId=ga;break;case Q.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=di,this._bitmask=255,this._pkcs8AlgId=Ea;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=pi,this._bitmask=1,this._pkcs8AlgId=Sa;break}}async serializePublicKey(t){let r=await this._api.exportKey("raw",t);if(r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");return r}async deserializePublicKey(t){if(t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",t,this._alg,!0,[])}catch{throw new Error("Invalid public key for the ciphersuite")}}async importKey(t,r,e){if(t!=="raw")throw new Error("Unsupported format");if(e&&r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!e&&r.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");try{if(e)return await this._api.importKey(t,r,this._alg,!0,[]);let s=new Uint8Array(r),f=new Uint8Array(this._pkcs8AlgId.length+s.length);return f.set(this._pkcs8AlgId,0),f.set(s,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",f,this._alg,!0,Fe)}catch{throw new Error("Invalid key for the ciphersuite")}}async derivePublicKey(t){let r=await this._api.exportKey("jwk",t);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,Fe)}async deriveKeyPair(t){let r=await this._hkdf.labeledExtract(J,it,new Uint8Array(t)),e=new $t(this._nSk);for(let b=0;e.isZero()||!e.lessThan(this._order);b++){if(b>255)throw new Error("Faild to derive a key pair");let u=new Uint8Array(await this._hkdf.labeledExpand(r,li,xe(b,1),this._nSk));u[0]=u[0]&this._bitmask,e.set(u)}let s=new Uint8Array(this._pkcs8AlgId.length+e.val().length);s.set(this._pkcs8AlgId,0),s.set(e.val(),this._pkcs8AlgId.length);let f=await this._api.importKey("pkcs8",s,this._alg,!0,Fe);return e.reset(),{privateKey:f,publicKey:await this.derivePublicKey(f)}}async dh(t,r){return await this._api.deriveBits({name:"ECDH",public:r},t,this._nDh*8)}};var dt=et(Ji(),1);var me=class{constructor(t,r,e){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:Fe}),this.key=r,this.type=e,this.algorithm={name:t}}};var bt="X25519",ir=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=32,this._nSk=32}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,r,e){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(r,e)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=await(0,dt.generateKeyPair)();return{publicKey:new me(bt,t.publicKey,"public"),privateKey:new me(bt,t.secretKey,"private")}}async deriveKeyPair(t){let r=await this._hkdf.labeledExtract(J,it,new Uint8Array(t)),e=await this._hkdf.labeledExpand(r,Bt,J,this._nSk),s=new me(bt,new Uint8Array(e),"private");return{privateKey:s,publicKey:await this.derivePublicKey(s)}}async dh(t,r){return await this._dh(t,r)}_serializePublicKey(t){return new Promise(r=>{r(t.key.buffer)})}_deserializePublicKey(t){return new Promise((r,e)=>{t.byteLength!==this._nPk?e(new Error("Invalid public key for the ciphersuite")):r(new me(bt,new Uint8Array(t),"public"))})}_importKey(t,r){return new Promise((e,s)=>{r&&t.byteLength!==this._nPk&&s(new Error("Invalid public key for the ciphersuite")),!r&&t.byteLength!==this._nSk&&s(new Error("Invalid private key for the ciphersuite")),e(new me(bt,new Uint8Array(t),r?"public":"private"))})}_derivePublicKey(t){return new Promise(r=>{r(new me(bt,(0,dt.scalarMultBase)(t.key),"public"))})}_dh(t,r){return new Promise((e,s)=>{try{e((0,dt.sharedKey)(t.key,r.key,!0))}catch(f){s(f)}})}};var pt=et(tn());function Qe(i){return new pt.BigInteger(i.toString(10))}var or=pt.BigInteger.ZERO,Nr=pt.BigInteger.ONE,Ra=Qe(2),Ca=Qe(3),ja=Qe(5),Ga=Qe(128),qa=Qe(255);function sr(i){return i.multiply(i)}var re=new pt.BigInteger("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439"),Fa=new pt.BigInteger("39081");function ar(i,t,r){var e=i.multiply(t.subtract(r)).mod(re);return[t.subtract(e).mod(re),r.add(e).mod(re)]}function rn(i,t){for(var r=t,e=Nr,s=or,f=t,b=Nr,u=or,y=448-1;y>=0;--y){var x=i.shiftRight(y).and(Nr);u=u.xor(x);{var U=ar(u,e,f),A=U[0],k=U[1];e=A,f=k}{var p=ar(u,s,b),H=p[0],T=p[1];s=H,b=T}u=x;var O=e.add(s).mod(re),D=sr(O).mod(re),M=e.subtract(s).mod(re),L=sr(M).mod(re),I=D.subtract(L).mod(re),z=f.add(b).mod(re),N=f.subtract(b).mod(re),c=N.multiply(O).mod(re),l=z.multiply(M).mod(re);f=sr(c.add(l).mod(re)).mod(re),b=r.multiply(sr(c.subtract(l).mod(re))).mod(re),e=D.multiply(L).mod(re),s=I.multiply(D.add(Fa.multiply(I).mod(re)).mod(re)).mod(re)}var K=ar(u,e,f),B=K[0],m=ar(u,s,b),w=m[0];return B.multiply(w.modPow(re.subtract(Ra),re)).mod(re)}function Va(i){return i.map(function(t,r){return Qe(t).shiftLeft(8*r)}).reduce(function(t,r){return t.add(r)},or)}function nn(i){var t=[].concat(i);return t[0]&=252,t[55]|=128,Va(t)}function Ya(i){if(i.length!==56)throw new Error("Invalid Curve448 scalar (len="+i.length+")");return i.map(function(t,r){return Qe(t).shiftLeft(8*r)}).reduce(function(t,r){return t.add(r)},or)}function sn(i){return Array.from({length:56},function(t,r){return i.shiftRight(8*r).and(qa).intValue()})}function an(i){return i.andNot(Ca).or(Ga.shiftLeft(8*55))}function Xa(i,t){var r=an(nn(i)),e=Ya(t);return sn(rn(r,e))}function Za(i){var t=an(nn(i));return sn(rn(t,ja))}function on(i){if(!i)throw new Error("Missing private key");if(i.length!==56)throw new Error("Invalid Curve448 private key (len="+i.length+")");return Za(Array.from(i))}function fn(i,t){if(!i)throw new Error("Missing private key");if(!t)throw new Error("Missing public key");if(i.length!==56)throw new Error("Invalid Curve448 private key (len="+i.length+")");var r=Xa(Array.from(i),Array.from(t));if(!r.some(function(e){return e}))throw new Error("Invalid Curve448 public key");return r}var fr="X448",hr=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=56,this._nSk=56}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,r,e){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(r,e)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=new Uint8Array(56);return(await Jr()).getRandomValues(t),await this.deriveKeyPair(t)}async deriveKeyPair(t){let r=await this._hkdf.labeledExtract(J,it,new Uint8Array(t)),e=await this._hkdf.labeledExpand(r,Bt,J,this._nSk),s=new me(fr,new Uint8Array(e),"private");return{privateKey:s,publicKey:await this.derivePublicKey(s)}}async dh(t,r){return await this._dh(t,r)}_serializePublicKey(t){return new Promise(r=>{r(t.key.buffer)})}_deserializePublicKey(t){return new Promise((r,e)=>{t.byteLength!==this._nPk?e(new Error("Invalid public key for the ciphersuite")):r(new me(fr,new Uint8Array(t),"public"))})}_importKey(t,r){return new Promise((e,s)=>{r&&t.byteLength!==this._nPk&&s(new Error("Invalid public key for the ciphersuite")),!r&&t.byteLength!==this._nSk&&s(new Error("Invalid private key for the ciphersuite")),e(new me(fr,new Uint8Array(t),r?"public":"private"))})}_derivePublicKey(t){return new Promise(r=>{r(new me(fr,Uint8Array.from(on(t.key)),"public"))})}_dh(t,r){return new Promise((e,s)=>{try{e(Uint8Array.from(fn(t.key,r.key)))}catch(f){s(f)}})}};var Je=class extends qe{constructor(t,r,e){super(t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=r,this._kdf=e}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(t){throw new Le(t)}}async deriveKeyPair(t){try{return await this._prim.deriveKeyPair(t)}catch(r){throw new It(r)}}async serializePublicKey(t){try{return await this._prim.serializePublicKey(t)}catch(r){throw new kt(r)}}async deserializePublicKey(t){try{return await this._prim.deserializePublicKey(t)}catch(r){throw new tt(r)}}async importKey(t,r,e){try{return await this._prim.importKey(t,r,e)}catch(s){throw new tt(s)}}async encap(t){try{let r=t.nonEphemeralKeyPair===void 0?await this.generateKeyPair():t.nonEphemeralKeyPair,e=await this._prim.serializePublicKey(r.publicKey),s=await this._prim.serializePublicKey(t.recipientPublicKey),f;if(t.senderKey===void 0)f=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey));else{let y=_t(t.senderKey)?t.senderKey.privateKey:t.senderKey,x=new Uint8Array(await this._prim.dh(r.privateKey,t.recipientPublicKey)),U=new Uint8Array(await this._prim.dh(y,t.recipientPublicKey));f=wt(x,U)}let b;if(t.senderKey===void 0)b=wt(new Uint8Array(e),new Uint8Array(s));else{let y=_t(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),x=await this._prim.serializePublicKey(y);b=Qr(new Uint8Array(e),new Uint8Array(s),new Uint8Array(x))}let u=await this.generateSharedSecret(f,b);return{enc:e,sharedSecret:u}}catch(r){throw new Lt(r)}}async decap(t){let r;try{r=await this._prim.deserializePublicKey(t.enc)}catch(e){throw new tt(e)}try{let e=_t(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,s=_t(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),f=await this._prim.serializePublicKey(s),b;if(t.senderPublicKey===void 0)b=new Uint8Array(await this._prim.dh(e,r));else{let y=new Uint8Array(await this._prim.dh(e,r)),x=new Uint8Array(await this._prim.dh(e,t.senderPublicKey));b=wt(y,x)}let u;if(t.senderPublicKey===void 0)u=wt(new Uint8Array(t.enc),new Uint8Array(f));else{let y=await this._prim.serializePublicKey(t.senderPublicKey);u=new Uint8Array(t.enc.byteLength+f.byteLength+y.byteLength),u.set(new Uint8Array(t.enc),0),u.set(new Uint8Array(f),t.enc.byteLength),u.set(new Uint8Array(y),t.enc.byteLength+f.byteLength)}return await this.generateSharedSecret(b,u)}catch(e){throw new Tt(e)}}async generateSharedSecret(t,r){let e=this._kdf.buildLabeledIkm(ii,t),s=this._kdf.buildLabeledInfo(oi,r,this.secretSize);return await this._kdf.extractAndExpand(J,e,s,this.secretSize)}},ur=class extends Je{constructor(t){let r=new Uint8Array(rt);r.set(xe(Q.DhkemP256HkdfSha256,2),3);let e=new We(t,r),s=new lt(Q.DhkemP256HkdfSha256,e,t);super(t,s,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Q.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},cr=class extends Je{constructor(t){let r=new Uint8Array(rt);r.set(xe(Q.DhkemP384HkdfSha384,2),3);let e=new ct(t,r),s=new lt(Q.DhkemP384HkdfSha384,e,t);super(t,s,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Q.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},lr=class extends Je{constructor(t){let r=new Uint8Array(rt);r.set(xe(Q.DhkemP521HkdfSha512,2),3);let e=new $e(t,r),s=new lt(Q.DhkemP521HkdfSha512,e,t);super(t,s,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Q.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}},br=class extends Je{constructor(t){let r=new Uint8Array(rt);r.set(xe(Q.DhkemX25519HkdfSha256,2),3);let e=new We(t,r),s=new ir(e);super(t,s,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Q.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},dr=class extends Je{constructor(t){let r=new Uint8Array(rt);r.set(xe(Q.DhkemX448HkdfSha512,2),3);let e=new $e(t,r),s=new hr(e);super(t,s,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Q.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};var Rr=class{constructor(t){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.kem){case Q.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case Q.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case Q.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case Q.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case Q.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new Se("Invalid KEM id")}switch(this.kem=t.kem,t.kdf){case Pe.HkdfSha256:case Pe.HkdfSha384:case Pe.HkdfSha512:break;default:throw new Se("Invalid KDF id")}switch(this.kdf=t.kdf,t.aead){case ae.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ae.Aes256Gcm:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ae.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ae.ExportOnly:break;default:throw new Se("Invalid AEAD id")}this.aead=t.aead,this._suiteId=new Uint8Array(ri),this._suiteId.set(xe(this.kem,2),4),this._suiteId.set(xe(this.kdf,2),6),this._suiteId.set(xe(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(t){return await this.setup(),Vt(this.aead,t,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>128)throw new Se("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(t)}async importKey(t,r,e=!0){return await this.setup(),await this._kem.importKey(t,r,e)}async createSenderContext(t){this.validateInputLength(t),await this.setup();let r=await this._kem.encap(t),e;return t.psk!==void 0?e=t.senderKey!==void 0?Ie.AuthPsk:Ie.Psk:e=t.senderKey!==void 0?Ie.Auth:Ie.Base,await this.keyScheduleS(e,r.sharedSecret,r.enc,t)}async createRecipientContext(t){this.validateInputLength(t),await this.setup();let r=await this._kem.decap(t),e;return t.psk!==void 0?e=t.senderPublicKey!==void 0?Ie.AuthPsk:Ie.Psk:e=t.senderPublicKey!==void 0?Ie.Auth:Ie.Base,await this.keyScheduleR(e,r,t)}async seal(t,r,e=J){let s=await this.createSenderContext(t);return{ct:await s.seal(r,e),enc:s.enc}}async open(t,r,e=J){return await(await this.createRecipientContext(t)).open(r,e)}async setup(){this._api=await ei(),(this._kem===void 0||this._kdf===void 0)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(t,r,e){let s=this.createKdfContext(),f=e.psk===void 0?J:new Uint8Array(e.psk.id),b=await s.labeledExtract(J,si,f),u=e.info===void 0?J:new Uint8Array(e.info),y=await s.labeledExtract(J,ni,u),x=new Uint8Array(1+b.byteLength+y.byteLength);x.set(new Uint8Array([t]),0),x.set(new Uint8Array(b),1),x.set(new Uint8Array(y),1+b.byteLength);let U=e.psk===void 0?J:new Uint8Array(e.psk.key),A=s.buildLabeledIkm(ai,U),k=s.buildLabeledInfo(ui,x,s.hashSize),p=await s.extractAndExpand(r,A,k,s.hashSize);if(this.aead===ae.ExportOnly)return{params:{aead:this.aead,exporterSecret:p},kdf:s};let H=s.buildLabeledInfo(fi,x,this.aeadKeySize),T=await s.extractAndExpand(r,A,H,this.aeadKeySize),O=s.buildLabeledInfo(hi,x,this.aeadNonceSize),D=await s.extractAndExpand(r,A,O,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:p,key:T,baseNonce:new Uint8Array(D),seq:0},kdf:s}}async keyScheduleS(t,r,e,s){let f=await this.keySchedule(t,r,s);return f.params.key===void 0?new Dt(this._api,f.kdf,f.params.exporterSecret,e):new Wt(this._api,f.kdf,f.params,e)}async keyScheduleR(t,r,e){let s=await this.keySchedule(t,r,e);return s.params.key===void 0?new Ht(this._api,s.kdf,s.params.exporterSecret):new Zt(this._api,s.kdf,s.params)}validateInputLength(t){if(t.info!==void 0&&t.info.byteLength>128)throw new Se("Too long info");if(t.psk!==void 0){if(t.psk.key.byteLength<32)throw new Se(`PSK must have at least ${32} bytes`);if(t.psk.key.byteLength>128)throw new Se("Too long psk.key");if(t.psk.id.byteLength>128)throw new Se("Too long psk.id")}}createKemContext(){switch(this.kem){case Q.DhkemP256HkdfSha256:return new ur(this._api);case Q.DhkemP384HkdfSha384:return new cr(this._api);case Q.DhkemP521HkdfSha512:return new lr(this._api);case Q.DhkemX25519HkdfSha256:return new br(this._api);default:return new dr(this._api)}}createKdfContext(){switch(this.kdf){case Pe.HkdfSha256:return new We(this._api,this._suiteId);case Pe.HkdfSha384:return new ct(this._api,this._suiteId);default:return new $e(this._api,this._suiteId)}}};export{ae as Aead,Rr as CipherSuite,Tt as DecapError,It as DeriveKeyPairError,tt as DeserializeError,Lt as EncapError,Kt as ExportError,Se as InvalidParamError,Pe as Kdf,Q as Kem,Ut as MessageLimitReachedError,Le as NotSupportedError,Ze as OpenError,Xe as SealError,kt as SerializeError,Zr as ValidationError};
