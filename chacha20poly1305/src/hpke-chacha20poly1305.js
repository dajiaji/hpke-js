var z=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));function at(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var xt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Lt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Lt)throw new Error("Non little-endian hardware is not supported");function Y(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function J(e){if(typeof e=="string")e=Y(e);else if(at(e))e=e.slice();else throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var _t=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function ut(e,t){if(t!==void 0&&(typeof t!="object"||!_t(t)))throw new Error("options must be object or undefined");return Object.assign(e,t)}function M(e,t){if(!at(e))throw new Error("Uint8Array expected");if(typeof t=="number"&&e.length!==t)throw new Error(`Uint8Array length ${t} expected`)}function pt(e,t){if(e.length!==t.length)return!1;let s=0;for(let r=0;r<e.length;r++)s|=e[r]^t[r];return s===0}var et=(e,t)=>(Object.assign(t,e),t);function rt(e,t,s,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,s,r);let c=BigInt(32),n=BigInt(4294967295),f=Number(s>>c&n),o=Number(s&n),h=r?4:0,a=r?0:4;e.setUint32(t+h,f,r),e.setUint32(t+a,o,r)}function Q(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`wrong positive integer: ${e}`)}function nt(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Bt(e){return e!=null&&typeof e=="object"&&(e instanceof Uint8Array||e.constructor.name==="Uint8Array")}function W(e,...t){if(!Bt(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ot(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function gt(e,t){W(e);let s=t.outputLen;if(e.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}var N=(e,t)=>e[t++]&255|(e[t++]&255)<<8,ft=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=J(t),M(t,32);let s=N(t,0),r=N(t,2),c=N(t,4),n=N(t,6),f=N(t,8),o=N(t,10),h=N(t,12),a=N(t,14);this.r[0]=s&8191,this.r[1]=(s>>>13|r<<3)&8191,this.r[2]=(r>>>10|c<<6)&7939,this.r[3]=(c>>>7|n<<9)&8191,this.r[4]=(n>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|o<<2)&8191,this.r[7]=(o>>>11|h<<5)&8065,this.r[8]=(h>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let x=0;x<8;x++)this.pad[x]=N(t,16+2*x)}process(t,s,r=!1){let c=r?0:2048,{h:n,r:f}=this,o=f[0],h=f[1],a=f[2],x=f[3],y=f[4],d=f[5],w=f[6],p=f[7],g=f[8],u=f[9],b=N(t,s+0),m=N(t,s+2),C=N(t,s+4),$=N(t,s+6),v=N(t,s+8),H=N(t,s+10),k=N(t,s+12),R=N(t,s+14),U=n[0]+(b&8191),A=n[1]+((b>>>13|m<<3)&8191),E=n[2]+((m>>>10|C<<6)&8191),L=n[3]+((C>>>7|$<<9)&8191),_=n[4]+(($>>>4|v<<12)&8191),B=n[5]+(v>>>1&8191),S=n[6]+((v>>>14|H<<2)&8191),O=n[7]+((H>>>11|k<<5)&8191),j=n[8]+((k>>>8|R<<8)&8191),T=n[9]+(R>>>5|c),l=0,P=l+U*o+A*(5*u)+E*(5*g)+L*(5*p)+_*(5*w);l=P>>>13,P&=8191,P+=B*(5*d)+S*(5*y)+O*(5*x)+j*(5*a)+T*(5*h),l+=P>>>13,P&=8191;let K=l+U*h+A*o+E*(5*u)+L*(5*g)+_*(5*p);l=K>>>13,K&=8191,K+=B*(5*w)+S*(5*d)+O*(5*y)+j*(5*x)+T*(5*a),l+=K>>>13,K&=8191;let I=l+U*a+A*h+E*o+L*(5*u)+_*(5*g);l=I>>>13,I&=8191,I+=B*(5*p)+S*(5*w)+O*(5*d)+j*(5*y)+T*(5*x),l+=I>>>13,I&=8191;let F=l+U*x+A*a+E*h+L*o+_*(5*u);l=F>>>13,F&=8191,F+=B*(5*g)+S*(5*p)+O*(5*w)+j*(5*d)+T*(5*y),l+=F>>>13,F&=8191;let D=l+U*y+A*x+E*a+L*h+_*o;l=D>>>13,D&=8191,D+=B*(5*u)+S*(5*g)+O*(5*p)+j*(5*w)+T*(5*d),l+=D>>>13,D&=8191;let X=l+U*d+A*y+E*x+L*a+_*h;l=X>>>13,X&=8191,X+=B*o+S*(5*u)+O*(5*g)+j*(5*p)+T*(5*w),l+=X>>>13,X&=8191;let V=l+U*w+A*d+E*y+L*x+_*a;l=V>>>13,V&=8191,V+=B*h+S*o+O*(5*u)+j*(5*g)+T*(5*p),l+=V>>>13,V&=8191;let q=l+U*p+A*w+E*d+L*y+_*x;l=q>>>13,q&=8191,q+=B*a+S*h+O*o+j*(5*u)+T*(5*g),l+=q>>>13,q&=8191;let G=l+U*g+A*p+E*w+L*d+_*y;l=G>>>13,G&=8191,G+=B*x+S*a+O*h+j*o+T*(5*u),l+=G>>>13,G&=8191;let Z=l+U*u+A*g+E*p+L*w+_*d;l=Z>>>13,Z&=8191,Z+=B*y+S*x+O*a+j*h+T*o,l+=Z>>>13,Z&=8191,l=(l<<2)+l|0,l=l+P|0,P=l&8191,l=l>>>13,K+=l,n[0]=P,n[1]=K,n[2]=I,n[3]=F,n[4]=D,n[5]=X,n[6]=V,n[7]=q,n[8]=G,n[9]=Z}finalize(){let{h:t,pad:s}=this,r=new Uint16Array(10),c=t[1]>>>13;t[1]&=8191;for(let o=2;o<10;o++)t[o]+=c,c=t[o]>>>13,t[o]&=8191;t[0]+=c*5,c=t[0]>>>13,t[0]&=8191,t[1]+=c,c=t[1]>>>13,t[1]&=8191,t[2]+=c,r[0]=t[0]+5,c=r[0]>>>13,r[0]&=8191;for(let o=1;o<10;o++)r[o]=t[o]+c,c=r[o]>>>13,r[o]&=8191;r[9]-=8192;let n=(c^1)-1;for(let o=0;o<10;o++)r[o]&=n;n=~n;for(let o=0;o<10;o++)t[o]=t[o]&n|r[o];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let f=t[0]+s[0];t[0]=f&65535;for(let o=1;o<8;o++)f=(t[o]+s[o]|0)+(f>>>16)|0,t[o]=f&65535}update(t){ot(this);let{buffer:s,blockLen:r}=this;t=J(t);let c=t.length;for(let n=0;n<c;){let f=Math.min(r-this.pos,c-n);if(f===r){for(;r<=c-n;n+=r)this.process(t,n);continue}s.set(t.subarray(n,n+f),this.pos),this.pos+=f,n+=f,this.pos===r&&(this.process(s,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(t){ot(this),gt(t,this),this.finished=!0;let{buffer:s,h:r}=this,{pos:c}=this;if(c){for(s[c++]=1;c<16;c++)s[c]=0;this.process(s,0,!0)}this.finalize();let n=0;for(let f=0;f<8;f++)t[n++]=r[f]>>>0,t[n++]=r[f]>>>8;return t}digest(){let{buffer:t,outputLen:s}=this;this.digestInto(t);let r=t.slice(0,s);return this.destroy(),r}};function St(e){let t=(r,c)=>e(c).update(J(r)).digest(),s=e(new Uint8Array(32));return t.outputLen=s.outputLen,t.blockLen=s.blockLen,t.create=r=>e(r),t}var yt=St(e=>new ft(e));var Ot=Y("expand 16-byte k"),jt=Y("expand 32-byte k"),Tt=z(Ot),It=z(jt);function i(e,t){return e<<t|e>>>32-t}function st(e){return e.byteOffset%4===0}var tt=64,Pt=16,dt=2**32-1,wt=new Uint32Array;function Ct(e,t,s,r,c,n,f,o){let h=c.length,a=new Uint8Array(tt),x=z(a),y=st(c)&&st(n),d=y?z(c):wt,w=y?z(n):wt;for(let p=0;p<h;f++){if(e(t,s,r,x,f,o),f>=dt)throw new Error("arx: counter overflow");let g=Math.min(tt,h-p);if(y&&g===tt){let u=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let b=0,m;b<Pt;b++)m=u+b,w[m]=d[m]^x[b];p+=tt;continue}for(let u=0,b;u<g;u++)b=p+u,n[b]=c[b]^a[u];p+=g}}function it(e,t){let{allowShortKeys:s,extendNonceFn:r,counterLength:c,counterRight:n,rounds:f}=ut({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Q(c),Q(f),nt(n),nt(s),(o,h,a,x,y=0)=>{W(o),W(h),W(a);let d=a.length;if(x||(x=new Uint8Array(d)),W(x),Q(y),y<0||y>=dt)throw new Error("arx: counter overflow");if(x.length<d)throw new Error(`arx: output (${x.length}) is shorter than data (${d})`);let w=[],p=o.length,g,u;if(p===32)g=o.slice(),w.push(g),u=It;else if(p===16&&s)g=new Uint8Array(32),g.set(o),g.set(o,16),u=Tt,w.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);st(h)||(h=h.slice(),w.push(h));let b=z(g);if(r){if(h.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(u,b,z(h.subarray(0,16)),b),h=h.subarray(16)}let m=16-c;if(m!==h.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let $=new Uint8Array(12);$.set(h,n?0:12-h.length),h=$,w.push(h)}let C=z(h);for(Ct(e,u,b,C,a,x,y,f);w.length>0;)w.pop().fill(0);return x}}function Ut(e,t,s,r,c,n=20){let f=e[0],o=e[1],h=e[2],a=e[3],x=t[0],y=t[1],d=t[2],w=t[3],p=t[4],g=t[5],u=t[6],b=t[7],m=c,C=s[0],$=s[1],v=s[2],H=f,k=o,R=h,U=a,A=x,E=y,L=d,_=w,B=p,S=g,O=u,j=b,T=m,l=C,P=$,K=v;for(let F=0;F<n;F+=2)H=H+A|0,T=i(T^H,16),B=B+T|0,A=i(A^B,12),H=H+A|0,T=i(T^H,8),B=B+T|0,A=i(A^B,7),k=k+E|0,l=i(l^k,16),S=S+l|0,E=i(E^S,12),k=k+E|0,l=i(l^k,8),S=S+l|0,E=i(E^S,7),R=R+L|0,P=i(P^R,16),O=O+P|0,L=i(L^O,12),R=R+L|0,P=i(P^R,8),O=O+P|0,L=i(L^O,7),U=U+_|0,K=i(K^U,16),j=j+K|0,_=i(_^j,12),U=U+_|0,K=i(K^U,8),j=j+K|0,_=i(_^j,7),H=H+E|0,K=i(K^H,16),O=O+K|0,E=i(E^O,12),H=H+E|0,K=i(K^H,8),O=O+K|0,E=i(E^O,7),k=k+L|0,T=i(T^k,16),j=j+T|0,L=i(L^j,12),k=k+L|0,T=i(T^k,8),j=j+T|0,L=i(L^j,7),R=R+_|0,l=i(l^R,16),B=B+l|0,_=i(_^B,12),R=R+_|0,l=i(l^R,8),B=B+l|0,_=i(_^B,7),U=U+A|0,P=i(P^U,16),S=S+P|0,A=i(A^S,12),U=U+A|0,P=i(P^U,8),S=S+P|0,A=i(A^S,7);let I=0;r[I++]=f+H|0,r[I++]=o+k|0,r[I++]=h+R|0,r[I++]=a+U|0,r[I++]=x+A|0,r[I++]=y+E|0,r[I++]=d+L|0,r[I++]=w+_|0,r[I++]=p+B|0,r[I++]=g+S|0,r[I++]=u+O|0,r[I++]=b+j|0,r[I++]=m+T|0,r[I++]=C+l|0,r[I++]=$+P|0,r[I++]=v+K|0}function Kt(e,t,s,r){let c=e[0],n=e[1],f=e[2],o=e[3],h=t[0],a=t[1],x=t[2],y=t[3],d=t[4],w=t[5],p=t[6],g=t[7],u=s[0],b=s[1],m=s[2],C=s[3];for(let v=0;v<20;v+=2)c=c+h|0,u=i(u^c,16),d=d+u|0,h=i(h^d,12),c=c+h|0,u=i(u^c,8),d=d+u|0,h=i(h^d,7),n=n+a|0,b=i(b^n,16),w=w+b|0,a=i(a^w,12),n=n+a|0,b=i(b^n,8),w=w+b|0,a=i(a^w,7),f=f+x|0,m=i(m^f,16),p=p+m|0,x=i(x^p,12),f=f+x|0,m=i(m^f,8),p=p+m|0,x=i(x^p,7),o=o+y|0,C=i(C^o,16),g=g+C|0,y=i(y^g,12),o=o+y|0,C=i(C^o,8),g=g+C|0,y=i(y^g,7),c=c+a|0,C=i(C^c,16),p=p+C|0,a=i(a^p,12),c=c+a|0,C=i(C^c,8),p=p+C|0,a=i(a^p,7),n=n+x|0,u=i(u^n,16),g=g+u|0,x=i(x^g,12),n=n+x|0,u=i(u^n,8),g=g+u|0,x=i(x^g,7),f=f+y|0,b=i(b^f,16),d=d+b|0,y=i(y^d,12),f=f+y|0,b=i(b^f,8),d=d+b|0,y=i(y^d,7),o=o+h|0,m=i(m^o,16),w=w+m|0,h=i(h^w,12),o=o+h|0,m=i(m^o,8),w=w+m|0,h=i(h^w,7);let $=0;r[$++]=c,r[$++]=n,r[$++]=f,r[$++]=o,r[$++]=u,r[$++]=b,r[$++]=m,r[$++]=C}var $t=it(Ut,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Nt=it(Ut,{counterRight:!1,counterLength:8,extendNonceFn:Kt,allowShortKeys:!1});var Ht=new Uint8Array(16),bt=(e,t)=>{e.update(t);let s=t.length%16;s&&e.update(Ht.subarray(s))},kt=new Uint8Array(32);function mt(e,t,s,r,c){let n=e(t,s,kt),f=yt.create(n);c&&bt(f,c),bt(f,r);let o=new Uint8Array(16),h=xt(o);rt(h,0,BigInt(c?c.length:0),!0),rt(h,8,BigInt(r.length),!0),f.update(o);let a=f.digest();return n.fill(0),a}var At=e=>(t,s,r)=>(M(t,32),M(s),{encrypt:(n,f)=>{let o=n.length,h=o+16;f?M(f,h):f=new Uint8Array(h),e(t,s,n,f,1);let a=mt(e,t,s,f.subarray(0,-16),r);return f.set(a,o),f},decrypt:(n,f)=>{let o=n.length,h=o-16;if(o<16)throw new Error("encrypted data must be at least 16 bytes");f?M(f,h):f=new Uint8Array(h);let a=n.subarray(0,-16),x=n.subarray(-16),y=mt(e,t,s,a,r);if(!pt(x,y))throw new Error("invalid tag");return e(t,s,a,f,1),f}}),ct=et({blockSize:64,nonceLength:12,tagLength:16},At($t)),Yt=et({blockSize:64,nonceLength:24,tagLength:16},At(Nt));var Rt={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535},Et=Rt;var ht=class{constructor(t){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(t)}async seal(t,s,r){return await this._seal(t,s,r)}async open(t,s,r){return await this._open(t,s,r)}_seal(t,s,r){return new Promise(c=>{let n=ct(this._key,new Uint8Array(t),new Uint8Array(r)).encrypt(new Uint8Array(s));c(n.buffer)})}_open(t,s,r){return new Promise(c=>{let n=ct(this._key,new Uint8Array(t),new Uint8Array(r)).decrypt(new Uint8Array(s));c(n.buffer)})}},lt=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Et.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(t){return new ht(t)}};export{lt as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
