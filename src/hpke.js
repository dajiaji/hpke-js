var wo=Object.create;var Ii=Object.defineProperty;var _o=Object.getOwnPropertyDescriptor;var vo=Object.getOwnPropertyNames;var mo=Object.getPrototypeOf,xo=Object.prototype.hasOwnProperty;var Hi=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var ge=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var go=(i,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of vo(e))!xo.call(i,n)&&n!==r&&Ii(i,n,{get:()=>e[n],enumerable:!(t=_o(e,n))||t.enumerable});return i};var at=(i,e,r)=>(r=i!=null?wo(mo(i)):{},go(e||!i||!i.__esModule?Ii(r,"default",{value:i,enumerable:!0}):r,i));var rn=ge(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});function Po(i,e){var r=i>>>16&65535,t=i&65535,n=e>>>16&65535,f=e&65535;return t*f+(r*f+t*n<<16>>>0)|0}Be.mul=Math.imul||Po;function ko(i,e){return i+e|0}Be.add=ko;function To(i,e){return i-e|0}Be.sub=To;function Lo(i,e){return i<<e|i>>>32-e}Be.rotl=Lo;function Ko(i,e){return i<<32-e|i>>>e}Be.rotr=Ko;function Uo(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i}Be.isInteger=Number.isInteger||Uo;Be.MAX_SAFE_INTEGER=9007199254740991;Be.isSafeInteger=function(i){return Be.isInteger(i)&&i>=-Be.MAX_SAFE_INTEGER&&i<=Be.MAX_SAFE_INTEGER}});var mt=ge(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});var nn=rn();function Bo(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}V.readInt16BE=Bo;function Io(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}V.readUint16BE=Io;function Ho(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}V.readInt16LE=Ho;function Oo(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}V.readUint16LE=Oo;function sn(i,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=i>>>8,e[r+1]=i>>>0,e}V.writeUint16BE=sn;V.writeInt16BE=sn;function on(i,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=i>>>0,e[r+1]=i>>>8,e}V.writeUint16LE=on;V.writeInt16LE=on;function ii(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}V.readInt32BE=ii;function ni(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}V.readUint32BE=ni;function si(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}V.readInt32LE=si;function oi(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}V.readUint32LE=oi;function ar(i,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=i>>>24,e[r+1]=i>>>16,e[r+2]=i>>>8,e[r+3]=i>>>0,e}V.writeUint32BE=ar;V.writeInt32BE=ar;function fr(i,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=i>>>0,e[r+1]=i>>>8,e[r+2]=i>>>16,e[r+3]=i>>>24,e}V.writeUint32LE=fr;V.writeInt32LE=fr;function Do(i,e){e===void 0&&(e=0);var r=ii(i,e),t=ii(i,e+4);return r*4294967296+t-(t>>31)*4294967296}V.readInt64BE=Do;function zo(i,e){e===void 0&&(e=0);var r=ni(i,e),t=ni(i,e+4);return r*4294967296+t}V.readUint64BE=zo;function Mo(i,e){e===void 0&&(e=0);var r=si(i,e),t=si(i,e+4);return t*4294967296+r-(r>>31)*4294967296}V.readInt64LE=Mo;function Ro(i,e){e===void 0&&(e=0);var r=oi(i,e),t=oi(i,e+4);return t*4294967296+r}V.readUint64LE=Ro;function an(i,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ar(i/4294967296>>>0,e,r),ar(i>>>0,e,r+4),e}V.writeUint64BE=an;V.writeInt64BE=an;function fn(i,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),fr(i>>>0,e,r),fr(i/4294967296>>>0,e,r+4),e}V.writeUint64LE=fn;V.writeInt64LE=fn;function No(i,e,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var t=0,n=1,f=i/8+r-1;f>=r;f--)t+=e[f]*n,n*=256;return t}V.readUintBE=No;function Co(i,e,r){if(r===void 0&&(r=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var t=0,n=1,f=r;f<r+i/8;f++)t+=e[f]*n,n*=256;return t}V.readUintLE=Co;function jo(i,e,r,t){if(r===void 0&&(r=new Uint8Array(i/8)),t===void 0&&(t=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!nn.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,f=i/8+t-1;f>=t;f--)r[f]=e/n&255,n*=256;return r}V.writeUintBE=jo;function qo(i,e,r,t){if(r===void 0&&(r=new Uint8Array(i/8)),t===void 0&&(t=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!nn.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,f=t;f<t+i/8;f++)r[f]=e/n&255,n*=256;return r}V.writeUintLE=qo;function Go(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(e)}V.readFloat32BE=Go;function Fo(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat32(e,!0)}V.readFloat32LE=Fo;function Vo(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(e)}V.readFloat64BE=Vo;function Zo(i,e){e===void 0&&(e=0);var r=new DataView(i.buffer,i.byteOffset,i.byteLength);return r.getFloat64(e,!0)}V.readFloat64LE=Zo;function Yo(i,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat32(r,i),e}V.writeFloat32BE=Yo;function Xo(i,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat32(r,i,!0),e}V.writeFloat32LE=Xo;function $o(i,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat64(r,i),e}V.writeFloat64BE=$o;function Wo(i,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.setFloat64(r,i,!0),e}V.writeFloat64LE=Wo});var je=ge(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});function Qo(i){for(var e=0;e<i.length;e++)i[e]=0;return i}ai.wipe=Qo});var un=ge(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});var Ee=mt(),fi=je(),Jo=20;function ea(i,e,r){for(var t=1634760805,n=857760878,f=2036477234,u=1797285236,h=r[3]<<24|r[2]<<16|r[1]<<8|r[0],b=r[7]<<24|r[6]<<16|r[5]<<8|r[4],p=r[11]<<24|r[10]<<16|r[9]<<8|r[8],E=r[15]<<24|r[14]<<16|r[13]<<8|r[12],g=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],k=r[31]<<24|r[30]<<16|r[29]<<8|r[28],T=e[3]<<24|e[2]<<16|e[1]<<8|e[0],D=e[7]<<24|e[6]<<16|e[5]<<8|e[4],O=e[11]<<24|e[10]<<16|e[9]<<8|e[8],z=e[15]<<24|e[14]<<16|e[13]<<8|e[12],K=t,H=n,M=f,N=u,l=h,d=b,B=p,R=E,S=g,m=_,x=y,A=k,j=T,C=D,L=O,q=z,ne=0;ne<Jo;ne+=2)K=K+l|0,j^=K,j=j>>>32-16|j<<16,S=S+j|0,l^=S,l=l>>>32-12|l<<12,H=H+d|0,C^=H,C=C>>>32-16|C<<16,m=m+C|0,d^=m,d=d>>>32-12|d<<12,M=M+B|0,L^=M,L=L>>>32-16|L<<16,x=x+L|0,B^=x,B=B>>>32-12|B<<12,N=N+R|0,q^=N,q=q>>>32-16|q<<16,A=A+q|0,R^=A,R=R>>>32-12|R<<12,M=M+B|0,L^=M,L=L>>>32-8|L<<8,x=x+L|0,B^=x,B=B>>>32-7|B<<7,N=N+R|0,q^=N,q=q>>>32-8|q<<8,A=A+q|0,R^=A,R=R>>>32-7|R<<7,H=H+d|0,C^=H,C=C>>>32-8|C<<8,m=m+C|0,d^=m,d=d>>>32-7|d<<7,K=K+l|0,j^=K,j=j>>>32-8|j<<8,S=S+j|0,l^=S,l=l>>>32-7|l<<7,K=K+d|0,q^=K,q=q>>>32-16|q<<16,x=x+q|0,d^=x,d=d>>>32-12|d<<12,H=H+B|0,j^=H,j=j>>>32-16|j<<16,A=A+j|0,B^=A,B=B>>>32-12|B<<12,M=M+R|0,C^=M,C=C>>>32-16|C<<16,S=S+C|0,R^=S,R=R>>>32-12|R<<12,N=N+l|0,L^=N,L=L>>>32-16|L<<16,m=m+L|0,l^=m,l=l>>>32-12|l<<12,M=M+R|0,C^=M,C=C>>>32-8|C<<8,S=S+C|0,R^=S,R=R>>>32-7|R<<7,N=N+l|0,L^=N,L=L>>>32-8|L<<8,m=m+L|0,l^=m,l=l>>>32-7|l<<7,H=H+B|0,j^=H,j=j>>>32-8|j<<8,A=A+j|0,B^=A,B=B>>>32-7|B<<7,K=K+d|0,q^=K,q=q>>>32-8|q<<8,x=x+q|0,d^=x,d=d>>>32-7|d<<7;Ee.writeUint32LE(K+t|0,i,0),Ee.writeUint32LE(H+n|0,i,4),Ee.writeUint32LE(M+f|0,i,8),Ee.writeUint32LE(N+u|0,i,12),Ee.writeUint32LE(l+h|0,i,16),Ee.writeUint32LE(d+b|0,i,20),Ee.writeUint32LE(B+p|0,i,24),Ee.writeUint32LE(R+E|0,i,28),Ee.writeUint32LE(S+g|0,i,32),Ee.writeUint32LE(m+_|0,i,36),Ee.writeUint32LE(x+y|0,i,40),Ee.writeUint32LE(A+k|0,i,44),Ee.writeUint32LE(j+T|0,i,48),Ee.writeUint32LE(C+D|0,i,52),Ee.writeUint32LE(L+O|0,i,56),Ee.writeUint32LE(q+z|0,i,60)}function hn(i,e,r,t,n){if(n===void 0&&(n=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(t.length<r.length)throw new Error("ChaCha: destination is shorter than source");var f,u;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");f=new Uint8Array(16),u=f.length-e.length,f.set(e,u)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");f=e,u=n}for(var h=new Uint8Array(64),b=0;b<r.length;b+=64){ea(h,f,i);for(var p=b;p<b+64&&p<r.length;p++)t[p]=r[p]^h[p-b];ra(f,0,u)}return fi.wipe(h),n===0&&fi.wipe(f),t}hr.streamXOR=hn;function ta(i,e,r,t){return t===void 0&&(t=0),fi.wipe(r),hn(i,e,r,r,t)}hr.stream=ta;function ra(i,e,r){for(var t=1;r--;)t=t+(i[e]&255)|0,i[e]=t&255,t>>>=8,e++;if(t>0)throw new Error("ChaCha: counter overflow")}});var ur=ge(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});function ia(i,e,r){return~(i-1)&e|i-1&r}xt.select=ia;function na(i,e){return(i|0)-(e|0)-1>>>31&1}xt.lessOrEqual=na;function cn(i,e){if(i.length!==e.length)return 0;for(var r=0,t=0;t<i.length;t++)r|=i[t]^e[t];return 1&r-1>>>8}xt.compare=cn;function sa(i,e){return i.length===0||e.length===0?!1:cn(i,e)!==0}xt.equal=sa});var dn=ge(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});var oa=ur(),cr=je();Ve.DIGEST_LENGTH=16;var ln=function(){function i(e){this.digestLength=Ve.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var t=e[2]|e[3]<<8;this._r[1]=(r>>>13|t<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(t>>>10|n<<6)&7939;var f=e[6]|e[7]<<8;this._r[3]=(n>>>7|f<<9)&8191;var u=e[8]|e[9]<<8;this._r[4]=(f>>>4|u<<12)&255,this._r[5]=u>>>1&8190;var h=e[10]|e[11]<<8;this._r[6]=(u>>>14|h<<2)&8191;var b=e[12]|e[13]<<8;this._r[7]=(h>>>11|b<<5)&8065;var p=e[14]|e[15]<<8;this._r[8]=(b>>>8|p<<8)&8191,this._r[9]=p>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return i.prototype._blocks=function(e,r,t){for(var n=this._fin?0:2048,f=this._h[0],u=this._h[1],h=this._h[2],b=this._h[3],p=this._h[4],E=this._h[5],g=this._h[6],_=this._h[7],y=this._h[8],k=this._h[9],T=this._r[0],D=this._r[1],O=this._r[2],z=this._r[3],K=this._r[4],H=this._r[5],M=this._r[6],N=this._r[7],l=this._r[8],d=this._r[9];t>=16;){var B=e[r+0]|e[r+1]<<8;f+=B&8191;var R=e[r+2]|e[r+3]<<8;u+=(B>>>13|R<<3)&8191;var S=e[r+4]|e[r+5]<<8;h+=(R>>>10|S<<6)&8191;var m=e[r+6]|e[r+7]<<8;b+=(S>>>7|m<<9)&8191;var x=e[r+8]|e[r+9]<<8;p+=(m>>>4|x<<12)&8191,E+=x>>>1&8191;var A=e[r+10]|e[r+11]<<8;g+=(x>>>14|A<<2)&8191;var j=e[r+12]|e[r+13]<<8;_+=(A>>>11|j<<5)&8191;var C=e[r+14]|e[r+15]<<8;y+=(j>>>8|C<<8)&8191,k+=C>>>5|n;var L=0,q=L;q+=f*T,q+=u*(5*d),q+=h*(5*l),q+=b*(5*N),q+=p*(5*M),L=q>>>13,q&=8191,q+=E*(5*H),q+=g*(5*K),q+=_*(5*z),q+=y*(5*O),q+=k*(5*D),L+=q>>>13,q&=8191;var ne=L;ne+=f*D,ne+=u*T,ne+=h*(5*d),ne+=b*(5*l),ne+=p*(5*N),L=ne>>>13,ne&=8191,ne+=E*(5*M),ne+=g*(5*H),ne+=_*(5*K),ne+=y*(5*z),ne+=k*(5*O),L+=ne>>>13,ne&=8191;var G=L;G+=f*O,G+=u*D,G+=h*T,G+=b*(5*d),G+=p*(5*l),L=G>>>13,G&=8191,G+=E*(5*N),G+=g*(5*M),G+=_*(5*H),G+=y*(5*K),G+=k*(5*z),L+=G>>>13,G&=8191;var Y=L;Y+=f*z,Y+=u*O,Y+=h*D,Y+=b*T,Y+=p*(5*d),L=Y>>>13,Y&=8191,Y+=E*(5*l),Y+=g*(5*N),Y+=_*(5*M),Y+=y*(5*H),Y+=k*(5*K),L+=Y>>>13,Y&=8191;var X=L;X+=f*K,X+=u*z,X+=h*O,X+=b*D,X+=p*T,L=X>>>13,X&=8191,X+=E*(5*d),X+=g*(5*l),X+=_*(5*N),X+=y*(5*M),X+=k*(5*H),L+=X>>>13,X&=8191;var $=L;$+=f*H,$+=u*K,$+=h*z,$+=b*O,$+=p*D,L=$>>>13,$&=8191,$+=E*T,$+=g*(5*d),$+=_*(5*l),$+=y*(5*N),$+=k*(5*M),L+=$>>>13,$&=8191;var Z=L;Z+=f*M,Z+=u*H,Z+=h*K,Z+=b*z,Z+=p*O,L=Z>>>13,Z&=8191,Z+=E*D,Z+=g*T,Z+=_*(5*d),Z+=y*(5*l),Z+=k*(5*N),L+=Z>>>13,Z&=8191;var W=L;W+=f*N,W+=u*M,W+=h*H,W+=b*K,W+=p*z,L=W>>>13,W&=8191,W+=E*O,W+=g*D,W+=_*T,W+=y*(5*d),W+=k*(5*l),L+=W>>>13,W&=8191;var Q=L;Q+=f*l,Q+=u*N,Q+=h*M,Q+=b*H,Q+=p*K,L=Q>>>13,Q&=8191,Q+=E*z,Q+=g*O,Q+=_*D,Q+=y*T,Q+=k*(5*d),L+=Q>>>13,Q&=8191;var F=L;F+=f*d,F+=u*l,F+=h*N,F+=b*M,F+=p*H,L=F>>>13,F&=8191,F+=E*K,F+=g*z,F+=_*O,F+=y*D,F+=k*T,L+=F>>>13,F&=8191,L=(L<<2)+L|0,L=L+q|0,q=L&8191,L=L>>>13,ne+=L,f=q,u=ne,h=G,b=Y,p=X,E=$,g=Z,_=W,y=Q,k=F,r+=16,t-=16}this._h[0]=f,this._h[1]=u,this._h[2]=h,this._h[3]=b,this._h[4]=p,this._h[5]=E,this._h[6]=g,this._h[7]=_,this._h[8]=y,this._h[9]=k},i.prototype.finish=function(e,r){r===void 0&&(r=0);var t=new Uint16Array(10),n,f,u,h;if(this._leftover){for(h=this._leftover,this._buffer[h++]=1;h<16;h++)this._buffer[h]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,h=2;h<10;h++)this._h[h]+=n,n=this._h[h]>>>13,this._h[h]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,t[0]=this._h[0]+5,n=t[0]>>>13,t[0]&=8191,h=1;h<10;h++)t[h]=this._h[h]+n,n=t[h]>>>13,t[h]&=8191;for(t[9]-=1<<13,f=(n^1)-1,h=0;h<10;h++)t[h]&=f;for(f=~f,h=0;h<10;h++)this._h[h]=this._h[h]&f|t[h];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,u=this._h[0]+this._pad[0],this._h[0]=u&65535,h=1;h<8;h++)u=(this._h[h]+this._pad[h]|0)+(u>>>16)|0,this._h[h]=u&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},i.prototype.update=function(e){var r=0,t=e.length,n;if(this._leftover){n=16-this._leftover,n>t&&(n=t);for(var f=0;f<n;f++)this._buffer[this._leftover+f]=e[r+f];if(t-=n,r+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(t>=16&&(n=t-t%16,this._blocks(e,r,n),r+=n,t-=n),t){for(var f=0;f<t;f++)this._buffer[this._leftover+f]=e[r+f];this._leftover+=t}return this},i.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},i.prototype.clean=function(){return cr.wipe(this._buffer),cr.wipe(this._r),cr.wipe(this._h),cr.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},i}();Ve.Poly1305=ln;function aa(i,e){var r=new ln(i);r.update(e);var t=r.digest();return r.clean(),t}Ve.oneTimeAuth=aa;function fa(i,e){return i.length!==Ve.DIGEST_LENGTH||e.length!==Ve.DIGEST_LENGTH?!1:oa.equal(i,e)}Ve.equal=fa});var yn=ge(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});var lr=un(),ha=dn(),zt=je(),bn=mt(),ua=ur();Ze.KEY_LENGTH=32;Ze.NONCE_LENGTH=12;Ze.TAG_LENGTH=16;var pn=new Uint8Array(16),ca=function(){function i(e){if(this.nonceLength=Ze.NONCE_LENGTH,this.tagLength=Ze.TAG_LENGTH,e.length!==Ze.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return i.prototype.seal=function(e,r,t,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var f=new Uint8Array(16);f.set(e,f.length-e.length);var u=new Uint8Array(32);lr.stream(this._key,f,u,4);var h=r.length+this.tagLength,b;if(n){if(n.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");b=n}else b=new Uint8Array(h);return lr.streamXOR(this._key,f,r,b,4),this._authenticate(b.subarray(b.length-this.tagLength,b.length),u,b.subarray(0,b.length-this.tagLength),t),zt.wipe(f),b},i.prototype.open=function(e,r,t,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var f=new Uint8Array(16);f.set(e,f.length-e.length);var u=new Uint8Array(32);lr.stream(this._key,f,u,4);var h=new Uint8Array(this.tagLength);if(this._authenticate(h,u,r.subarray(0,r.length-this.tagLength),t),!ua.equal(h,r.subarray(r.length-this.tagLength,r.length)))return null;var b=r.length-this.tagLength,p;if(n){if(n.length!==b)throw new Error("ChaCha20Poly1305: incorrect destination length");p=n}else p=new Uint8Array(b);return lr.streamXOR(this._key,f,r.subarray(0,r.length-this.tagLength),p,4),zt.wipe(f),p},i.prototype.clean=function(){return zt.wipe(this._key),this},i.prototype._authenticate=function(e,r,t,n){var f=new ha.Poly1305(r);n&&(f.update(n),n.length%16>0&&f.update(pn.subarray(n.length%16))),f.update(t),t.length%16>0&&f.update(pn.subarray(t.length%16));var u=new Uint8Array(8);n&&bn.writeUint64LE(n.length,u),f.update(u),bn.writeUint64LE(t.length,u),f.update(u);for(var h=f.digest(),b=0;b<h.length;b++)e[b]=h[b];f.clean(),zt.wipe(h),zt.wipe(u)},i}();Ze.ChaCha20Poly1305=ca});var _n=ge(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0});function la(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}hi.isSerializableHash=la});var mn=ge(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});var qe=_n(),da=ur(),ba=je(),vn=function(){function i(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var t=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(t).clean():t.set(r);for(var n=0;n<t.length;n++)t[n]^=54;this._inner.update(t);for(var n=0;n<t.length;n++)t[n]^=106;this._outer.update(t),qe.isSerializableHash(this._inner)&&qe.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ba.wipe(t)}return i.prototype.reset=function(){if(!qe.isSerializableHash(this._inner)||!qe.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){qe.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),qe.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!qe.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!qe.isSerializableHash(this._inner)||!qe.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!qe.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Mt.HMAC=vn;function pa(i,e,r){var t=new vn(i,e);t.update(r);var n=t.digest();return t.clean(),n}Mt.hmac=pa;Mt.equal=da.equal});var gn=ge(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});var yr=mt(),pr=je();rt.DIGEST_LENGTH=32;rt.BLOCK_SIZE=64;var xn=function(){function i(){this.digestLength=rt.DIGEST_LENGTH,this.blockSize=rt.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){pr.wipe(this._buffer),pr.wipe(this._temp),this.reset()},i.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var t=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[t++],r--;this._bufferLength===this.blockSize&&(ui(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(t=ui(this._temp,this._state,e,t,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[t++],r--;return this},i.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,t=this._bufferLength,n=r/536870912|0,f=r<<3,u=r%64<56?64:128;this._buffer[t]=128;for(var h=t+1;h<u-8;h++)this._buffer[h]=0;yr.writeUint32BE(n,this._buffer,u-8),yr.writeUint32BE(f,this._buffer,u-4),ui(this._temp,this._state,this._buffer,0,u),this._finished=!0}for(var h=0;h<this.digestLength/4;h++)yr.writeUint32BE(this._state[h],e,h*4);return this},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(e){pr.wipe(e.state),e.buffer&&pr.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},i}();rt.SHA256=xn;var ya=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function ui(i,e,r,t,n){for(;n>=64;){for(var f=e[0],u=e[1],h=e[2],b=e[3],p=e[4],E=e[5],g=e[6],_=e[7],y=0;y<16;y++){var k=t+y*4;i[y]=yr.readUint32BE(r,k)}for(var y=16;y<64;y++){var T=i[y-2],D=(T>>>17|T<<32-17)^(T>>>19|T<<32-19)^T>>>10;T=i[y-15];var O=(T>>>7|T<<32-7)^(T>>>18|T<<32-18)^T>>>3;i[y]=(D+i[y-7]|0)+(O+i[y-16]|0)}for(var y=0;y<64;y++){var D=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&E^~p&g)|0)+(_+(ya[y]+i[y]|0)|0)|0,O=((f>>>2|f<<32-2)^(f>>>13|f<<32-13)^(f>>>22|f<<32-22))+(f&u^f&h^u&h)|0;_=g,g=E,E=p,p=b+D|0,b=h,h=u,u=f,f=D+O|0}e[0]+=f,e[1]+=u,e[2]+=h,e[3]+=b,e[4]+=p,e[5]+=E,e[6]+=g,e[7]+=_,t+=64,n-=64}return t}function wa(i){var e=new xn;e.update(i);var r=e.digest();return e.clean(),r}rt.hash=wa});var An=ge(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});var St=mt(),Et=je();Ye.DIGEST_LENGTH=64;Ye.BLOCK_SIZE=128;var Sn=function(){function i(){this.digestLength=Ye.DIGEST_LENGTH,this.blockSize=Ye.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){Et.wipe(this._buffer),Et.wipe(this._tempHi),Et.wipe(this._tempLo),this.reset()},i.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var t=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<Ye.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=e[t++],r--;this._bufferLength===this.blockSize&&(ci(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(t=ci(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,t,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[t++],r--;return this},i.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,t=this._bufferLength,n=r/536870912|0,f=r<<3,u=r%128<112?128:256;this._buffer[t]=128;for(var h=t+1;h<u-8;h++)this._buffer[h]=0;St.writeUint32BE(n,this._buffer,u-8),St.writeUint32BE(f,this._buffer,u-4),ci(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,u),this._finished=!0}for(var h=0;h<this.digestLength/8;h++)St.writeUint32BE(this._stateHi[h],e,h*8),St.writeUint32BE(this._stateLo[h],e,h*8+4);return this},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(e){Et.wipe(e.stateHi),Et.wipe(e.stateLo),e.buffer&&Et.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},i}();Ye.SHA512=Sn;var En=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function ci(i,e,r,t,n,f,u){for(var h=r[0],b=r[1],p=r[2],E=r[3],g=r[4],_=r[5],y=r[6],k=r[7],T=t[0],D=t[1],O=t[2],z=t[3],K=t[4],H=t[5],M=t[6],N=t[7],l,d,B,R,S,m,x,A;u>=128;){for(var j=0;j<16;j++){var C=8*j+f;i[j]=St.readUint32BE(n,C),e[j]=St.readUint32BE(n,C+4)}for(var j=0;j<80;j++){var L=h,q=b,ne=p,G=E,Y=g,X=_,$=y,Z=k,W=T,Q=D,F=O,fe=z,le=K,de=H,be=M,ue=N;if(l=k,d=N,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=(g>>>14|K<<32-14)^(g>>>18|K<<32-18)^(K>>>41-32|g<<32-(41-32)),d=(K>>>14|g<<32-14)^(K>>>18|g<<32-18)^(g>>>41-32|K<<32-(41-32)),S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,l=g&_^~g&y,d=K&H^~K&M,S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,l=En[j*2],d=En[j*2+1],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,l=i[j%16],d=e[j%16],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,B=x&65535|A<<16,R=S&65535|m<<16,l=B,d=R,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=(h>>>28|T<<32-28)^(T>>>34-32|h<<32-(34-32))^(T>>>39-32|h<<32-(39-32)),d=(T>>>28|h<<32-28)^(h>>>34-32|T<<32-(34-32))^(h>>>39-32|T<<32-(39-32)),S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,l=h&b^h&p^b&p,d=T&D^T&O^D&O,S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,Z=x&65535|A<<16,ue=S&65535|m<<16,l=G,d=fe,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=B,d=R,S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,G=x&65535|A<<16,fe=S&65535|m<<16,b=L,p=q,E=ne,g=G,_=Y,y=X,k=$,h=Z,D=W,O=Q,z=F,K=fe,H=le,M=de,N=be,T=ue,j%16===15)for(var C=0;C<16;C++)l=i[C],d=e[C],S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=i[(C+9)%16],d=e[(C+9)%16],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,B=i[(C+1)%16],R=e[(C+1)%16],l=(B>>>1|R<<32-1)^(B>>>8|R<<32-8)^B>>>7,d=(R>>>1|B<<32-1)^(R>>>8|B<<32-8)^(R>>>7|B<<32-7),S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,B=i[(C+14)%16],R=e[(C+14)%16],l=(B>>>19|R<<32-19)^(R>>>61-32|B<<32-(61-32))^B>>>6,d=(R>>>19|B<<32-19)^(B>>>61-32|R<<32-(61-32))^(R>>>6|B<<32-6),S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,i[C]=x&65535|A<<16,e[C]=S&65535|m<<16}l=h,d=T,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[0],d=t[0],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[0]=h=x&65535|A<<16,t[0]=T=S&65535|m<<16,l=b,d=D,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[1],d=t[1],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[1]=b=x&65535|A<<16,t[1]=D=S&65535|m<<16,l=p,d=O,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[2],d=t[2],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[2]=p=x&65535|A<<16,t[2]=O=S&65535|m<<16,l=E,d=z,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[3],d=t[3],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[3]=E=x&65535|A<<16,t[3]=z=S&65535|m<<16,l=g,d=K,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[4],d=t[4],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[4]=g=x&65535|A<<16,t[4]=K=S&65535|m<<16,l=_,d=H,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[5],d=t[5],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[5]=_=x&65535|A<<16,t[5]=H=S&65535|m<<16,l=y,d=M,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[6],d=t[6],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[6]=y=x&65535|A<<16,t[6]=M=S&65535|m<<16,l=k,d=N,S=d&65535,m=d>>>16,x=l&65535,A=l>>>16,l=r[7],d=t[7],S+=d&65535,m+=d>>>16,x+=l&65535,A+=l>>>16,m+=S>>>16,x+=m>>>16,A+=x>>>16,r[7]=k=x&65535|A<<16,t[7]=N=S&65535|m<<16,f+=128,u-=128}return f}function _a(i){var e=new Sn;e.update(i);var r=e.digest();return e.clean(),r}Ye.hash=_a});var di=ge(()=>{});var Nn=ge(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.BrowserRandomSource=void 0;var Rn=65536,vi=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(e);for(let t=0;t<r.length;t+=Rn)this._crypto.getRandomValues(r.subarray(t,t+Math.min(r.length-t,Rn)));return r}};Ur.BrowserRandomSource=vi});var Cn=ge(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.NodeRandomSource=void 0;var Ia=je(),mi=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Hi<"u"){let e=di();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");let t=new Uint8Array(e);for(let n=0;n<t.length;n++)t[n]=r[n];return(0,Ia.wipe)(r),t}};Br.NodeRandomSource=mi});var jn=ge(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.SystemRandomSource=void 0;var Ha=Nn(),Oa=Cn(),xi=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ha.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Oa.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}};Ir.SystemRandomSource=xi});var Vn=ge(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.randomStringForEntropy=Se.randomString=Se.randomUint32=Se.randomBytes=Se.defaultRandomSource=void 0;var Da=jn(),za=mt(),qn=je();Se.defaultRandomSource=new Da.SystemRandomSource;function gi(i,e=Se.defaultRandomSource){return e.randomBytes(i)}Se.randomBytes=gi;function Ma(i=Se.defaultRandomSource){let e=gi(4,i),r=(0,za.readUint32LE)(e);return(0,qn.wipe)(e),r}Se.randomUint32=Ma;var Gn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Fn(i,e=Gn,r=Se.defaultRandomSource){if(e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");let t="",n=e.length,f=256-256%n;for(;i>0;){let u=gi(Math.ceil(i*256/f),r);for(let h=0;h<u.length&&i>0;h++){let b=u[h];b<f&&(t+=e.charAt(b%n),i--)}(0,qn.wipe)(u)}return t}Se.randomString=Fn;function Ra(i,e=Gn,r=Se.defaultRandomSource){let t=Math.ceil(i/(Math.log(e.length)/Math.LN2));return Fn(t,e,r)}Se.randomStringForEntropy=Ra});var $n=ge(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.sharedKey=he.generateKeyPair=he.generateKeyPairFromSeed=he.scalarMultBase=he.scalarMult=he.SHARED_KEY_LENGTH=he.SECRET_KEY_LENGTH=he.PUBLIC_KEY_LENGTH=void 0;var Na=Vn(),Ca=je();he.PUBLIC_KEY_LENGTH=32;he.SECRET_KEY_LENGTH=32;he.SHARED_KEY_LENGTH=32;function Ge(i){let e=new Float64Array(16);if(i)for(let r=0;r<i.length;r++)e[r]=i[r];return e}var Zn=new Uint8Array(32);Zn[0]=9;var ja=Ge([56129,1]);function Ei(i){let e=1;for(let r=0;r<16;r++){let t=i[r]+e+65535;e=Math.floor(t/65536),i[r]=t-e*65536}i[0]+=e-1+37*(e-1)}function Ft(i,e,r){let t=~(r-1);for(let n=0;n<16;n++){let f=t&(i[n]^e[n]);i[n]^=f,e[n]^=f}}function qa(i,e){let r=Ge(),t=Ge();for(let n=0;n<16;n++)t[n]=e[n];Ei(t),Ei(t),Ei(t);for(let n=0;n<2;n++){r[0]=t[0]-65517;for(let u=1;u<15;u++)r[u]=t[u]-65535-(r[u-1]>>16&1),r[u-1]&=65535;r[15]=t[15]-32767-(r[14]>>16&1);let f=r[15]>>16&1;r[14]&=65535,Ft(t,r,1-f)}for(let n=0;n<16;n++)i[2*n]=t[n]&255,i[2*n+1]=t[n]>>8}function Ga(i,e){for(let r=0;r<16;r++)i[r]=e[2*r]+(e[2*r+1]<<8);i[15]&=32767}function Hr(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]+r[t]}function Or(i,e,r){for(let t=0;t<16;t++)i[t]=e[t]-r[t]}function $e(i,e,r){let t,n,f=0,u=0,h=0,b=0,p=0,E=0,g=0,_=0,y=0,k=0,T=0,D=0,O=0,z=0,K=0,H=0,M=0,N=0,l=0,d=0,B=0,R=0,S=0,m=0,x=0,A=0,j=0,C=0,L=0,q=0,ne=0,G=r[0],Y=r[1],X=r[2],$=r[3],Z=r[4],W=r[5],Q=r[6],F=r[7],fe=r[8],le=r[9],de=r[10],be=r[11],ue=r[12],we=r[13],_e=r[14],ve=r[15];t=e[0],f+=t*G,u+=t*Y,h+=t*X,b+=t*$,p+=t*Z,E+=t*W,g+=t*Q,_+=t*F,y+=t*fe,k+=t*le,T+=t*de,D+=t*be,O+=t*ue,z+=t*we,K+=t*_e,H+=t*ve,t=e[1],u+=t*G,h+=t*Y,b+=t*X,p+=t*$,E+=t*Z,g+=t*W,_+=t*Q,y+=t*F,k+=t*fe,T+=t*le,D+=t*de,O+=t*be,z+=t*ue,K+=t*we,H+=t*_e,M+=t*ve,t=e[2],h+=t*G,b+=t*Y,p+=t*X,E+=t*$,g+=t*Z,_+=t*W,y+=t*Q,k+=t*F,T+=t*fe,D+=t*le,O+=t*de,z+=t*be,K+=t*ue,H+=t*we,M+=t*_e,N+=t*ve,t=e[3],b+=t*G,p+=t*Y,E+=t*X,g+=t*$,_+=t*Z,y+=t*W,k+=t*Q,T+=t*F,D+=t*fe,O+=t*le,z+=t*de,K+=t*be,H+=t*ue,M+=t*we,N+=t*_e,l+=t*ve,t=e[4],p+=t*G,E+=t*Y,g+=t*X,_+=t*$,y+=t*Z,k+=t*W,T+=t*Q,D+=t*F,O+=t*fe,z+=t*le,K+=t*de,H+=t*be,M+=t*ue,N+=t*we,l+=t*_e,d+=t*ve,t=e[5],E+=t*G,g+=t*Y,_+=t*X,y+=t*$,k+=t*Z,T+=t*W,D+=t*Q,O+=t*F,z+=t*fe,K+=t*le,H+=t*de,M+=t*be,N+=t*ue,l+=t*we,d+=t*_e,B+=t*ve,t=e[6],g+=t*G,_+=t*Y,y+=t*X,k+=t*$,T+=t*Z,D+=t*W,O+=t*Q,z+=t*F,K+=t*fe,H+=t*le,M+=t*de,N+=t*be,l+=t*ue,d+=t*we,B+=t*_e,R+=t*ve,t=e[7],_+=t*G,y+=t*Y,k+=t*X,T+=t*$,D+=t*Z,O+=t*W,z+=t*Q,K+=t*F,H+=t*fe,M+=t*le,N+=t*de,l+=t*be,d+=t*ue,B+=t*we,R+=t*_e,S+=t*ve,t=e[8],y+=t*G,k+=t*Y,T+=t*X,D+=t*$,O+=t*Z,z+=t*W,K+=t*Q,H+=t*F,M+=t*fe,N+=t*le,l+=t*de,d+=t*be,B+=t*ue,R+=t*we,S+=t*_e,m+=t*ve,t=e[9],k+=t*G,T+=t*Y,D+=t*X,O+=t*$,z+=t*Z,K+=t*W,H+=t*Q,M+=t*F,N+=t*fe,l+=t*le,d+=t*de,B+=t*be,R+=t*ue,S+=t*we,m+=t*_e,x+=t*ve,t=e[10],T+=t*G,D+=t*Y,O+=t*X,z+=t*$,K+=t*Z,H+=t*W,M+=t*Q,N+=t*F,l+=t*fe,d+=t*le,B+=t*de,R+=t*be,S+=t*ue,m+=t*we,x+=t*_e,A+=t*ve,t=e[11],D+=t*G,O+=t*Y,z+=t*X,K+=t*$,H+=t*Z,M+=t*W,N+=t*Q,l+=t*F,d+=t*fe,B+=t*le,R+=t*de,S+=t*be,m+=t*ue,x+=t*we,A+=t*_e,j+=t*ve,t=e[12],O+=t*G,z+=t*Y,K+=t*X,H+=t*$,M+=t*Z,N+=t*W,l+=t*Q,d+=t*F,B+=t*fe,R+=t*le,S+=t*de,m+=t*be,x+=t*ue,A+=t*we,j+=t*_e,C+=t*ve,t=e[13],z+=t*G,K+=t*Y,H+=t*X,M+=t*$,N+=t*Z,l+=t*W,d+=t*Q,B+=t*F,R+=t*fe,S+=t*le,m+=t*de,x+=t*be,A+=t*ue,j+=t*we,C+=t*_e,L+=t*ve,t=e[14],K+=t*G,H+=t*Y,M+=t*X,N+=t*$,l+=t*Z,d+=t*W,B+=t*Q,R+=t*F,S+=t*fe,m+=t*le,x+=t*de,A+=t*be,j+=t*ue,C+=t*we,L+=t*_e,q+=t*ve,t=e[15],H+=t*G,M+=t*Y,N+=t*X,l+=t*$,d+=t*Z,B+=t*W,R+=t*Q,S+=t*F,m+=t*fe,x+=t*le,A+=t*de,j+=t*be,C+=t*ue,L+=t*we,q+=t*_e,ne+=t*ve,f+=38*M,u+=38*N,h+=38*l,b+=38*d,p+=38*B,E+=38*R,g+=38*S,_+=38*m,y+=38*x,k+=38*A,T+=38*j,D+=38*C,O+=38*L,z+=38*q,K+=38*ne,n=1,t=f+n+65535,n=Math.floor(t/65536),f=t-n*65536,t=u+n+65535,n=Math.floor(t/65536),u=t-n*65536,t=h+n+65535,n=Math.floor(t/65536),h=t-n*65536,t=b+n+65535,n=Math.floor(t/65536),b=t-n*65536,t=p+n+65535,n=Math.floor(t/65536),p=t-n*65536,t=E+n+65535,n=Math.floor(t/65536),E=t-n*65536,t=g+n+65535,n=Math.floor(t/65536),g=t-n*65536,t=_+n+65535,n=Math.floor(t/65536),_=t-n*65536,t=y+n+65535,n=Math.floor(t/65536),y=t-n*65536,t=k+n+65535,n=Math.floor(t/65536),k=t-n*65536,t=T+n+65535,n=Math.floor(t/65536),T=t-n*65536,t=D+n+65535,n=Math.floor(t/65536),D=t-n*65536,t=O+n+65535,n=Math.floor(t/65536),O=t-n*65536,t=z+n+65535,n=Math.floor(t/65536),z=t-n*65536,t=K+n+65535,n=Math.floor(t/65536),K=t-n*65536,t=H+n+65535,n=Math.floor(t/65536),H=t-n*65536,f+=n-1+37*(n-1),n=1,t=f+n+65535,n=Math.floor(t/65536),f=t-n*65536,t=u+n+65535,n=Math.floor(t/65536),u=t-n*65536,t=h+n+65535,n=Math.floor(t/65536),h=t-n*65536,t=b+n+65535,n=Math.floor(t/65536),b=t-n*65536,t=p+n+65535,n=Math.floor(t/65536),p=t-n*65536,t=E+n+65535,n=Math.floor(t/65536),E=t-n*65536,t=g+n+65535,n=Math.floor(t/65536),g=t-n*65536,t=_+n+65535,n=Math.floor(t/65536),_=t-n*65536,t=y+n+65535,n=Math.floor(t/65536),y=t-n*65536,t=k+n+65535,n=Math.floor(t/65536),k=t-n*65536,t=T+n+65535,n=Math.floor(t/65536),T=t-n*65536,t=D+n+65535,n=Math.floor(t/65536),D=t-n*65536,t=O+n+65535,n=Math.floor(t/65536),O=t-n*65536,t=z+n+65535,n=Math.floor(t/65536),z=t-n*65536,t=K+n+65535,n=Math.floor(t/65536),K=t-n*65536,t=H+n+65535,n=Math.floor(t/65536),H=t-n*65536,f+=n-1+37*(n-1),i[0]=f,i[1]=u,i[2]=h,i[3]=b,i[4]=p,i[5]=E,i[6]=g,i[7]=_,i[8]=y,i[9]=k,i[10]=T,i[11]=D,i[12]=O,i[13]=z,i[14]=K,i[15]=H}function Vt(i,e){$e(i,e,e)}function Fa(i,e){let r=Ge();for(let t=0;t<16;t++)r[t]=e[t];for(let t=253;t>=0;t--)Vt(r,r),t!==2&&t!==4&&$e(r,r,e);for(let t=0;t<16;t++)i[t]=r[t]}function Si(i,e){let r=new Uint8Array(32),t=new Float64Array(80),n=Ge(),f=Ge(),u=Ge(),h=Ge(),b=Ge(),p=Ge();for(let y=0;y<31;y++)r[y]=i[y];r[31]=i[31]&127|64,r[0]&=248,Ga(t,e);for(let y=0;y<16;y++)f[y]=t[y];n[0]=h[0]=1;for(let y=254;y>=0;--y){let k=r[y>>>3]>>>(y&7)&1;Ft(n,f,k),Ft(u,h,k),Hr(b,n,u),Or(n,n,u),Hr(u,f,h),Or(f,f,h),Vt(h,b),Vt(p,n),$e(n,u,n),$e(u,f,b),Hr(b,n,u),Or(n,n,u),Vt(f,n),Or(u,h,p),$e(n,u,ja),Hr(n,n,h),$e(u,u,n),$e(n,h,p),$e(h,f,t),Vt(f,b),Ft(n,f,k),Ft(u,h,k)}for(let y=0;y<16;y++)t[y+16]=n[y],t[y+32]=u[y],t[y+48]=f[y],t[y+64]=h[y];let E=t.subarray(32),g=t.subarray(16);Fa(E,E),$e(g,g,E);let _=new Uint8Array(32);return qa(_,g),_}he.scalarMult=Si;function Yn(i){return Si(i,Zn)}he.scalarMultBase=Yn;function Xn(i){if(i.length!==he.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${he.SECRET_KEY_LENGTH} bytes`);let e=new Uint8Array(i);return{publicKey:Yn(e),secretKey:e}}he.generateKeyPairFromSeed=Xn;function Va(i){let e=(0,Na.randomBytes)(32,i),r=Xn(e);return(0,Ca.wipe)(e),r}he.generateKeyPair=Va;function Za(i,e,r=!1){if(i.length!==he.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==he.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let t=Si(i,e);if(r){let n=0;for(let f=0;f<t.length;f++)n|=t[f];if(n===0)throw new Error("X25519: invalid shared key")}return t}he.sharedKey=Za});var Qn=ge((zr,Wn)=>{(function(){var i,e=0xdeadbeefcafe,r=(e&16777215)==15715070;function t(s,o,a){s!=null&&(typeof s=="number"?this.fromNumber(s,o,a):o==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,o))}function n(){return new t(null)}function f(s,o,a,c,w,v){for(;--v>=0;){var P=o*this[s++]+a[c]+w;w=Math.floor(P/67108864),a[c++]=P&67108863}return w}function u(s,o,a,c,w,v){for(var P=o&32767,U=o>>15;--v>=0;){var se=this[s]&32767,xe=this[s++]>>15,He=U*se+xe*P;se=P*se+((He&32767)<<15)+a[c]+(w&1073741823),w=(se>>>30)+(He>>>15)+U*xe+(w>>>30),a[c++]=se&1073741823}return w}function h(s,o,a,c,w,v){for(var P=o&16383,U=o>>14;--v>=0;){var se=this[s]&16383,xe=this[s++]>>14,He=U*se+xe*P;se=P*se+((He&16383)<<14)+a[c]+w,w=(se>>28)+(He>>14)+U*xe,a[c++]=se&268435455}return w}var b=typeof navigator<"u";b&&r&&navigator.appName=="Microsoft Internet Explorer"?(t.prototype.am=u,i=30):b&&r&&navigator.appName!="Netscape"?(t.prototype.am=f,i=26):(t.prototype.am=h,i=28),t.prototype.DB=i,t.prototype.DM=(1<<i)-1,t.prototype.DV=1<<i;var p=52;t.prototype.FV=Math.pow(2,p),t.prototype.F1=p-i,t.prototype.F2=2*i-p;var E="0123456789abcdefghijklmnopqrstuvwxyz",g=new Array,_,y;for(_="0".charCodeAt(0),y=0;y<=9;++y)g[_++]=y;for(_="a".charCodeAt(0),y=10;y<36;++y)g[_++]=y;for(_="A".charCodeAt(0),y=10;y<36;++y)g[_++]=y;function k(s){return E.charAt(s)}function T(s,o){var a=g[s.charCodeAt(o)];return a??-1}function D(s){for(var o=this.t-1;o>=0;--o)s[o]=this[o];s.t=this.t,s.s=this.s}function O(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function z(s){var o=n();return o.fromInt(s),o}function K(s,o){var a;if(o==16)a=4;else if(o==8)a=3;else if(o==256)a=8;else if(o==2)a=1;else if(o==32)a=5;else if(o==4)a=2;else{this.fromRadix(s,o);return}this.t=0,this.s=0;for(var c=s.length,w=!1,v=0;--c>=0;){var P=a==8?s[c]&255:T(s,c);if(P<0){s.charAt(c)=="-"&&(w=!0);continue}w=!1,v==0?this[this.t++]=P:v+a>this.DB?(this[this.t-1]|=(P&(1<<this.DB-v)-1)<<v,this[this.t++]=P>>this.DB-v):this[this.t-1]|=P<<v,v+=a,v>=this.DB&&(v-=this.DB)}a==8&&s[0]&128&&(this.s=-1,v>0&&(this[this.t-1]|=(1<<this.DB-v)-1<<v)),this.clamp(),w&&t.ZERO.subTo(this,this)}function H(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function M(s){if(this.s<0)return"-"+this.negate().toString(s);var o;if(s==16)o=4;else if(s==8)o=3;else if(s==2)o=1;else if(s==32)o=5;else if(s==4)o=2;else return this.toRadix(s);var a=(1<<o)-1,c,w=!1,v="",P=this.t,U=this.DB-P*this.DB%o;if(P-- >0)for(U<this.DB&&(c=this[P]>>U)>0&&(w=!0,v=k(c));P>=0;)U<o?(c=(this[P]&(1<<U)-1)<<o-U,c|=this[--P]>>(U+=this.DB-o)):(c=this[P]>>(U-=o)&a,U<=0&&(U+=this.DB,--P)),c>0&&(w=!0),w&&(v+=k(c));return w?v:"0"}function N(){var s=n();return t.ZERO.subTo(this,s),s}function l(){return this.s<0?this.negate():this}function d(s){var o=this.s-s.s;if(o!=0)return o;var a=this.t;if(o=a-s.t,o!=0)return this.s<0?-o:o;for(;--a>=0;)if((o=this[a]-s[a])!=0)return o;return 0}function B(s){var o=1,a;return(a=s>>>16)!=0&&(s=a,o+=16),(a=s>>8)!=0&&(s=a,o+=8),(a=s>>4)!=0&&(s=a,o+=4),(a=s>>2)!=0&&(s=a,o+=2),(a=s>>1)!=0&&(s=a,o+=1),o}function R(){return this.t<=0?0:this.DB*(this.t-1)+B(this[this.t-1]^this.s&this.DM)}function S(s,o){var a;for(a=this.t-1;a>=0;--a)o[a+s]=this[a];for(a=s-1;a>=0;--a)o[a]=0;o.t=this.t+s,o.s=this.s}function m(s,o){for(var a=s;a<this.t;++a)o[a-s]=this[a];o.t=Math.max(this.t-s,0),o.s=this.s}function x(s,o){var a=s%this.DB,c=this.DB-a,w=(1<<c)-1,v=Math.floor(s/this.DB),P=this.s<<a&this.DM,U;for(U=this.t-1;U>=0;--U)o[U+v+1]=this[U]>>c|P,P=(this[U]&w)<<a;for(U=v-1;U>=0;--U)o[U]=0;o[v]=P,o.t=this.t+v+1,o.s=this.s,o.clamp()}function A(s,o){o.s=this.s;var a=Math.floor(s/this.DB);if(a>=this.t){o.t=0;return}var c=s%this.DB,w=this.DB-c,v=(1<<c)-1;o[0]=this[a]>>c;for(var P=a+1;P<this.t;++P)o[P-a-1]|=(this[P]&v)<<w,o[P-a]=this[P]>>c;c>0&&(o[this.t-a-1]|=(this.s&v)<<w),o.t=this.t-a,o.clamp()}function j(s,o){for(var a=0,c=0,w=Math.min(s.t,this.t);a<w;)c+=this[a]-s[a],o[a++]=c&this.DM,c>>=this.DB;if(s.t<this.t){for(c-=s.s;a<this.t;)c+=this[a],o[a++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;a<s.t;)c-=s[a],o[a++]=c&this.DM,c>>=this.DB;c-=s.s}o.s=c<0?-1:0,c<-1?o[a++]=this.DV+c:c>0&&(o[a++]=c),o.t=a,o.clamp()}function C(s,o){var a=this.abs(),c=s.abs(),w=a.t;for(o.t=w+c.t;--w>=0;)o[w]=0;for(w=0;w<c.t;++w)o[w+a.t]=a.am(0,c[w],o,w,0,a.t);o.s=0,o.clamp(),this.s!=s.s&&t.ZERO.subTo(o,o)}function L(s){for(var o=this.abs(),a=s.t=2*o.t;--a>=0;)s[a]=0;for(a=0;a<o.t-1;++a){var c=o.am(a,o[a],s,2*a,0,1);(s[a+o.t]+=o.am(a+1,2*o[a],s,2*a+1,c,o.t-a-1))>=o.DV&&(s[a+o.t]-=o.DV,s[a+o.t+1]=1)}s.t>0&&(s[s.t-1]+=o.am(a,o[a],s,2*a,0,1)),s.s=0,s.clamp()}function q(s,o,a){var c=s.abs();if(!(c.t<=0)){var w=this.abs();if(w.t<c.t){o?.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=n());var v=n(),P=this.s,U=s.s,se=this.DB-B(c[c.t-1]);se>0?(c.lShiftTo(se,v),w.lShiftTo(se,a)):(c.copyTo(v),w.copyTo(a));var xe=v.t,He=v[xe-1];if(He!=0){var Le=He*(1<<this.F1)+(xe>1?v[xe-2]>>this.F2:0),Fe=this.FV/Le,Yt=(1<<this.F1)/Le,Me=1<<this.F2,Re=a.t,Xt=Re-xe,We=o??n();for(v.dlShiftTo(Xt,We),a.compareTo(We)>=0&&(a[a.t++]=1,a.subTo(We,a)),t.ONE.dlShiftTo(xe,We),We.subTo(v,v);v.t<xe;)v[v.t++]=0;for(;--Xt>=0;){var Jr=a[--Re]==He?this.DM:Math.floor(a[Re]*Fe+(a[Re-1]+Me)*Yt);if((a[Re]+=v.am(0,Jr,a,Xt,0,xe))<Jr)for(v.dlShiftTo(Xt,We),a.subTo(We,a);a[Re]<--Jr;)a.subTo(We,a)}o!=null&&(a.drShiftTo(xe,o),P!=U&&t.ZERO.subTo(o,o)),a.t=xe,a.clamp(),se>0&&a.rShiftTo(se,a),P<0&&t.ZERO.subTo(a,a)}}}function ne(s){var o=n();return this.abs().divRemTo(s,null,o),this.s<0&&o.compareTo(t.ZERO)>0&&s.subTo(o,o),o}function G(s){this.m=s}function Y(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function X(s){return s}function $(s){s.divRemTo(this.m,null,s)}function Z(s,o,a){s.multiplyTo(o,a),this.reduce(a)}function W(s,o){s.squareTo(o),this.reduce(o)}G.prototype.convert=Y,G.prototype.revert=X,G.prototype.reduce=$,G.prototype.mulTo=Z,G.prototype.sqrTo=W;function Q(){if(this.t<1)return 0;var s=this[0];if(!(s&1))return 0;var o=s&3;return o=o*(2-(s&15)*o)&15,o=o*(2-(s&255)*o)&255,o=o*(2-((s&65535)*o&65535))&65535,o=o*(2-s*o%this.DV)%this.DV,o>0?this.DV-o:-o}function F(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function fe(s){var o=n();return s.abs().dlShiftTo(this.m.t,o),o.divRemTo(this.m,null,o),s.s<0&&o.compareTo(t.ZERO)>0&&this.m.subTo(o,o),o}function le(s){var o=n();return s.copyTo(o),this.reduce(o),o}function de(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var o=0;o<this.m.t;++o){var a=s[o]&32767,c=a*this.mpl+((a*this.mph+(s[o]>>15)*this.mpl&this.um)<<15)&s.DM;for(a=o+this.m.t,s[a]+=this.m.am(0,c,s,o,0,this.m.t);s[a]>=s.DV;)s[a]-=s.DV,s[++a]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function be(s,o){s.squareTo(o),this.reduce(o)}function ue(s,o,a){s.multiplyTo(o,a),this.reduce(a)}F.prototype.convert=fe,F.prototype.revert=le,F.prototype.reduce=de,F.prototype.mulTo=ue,F.prototype.sqrTo=be;function we(){return(this.t>0?this[0]&1:this.s)==0}function _e(s,o){if(s>4294967295||s<1)return t.ONE;var a=n(),c=n(),w=o.convert(this),v=B(s)-1;for(w.copyTo(a);--v>=0;)if(o.sqrTo(a,c),(s&1<<v)>0)o.mulTo(c,w,a);else{var P=a;a=c,c=P}return o.revert(a)}function ve(s,o){var a;return s<256||o.isEven()?a=new G(o):a=new F(o),this.exp(s,a)}t.prototype.copyTo=D,t.prototype.fromInt=O,t.prototype.fromString=K,t.prototype.clamp=H,t.prototype.dlShiftTo=S,t.prototype.drShiftTo=m,t.prototype.lShiftTo=x,t.prototype.rShiftTo=A,t.prototype.subTo=j,t.prototype.multiplyTo=C,t.prototype.squareTo=L,t.prototype.divRemTo=q,t.prototype.invDigit=Q,t.prototype.isEven=we,t.prototype.exp=_e,t.prototype.toString=M,t.prototype.negate=N,t.prototype.abs=l,t.prototype.compareTo=d,t.prototype.bitLength=R,t.prototype.mod=ne,t.prototype.modPowInt=ve,t.ZERO=z(0),t.ONE=z(1);function os(){var s=n();return this.copyTo(s),s}function as(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function fs(){return this.t==0?this.s:this[0]<<24>>24}function hs(){return this.t==0?this.s:this[0]<<16>>16}function us(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function cs(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function ls(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var o=this.chunkSize(s),a=Math.pow(s,o),c=z(a),w=n(),v=n(),P="";for(this.divRemTo(c,w,v);w.signum()>0;)P=(a+v.intValue()).toString(s).substr(1)+P,w.divRemTo(c,w,v);return v.intValue().toString(s)+P}function ds(s,o){this.fromInt(0),o==null&&(o=10);for(var a=this.chunkSize(o),c=Math.pow(o,a),w=!1,v=0,P=0,U=0;U<s.length;++U){var se=T(s,U);if(se<0){s.charAt(U)=="-"&&this.signum()==0&&(w=!0);continue}P=o*P+se,++v>=a&&(this.dMultiply(c),this.dAddOffset(P,0),v=0,P=0)}v>0&&(this.dMultiply(Math.pow(o,v)),this.dAddOffset(P,0)),w&&t.ZERO.subTo(this,this)}function bs(s,o,a){if(typeof o=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,a),this.testBit(s-1)||this.bitwiseTo(t.ONE.shiftLeft(s-1),Xr,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(o);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(t.ONE.shiftLeft(s-1),this);else{var c=new Array,w=s&7;c.length=(s>>3)+1,o.nextBytes(c),w>0?c[0]&=(1<<w)-1:c[0]=0,this.fromString(c,256)}}function ps(){var s=this.t,o=new Array;o[0]=this.s;var a=this.DB-s*this.DB%8,c,w=0;if(s-- >0)for(a<this.DB&&(c=this[s]>>a)!=(this.s&this.DM)>>a&&(o[w++]=c|this.s<<this.DB-a);s>=0;)a<8?(c=(this[s]&(1<<a)-1)<<8-a,c|=this[--s]>>(a+=this.DB-8)):(c=this[s]>>(a-=8)&255,a<=0&&(a+=this.DB,--s)),c&128&&(c|=-256),w==0&&(this.s&128)!=(c&128)&&++w,(w>0||c!=this.s)&&(o[w++]=c);return o}function ys(s){return this.compareTo(s)==0}function ws(s){return this.compareTo(s)<0?this:s}function _s(s){return this.compareTo(s)>0?this:s}function vs(s,o,a){var c,w,v=Math.min(s.t,this.t);for(c=0;c<v;++c)a[c]=o(this[c],s[c]);if(s.t<this.t){for(w=s.s&this.DM,c=v;c<this.t;++c)a[c]=o(this[c],w);a.t=this.t}else{for(w=this.s&this.DM,c=v;c<s.t;++c)a[c]=o(w,s[c]);a.t=s.t}a.s=o(this.s,s.s),a.clamp()}function ms(s,o){return s&o}function xs(s){var o=n();return this.bitwiseTo(s,ms,o),o}function Xr(s,o){return s|o}function gs(s){var o=n();return this.bitwiseTo(s,Xr,o),o}function ki(s,o){return s^o}function Es(s){var o=n();return this.bitwiseTo(s,ki,o),o}function Ti(s,o){return s&~o}function Ss(s){var o=n();return this.bitwiseTo(s,Ti,o),o}function As(){for(var s=n(),o=0;o<this.t;++o)s[o]=this.DM&~this[o];return s.t=this.t,s.s=~this.s,s}function Ps(s){var o=n();return s<0?this.rShiftTo(-s,o):this.lShiftTo(s,o),o}function ks(s){var o=n();return s<0?this.lShiftTo(-s,o):this.rShiftTo(s,o),o}function Ts(s){if(s==0)return-1;var o=0;return s&65535||(s>>=16,o+=16),s&255||(s>>=8,o+=8),s&15||(s>>=4,o+=4),s&3||(s>>=2,o+=2),s&1||++o,o}function Ls(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+Ts(this[s]);return this.s<0?this.t*this.DB:-1}function Ks(s){for(var o=0;s!=0;)s&=s-1,++o;return o}function Us(){for(var s=0,o=this.s&this.DM,a=0;a<this.t;++a)s+=Ks(this[a]^o);return s}function Bs(s){var o=Math.floor(s/this.DB);return o>=this.t?this.s!=0:(this[o]&1<<s%this.DB)!=0}function Is(s,o){var a=t.ONE.shiftLeft(s);return this.bitwiseTo(a,o,a),a}function Hs(s){return this.changeBit(s,Xr)}function Os(s){return this.changeBit(s,Ti)}function Ds(s){return this.changeBit(s,ki)}function zs(s,o){for(var a=0,c=0,w=Math.min(s.t,this.t);a<w;)c+=this[a]+s[a],o[a++]=c&this.DM,c>>=this.DB;if(s.t<this.t){for(c+=s.s;a<this.t;)c+=this[a],o[a++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;a<s.t;)c+=s[a],o[a++]=c&this.DM,c>>=this.DB;c+=s.s}o.s=c<0?-1:0,c>0?o[a++]=c:c<-1&&(o[a++]=this.DV+c),o.t=a,o.clamp()}function Ms(s){var o=n();return this.addTo(s,o),o}function Rs(s){var o=n();return this.subTo(s,o),o}function Ns(s){var o=n();return this.multiplyTo(s,o),o}function Cs(){var s=n();return this.squareTo(s),s}function js(s){var o=n();return this.divRemTo(s,o,null),o}function qs(s){var o=n();return this.divRemTo(s,null,o),o}function Gs(s){var o=n(),a=n();return this.divRemTo(s,o,a),new Array(o,a)}function Fs(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function Vs(s,o){if(s!=0){for(;this.t<=o;)this[this.t++]=0;for(this[o]+=s;this[o]>=this.DV;)this[o]-=this.DV,++o>=this.t&&(this[this.t++]=0),++this[o]}}function Ht(){}function Li(s){return s}function Zs(s,o,a){s.multiplyTo(o,a)}function Ys(s,o){s.squareTo(o)}Ht.prototype.convert=Li,Ht.prototype.revert=Li,Ht.prototype.mulTo=Zs,Ht.prototype.sqrTo=Ys;function Xs(s){return this.exp(s,new Ht)}function $s(s,o,a){var c=Math.min(this.t+s.t,o);for(a.s=0,a.t=c;c>0;)a[--c]=0;var w;for(w=a.t-this.t;c<w;++c)a[c+this.t]=this.am(0,s[c],a,c,0,this.t);for(w=Math.min(s.t,o);c<w;++c)this.am(0,s[c],a,c,0,o-c);a.clamp()}function Ws(s,o,a){--o;var c=a.t=this.t+s.t-o;for(a.s=0;--c>=0;)a[c]=0;for(c=Math.max(o-this.t,0);c<s.t;++c)a[this.t+c-o]=this.am(o-c,s[c],a,0,0,this.t+c-o);a.clamp(),a.drShiftTo(1,a)}function ot(s){this.r2=n(),this.q3=n(),t.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function Qs(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var o=n();return s.copyTo(o),this.reduce(o),o}function Js(s){return s}function eo(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function to(s,o){s.squareTo(o),this.reduce(o)}function ro(s,o,a){s.multiplyTo(o,a),this.reduce(a)}ot.prototype.convert=Qs,ot.prototype.revert=Js,ot.prototype.reduce=eo,ot.prototype.mulTo=ro,ot.prototype.sqrTo=to;function io(s,o){var a=s.bitLength(),c,w=z(1),v;if(a<=0)return w;a<18?c=1:a<48?c=3:a<144?c=4:a<768?c=5:c=6,a<8?v=new G(o):o.isEven()?v=new ot(o):v=new F(o);var P=new Array,U=3,se=c-1,xe=(1<<c)-1;if(P[1]=v.convert(this),c>1){var He=n();for(v.sqrTo(P[1],He);U<=xe;)P[U]=n(),v.mulTo(He,P[U-2],P[U]),U+=2}var Le=s.t-1,Fe,Yt=!0,Me=n(),Re;for(a=B(s[Le])-1;Le>=0;){for(a>=se?Fe=s[Le]>>a-se&xe:(Fe=(s[Le]&(1<<a+1)-1)<<se-a,Le>0&&(Fe|=s[Le-1]>>this.DB+a-se)),U=c;!(Fe&1);)Fe>>=1,--U;if((a-=U)<0&&(a+=this.DB,--Le),Yt)P[Fe].copyTo(w),Yt=!1;else{for(;U>1;)v.sqrTo(w,Me),v.sqrTo(Me,w),U-=2;U>0?v.sqrTo(w,Me):(Re=w,w=Me,Me=Re),v.mulTo(Me,P[Fe],w)}for(;Le>=0&&!(s[Le]&1<<a);)v.sqrTo(w,Me),Re=w,w=Me,Me=Re,--a<0&&(a=this.DB-1,--Le)}return v.revert(w)}function no(s){var o=this.s<0?this.negate():this.clone(),a=s.s<0?s.negate():s.clone();if(o.compareTo(a)<0){var c=o;o=a,a=c}var w=o.getLowestSetBit(),v=a.getLowestSetBit();if(v<0)return o;for(w<v&&(v=w),v>0&&(o.rShiftTo(v,o),a.rShiftTo(v,a));o.signum()>0;)(w=o.getLowestSetBit())>0&&o.rShiftTo(w,o),(w=a.getLowestSetBit())>0&&a.rShiftTo(w,a),o.compareTo(a)>=0?(o.subTo(a,o),o.rShiftTo(1,o)):(a.subTo(o,a),a.rShiftTo(1,a));return v>0&&a.lShiftTo(v,a),a}function so(s){if(s<=0)return 0;var o=this.DV%s,a=this.s<0?s-1:0;if(this.t>0)if(o==0)a=this[0]%s;else for(var c=this.t-1;c>=0;--c)a=(o*a+this[c])%s;return a}function oo(s){var o=s.isEven();if(this.isEven()&&o||s.signum()==0)return t.ZERO;for(var a=s.clone(),c=this.clone(),w=z(1),v=z(0),P=z(0),U=z(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),o?((!w.isEven()||!v.isEven())&&(w.addTo(this,w),v.subTo(s,v)),w.rShiftTo(1,w)):v.isEven()||v.subTo(s,v),v.rShiftTo(1,v);for(;c.isEven();)c.rShiftTo(1,c),o?((!P.isEven()||!U.isEven())&&(P.addTo(this,P),U.subTo(s,U)),P.rShiftTo(1,P)):U.isEven()||U.subTo(s,U),U.rShiftTo(1,U);a.compareTo(c)>=0?(a.subTo(c,a),o&&w.subTo(P,w),v.subTo(U,v)):(c.subTo(a,c),o&&P.subTo(w,P),U.subTo(v,U))}if(c.compareTo(t.ONE)!=0)return t.ZERO;if(U.compareTo(s)>=0)return U.subtract(s);if(U.signum()<0)U.addTo(s,U);else return U;return U.signum()<0?U.add(s):U}var Ae=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ao=(1<<26)/Ae[Ae.length-1];function fo(s){var o,a=this.abs();if(a.t==1&&a[0]<=Ae[Ae.length-1]){for(o=0;o<Ae.length;++o)if(a[0]==Ae[o])return!0;return!1}if(a.isEven())return!1;for(o=1;o<Ae.length;){for(var c=Ae[o],w=o+1;w<Ae.length&&c<ao;)c*=Ae[w++];for(c=a.modInt(c);o<w;)if(c%Ae[o++]==0)return!1}return a.millerRabin(s)}function ho(s){var o=this.subtract(t.ONE),a=o.getLowestSetBit();if(a<=0)return!1;var c=o.shiftRight(a);s=s+1>>1,s>Ae.length&&(s=Ae.length);for(var w=n(),v=0;v<s;++v){w.fromInt(Ae[Math.floor(Math.random()*Ae.length)]);var P=w.modPow(c,this);if(P.compareTo(t.ONE)!=0&&P.compareTo(o)!=0){for(var U=1;U++<a&&P.compareTo(o)!=0;)if(P=P.modPowInt(2,this),P.compareTo(t.ONE)==0)return!1;if(P.compareTo(o)!=0)return!1}}return!0}t.prototype.chunkSize=us,t.prototype.toRadix=ls,t.prototype.fromRadix=ds,t.prototype.fromNumber=bs,t.prototype.bitwiseTo=vs,t.prototype.changeBit=Is,t.prototype.addTo=zs,t.prototype.dMultiply=Fs,t.prototype.dAddOffset=Vs,t.prototype.multiplyLowerTo=$s,t.prototype.multiplyUpperTo=Ws,t.prototype.modInt=so,t.prototype.millerRabin=ho,t.prototype.clone=os,t.prototype.intValue=as,t.prototype.byteValue=fs,t.prototype.shortValue=hs,t.prototype.signum=cs,t.prototype.toByteArray=ps,t.prototype.equals=ys,t.prototype.min=ws,t.prototype.max=_s,t.prototype.and=xs,t.prototype.or=gs,t.prototype.xor=Es,t.prototype.andNot=Ss,t.prototype.not=As,t.prototype.shiftLeft=Ps,t.prototype.shiftRight=ks,t.prototype.getLowestSetBit=Ls,t.prototype.bitCount=Us,t.prototype.testBit=Bs,t.prototype.setBit=Hs,t.prototype.clearBit=Os,t.prototype.flipBit=Ds,t.prototype.add=Ms,t.prototype.subtract=Rs,t.prototype.multiply=Ns,t.prototype.divide=js,t.prototype.remainder=qs,t.prototype.divideAndRemainder=Gs,t.prototype.modPow=io,t.prototype.modInverse=oo,t.prototype.pow=Xs,t.prototype.gcd=no,t.prototype.isProbablePrime=fo,t.prototype.square=Cs,t.prototype.Barrett=ot;var Zt,Te,me;function uo(s){Te[me++]^=s&255,Te[me++]^=s>>8&255,Te[me++]^=s>>16&255,Te[me++]^=s>>24&255,me>=Qr&&(me-=Qr)}function Ki(){uo(new Date().getTime())}if(Te==null){Te=new Array,me=0;var ze;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var Ui=new Uint8Array(32);for(window.crypto.getRandomValues(Ui),ze=0;ze<32;++ze)Te[me++]=Ui[ze]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Bi=window.crypto.random(32);for(ze=0;ze<Bi.length;++ze)Te[me++]=Bi.charCodeAt(ze)&255}}for(;me<Qr;)ze=Math.floor(65536*Math.random()),Te[me++]=ze>>>8,Te[me++]=ze&255;me=0,Ki()}function co(){if(Zt==null){for(Ki(),Zt=yo(),Zt.init(Te),me=0;me<Te.length;++me)Te[me]=0;me=0}return Zt.next()}function lo(s){var o;for(o=0;o<s.length;++o)s[o]=co()}function $r(){}$r.prototype.nextBytes=lo;function Wr(){this.i=0,this.j=0,this.S=new Array}function bo(s){var o,a,c;for(o=0;o<256;++o)this.S[o]=o;for(a=0,o=0;o<256;++o)a=a+this.S[o]+s[o%s.length]&255,c=this.S[o],this.S[o]=this.S[a],this.S[a]=c;this.i=0,this.j=0}function po(){var s;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,s=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=s,this.S[s+this.S[this.i]&255]}Wr.prototype.init=bo,Wr.prototype.next=po;function yo(){return new Wr}var Qr=256;typeof zr<"u"?zr=Wn.exports={default:t,BigInteger:t,SecureRandom:$r}:this.jsbn={BigInteger:t,SecureRandom:$r}}).call(zr)});var ke=class extends Error{constructor(e){let r;e instanceof Error?r=e.message:typeof e=="string"?r=e:r="",super(r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}},Ke=class extends ke{},Oi=class extends ke{},$t=class extends ke{},yt=class extends ke{},Wt=class extends ke{},Qt=class extends ke{},Jt=class extends ke{},ft=class extends ke{},ht=class extends ke{},er=class extends ke{},tr=class extends ke{},Oe=class extends ke{};var Ne;(function(i){i[i.Base=0]="Base",i[i.Psk=1]="Psk",i[i.Auth=2]="Auth",i[i.AuthPsk=3]="AuthPsk"})(Ne||(Ne={}));var J;(function(i){i[i.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",i[i.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",i[i.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",i[i.DhkemSecp256K1HkdfSha256=19]="DhkemSecp256K1HkdfSha256",i[i.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",i[i.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512"})(J||(J={}));var Ue;(function(i){i[i.HkdfSha256=1]="HkdfSha256",i[i.HkdfSha384=2]="HkdfSha384",i[i.HkdfSha512=3]="HkdfSha512"})(Ue||(Ue={}));var ce;(function(i){i[i.Aes128Gcm=1]="Aes128Gcm",i[i.Aes256Gcm=2]="Aes256Gcm",i[i.Chacha20Poly1305=3]="Chacha20Poly1305",i[i.ExportOnly=65535]="ExportOnly"})(ce||(ce={}));var Eo={},Di=So(globalThis,Eo);function So(i,e){return new Proxy(i,{get(r,t,n){return t in e?e[t]:i[t]},set(r,t,n){return t in e&&delete e[t],i[t]=n,!0},deleteProperty(r,t){let n=!1;return t in e&&(delete e[t],n=!0),t in i&&(delete i[t],n=!0),n},ownKeys(r){let t=Reflect.ownKeys(i),n=Reflect.ownKeys(e),f=new Set(n);return[...t.filter(u=>!f.has(u)),...n]},defineProperty(r,t,n){return t in e&&delete e[t],Reflect.defineProperty(i,t,n),!0},getOwnPropertyDescriptor(r,t){return t in e?Reflect.getOwnPropertyDescriptor(e,t):Reflect.getOwnPropertyDescriptor(i,t)},has(r,t){return t in e||t in i}})}var ei=()=>typeof Di<"u",ti=()=>typeof caches<"u";var Ot=i=>typeof i=="object"&&i!==null&&typeof i.privateKey=="object"&&typeof i.publicKey=="object";function Pe(i,e){if(e<=0)throw new Error("i2Osp: too small size");if(i>=256**e)throw new Error("i2Osp: too large integer");let r=new Uint8Array(e);for(let t=0;t<e&&i;t++)r[e-(t+1)]=i%256,i=i>>8;return r}function zi(i,e){if(i.byteLength!==e.byteLength)throw new Error("xor: different length inputs");let r=new Uint8Array(i.byteLength);for(let t=0;t<i.byteLength;t++)r[t]=i[t]^e[t];return r}function Dt(i,e){let r=new Uint8Array(i.length+e.length);return r.set(i,0),r.set(e,i.length),r}function Mi(i,e,r){let t=new Uint8Array(i.length+e.length+r.length);return t.set(i,0),t.set(e,i.length),t.set(r,i.length+e.length),t}var Je=class{constructor(e){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=e}};async function Ri(){if((ei()||ti())&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:i}=await import("crypto");return i}catch{throw new Oe("Web Cryptograph API not supported")}}async function Ni(){if((ei()||ti())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:i}=await import("crypto");return i.subtle}catch{throw new Oe("Web Cryptograph API not supported")}}var et=["deriveBits"],Ci=["encrypt","decrypt"];var te=new Uint8Array(0),ri=new Uint8Array([72,80,75,69,45,118,49]),ji=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),ut=new Uint8Array([75,69,77,0,0]),tt=new Uint8Array([100,107,112,95,112,114,107]),qi=new Uint8Array([101,97,101,95,112,114,107]),Gi=new Uint8Array([105,110,102,111,95,104,97,115,104]),Fi=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),Vi=new Uint8Array([115,101,99,114,101,116]),Zi=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),Yi=new Uint8Array([107,101,121]),Xi=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),$i=new Uint8Array([101,120,112]),Wi=new Uint8Array([115,101,99]),Qi=new Uint8Array([99,97,110,100,105,100,97,116,101]),wt=new Uint8Array([115,107]),Ji=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),en=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),tn=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var _t=class extends Je{constructor(e,r,t){super(e),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=r,this.exporterSecret=t}async seal(e,r){return await this._emitError1()}async open(e,r){return await this._emitError1()}async setupBidirectional(e,r){return await this._emitError2()}async export(e,r){if(e.byteLength>128)throw new Ke("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,Wi,new Uint8Array(e),r)}catch(t){throw new Jt(t)}}_emitError1(){return new Promise((e,r)=>{r(new Oe("Not available on export-only mode"))})}_emitError2(){return new Promise((e,r)=>{r(new Oe("Not available on export-only mode"))})}},rr=class extends _t{},ir=class extends _t{constructor(e,r,t,n){super(e,r,t),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}};var nr=class{constructor(e,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=e,this._api=r}async seal(e,r,t){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let n={name:"AES-GCM",iv:e,additionalData:t};return await this._api.encrypt(n,this._key,r)}async open(e,r,t){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let n={name:"AES-GCM",iv:e,additionalData:t};return await this._api.decrypt(n,this._key,r)}async importKey(e){return await this._api.importKey("raw",e,{name:"AES-GCM"},!0,Ci)}},sr=class extends nr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}},or=class extends nr{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var wn=at(yn(),1);var dr=class{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new wn.ChaCha20Poly1305(new Uint8Array(e))}async seal(e,r,t){return await this._seal(e,r,t)}async open(e,r,t){return await this._open(e,r,t)}_seal(e,r,t){return new Promise(n=>{let f=this._key.seal(new Uint8Array(e),new Uint8Array(r),new Uint8Array(t));n(f.buffer)})}_open(e,r,t){return new Promise((n,f)=>{let u=this._key.open(new Uint8Array(e),new Uint8Array(r),new Uint8Array(t));u instanceof Uint8Array?n(u.buffer):f(new Error("failed to open."))})}};var gt=class extends _t{constructor(e,r,t){if(super(e,r,t.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.key===void 0||t.baseNonce===void 0||t.seq===void 0)throw new Error("Required parameters are missing");switch(this._aead=t.aead,this._aead){case ce.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case ce.Aes256Gcm:this._nK=32,this._nN=12,this._nT=16;break;case ce.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0;break}let n=br(this._aead,t.key,this._api);this._f={key:n,baseNonce:t.baseNonce,seq:t.seq},this._r={key:n,baseNonce:te,seq:0}}computeNonce(e){let r=Pe(e.seq,e.baseNonce.byteLength);return zi(e.baseNonce,r)}incrementSeq(e){if(e.seq>Number.MAX_SAFE_INTEGER)throw new er("Message limit reached");e.seq+=1}async setupBidirectional(e,r){try{this._r.baseNonce=new Uint8Array(await this.export(r,this._nN));let t=await this.export(e,this._nK);this._r.key=br(this._aead,t,this._api),this._r.seq=0}catch(t){throw this._r.baseNonce=te,t}}};function br(i,e,r){switch(i){case ce.Aes128Gcm:return new sr(e,r);case ce.Aes256Gcm:return new or(e,r);case ce.Chacha20Poly1305:return new dr(e);default:throw new Error("Invalid or unsupported AEAD id")}}var li=at(mn(),1),Pn=at(gn(),1),kn=at(An(),1);var Rt=class extends Je{constructor(e,r){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=r}buildLabeledIkm(e,r){let t=new Uint8Array(7+this.suiteId.byteLength+e.byteLength+r.byteLength);return t.set(ri,0),t.set(this.suiteId,7),t.set(e,7+this.suiteId.byteLength),t.set(r,7+this.suiteId.byteLength+e.byteLength),t}buildLabeledInfo(e,r,t){let n=new Uint8Array(9+this.suiteId.byteLength+e.byteLength+r.byteLength);return n.set(new Uint8Array([0,t]),0),n.set(ri,2),n.set(this.suiteId,9),n.set(e,9+this.suiteId.byteLength),n.set(r,9+this.suiteId.byteLength+e.byteLength),n}async extract(e,r){if(e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return(0,li.hmac)(Pn.SHA256,new Uint8Array(e),new Uint8Array(r));case"SHA-512":return(0,li.hmac)(kn.SHA512,new Uint8Array(e),new Uint8Array(r));default:throw new Oe(`${this.algHash.hash} key length should be ${this.hashSize}.`)}let t=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",t,r)}async expand(e,r,t){let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),f=new ArrayBuffer(t),u=new Uint8Array(f),h=te,b=new Uint8Array(r),p=new Uint8Array(1);if(t>255*this.hashSize)throw new Error("Entropy limit reached");let E=new Uint8Array(this.hashSize+b.length+1);for(let g=1,_=0;_<u.length;g++)p[0]=g,E.set(h,0),E.set(b,h.length),E.set(p,h.length+b.length),h=new Uint8Array(await this._api.sign("HMAC",n,E.slice(0,h.length+b.length+1))),u.length-_>=h.length?(u.set(h,_),_+=h.length):(u.set(h.slice(0,u.length-_),_),_+=u.length-_);return f}async extractAndExpand(e,r,t,n){let f=await this._api.importKey("raw",r,"HKDF",!1,et);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:t},f,n*8)}async labeledExtract(e,r,t){return await this.extract(e,this.buildLabeledIkm(r,t))}async labeledExpand(e,r,t,n){return await this.expand(e,this.buildLabeledInfo(r,t,n),n)}},it=class extends Rt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ue.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},At=class extends Rt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ue.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},ct=class extends Rt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ue.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var wr=class extends gt{async seal(e,r=te){if(this._r.baseNonce.length===0)throw new ft("Bidirectional encryption is not setup");let t;try{t=await this._r.key.seal(this.computeNonce(this._r),e,r)}catch(n){throw new ft(n)}return this.incrementSeq(this._r),t}async open(e,r=te){let t;try{t=await this._f.key.open(this.computeNonce(this._f),e,r)}catch(n){throw new ht(n)}return this.incrementSeq(this._f),t}};var _r=class extends gt{constructor(e,r,t,n){super(e,r,t),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}async seal(e,r=te){let t;try{t=await this._f.key.seal(this.computeNonce(this._f),e,r)}catch(n){throw new ft(n)}return this.incrementSeq(this._f),t}async open(e,r=te){if(this._r.baseNonce.length===0)throw new ht("Bidirectional encryption is not setup");let t;try{t=await this._r.key.open(this.computeNonce(this._r),e,r)}catch(n){throw new ht(n)}return this.incrementSeq(this._r),t}};var vr=class{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(this._num[e]!==0)return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let r=0;r<this._num.length;r++){if(this._num[r]<e[r])return!0;if(this._num[r]>e[r])return!1}return!1}};var va=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),ma=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),xa=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),Pt=class{constructor(e,r,t){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=r,this._api=t,e){case J.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=Ji,this._bitmask=255,this._pkcs8AlgId=va;break;case J.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=en,this._bitmask=255,this._pkcs8AlgId=ma;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=tn,this._bitmask=1,this._pkcs8AlgId=xa;break}}async serializePublicKey(e){let r=await this._api.exportKey("raw",e);if(r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");return r}async deserializePublicKey(e){if(e.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",e,this._alg,!0,[])}catch{throw new Error("Invalid public key for the ciphersuite")}}async importKey(e,r,t){if(e!=="raw")throw new Error("Unsupported format");if(t&&r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!t&&r.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");try{if(t)return await this._api.importKey(e,r,this._alg,!0,[]);let n=new Uint8Array(r),f=new Uint8Array(this._pkcs8AlgId.length+n.length);return f.set(this._pkcs8AlgId,0),f.set(n,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",f,this._alg,!0,et)}catch{throw new Error("Invalid key for the ciphersuite")}}async derivePublicKey(e){let r=await this._api.exportKey("jwk",e);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,et)}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(te,tt,new Uint8Array(e)),t=new vr(this._nSk);for(let u=0;t.isZero()||!t.lessThan(this._order);u++){if(u>255)throw new Error("Faild to derive a key pair");let h=new Uint8Array(await this._hkdf.labeledExpand(r,Qi,Pe(u,1),this._nSk));h[0]=h[0]&this._bitmask,t.set(h)}let n=new Uint8Array(this._pkcs8AlgId.length+t.val().length);n.set(this._pkcs8AlgId,0),n.set(t.val(),this._pkcs8AlgId.length);let f=await this._api.importKey("pkcs8",n,this._alg,!0,et);return t.reset(),{privateKey:f,publicKey:await this.derivePublicKey(f)}}async dh(e,r){return await this._api.deriveBits({name:"ECDH",public:r},e,this._nDh*8)}};var ga=at(di(),1);var re=BigInt(0),oe=BigInt(1),nt=BigInt(2),jt=BigInt(3),Tn=BigInt(8),ye=Object.freeze({a:re,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:oe,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Ln=(i,e)=>(i+e/nt)/e,mr={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(i){let{n:e}=ye,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),t=-oe*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),f=r,u=BigInt("0x100000000000000000000000000000000"),h=Ln(f*i,e),b=Ln(-t*i,e),p=I(i-h*r-b*n,e),E=I(-h*t-b*f,e),g=p>u,_=E>u;if(g&&(p=e-p),_&&(E=e-E),p>u||E>u)throw new Error("splitScalarEndo: Endomorphism failed, k="+i);return{k1neg:g,k1:p,k2neg:_,k2:E}}},kt=32,qt=32;var Sr=kt+1,Ar=2*kt+1;function Kn(i){let{a:e,b:r}=ye,t=I(i*i),n=I(t*i);return I(n+e*i+r)}var xr=ye.a===re,yi=class extends Error{constructor(e){super(e)}};function Un(i){if(!(i instanceof ee))throw new TypeError("JacobianPoint expected")}var ee=class{constructor(e,r,t){this.x=e,this.y=r,this.z=t}static fromAffine(e){if(!(e instanceof ie))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(ie.ZERO)?ee.ZERO:new ee(e.x,e.y,oe)}static toAffineBatch(e){let r=ka(e.map(t=>t.z));return e.map((t,n)=>t.toAffine(r[n]))}static normalizeZ(e){return ee.toAffineBatch(e).map(ee.fromAffine)}equals(e){Un(e);let{x:r,y:t,z:n}=this,{x:f,y:u,z:h}=e,b=I(n*n),p=I(h*h),E=I(r*p),g=I(f*b),_=I(I(t*h)*p),y=I(I(u*n)*b);return E===g&&_===y}negate(){return new ee(this.x,I(-this.y),this.z)}double(){let{x:e,y:r,z:t}=this,n=I(e*e),f=I(r*r),u=I(f*f),h=e+f,b=I(nt*(I(h*h)-n-u)),p=I(jt*n),E=I(p*p),g=I(E-nt*b),_=I(p*(b-g)-Tn*u),y=I(nt*r*t);return new ee(g,_,y)}add(e){Un(e);let{x:r,y:t,z:n}=this,{x:f,y:u,z:h}=e;if(f===re||u===re)return this;if(r===re||t===re)return e;let b=I(n*n),p=I(h*h),E=I(r*p),g=I(f*b),_=I(I(t*h)*p),y=I(I(u*n)*b),k=I(g-E),T=I(y-_);if(k===re)return T===re?this.double():ee.ZERO;let D=I(k*k),O=I(k*D),z=I(E*D),K=I(T*T-O-nt*z),H=I(T*(z-K)-_*O),M=I(n*h*k);return new ee(K,H,M)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=ee.ZERO;if(typeof e=="bigint"&&e===re)return r;let t=On(e);if(t===oe)return this;if(!xr){let g=r,_=this;for(;t>re;)t&oe&&(g=g.add(_)),_=_.double(),t>>=oe;return g}let{k1neg:n,k1:f,k2neg:u,k2:h}=mr.splitScalar(t),b=r,p=r,E=this;for(;f>re||h>re;)f&oe&&(b=b.add(E)),h&oe&&(p=p.add(E)),E=E.double(),f>>=oe,h>>=oe;return n&&(b=b.negate()),u&&(p=p.negate()),p=new ee(I(p.x*mr.beta),p.y,p.z),b.add(p)}precomputeWindow(e){let r=xr?128/e+1:256/e+1,t=[],n=this,f=n;for(let u=0;u<r;u++){f=n,t.push(f);for(let h=1;h<2**(e-1);h++)f=f.add(n),t.push(f);n=f.double()}return t}wNAF(e,r){!r&&this.equals(ee.BASE)&&(r=ie.BASE);let t=r&&r._WINDOW_SIZE||1;if(256%t)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=r&&wi.get(r);n||(n=this.precomputeWindow(t),r&&t!==1&&(n=ee.normalizeZ(n),wi.set(r,n)));let f=ee.ZERO,u=ee.BASE,h=1+(xr?128/t:256/t),b=2**(t-1),p=BigInt(2**t-1),E=2**t,g=BigInt(t);for(let _=0;_<h;_++){let y=_*b,k=Number(e&p);e>>=g,k>b&&(k-=E,e+=oe);let T=y,D=y+Math.abs(k)-1,O=_%2!==0,z=k<0;k===0?u=u.add(gr(O,n[T])):f=f.add(gr(z,n[D]))}return{p:f,f:u}}multiply(e,r){let t=On(e),n,f;if(xr){let{k1neg:u,k1:h,k2neg:b,k2:p}=mr.splitScalar(t),{p:E,f:g}=this.wNAF(h,r),{p:_,f:y}=this.wNAF(p,r);E=gr(u,E),_=gr(b,_),_=new ee(I(_.x*mr.beta),_.y,_.z),n=E.add(_),f=g.add(y)}else{let{p:u,f:h}=this.wNAF(t,r);n=u,f=h}return ee.normalizeZ([n,f])[0]}toAffine(e){let{x:r,y:t,z:n}=this,f=this.equals(ee.ZERO);e==null&&(e=f?Tn:Lr(n));let u=e,h=I(u*u),b=I(h*u),p=I(r*h),E=I(t*b),g=I(n*u);if(f)return ie.ZERO;if(g!==oe)throw new Error("invZ was invalid");return new ie(p,E)}};ee.BASE=new ee(ye.Gx,ye.Gy,oe);ee.ZERO=new ee(re,oe,re);function gr(i,e){let r=e.negate();return i?r:e}var wi=new WeakMap,ie=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,wi.delete(this)}hasEvenY(){return this.y%nt===re}static fromCompressedHex(e){let r=e.length===32,t=bt(r?e:e.subarray(1));if(!pi(t))throw new Error("Point is not on curve");let n=Kn(t),f=Pa(n),u=(f&oe)===oe;r?u&&(f=I(-f)):(e[0]&1)===1!==u&&(f=I(-f));let h=new ie(t,f);return h.assertValidity(),h}static fromUncompressedHex(e){let r=bt(e.subarray(1,kt+1)),t=bt(e.subarray(kt+1,kt*2+1)),n=new ie(r,t);return n.assertValidity(),n}static fromHex(e){let r=_i(e),t=r.length,n=r[0];if(t===kt)return this.fromCompressedHex(r);if(t===Sr&&(n===2||n===3))return this.fromCompressedHex(r);if(t===Ar&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Sr} compressed bytes or ${Ar} uncompressed bytes, not ${t}`)}static fromPrivateKey(e){return ie.BASE.multiply(Tr(e))}static fromSignature(e,r,t){let{r:n,s:f}=Ua(r);if(![0,1,2,3].includes(t))throw new Error("Cannot recover: invalid recovery bit");let u=La(_i(e)),{n:h}=ye,b=t===2||t===3?n+h:n,p=Lr(b,h),E=I(-u*p,h),g=I(f*p,h),_=t&1?"03":"02",y=ie.fromHex(_+Tt(b)),k=ie.BASE.multiplyAndAddUnsafe(y,E,g);if(!k)throw new Error("Cannot recover signature: point at infinify");return k.assertValidity(),k}toRawBytes(e=!1){return dt(this.toHex(e))}toHex(e=!1){let r=Tt(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${Tt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:t}=this;if(!pi(r)||!pi(t))throw new Error(e);let n=I(t*t),f=Kn(r);if(I(n-f)!==re)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ie(this.x,I(-this.y))}double(){return ee.fromAffine(this).double().toAffine()}add(e){return ee.fromAffine(this).add(ee.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ee.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,t){let n=ee.fromAffine(this),f=r===re||r===oe||this!==ie.BASE?n.multiplyUnsafe(r):n.multiply(r),u=ee.fromAffine(e).multiplyUnsafe(t),h=f.add(u);return h.equals(ee.ZERO)?void 0:h.toAffine()}};ie.BASE=new ie(ye.Gx,ye.Gy);ie.ZERO=new ie(re,re);function Bn(i){return Number.parseInt(i[0],16)>=8?"00"+i:i}function In(i){if(i.length<2||i[0]!==2)throw new Error(`Invalid signature integer tag: ${Kt(i)}`);let e=i[1],r=i.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:bt(r),left:i.subarray(e+2)}}function Ea(i){if(i.length<2||i[0]!=48)throw new Error(`Invalid signature tag: ${Kt(i)}`);if(i[1]!==i.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=In(i.subarray(2)),{data:t,left:n}=In(r);if(n.length)throw new Error(`Invalid signature: left bytes after parsing: ${Kt(n)}`);return{r:e,s:t}}var Xe=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,t="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${t}: Expected string or Uint8Array`);let n=r?Kt(e):e;if(n.length!==128)throw new Error(`${t}: Expected 64-byte hex`);return new Xe(Pr(n.slice(0,64)),Pr(n.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:t,s:n}=Ea(r?e:dt(e));return new Xe(t,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!kr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!kr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ye.n>>oe;return this.s>e}normalizeS(){return this.hasHighS()?new Xe(this.r,I(-this.s,ye.n)):this}toDERRawBytes(){return dt(this.toDERHex())}toDERHex(){let e=Bn(Ct(this.s)),r=Bn(Ct(this.r)),t=e.length/2,n=r.length/2,f=Ct(t),u=Ct(n);return`30${Ct(n+t+4)}02${u}${r}02${f}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return dt(this.toCompactHex())}toCompactHex(){return Tt(this.r)+Tt(this.s)}};function Nt(...i){if(!i.every(t=>t instanceof Uint8Array))throw new Error("Uint8Array list expected");if(i.length===1)return i[0];let e=i.reduce((t,n)=>t+n.length,0),r=new Uint8Array(e);for(let t=0,n=0;t<i.length;t++){let f=i[t];r.set(f,n),n+=f.length}return r}var Sa=Array.from({length:256},(i,e)=>e.toString(16).padStart(2,"0"));function Kt(i){if(!(i instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<i.length;r++)e+=Sa[i[r]];return e}var Aa=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Tt(i){if(typeof i!="bigint")throw new Error("Expected bigint");if(!(re<=i&&i<Aa))throw new Error("Expected number 0 <= n < 2^256");return i.toString(16).padStart(64,"0")}function Hn(i){let e=dt(Tt(i));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Ct(i){let e=i.toString(16);return e.length&1?`0${e}`:e}function Pr(i){if(typeof i!="string")throw new TypeError("hexToNumber: expected string, got "+typeof i);return BigInt(`0x${i}`)}function dt(i){if(typeof i!="string")throw new TypeError("hexToBytes: expected string, got "+typeof i);if(i.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+i.length);let e=new Uint8Array(i.length/2);for(let r=0;r<e.length;r++){let t=r*2,n=i.slice(t,t+2),f=Number.parseInt(n,16);if(Number.isNaN(f)||f<0)throw new Error("Invalid byte sequence");e[r]=f}return e}function bt(i){return Pr(Kt(i))}function _i(i){return i instanceof Uint8Array?Uint8Array.from(i):dt(i)}function On(i){if(typeof i=="number"&&Number.isSafeInteger(i)&&i>0)return BigInt(i);if(typeof i=="bigint"&&kr(i))return i;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function I(i,e=ye.P){let r=i%e;return r>=re?r:e+r}function De(i,e){let{P:r}=ye,t=i;for(;e-- >re;)t*=t,t%=r;return t}function Pa(i){let{P:e}=ye,r=BigInt(6),t=BigInt(11),n=BigInt(22),f=BigInt(23),u=BigInt(44),h=BigInt(88),b=i*i*i%e,p=b*b*i%e,E=De(p,jt)*p%e,g=De(E,jt)*p%e,_=De(g,nt)*b%e,y=De(_,t)*_%e,k=De(y,n)*y%e,T=De(k,u)*k%e,D=De(T,h)*T%e,O=De(D,u)*k%e,z=De(O,jt)*p%e,K=De(z,f)*y%e,H=De(K,r)*b%e,M=De(H,nt);if(M*M%e!==i)throw new Error("Cannot find square root");return M}function Lr(i,e=ye.P){if(i===re||e<=re)throw new Error(`invert: expected positive integers, got n=${i} mod=${e}`);let r=I(i,e),t=e,n=re,f=oe,u=oe,h=re;for(;r!==re;){let p=t/r,E=t%r,g=n-u*p,_=f-h*p;t=r,r=E,n=u,f=h,u=g,h=_}if(t!==oe)throw new Error("invert: does not exist");return I(n,e)}function ka(i,e=ye.P){let r=new Array(i.length),t=i.reduce((f,u,h)=>u===re?f:(r[h]=f,I(f*u,e)),oe),n=Lr(t,e);return i.reduceRight((f,u,h)=>u===re?f:(r[h]=I(f*r[h],e),I(f*u,e)),n),r}function Ta(i){let e=i.length*8-qt*8,r=bt(i);return e>0?r>>BigInt(e):r}function La(i,e=!1){let r=Ta(i);if(e)return r;let{n:t}=ye;return r>=t?r-t:r}var Lt,bi;function kr(i){return re<i&&i<ye.n}function pi(i){return re<i&&i<ye.P}function Tr(i){let e;if(typeof i=="bigint")e=i;else if(typeof i=="number"&&Number.isSafeInteger(i)&&i>0)e=BigInt(i);else if(typeof i=="string"){if(i.length!==2*qt)throw new Error("Expected 32 bytes of private key");e=Pr(i)}else if(i instanceof Uint8Array){if(i.length!==qt)throw new Error("Expected 32 bytes of private key");e=bt(i)}else throw new TypeError("Expected valid private key");if(!kr(e))throw new Error("Expected private key: 0 < key < n");return e}function Ka(i){return i instanceof ie?(i.assertValidity(),i):ie.fromHex(i)}function Ua(i){if(i instanceof Xe)return i.assertValidity(),i;try{return Xe.fromDER(i)}catch{return Xe.fromCompact(i)}}function zn(i,e=!1){return ie.fromPrivateKey(i).toRawBytes(e)}function Dn(i){let e=i instanceof Uint8Array,r=typeof i=="string",t=(e||r)&&i.length;return e?t===Sr||t===Ar:r?t===Sr*2||t===Ar*2:i instanceof ie}function Mn(i,e,r=!1){if(Dn(i))throw new TypeError("getSharedSecret: first arg must be private key");if(!Dn(e))throw new TypeError("getSharedSecret: second arg must be public key");let t=Ka(e);return t.assertValidity(),t.multiply(Tr(i)).toRawBytes(r)}ie.BASE._setWindowSize(8);var Ie={node:ga,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Er={},lt={bytesToHex:Kt,hexToBytes:dt,concatBytes:Nt,mod:I,invert:Lr,isValidPrivateKey(i){try{return Tr(i),!0}catch{return!1}},_bigintTo32Bytes:Hn,_normalizePrivateKey:Tr,hashToPrivateKey:i=>{i=_i(i);let e=qt+8;if(i.length<e||i.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=I(bt(i),ye.n-oe)+oe;return Hn(r)},randomBytes:(i=32)=>{if(Ie.web)return Ie.web.getRandomValues(new Uint8Array(i));if(Ie.node){let{randomBytes:e}=Ie.node;return Uint8Array.from(e(i))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>lt.hashToPrivateKey(lt.randomBytes(qt+8)),precompute(i=8,e=ie.BASE){let r=e===ie.BASE?e:new ie(e.x,e.y);return r._setWindowSize(i),r.multiply(jt),r},sha256:async(...i)=>{if(Ie.web){let e=await Ie.web.subtle.digest("SHA-256",Nt(...i));return new Uint8Array(e)}else if(Ie.node){let{createHash:e}=Ie.node,r=e("sha256");return i.forEach(t=>r.update(t)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(i,...e)=>{if(Ie.web){let r=await Ie.web.subtle.importKey("raw",i,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),t=Nt(...e),n=await Ie.web.subtle.sign("HMAC",r,t);return new Uint8Array(n)}else if(Ie.node){let{createHmac:r}=Ie.node,t=r("sha256",i);return e.forEach(n=>t.update(n)),Uint8Array.from(t.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(i,...e)=>{let r=Er[i];if(r===void 0){let t=await lt.sha256(Uint8Array.from(i,n=>n.charCodeAt(0)));r=Nt(t,t),Er[i]=r}return lt.sha256(r,...e)},taggedHashSync:(i,...e)=>{if(typeof Lt!="function")throw new yi("sha256Sync is undefined, you need to set it");let r=Er[i];if(r===void 0){let t=Lt(Uint8Array.from(i,n=>n.charCodeAt(0)));r=Nt(t,t),Er[i]=r}return Lt(r,...e)},_JacobianPoint:ee};Object.defineProperties(lt,{sha256Sync:{configurable:!1,get(){return Lt},set(i){Lt||(Lt=i)}},hmacSha256Sync:{configurable:!1,get(){return bi},set(i){bi||(bi=i)}}});var pe=class{constructor(e,r,t){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:et}),this.key=r,this.type=t,this.algorithm={name:e}}};var Gt="ECDH",Kr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=65,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,t){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,t)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=lt.randomPrivateKey(),r=new pe(Gt,e,"private");return{publicKey:await this.derivePublicKey(r),privateKey:r}}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(te,tt,new Uint8Array(e)),t=await this._hkdf.labeledExpand(r,wt,te,this._nSk),n=new pe(Gt,new Uint8Array(t),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,t)=>{e.byteLength!==this._nPk?t(new Error("Invalid public key for the ciphersuite")):r(new pe(Gt,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((t,n)=>{r&&e.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),t(new pe(Gt,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{let t=zn(e.key);r(new pe(Gt,t,"public"))})}_dh(e,r){return new Promise((t,n)=>{try{t(Mn(e.key,r.key).buffer)}catch(f){n(f)}})}};var Bt=at($n(),1);var Ut="X25519",Dr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=32,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,t){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,t)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=await(0,Bt.generateKeyPair)();return{publicKey:new pe(Ut,e.publicKey,"public"),privateKey:new pe(Ut,e.secretKey,"private")}}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(te,tt,new Uint8Array(e)),t=await this._hkdf.labeledExpand(r,wt,te,this._nSk),n=new pe(Ut,new Uint8Array(t),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,t)=>{e.byteLength!==this._nPk?t(new Error("Invalid public key for the ciphersuite")):r(new pe(Ut,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((t,n)=>{r&&e.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),t(new pe(Ut,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{r(new pe(Ut,(0,Bt.scalarMultBase)(e.key),"public"))})}_dh(e,r){return new Promise((t,n)=>{try{t((0,Bt.sharedKey)(e.key,r.key,!0))}catch(f){n(f)}})}};var It=at(Qn());function pt(i){return new It.BigInteger(i.toString(10))}var Nr=It.BigInteger.ZERO,Ai=It.BigInteger.ONE,Ya=pt(2),Xa=pt(3),$a=pt(5),Wa=pt(128),Qa=pt(255);function Mr(i){return i.multiply(i)}var ae=new It.BigInteger("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439"),Ja=new It.BigInteger("39081");function Rr(i,e,r){var t=i.multiply(e.subtract(r)).mod(ae);return[e.subtract(t).mod(ae),r.add(t).mod(ae)]}function Jn(i,e){for(var r=e,t=Ai,n=Nr,f=e,u=Ai,h=Nr,b=448-1;b>=0;--b){var p=i.shiftRight(b).and(Ai);h=h.xor(p);{var E=Rr(h,t,f),g=E[0],_=E[1];t=g,f=_}{var y=Rr(h,n,u),k=y[0],T=y[1];n=k,u=T}h=p;var D=t.add(n).mod(ae),O=Mr(D).mod(ae),z=t.subtract(n).mod(ae),K=Mr(z).mod(ae),H=O.subtract(K).mod(ae),M=f.add(u).mod(ae),N=f.subtract(u).mod(ae),l=N.multiply(D).mod(ae),d=M.multiply(z).mod(ae);f=Mr(l.add(d).mod(ae)).mod(ae),u=r.multiply(Mr(l.subtract(d).mod(ae))).mod(ae),t=O.multiply(K).mod(ae),n=H.multiply(O.add(Ja.multiply(H).mod(ae)).mod(ae)).mod(ae)}var B=Rr(h,t,f),R=B[0],S=Rr(h,n,u),m=S[0];return R.multiply(m.modPow(ae.subtract(Ya),ae)).mod(ae)}function ef(i){return i.map(function(e,r){return pt(e).shiftLeft(8*r)}).reduce(function(e,r){return e.add(r)},Nr)}function es(i){var e=[].concat(i);return e[0]&=252,e[55]|=128,ef(e)}function tf(i){if(i.length!==56)throw new Error("Invalid Curve448 scalar (len="+i.length+")");return i.map(function(e,r){return pt(e).shiftLeft(8*r)}).reduce(function(e,r){return e.add(r)},Nr)}function ts(i){return Array.from({length:56},function(e,r){return i.shiftRight(8*r).and(Qa).intValue()})}function rs(i){return i.andNot(Xa).or(Wa.shiftLeft(8*55))}function rf(i,e){var r=rs(es(i)),t=tf(e);return ts(Jn(r,t))}function nf(i){var e=rs(es(i));return ts(Jn(e,$a))}function is(i){if(!i)throw new Error("Missing private key");if(i.length!==56)throw new Error("Invalid Curve448 private key (len="+i.length+")");return nf(Array.from(i))}function ns(i,e){if(!i)throw new Error("Missing private key");if(!e)throw new Error("Missing public key");if(i.length!==56)throw new Error("Invalid Curve448 private key (len="+i.length+")");var r=rf(Array.from(i),Array.from(e));if(!r.some(function(t){return t}))throw new Error("Invalid Curve448 public key");return r}var Cr="X448",jr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,t){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,t)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=new Uint8Array(56);return(await Ri()).getRandomValues(e),await this.deriveKeyPair(e)}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(te,tt,new Uint8Array(e)),t=await this._hkdf.labeledExpand(r,wt,te,this._nSk),n=new pe(Cr,new Uint8Array(t),"private");return{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,t)=>{e.byteLength!==this._nPk?t(new Error("Invalid public key for the ciphersuite")):r(new pe(Cr,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((t,n)=>{r&&e.byteLength!==this._nPk&&n(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&n(new Error("Invalid private key for the ciphersuite")),t(new pe(Cr,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{r(new pe(Cr,Uint8Array.from(is(e.key)),"public"))})}_dh(e,r){return new Promise((t,n)=>{try{t(Uint8Array.from(ns(e.key,r.key)))}catch(f){n(f)}})}};var st=class extends Je{constructor(e,r,t){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=r,this._kdf=t}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(e){throw new Oe(e)}}async deriveKeyPair(e){try{return await this._prim.deriveKeyPair(e)}catch(r){throw new tr(r)}}async serializePublicKey(e){try{return await this._prim.serializePublicKey(e)}catch(r){throw new $t(r)}}async deserializePublicKey(e){try{return await this._prim.deserializePublicKey(e)}catch(r){throw new yt(r)}}async importKey(e,r,t){try{return await this._prim.importKey(e,r,t)}catch(n){throw new yt(n)}}async encap(e){try{let r=e.nonEphemeralKeyPair===void 0?await this.generateKeyPair():e.nonEphemeralKeyPair,t=await this._prim.serializePublicKey(r.publicKey),n=await this._prim.serializePublicKey(e.recipientPublicKey),f;if(e.senderKey===void 0)f=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey));else{let b=Ot(e.senderKey)?e.senderKey.privateKey:e.senderKey,p=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey)),E=new Uint8Array(await this._prim.dh(b,e.recipientPublicKey));f=Dt(p,E)}let u;if(e.senderKey===void 0)u=Dt(new Uint8Array(t),new Uint8Array(n));else{let b=Ot(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),p=await this._prim.serializePublicKey(b);u=Mi(new Uint8Array(t),new Uint8Array(n),new Uint8Array(p))}let h=await this.generateSharedSecret(f,u);return{enc:t,sharedSecret:h}}catch(r){throw new Wt(r)}}async decap(e){let r;try{r=await this._prim.deserializePublicKey(e.enc)}catch(t){throw new yt(t)}try{let t=Ot(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,n=Ot(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),f=await this._prim.serializePublicKey(n),u;if(e.senderPublicKey===void 0)u=new Uint8Array(await this._prim.dh(t,r));else{let b=new Uint8Array(await this._prim.dh(t,r)),p=new Uint8Array(await this._prim.dh(t,e.senderPublicKey));u=Dt(b,p)}let h;if(e.senderPublicKey===void 0)h=Dt(new Uint8Array(e.enc),new Uint8Array(f));else{let b=await this._prim.serializePublicKey(e.senderPublicKey);h=new Uint8Array(e.enc.byteLength+f.byteLength+b.byteLength),h.set(new Uint8Array(e.enc),0),h.set(new Uint8Array(f),e.enc.byteLength),h.set(new Uint8Array(b),e.enc.byteLength+f.byteLength)}return await this.generateSharedSecret(u,h)}catch(t){throw new Qt(t)}}async generateSharedSecret(e,r){let t=this._kdf.buildLabeledIkm(qi,e),n=this._kdf.buildLabeledInfo(Zi,r,this.secretSize);return await this._kdf.extractAndExpand(te,t,n,this.secretSize)}},qr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemP256HkdfSha256,2),3);let t=new it(e,r),n=new Pt(J.DhkemP256HkdfSha256,t,e);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Gr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemP384HkdfSha384,2),3);let t=new At(e,r),n=new Pt(J.DhkemP384HkdfSha384,t,e);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},Fr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemP521HkdfSha512,2),3);let t=new ct(e,r),n=new Pt(J.DhkemP521HkdfSha512,t,e);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}},Vr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemSecp256K1HkdfSha256,2),3);let t=new it(e,r),n=new Kr(t);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Zr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemX25519HkdfSha256,2),3);let t=new it(e,r),n=new Dr(t);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Yr=class extends st{constructor(e){let r=new Uint8Array(ut);r.set(Pe(J.DhkemX448HkdfSha512,2),3);let t=new ct(e,r),n=new jr(t);super(e,n,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};var Pi=class{constructor(e){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.kem){case J.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case J.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case J.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case J.DhkemSecp256K1HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case J.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case J.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new Ke("Invalid KEM id")}switch(this.kem=e.kem,e.kdf){case Ue.HkdfSha256:case Ue.HkdfSha384:case Ue.HkdfSha512:break;default:throw new Ke("Invalid KDF id")}switch(this.kdf=e.kdf,e.aead){case ce.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ce.Aes256Gcm:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ce.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case ce.ExportOnly:break;default:throw new Ke("Invalid AEAD id")}this.aead=e.aead,this._suiteId=new Uint8Array(ji),this._suiteId.set(Pe(this.kem,2),4),this._suiteId.set(Pe(this.kdf,2),6),this._suiteId.set(Pe(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(e){return await this.setup(),br(this.aead,e,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>128)throw new Ke("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(e)}async importKey(e,r,t=!0){return await this.setup(),await this._kem.importKey(e,r,t)}async createSenderContext(e){this.validateInputLength(e),await this.setup();let r=await this._kem.encap(e),t;return e.psk!==void 0?t=e.senderKey!==void 0?Ne.AuthPsk:Ne.Psk:t=e.senderKey!==void 0?Ne.Auth:Ne.Base,await this.keyScheduleS(t,r.sharedSecret,r.enc,e)}async createRecipientContext(e){this.validateInputLength(e),await this.setup();let r=await this._kem.decap(e),t;return e.psk!==void 0?t=e.senderPublicKey!==void 0?Ne.AuthPsk:Ne.Psk:t=e.senderPublicKey!==void 0?Ne.Auth:Ne.Base,await this.keyScheduleR(t,r,e)}async seal(e,r,t=te){let n=await this.createSenderContext(e);return{ct:await n.seal(r,t),enc:n.enc}}async open(e,r,t=te){return await(await this.createRecipientContext(e)).open(r,t)}async setup(){this._api=await Ni(),(this._kem===void 0||this._kdf===void 0)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(e,r,t){let n=this.createKdfContext(),f=t.psk===void 0?te:new Uint8Array(t.psk.id),u=await n.labeledExtract(te,Fi,f),h=t.info===void 0?te:new Uint8Array(t.info),b=await n.labeledExtract(te,Gi,h),p=new Uint8Array(1+u.byteLength+b.byteLength);p.set(new Uint8Array([e]),0),p.set(new Uint8Array(u),1),p.set(new Uint8Array(b),1+u.byteLength);let E=t.psk===void 0?te:new Uint8Array(t.psk.key),g=n.buildLabeledIkm(Vi,E),_=n.buildLabeledInfo($i,p,n.hashSize),y=await n.extractAndExpand(r,g,_,n.hashSize);if(this.aead===ce.ExportOnly)return{params:{aead:this.aead,exporterSecret:y},kdf:n};let k=n.buildLabeledInfo(Yi,p,this.aeadKeySize),T=await n.extractAndExpand(r,g,k,this.aeadKeySize),D=n.buildLabeledInfo(Xi,p,this.aeadNonceSize),O=await n.extractAndExpand(r,g,D,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:y,key:T,baseNonce:new Uint8Array(O),seq:0},kdf:n}}async keyScheduleS(e,r,t,n){let f=await this.keySchedule(e,r,n);return f.params.key===void 0?new ir(this._api,f.kdf,f.params.exporterSecret,t):new _r(this._api,f.kdf,f.params,t)}async keyScheduleR(e,r,t){let n=await this.keySchedule(e,r,t);return n.params.key===void 0?new rr(this._api,n.kdf,n.params.exporterSecret):new wr(this._api,n.kdf,n.params)}validateInputLength(e){if(e.info!==void 0&&e.info.byteLength>128)throw new Ke("Too long info");if(e.psk!==void 0){if(e.psk.key.byteLength<32)throw new Ke(`PSK must have at least ${32} bytes`);if(e.psk.key.byteLength>128)throw new Ke("Too long psk.key");if(e.psk.id.byteLength>128)throw new Ke("Too long psk.id")}}createKemContext(){switch(this.kem){case J.DhkemP256HkdfSha256:return new qr(this._api);case J.DhkemP384HkdfSha384:return new Gr(this._api);case J.DhkemP521HkdfSha512:return new Fr(this._api);case J.DhkemX25519HkdfSha256:return new Zr(this._api);case J.DhkemX448HkdfSha512:return new Yr(this._api);default:return new Vr(this._api)}}createKdfContext(){switch(this.kdf){case Ue.HkdfSha256:return new it(this._api,this._suiteId);case Ue.HkdfSha384:return new At(this._api,this._suiteId);default:return new ct(this._api,this._suiteId)}}};export{ce as Aead,Pi as CipherSuite,Qt as DecapError,tr as DeriveKeyPairError,yt as DeserializeError,Wt as EncapError,Jt as ExportError,Ke as InvalidParamError,Ue as Kdf,J as Kem,er as MessageLimitReachedError,Oe as NotSupportedError,ht as OpenError,ft as SealError,$t as SerializeError,Oi as ValidationError};
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
