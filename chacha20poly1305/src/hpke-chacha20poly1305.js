function xe(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function J(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Q(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function R(t,...e){if(!xe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ie(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ge(t,e){R(t);let n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function G(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function F(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function je(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}var Re=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Me(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ee(t){if(typeof t=="string")t=Me(t);else if(xe(t))t=te(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function me(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function _e(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}var ne=(t,e)=>{function n(r,...s){if(R(r),!Re)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){let l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?R(l):R(l,t.nonceLength)}let i=t.tagLength;i&&s[1]!==void 0&&R(s[1]);let a=e(r,...s),o=(l,y)=>{if(y!==void 0){if(l!==2)throw new Error("cipher output not supported");R(y)}},c=!1;return{encrypt(l,y){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,R(l),o(a.encrypt.length,y),a.encrypt(l,y)},decrypt(l,y){if(R(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return o(a.decrypt.length,y),a.decrypt(l,y)}}}return Object.assign(n,t),n};function se(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!Ne(e))throw new Error("invalid output, must be aligned");return e}function be(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);let s=BigInt(32),i=BigInt(4294967295),a=Number(n>>s&i),o=Number(n&i),c=r?4:0,h=r?0:4;t.setUint32(e+c,a,r),t.setUint32(e+h,o,r)}function Ke(t,e,n){J(n);let r=new Uint8Array(16),s=je(r);return be(s,0,BigInt(e),n),be(s,8,BigInt(t),n),r}function Ne(t){return t.byteOffset%4===0}function te(t){return Uint8Array.from(t)}var Ae=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Ge=Ae("expand 16-byte k"),Fe=Ae("expand 32-byte k"),$e=G(Ge),Xe=G(Fe);function f(t,e){return t<<e|t>>>32-e}function ae(t){return t.byteOffset%4===0}var re=64,Ye=16,ve=2**32-1,Pe=new Uint32Array;function Ve(t,e,n,r,s,i,a,o){let c=s.length,h=new Uint8Array(re),l=G(h),y=ae(s)&&ae(i),x=y?G(s):Pe,b=y?G(i):Pe;for(let p=0;p<c;a++){if(t(e,n,r,l,a,o),a>=ve)throw new Error("arx: counter overflow");let w=Math.min(re,c-p);if(y&&w===re){let d=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let g=0,m;g<Ye;g++)m=d+g,b[m]=x[m]^l[g];p+=re;continue}for(let d=0,g;d<w;d++)g=p+d,i[g]=s[g]^h[d];p+=w}}function oe(t,e){let{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:a}=me({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Q(s),Q(a),J(i),J(n),(o,c,h,l,y=0)=>{R(o),R(c),R(h);let x=h.length;if(l===void 0&&(l=new Uint8Array(x)),R(l),Q(y),y<0||y>=ve)throw new Error("arx: counter overflow");if(l.length<x)throw new Error(`arx: output (${l.length}) is shorter than data (${x})`);let b=[],p=o.length,w,d;if(p===32)b.push(w=te(o)),d=Xe;else if(p===16&&n)w=new Uint8Array(32),w.set(o),w.set(o,16),d=$e,b.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);ae(c)||b.push(c=te(c));let g=G(w);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(d,g,G(c.subarray(0,16)),g),c=c.subarray(16)}let m=16-s;if(m!==c.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let O=new Uint8Array(12);O.set(c,i?0:12-c.length),c=O,b.push(c)}let T=G(c);return Ve(t,d,g,T,h,l,y,a),F(...b),l}}var H=(t,e)=>t[e++]&255|(t[e++]&255)<<8,fe=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=ee(e),R(e,32);let n=H(e,0),r=H(e,2),s=H(e,4),i=H(e,6),a=H(e,8),o=H(e,10),c=H(e,12),h=H(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|o<<2)&8191,this.r[7]=(o>>>11|c<<5)&8065,this.r[8]=(c>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let l=0;l<8;l++)this.pad[l]=H(e,16+2*l)}process(e,n,r=!1){let s=r?0:2048,{h:i,r:a}=this,o=a[0],c=a[1],h=a[2],l=a[3],y=a[4],x=a[5],b=a[6],p=a[7],w=a[8],d=a[9],g=H(e,n+0),m=H(e,n+2),T=H(e,n+4),O=H(e,n+6),M=H(e,n+8),C=H(e,n+10),D=H(e,n+12),j=H(e,n+14),_=i[0]+(g&8191),K=i[1]+((g>>>13|m<<3)&8191),P=i[2]+((m>>>10|T<<6)&8191),A=i[3]+((T>>>7|O<<9)&8191),v=i[4]+((O>>>4|M<<12)&8191),E=i[5]+(M>>>1&8191),U=i[6]+((M>>>14|C<<2)&8191),k=i[7]+((C>>>11|D<<5)&8191),S=i[8]+((D>>>8|j<<8)&8191),L=i[9]+(j>>>5|s),u=0,z=u+_*o+K*(5*d)+P*(5*w)+A*(5*p)+v*(5*b);u=z>>>13,z&=8191,z+=E*(5*x)+U*(5*y)+k*(5*l)+S*(5*h)+L*(5*c),u+=z>>>13,z&=8191;let B=u+_*c+K*o+P*(5*d)+A*(5*w)+v*(5*p);u=B>>>13,B&=8191,B+=E*(5*b)+U*(5*x)+k*(5*y)+S*(5*l)+L*(5*h),u+=B>>>13,B&=8191;let I=u+_*h+K*c+P*o+A*(5*d)+v*(5*w);u=I>>>13,I&=8191,I+=E*(5*p)+U*(5*b)+k*(5*x)+S*(5*y)+L*(5*l),u+=I>>>13,I&=8191;let N=u+_*l+K*h+P*c+A*o+v*(5*d);u=N>>>13,N&=8191,N+=E*(5*w)+U*(5*p)+k*(5*b)+S*(5*x)+L*(5*y),u+=N>>>13,N&=8191;let $=u+_*y+K*l+P*h+A*c+v*o;u=$>>>13,$&=8191,$+=E*(5*d)+U*(5*w)+k*(5*p)+S*(5*b)+L*(5*x),u+=$>>>13,$&=8191;let X=u+_*x+K*y+P*l+A*h+v*c;u=X>>>13,X&=8191,X+=E*o+U*(5*d)+k*(5*w)+S*(5*p)+L*(5*b),u+=X>>>13,X&=8191;let Y=u+_*b+K*x+P*y+A*l+v*h;u=Y>>>13,Y&=8191,Y+=E*c+U*o+k*(5*d)+S*(5*w)+L*(5*p),u+=Y>>>13,Y&=8191;let V=u+_*p+K*b+P*x+A*y+v*l;u=V>>>13,V&=8191,V+=E*h+U*c+k*o+S*(5*d)+L*(5*w),u+=V>>>13,V&=8191;let W=u+_*w+K*p+P*b+A*x+v*y;u=W>>>13,W&=8191,W+=E*l+U*h+k*c+S*o+L*(5*d),u+=W>>>13,W&=8191;let Z=u+_*d+K*w+P*p+A*b+v*x;u=Z>>>13,Z&=8191,Z+=E*y+U*l+k*h+S*c+L*o,u+=Z>>>13,Z&=8191,u=(u<<2)+u|0,u=u+z|0,z=u&8191,u=u>>>13,B+=u,i[0]=z,i[1]=B,i[2]=I,i[3]=N,i[4]=$,i[5]=X,i[6]=Y,i[7]=V,i[8]=W,i[9]=Z}finalize(){let{h:e,pad:n}=this,r=new Uint16Array(10),s=e[1]>>>13;e[1]&=8191;for(let o=2;o<10;o++)e[o]+=s,s=e[o]>>>13,e[o]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let o=1;o<10;o++)r[o]=e[o]+s,s=r[o]>>>13,r[o]&=8191;r[9]-=8192;let i=(s^1)-1;for(let o=0;o<10;o++)r[o]&=i;i=~i;for(let o=0;o<10;o++)e[o]=e[o]&i|r[o];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+n[0];e[0]=a&65535;for(let o=1;o<8;o++)a=(e[o]+n[o]|0)+(a>>>16)|0,e[o]=a&65535;F(r)}update(e){ie(this),e=ee(e),R(e);let{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){let a=Math.min(r-this.pos,s-i);if(a===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){F(this.h,this.r,this.buffer,this.pad)}digestInto(e){ie(this),ge(e,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)e[i++]=r[a]>>>0,e[i++]=r[a]>>>8;return e}digest(){let{buffer:e,outputLen:n}=this;this.digestInto(e);let r=e.slice(0,n);return this.destroy(),r}};function We(t){let e=(r,s)=>t(s).update(ee(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}var Ee=We(t=>new fe(t));function Se(t,e,n,r,s,i=20){let a=t[0],o=t[1],c=t[2],h=t[3],l=e[0],y=e[1],x=e[2],b=e[3],p=e[4],w=e[5],d=e[6],g=e[7],m=s,T=n[0],O=n[1],M=n[2],C=a,D=o,j=c,_=h,K=l,P=y,A=x,v=b,E=p,U=w,k=d,S=g,L=m,u=T,z=O,B=M;for(let N=0;N<i;N+=2)C=C+K|0,L=f(L^C,16),E=E+L|0,K=f(K^E,12),C=C+K|0,L=f(L^C,8),E=E+L|0,K=f(K^E,7),D=D+P|0,u=f(u^D,16),U=U+u|0,P=f(P^U,12),D=D+P|0,u=f(u^D,8),U=U+u|0,P=f(P^U,7),j=j+A|0,z=f(z^j,16),k=k+z|0,A=f(A^k,12),j=j+A|0,z=f(z^j,8),k=k+z|0,A=f(A^k,7),_=_+v|0,B=f(B^_,16),S=S+B|0,v=f(v^S,12),_=_+v|0,B=f(B^_,8),S=S+B|0,v=f(v^S,7),C=C+P|0,B=f(B^C,16),k=k+B|0,P=f(P^k,12),C=C+P|0,B=f(B^C,8),k=k+B|0,P=f(P^k,7),D=D+A|0,L=f(L^D,16),S=S+L|0,A=f(A^S,12),D=D+A|0,L=f(L^D,8),S=S+L|0,A=f(A^S,7),j=j+v|0,u=f(u^j,16),E=E+u|0,v=f(v^E,12),j=j+v|0,u=f(u^j,8),E=E+u|0,v=f(v^E,7),_=_+K|0,z=f(z^_,16),U=U+z|0,K=f(K^U,12),_=_+K|0,z=f(z^_,8),U=U+z|0,K=f(K^U,7);let I=0;r[I++]=a+C|0,r[I++]=o+D|0,r[I++]=c+j|0,r[I++]=h+_|0,r[I++]=l+K|0,r[I++]=y+P|0,r[I++]=x+A|0,r[I++]=b+v|0,r[I++]=p+E|0,r[I++]=w+U|0,r[I++]=d+k|0,r[I++]=g+S|0,r[I++]=m+L|0,r[I++]=T+u|0,r[I++]=O+z|0,r[I++]=M+B|0}function Ze(t,e,n,r){let s=t[0],i=t[1],a=t[2],o=t[3],c=e[0],h=e[1],l=e[2],y=e[3],x=e[4],b=e[5],p=e[6],w=e[7],d=n[0],g=n[1],m=n[2],T=n[3];for(let M=0;M<20;M+=2)s=s+c|0,d=f(d^s,16),x=x+d|0,c=f(c^x,12),s=s+c|0,d=f(d^s,8),x=x+d|0,c=f(c^x,7),i=i+h|0,g=f(g^i,16),b=b+g|0,h=f(h^b,12),i=i+h|0,g=f(g^i,8),b=b+g|0,h=f(h^b,7),a=a+l|0,m=f(m^a,16),p=p+m|0,l=f(l^p,12),a=a+l|0,m=f(m^a,8),p=p+m|0,l=f(l^p,7),o=o+y|0,T=f(T^o,16),w=w+T|0,y=f(y^w,12),o=o+y|0,T=f(T^o,8),w=w+T|0,y=f(y^w,7),s=s+h|0,T=f(T^s,16),p=p+T|0,h=f(h^p,12),s=s+h|0,T=f(T^s,8),p=p+T|0,h=f(h^p,7),i=i+l|0,d=f(d^i,16),w=w+d|0,l=f(l^w,12),i=i+l|0,d=f(d^i,8),w=w+d|0,l=f(l^w,7),a=a+y|0,g=f(g^a,16),x=x+g|0,y=f(y^x,12),a=a+y|0,g=f(g^a,8),x=x+g|0,y=f(y^x,7),o=o+c|0,m=f(m^o,16),b=b+m|0,c=f(c^b,12),o=o+c|0,m=f(m^o,8),b=b+m|0,c=f(c^b,7);let O=0;r[O++]=s,r[O++]=i,r[O++]=a,r[O++]=o,r[O++]=d,r[O++]=g,r[O++]=m,r[O++]=T}var qe=oe(Se,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Je=oe(Se,{counterRight:!1,counterLength:8,extendNonceFn:Ze,allowShortKeys:!1});var Qe=new Uint8Array(16),Ue=(t,e)=>{t.update(e);let n=e.length%16;n&&t.update(Qe.subarray(n))},et=new Uint8Array(32);function ke(t,e,n,r,s){let i=t(e,n,et),a=Ee.create(i);s&&Ue(a,s),Ue(a,r);let o=Ke(r.length,s?s.length:0,!0);a.update(o);let c=a.digest();return F(i,o),c}var Le=t=>(e,n,r)=>({encrypt(i,a){let o=i.length;a=se(o+16,a,!1),a.set(i);let c=a.subarray(0,-16);t(e,n,c,c,1);let h=ke(t,e,n,c,r);return a.set(h,o),F(h),a},decrypt(i,a){a=se(i.length-16,a,!1);let o=i.subarray(0,-16),c=i.subarray(-16),h=ke(t,e,n,o,r);if(!_e(c,h))throw new Error("invalid tag");return a.set(i.subarray(0,-16)),t(e,n,a,a,1),F(h),a}}),ce=ne({blockSize:64,nonceLength:12,tagLength:16},Le(qe)),gt=ne({blockSize:64,nonceLength:24,tagLength:16},Le(Je));var tt={},Ie=rt(globalThis,tt);function rt(t,e){return new Proxy(t,{get(n,r,s){return r in e?e[r]:t[r]},set(n,r,s){return r in e&&delete e[r],t[r]=s,!0},deleteProperty(n,r){let s=!1;return r in e&&(delete e[r],s=!0),r in t&&(delete t[r],s=!0),s},ownKeys(n){let r=Reflect.ownKeys(t),s=Reflect.ownKeys(e),i=new Set(s);return[...r.filter(a=>!i.has(a)),...s]},defineProperty(n,r,s){return r in e&&delete e[r],Reflect.defineProperty(t,r,s),!0},getOwnPropertyDescriptor(n,r){return r in e?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(t,r)},has(n,r){return r in e||r in t}})}var le={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var q=new Uint8Array(0);var ue=new Uint8Array([75,69,77,0,0]);var Ot=new Uint8Array([101,97,101,95,112,114,107]),Ht=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var de=new Uint8Array([100,107,112,95,112,114,107]),Ce=new Uint8Array([115,107]);var Wt=new Uint8Array([99,97,110,100,105,100,97,116,101]),Zt=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),qt=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),Jt=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),Qt=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),er=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),tr=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var wr=new Uint8Array([72,80,75,69,45,118,49]);var pe=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,n,r){return await this._seal(e,n,r)}async open(e,n,r){return await this._open(e,n,r)}_seal(e,n,r){return new Promise(s=>{let i=ce(this._key,new Uint8Array(e),new Uint8Array(r)).encrypt(new Uint8Array(n));s(i.buffer)})}_open(e,n,r){return new Promise(s=>{let i=ce(this._key,new Uint8Array(e),new Uint8Array(r)).decrypt(new Uint8Array(n));s(i.buffer)})}},we=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:le.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new pe(e)}};export{we as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
