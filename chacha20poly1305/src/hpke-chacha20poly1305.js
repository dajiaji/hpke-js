function q(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`positive integer expected, not ${r}`)}function ee(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function te(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function R(r,...e){if(!te(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function re(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function we(r,e){R(r);let s=e.outputLen;if(r.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}var G=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),be=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Oe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Oe)throw new Error("Non little-endian hardware is not supported");function De(r){if(typeof r!="string")throw new Error(`string expected, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function J(r){if(typeof r=="string")r=De(r);else if(te(r))r=r.slice();else throw new Error(`Uint8Array expected, got ${typeof r}`);return r}function xe(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function ge(r,e){if(r.length!==e.length)return!1;let s=0;for(let t=0;t<r.length;t++)s|=r[t]^e[t];return s===0}var ie=(r,e)=>(Object.assign(e,r),e);function ne(r,e,s,t){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,s,t);let a=BigInt(32),i=BigInt(4294967295),o=Number(s>>a&i),n=Number(s&i),c=t?4:0,h=t?0:4;r.setUint32(e+c,o,t),r.setUint32(e+h,n,t)}var H=(r,e)=>r[e++]&255|(r[e++]&255)<<8,se=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=J(e),R(e,32);let s=H(e,0),t=H(e,2),a=H(e,4),i=H(e,6),o=H(e,8),n=H(e,10),c=H(e,12),h=H(e,14);this.r[0]=s&8191,this.r[1]=(s>>>13|t<<3)&8191,this.r[2]=(t>>>10|a<<6)&7939,this.r[3]=(a>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|n<<2)&8191,this.r[7]=(n>>>11|c<<5)&8065,this.r[8]=(c>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let u=0;u<8;u++)this.pad[u]=H(e,16+2*u)}process(e,s,t=!1){let a=t?0:2048,{h:i,r:o}=this,n=o[0],c=o[1],h=o[2],u=o[3],w=o[4],x=o[5],b=o[6],d=o[7],p=o[8],y=o[9],g=H(e,s+0),m=H(e,s+2),T=H(e,s+4),C=H(e,s+6),M=H(e,s+8),O=H(e,s+10),D=H(e,s+12),j=H(e,s+14),_=i[0]+(g&8191),K=i[1]+((g>>>13|m<<3)&8191),P=i[2]+((m>>>10|T<<6)&8191),A=i[3]+((T>>>7|C<<9)&8191),v=i[4]+((C>>>4|M<<12)&8191),U=i[5]+(M>>>1&8191),k=i[6]+((M>>>14|O<<2)&8191),E=i[7]+((O>>>11|D<<5)&8191),S=i[8]+((D>>>8|j<<8)&8191),L=i[9]+(j>>>5|a),l=0,z=l+_*n+K*(5*y)+P*(5*p)+A*(5*d)+v*(5*b);l=z>>>13,z&=8191,z+=U*(5*x)+k*(5*w)+E*(5*u)+S*(5*h)+L*(5*c),l+=z>>>13,z&=8191;let B=l+_*c+K*n+P*(5*y)+A*(5*p)+v*(5*d);l=B>>>13,B&=8191,B+=U*(5*b)+k*(5*x)+E*(5*w)+S*(5*u)+L*(5*h),l+=B>>>13,B&=8191;let I=l+_*h+K*c+P*n+A*(5*y)+v*(5*p);l=I>>>13,I&=8191,I+=U*(5*d)+k*(5*b)+E*(5*x)+S*(5*w)+L*(5*u),l+=I>>>13,I&=8191;let N=l+_*u+K*h+P*c+A*n+v*(5*y);l=N>>>13,N&=8191,N+=U*(5*p)+k*(5*d)+E*(5*b)+S*(5*x)+L*(5*w),l+=N>>>13,N&=8191;let $=l+_*w+K*u+P*h+A*c+v*n;l=$>>>13,$&=8191,$+=U*(5*y)+k*(5*p)+E*(5*d)+S*(5*b)+L*(5*x),l+=$>>>13,$&=8191;let F=l+_*x+K*w+P*u+A*h+v*c;l=F>>>13,F&=8191,F+=U*n+k*(5*y)+E*(5*p)+S*(5*d)+L*(5*b),l+=F>>>13,F&=8191;let Y=l+_*b+K*x+P*w+A*u+v*h;l=Y>>>13,Y&=8191,Y+=U*c+k*n+E*(5*y)+S*(5*p)+L*(5*d),l+=Y>>>13,Y&=8191;let X=l+_*d+K*b+P*x+A*w+v*u;l=X>>>13,X&=8191,X+=U*h+k*c+E*n+S*(5*y)+L*(5*p),l+=X>>>13,X&=8191;let V=l+_*p+K*d+P*b+A*x+v*w;l=V>>>13,V&=8191,V+=U*u+k*h+E*c+S*n+L*(5*y),l+=V>>>13,V&=8191;let W=l+_*y+K*p+P*d+A*b+v*x;l=W>>>13,W&=8191,W+=U*w+k*u+E*h+S*c+L*n,l+=W>>>13,W&=8191,l=(l<<2)+l|0,l=l+z|0,z=l&8191,l=l>>>13,B+=l,i[0]=z,i[1]=B,i[2]=I,i[3]=N,i[4]=$,i[5]=F,i[6]=Y,i[7]=X,i[8]=V,i[9]=W}finalize(){let{h:e,pad:s}=this,t=new Uint16Array(10),a=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=a,a=e[n]>>>13,e[n]&=8191;e[0]+=a*5,a=e[0]>>>13,e[0]&=8191,e[1]+=a,a=e[1]>>>13,e[1]&=8191,e[2]+=a,t[0]=e[0]+5,a=t[0]>>>13,t[0]&=8191;for(let n=1;n<10;n++)t[n]=e[n]+a,a=t[n]>>>13,t[n]&=8191;t[9]-=8192;let i=(a^1)-1;for(let n=0;n<10;n++)t[n]&=i;i=~i;for(let n=0;n<10;n++)e[n]=e[n]&i|t[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+s[0];e[0]=o&65535;for(let n=1;n<8;n++)o=(e[n]+s[n]|0)+(o>>>16)|0,e[n]=o&65535}update(e){re(this);let{buffer:s,blockLen:t}=this;e=J(e);let a=e.length;for(let i=0;i<a;){let o=Math.min(t-this.pos,a-i);if(o===t){for(;t<=a-i;i+=t)this.process(e,i);continue}s.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===t&&(this.process(s,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){re(this),we(e,this),this.finished=!0;let{buffer:s,h:t}=this,{pos:a}=this;if(a){for(s[a++]=1;a<16;a++)s[a]=0;this.process(s,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=t[o]>>>0,e[i++]=t[o]>>>8;return e}digest(){let{buffer:e,outputLen:s}=this;this.digestInto(e);let t=e.slice(0,s);return this.destroy(),t}};function je(r){let e=(t,a)=>r(a).update(J(t)).digest(),s=r(new Uint8Array(32));return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=t=>r(t),e}var me=je(r=>new se(r));var Ke=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),Re=Ke("expand 16-byte k"),Me=Ke("expand 32-byte k"),Ne=G(Re),Pe=G(Me),ut=Pe.slice();function f(r,e){return r<<e|r>>>32-e}function ae(r){return r.byteOffset%4===0}var Q=64,Ge=16,Ae=2**32-1,_e=new Uint32Array;function $e(r,e,s,t,a,i,o,n){let c=a.length,h=new Uint8Array(Q),u=G(h),w=ae(a)&&ae(i),x=w?G(a):_e,b=w?G(i):_e;for(let d=0;d<c;o++){if(r(e,s,t,u,o,n),o>=Ae)throw new Error("arx: counter overflow");let p=Math.min(Q,c-d);if(w&&p===Q){let y=d/4;if(d%4!==0)throw new Error("arx: invalid block position");for(let g=0,m;g<Ge;g++)m=y+g,b[m]=x[m]^u[g];d+=Q;continue}for(let y=0,g;y<p;y++)g=d+y,i[g]=a[g]^h[y];d+=p}}function oe(r,e){let{allowShortKeys:s,extendNonceFn:t,counterLength:a,counterRight:i,rounds:o}=xe({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return q(a),q(o),ee(i),ee(s),(n,c,h,u,w=0)=>{R(n),R(c),R(h);let x=h.length;if(u||(u=new Uint8Array(x)),R(u),q(w),w<0||w>=Ae)throw new Error("arx: counter overflow");if(u.length<x)throw new Error(`arx: output (${u.length}) is shorter than data (${x})`);let b=[],d=n.length,p,y;if(d===32)p=n.slice(),b.push(p),y=Pe;else if(d===16&&s)p=new Uint8Array(32),p.set(n),p.set(n,16),y=Ne,b.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${d}`);ae(c)||(c=c.slice(),b.push(c));let g=G(p);if(t){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");t(y,g,G(c.subarray(0,16)),g),c=c.subarray(16)}let m=16-a;if(m!==c.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let C=new Uint8Array(12);C.set(c,i?0:12-c.length),c=C,b.push(c)}let T=G(c);for($e(r,y,g,T,h,u,w,o);b.length>0;)b.pop().fill(0);return u}}function ke(r,e,s,t,a,i=20){let o=r[0],n=r[1],c=r[2],h=r[3],u=e[0],w=e[1],x=e[2],b=e[3],d=e[4],p=e[5],y=e[6],g=e[7],m=a,T=s[0],C=s[1],M=s[2],O=o,D=n,j=c,_=h,K=u,P=w,A=x,v=b,U=d,k=p,E=y,S=g,L=m,l=T,z=C,B=M;for(let N=0;N<i;N+=2)O=O+K|0,L=f(L^O,16),U=U+L|0,K=f(K^U,12),O=O+K|0,L=f(L^O,8),U=U+L|0,K=f(K^U,7),D=D+P|0,l=f(l^D,16),k=k+l|0,P=f(P^k,12),D=D+P|0,l=f(l^D,8),k=k+l|0,P=f(P^k,7),j=j+A|0,z=f(z^j,16),E=E+z|0,A=f(A^E,12),j=j+A|0,z=f(z^j,8),E=E+z|0,A=f(A^E,7),_=_+v|0,B=f(B^_,16),S=S+B|0,v=f(v^S,12),_=_+v|0,B=f(B^_,8),S=S+B|0,v=f(v^S,7),O=O+P|0,B=f(B^O,16),E=E+B|0,P=f(P^E,12),O=O+P|0,B=f(B^O,8),E=E+B|0,P=f(P^E,7),D=D+A|0,L=f(L^D,16),S=S+L|0,A=f(A^S,12),D=D+A|0,L=f(L^D,8),S=S+L|0,A=f(A^S,7),j=j+v|0,l=f(l^j,16),U=U+l|0,v=f(v^U,12),j=j+v|0,l=f(l^j,8),U=U+l|0,v=f(v^U,7),_=_+K|0,z=f(z^_,16),k=k+z|0,K=f(K^k,12),_=_+K|0,z=f(z^_,8),k=k+z|0,K=f(K^k,7);let I=0;t[I++]=o+O|0,t[I++]=n+D|0,t[I++]=c+j|0,t[I++]=h+_|0,t[I++]=u+K|0,t[I++]=w+P|0,t[I++]=x+A|0,t[I++]=b+v|0,t[I++]=d+U|0,t[I++]=p+k|0,t[I++]=y+E|0,t[I++]=g+S|0,t[I++]=m+L|0,t[I++]=T+l|0,t[I++]=C+z|0,t[I++]=M+B|0}function Fe(r,e,s,t){let a=r[0],i=r[1],o=r[2],n=r[3],c=e[0],h=e[1],u=e[2],w=e[3],x=e[4],b=e[5],d=e[6],p=e[7],y=s[0],g=s[1],m=s[2],T=s[3];for(let M=0;M<20;M+=2)a=a+c|0,y=f(y^a,16),x=x+y|0,c=f(c^x,12),a=a+c|0,y=f(y^a,8),x=x+y|0,c=f(c^x,7),i=i+h|0,g=f(g^i,16),b=b+g|0,h=f(h^b,12),i=i+h|0,g=f(g^i,8),b=b+g|0,h=f(h^b,7),o=o+u|0,m=f(m^o,16),d=d+m|0,u=f(u^d,12),o=o+u|0,m=f(m^o,8),d=d+m|0,u=f(u^d,7),n=n+w|0,T=f(T^n,16),p=p+T|0,w=f(w^p,12),n=n+w|0,T=f(T^n,8),p=p+T|0,w=f(w^p,7),a=a+h|0,T=f(T^a,16),d=d+T|0,h=f(h^d,12),a=a+h|0,T=f(T^a,8),d=d+T|0,h=f(h^d,7),i=i+u|0,y=f(y^i,16),p=p+y|0,u=f(u^p,12),i=i+u|0,y=f(y^i,8),p=p+y|0,u=f(u^p,7),o=o+w|0,g=f(g^o,16),x=x+g|0,w=f(w^x,12),o=o+w|0,g=f(g^o,8),x=x+g|0,w=f(w^x,7),n=n+c|0,m=f(m^n,16),b=b+m|0,c=f(c^b,12),n=n+c|0,m=f(m^n,8),b=b+m|0,c=f(c^b,7);let C=0;t[C++]=a,t[C++]=i,t[C++]=o,t[C++]=n,t[C++]=y,t[C++]=g,t[C++]=m,t[C++]=T}var Ye=oe(ke,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Xe=oe(ke,{counterRight:!1,counterLength:8,extendNonceFn:Fe,allowShortKeys:!1});var Ve=new Uint8Array(16),ve=(r,e)=>{r.update(e);let s=e.length%16;s&&r.update(Ve.subarray(s))},We=new Uint8Array(32);function Ue(r,e,s,t,a){let i=r(e,s,We),o=me.create(i);a&&ve(o,a),ve(o,t);let n=new Uint8Array(16),c=be(n);ne(c,0,BigInt(a?a.length:0),!0),ne(c,8,BigInt(t.length),!0),o.update(n);let h=o.digest();return i.fill(0),h}var Ee=r=>(e,s,t)=>(R(e,32),R(s),{encrypt:(i,o)=>{let n=i.length,c=n+16;o?R(o,c):o=new Uint8Array(c),r(e,s,i,o,1);let h=Ue(r,e,s,o.subarray(0,-16),t);return o.set(h,n),o},decrypt:(i,o)=>{let n=i.length,c=n-16;if(n<16)throw new Error("encrypted data must be at least 16 bytes");o?R(o,c):o=new Uint8Array(c);let h=i.subarray(0,-16),u=i.subarray(-16),w=Ue(r,e,s,h,t);if(!ge(u,w))throw new Error("invalid tag");return r(e,s,h,o,1),o}}),fe=ie({blockSize:64,nonceLength:12,tagLength:16},Ee(Ye)),xt=ie({blockSize:64,nonceLength:24,tagLength:16},Ee(Xe));var Ze={},Se=qe(globalThis,Ze);function qe(r,e){return new Proxy(r,{get(s,t,a){return t in e?e[t]:r[t]},set(s,t,a){return t in e&&delete e[t],r[t]=a,!0},deleteProperty(s,t){let a=!1;return t in e&&(delete e[t],a=!0),t in r&&(delete r[t],a=!0),a},ownKeys(s){let t=Reflect.ownKeys(r),a=Reflect.ownKeys(e),i=new Set(a);return[...t.filter(o=>!i.has(o)),...a]},defineProperty(s,t,a){return t in e&&delete e[t],Reflect.defineProperty(r,t,a),!0},getOwnPropertyDescriptor(s,t){return t in e?Reflect.getOwnPropertyDescriptor(e,t):Reflect.getOwnPropertyDescriptor(r,t)},has(s,t){return t in e||t in r}})}var ce={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var Z=new Uint8Array(0);var le=new Uint8Array([75,69,77,0,0]);var Bt=new Uint8Array([101,97,101,95,112,114,107]),Ct=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var ye=new Uint8Array([100,107,112,95,112,114,107]),Ce=new Uint8Array([115,107]);var Wt=new Uint8Array([99,97,110,100,105,100,97,116,101]),Zt=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),qt=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),Jt=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),Qt=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),er=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),tr=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var wr=new Uint8Array([72,80,75,69,45,118,49]);var de=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,s,t){return await this._seal(e,s,t)}async open(e,s,t){return await this._open(e,s,t)}_seal(e,s,t){return new Promise(a=>{let i=fe(this._key,new Uint8Array(e),new Uint8Array(t)).encrypt(new Uint8Array(s));a(i.buffer)})}_open(e,s,t){return new Promise(a=>{let i=fe(this._key,new Uint8Array(e),new Uint8Array(t)).decrypt(new Uint8Array(s));a(i.buffer)})}},pe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new de(e)}};export{pe as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
