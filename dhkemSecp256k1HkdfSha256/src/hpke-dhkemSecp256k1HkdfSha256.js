var Jr=Object.defineProperty;var tn=(r,t)=>{for(var e in t)Jr(r,e,{get:t[e],enumerable:!0})};function Ae(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function en(r){if(typeof r!="boolean")throw new Error(`Expected boolean, not ${r}`)}function or(r,...t){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(r.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${r.length}`)}function rn(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ae(r.outputLen),Ae(r.blockLen)}function nn(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function on(r,t){or(r);let e=t.outputLen;if(r.length<e)throw new Error(`digestInto() expects output buffer of length at least ${e}`)}var sn={number:Ae,bool:en,bytes:or,hash:rn,exists:nn,output:on},et=sn;var re=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var sr=r=>r instanceof Uint8Array;var cr=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),ne=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),at=(r,t)=>r<<32-t|r>>>t,cn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!cn)throw new Error("Non little-endian hardware is not supported");var Xi=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function Mt(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Et(r){if(typeof r=="string"&&(r=Mt(r)),!sr(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function Ct(...r){let t=new Uint8Array(r.reduce((n,i)=>n+i.length,0)),e=0;return r.forEach(n=>{if(!sr(n))throw new Error("Uint8Array expected");t.set(n,e),e+=n.length}),t}var gt=class{clone(){return this._cloneInto()}};function rt(r){let t=n=>r().update(Et(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function ar(r){let t=(n,i)=>r(i).update(Et(n)).digest(),e=r({});return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=n=>r(n),t}function Kt(r=32){if(re&&typeof re.getRandomValues=="function")return re.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}function an(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let i=BigInt(32),c=BigInt(4294967295),o=Number(e>>i&c),s=Number(e&c),a=n?4:0,u=n?0:4;r.setUint32(t+a,o,n),r.setUint32(t+u,s,n)}var Dt=class extends gt{constructor(t,e,n,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ne(this.buffer)}update(t){et.exists(this);let{view:e,buffer:n,blockLen:i}=this;t=Et(t);let c=t.length;for(let o=0;o<c;){let s=Math.min(i-this.pos,c-o);if(s===i){let a=ne(t);for(;i<=c-o;o+=i)this.process(a,o);continue}n.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){et.exists(this),et.output(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:i,isLE:c}=this,{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let l=o;l<i;l++)e[l]=0;an(n,i-8,BigInt(this.length*8),c),this.process(n,0);let s=ne(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)s.setUint32(4*l,f[l],c)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:i,finished:c,destroyed:o,pos:s}=this;return t.length=i,t.pos=s,t.finished=c,t.destroyed=o,i%e&&t.buffer.set(n),t}};var fn=(r,t,e)=>r&t^~r&e,un=(r,t,e)=>r&t^r&e^t&e,ln=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_t=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),vt=new Uint32Array(64),ie=class extends Dt{constructor(){super(64,32,8,!1),this.A=_t[0]|0,this.B=_t[1]|0,this.C=_t[2]|0,this.D=_t[3]|0,this.E=_t[4]|0,this.F=_t[5]|0,this.G=_t[6]|0,this.H=_t[7]|0}get(){let{A:t,B:e,C:n,D:i,E:c,F:o,G:s,H:a}=this;return[t,e,n,i,c,o,s,a]}set(t,e,n,i,c,o,s,a){this.A=t|0,this.B=e|0,this.C=n|0,this.D=i|0,this.E=c|0,this.F=o|0,this.G=s|0,this.H=a|0}process(t,e){for(let l=0;l<16;l++,e+=4)vt[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){let w=vt[l-15],P=vt[l-2],v=at(w,7)^at(w,18)^w>>>3,d=at(P,17)^at(P,19)^P>>>10;vt[l]=d+vt[l-7]+v+vt[l-16]|0}let{A:n,B:i,C:c,D:o,E:s,F:a,G:u,H:f}=this;for(let l=0;l<64;l++){let w=at(s,6)^at(s,11)^at(s,25),P=f+w+fn(s,a,u)+ln[l]+vt[l]|0,d=(at(n,2)^at(n,13)^at(n,22))+un(n,i,c)|0;f=u,u=a,a=s,s=o+P|0,o=c,c=i,i=n,n=P+d|0}n=n+this.A|0,i=i+this.B|0,c=c+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,i,c,o,s,a,u,f)}roundClean(){vt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Pe=class extends ie{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},oe=rt(()=>new ie),ro=rt(()=>new Pe);var ae={};tn(ae,{bitGet:()=>yn,bitLen:()=>pn,bitMask:()=>Zt,bitSet:()=>xn,bytesToHex:()=>dt,bytesToNumberBE:()=>ft,bytesToNumberLE:()=>ht,concatBytes:()=>ut,createHmacDrbg:()=>Le,ensureBytes:()=>M,equalBytes:()=>dr,hexToBytes:()=>Ot,hexToNumber:()=>ke,numberToBytesBE:()=>yt,numberToBytesLE:()=>Bt,numberToHexUnpadded:()=>lr,numberToVarBytesBE:()=>bn,utf8ToBytes:()=>hr,validateObject:()=>ot});var ur=BigInt(0),se=BigInt(1),dn=BigInt(2),ce=r=>r instanceof Uint8Array,hn=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function dt(r){if(!ce(r))throw new Error("Uint8Array expected");let t="";for(let e=0;e<r.length;e++)t+=hn[r[e]];return t}function lr(r){let t=r.toString(16);return t.length&1?`0${t}`:t}function ke(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Ot(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);let t=r.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let e=new Uint8Array(t/2);for(let n=0;n<e.length;n++){let i=n*2,c=r.slice(i,i+2),o=Number.parseInt(c,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function ft(r){return ke(dt(r))}function ht(r){if(!ce(r))throw new Error("Uint8Array expected");return ke(dt(Uint8Array.from(r).reverse()))}function yt(r,t){return Ot(r.toString(16).padStart(t*2,"0"))}function Bt(r,t){return yt(r,t).reverse()}function bn(r){return Ot(lr(r))}function M(r,t,e){let n;if(typeof t=="string")try{n=Ot(t)}catch(c){throw new Error(`${r} must be valid hex string, got "${t}". Cause: ${c}`)}else if(ce(t))n=Uint8Array.from(t);else throw new Error(`${r} must be hex string or Uint8Array`);let i=n.length;if(typeof e=="number"&&i!==e)throw new Error(`${r} expected ${e} bytes, got ${i}`);return n}function ut(...r){let t=new Uint8Array(r.reduce((n,i)=>n+i.length,0)),e=0;return r.forEach(n=>{if(!ce(n))throw new Error("Uint8Array expected");t.set(n,e),e+=n.length}),t}function dr(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function hr(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function pn(r){let t;for(t=0;r>ur;r>>=se,t+=1);return t}function yn(r,t){return r>>BigInt(t)&se}var xn=(r,t,e)=>r|(e?se:ur)<<BigInt(t),Zt=r=>(dn<<BigInt(r-1))-se,Ie=r=>new Uint8Array(r),fr=r=>Uint8Array.from(r);function Le(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=Ie(r),i=Ie(r),c=0,o=()=>{n.fill(1),i.fill(0),c=0},s=(...l)=>e(i,n,...l),a=(l=Ie())=>{i=s(fr([0]),l),n=s(),l.length!==0&&(i=s(fr([1]),l),n=s())},u=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,w=[];for(;l<t;){n=s();let P=n.slice();w.push(P),l+=n.length}return ut(...w)};return(l,w)=>{o(),a(l);let P;for(;!(P=w(u()));)a();return o(),P}}var wn={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function ot(r,t,e={}){let n=(i,c,o)=>{let s=wn[c];if(typeof s!="function")throw new Error(`Invalid validator "${c}", expected function`);let a=r[i];if(!(o&&a===void 0)&&!s(a,r))throw new Error(`Invalid param ${String(i)}=${a} (${typeof a}), expected ${c}`)};for(let[i,c]of Object.entries(t))n(i,c,!1);for(let[i,c]of Object.entries(e))n(i,c,!0);return r}var F=BigInt(0),G=BigInt(1),Ut=BigInt(2),mn=BigInt(3),Ke=BigInt(4),br=BigInt(5),pr=BigInt(8),gn=BigInt(9),En=BigInt(16);function R(r,t){let e=r%t;return e>=F?e:t+e}function yr(r,t,e){if(e<=F||t<F)throw new Error("Expected power/modulo > 0");if(e===G)return F;let n=G;for(;t>F;)t&G&&(n=n*r%e),r=r*r%e,t>>=G;return n}function C(r,t,e){let n=r;for(;t-- >F;)n*=n,n%=e;return n}function fe(r,t){if(r===F||t<=F)throw new Error(`invert: expected positive integers, got n=${r} mod=${t}`);let e=R(r,t),n=t,i=F,c=G,o=G,s=F;for(;e!==F;){let u=n/e,f=n%e,l=i-o*u,w=c-s*u;n=e,e=f,i=o,c=s,o=l,s=w}if(n!==G)throw new Error("invert: does not exist");return R(i,t)}function _n(r){let t=(r-G)/Ut,e,n,i;for(e=r-G,n=0;e%Ut===F;e/=Ut,n++);for(i=Ut;i<r&&yr(i,t,r)!==r-G;i++);if(n===1){let o=(r+G)/Ke;return function(a,u){let f=a.pow(u,o);if(!a.eql(a.sqr(f),u))throw new Error("Cannot find square root");return f}}let c=(e+G)/Ut;return function(s,a){if(s.pow(a,t)===s.neg(s.ONE))throw new Error("Cannot find square root");let u=n,f=s.pow(s.mul(s.ONE,i),e),l=s.pow(a,c),w=s.pow(a,e);for(;!s.eql(w,s.ONE);){if(s.eql(w,s.ZERO))return s.ZERO;let P=1;for(let d=s.sqr(w);P<u&&!s.eql(d,s.ONE);P++)d=s.sqr(d);let v=s.pow(f,G<<BigInt(u-P-1));f=s.sqr(v),l=s.mul(l,v),w=s.mul(w,f),u=P}return l}}function vn(r){if(r%Ke===mn){let t=(r+G)/Ke;return function(n,i){let c=n.pow(i,t);if(!n.eql(n.sqr(c),i))throw new Error("Cannot find square root");return c}}if(r%pr===br){let t=(r-br)/pr;return function(n,i){let c=n.mul(i,Ut),o=n.pow(c,t),s=n.mul(i,o),a=n.mul(n.mul(s,Ut),o),u=n.mul(s,n.sub(a,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return r%En,_n(r)}var xr=(r,t)=>(R(r,t)&G)===G,Bn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Oe(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=Bn.reduce((n,i)=>(n[i]="function",n),t);return ot(r,e)}function Sn(r,t,e){if(e<F)throw new Error("Expected power > 0");if(e===F)return r.ONE;if(e===G)return t;let n=r.ONE,i=t;for(;e>F;)e&G&&(n=r.mul(n,i)),i=r.sqr(i),e>>=G;return n}function An(r,t){let e=new Array(t.length),n=t.reduce((c,o,s)=>r.is0(o)?c:(e[s]=c,r.mul(c,o)),r.ONE),i=r.inv(n);return t.reduceRight((c,o,s)=>r.is0(o)?c:(e[s]=r.mul(c,e[s]),r.mul(c,o)),i),e}function ue(r,t){let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function Nt(r,t,e=!1,n={}){if(r<=F)throw new Error(`Expected Fp ORDER > 0, got ${r}`);let{nBitLength:i,nByteLength:c}=ue(r,t);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=vn(r),s=Object.freeze({ORDER:r,BITS:i,BYTES:c,MASK:Zt(i),ZERO:F,ONE:G,create:a=>R(a,r),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return F<=a&&a<r},is0:a=>a===F,isOdd:a=>(a&G)===G,neg:a=>R(-a,r),eql:(a,u)=>a===u,sqr:a=>R(a*a,r),add:(a,u)=>R(a+u,r),sub:(a,u)=>R(a-u,r),mul:(a,u)=>R(a*u,r),pow:(a,u)=>Sn(s,a,u),div:(a,u)=>R(a*fe(u,r),r),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>fe(a,r),sqrt:n.sqrt||(a=>o(s,a)),invertBatch:a=>An(s,a),cmov:(a,u,f)=>f?u:a,toBytes:a=>e?Bt(a,c):yt(a,c),fromBytes:a=>{if(a.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${a.length}`);return e?ht(a):ft(a)}});return Object.freeze(s)}function wr(r,t){if(!r.isOdd)throw new Error("Field doesn't have isOdd");let e=r.sqrt(t);return r.isOdd(e)?r.neg(e):e}function mr(r,t,e=!1){r=M("privateHash",r);let n=r.length,i=ue(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let c=e?ht(r):ft(r);return R(c,t-G)+G}var In=BigInt(0),Ue=BigInt(1);function le(r,t){let e=(i,c)=>{let o=c.negate();return i?o:c},n=i=>{let c=Math.ceil(t/i)+1,o=2**(i-1);return{windows:c,windowSize:o}};return{constTimeNegate:e,unsafeLadder(i,c){let o=r.ZERO,s=i;for(;c>In;)c&Ue&&(o=o.add(s)),s=s.double(),c>>=Ue;return o},precomputeWindow(i,c){let{windows:o,windowSize:s}=n(c),a=[],u=i,f=u;for(let l=0;l<o;l++){f=u,a.push(f);for(let w=1;w<s;w++)f=f.add(u),a.push(f);u=f.double()}return a},wNAF(i,c,o){let{windows:s,windowSize:a}=n(i),u=r.ZERO,f=r.BASE,l=BigInt(2**i-1),w=2**i,P=BigInt(i);for(let v=0;v<s;v++){let d=v*a,b=Number(o&l);o>>=P,b>a&&(b-=w,o+=Ue);let x=d,S=d+Math.abs(b)-1,m=v%2!==0,K=b<0;b===0?f=f.add(e(m,c[x])):u=u.add(e(K,c[S]))}return{p:u,f}},wNAFCached(i,c,o,s){let a=i._WINDOW_SIZE||1,u=c.get(i);return u||(u=this.precomputeWindow(i,a),a!==1&&c.set(i,s(u))),this.wNAF(a,u,o)}}}function Gt(r){return Oe(r.Fp),ot(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ue(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}function kn(r){let t=Gt(r);ot(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:n,a:i}=t;if(e){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Ln,hexToBytes:Kn}=ae,Ht={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(r){let{Err:t}=Ht;if(r.length<2||r[0]!==2)throw new t("Invalid signature integer tag");let e=r[1],n=r.subarray(2,e+2);if(!e||n.length!==e)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Ln(n),l:r.subarray(e+2)}},toSig(r){let{Err:t}=Ht,e=typeof r=="string"?Kn(r):r;if(!(e instanceof Uint8Array))throw new Error("ui8a expected");let n=e.length;if(n<2||e[0]!=48)throw new t("Invalid signature tag");if(e[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:c}=Ht._parseInt(e.subarray(2)),{d:o,l:s}=Ht._parseInt(c);if(s.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(r){let t=u=>Number.parseInt(u[0],16)&8?"00"+u:u,e=u=>{let f=u.toString(16);return f.length&1?`0${f}`:f},n=t(e(r.s)),i=t(e(r.r)),c=n.length/2,o=i.length/2,s=e(c),a=e(o);return`30${e(o+c+4)}02${a}${i}02${s}${n}`}},xt=BigInt(0),st=BigInt(1),lo=BigInt(2),gr=BigInt(3),ho=BigInt(4);function On(r){let t=kn(r),{Fp:e}=t,n=t.toBytes||((v,d,b)=>{let x=d.toAffine();return ut(Uint8Array.from([4]),e.toBytes(x.x),e.toBytes(x.y))}),i=t.fromBytes||(v=>{let d=v.subarray(1),b=e.fromBytes(d.subarray(0,e.BYTES)),x=e.fromBytes(d.subarray(e.BYTES,2*e.BYTES));return{x:b,y:x}});function c(v){let{a:d,b}=t,x=e.sqr(v),S=e.mul(x,v);return e.add(e.add(S,e.mul(v,d)),b)}if(!e.eql(e.sqr(t.Gy),c(t.Gx)))throw new Error("bad generator point: equation left != right");function o(v){return typeof v=="bigint"&&xt<v&&v<t.n}function s(v){if(!o(v))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(v){let{allowedPrivateKeyLengths:d,nByteLength:b,wrapPrivateKey:x,n:S}=t;if(d&&typeof v!="bigint"){if(v instanceof Uint8Array&&(v=dt(v)),typeof v!="string"||!d.includes(v.length))throw new Error("Invalid key");v=v.padStart(b*2,"0")}let m;try{m=typeof v=="bigint"?v:ft(M("private key",v,b))}catch{throw new Error(`private key must be ${b} bytes, hex or bigint, not ${typeof v}`)}return x&&(m=R(m,S)),s(m),m}let u=new Map;function f(v){if(!(v instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(d,b,x){if(this.px=d,this.py=b,this.pz=x,d==null||!e.isValid(d))throw new Error("x required");if(b==null||!e.isValid(b))throw new Error("y required");if(x==null||!e.isValid(x))throw new Error("z required")}static fromAffine(d){let{x:b,y:x}=d||{};if(!d||!e.isValid(b)||!e.isValid(x))throw new Error("invalid affine point");if(d instanceof l)throw new Error("projective point not allowed");let S=m=>e.eql(m,e.ZERO);return S(b)&&S(x)?l.ZERO:new l(b,x,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let b=e.invertBatch(d.map(x=>x.pz));return d.map((x,S)=>x.toAffine(b[S])).map(l.fromAffine)}static fromHex(d){let b=l.fromAffine(i(M("pointHex",d)));return b.assertValidity(),b}static fromPrivateKey(d){return l.BASE.multiply(a(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:d,y:b}=this.toAffine();if(!e.isValid(d)||!e.isValid(b))throw new Error("bad point: x or y not FE");let x=e.sqr(b),S=c(d);if(!e.eql(x,S))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(e.isOdd)return!e.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){f(d);let{px:b,py:x,pz:S}=this,{px:m,py:K,pz:g}=d,B=e.eql(e.mul(b,g),e.mul(m,S)),k=e.eql(e.mul(x,g),e.mul(K,S));return B&&k}negate(){return new l(this.px,e.neg(this.py),this.pz)}double(){let{a:d,b}=t,x=e.mul(b,gr),{px:S,py:m,pz:K}=this,g=e.ZERO,B=e.ZERO,k=e.ZERO,I=e.mul(S,S),Z=e.mul(m,m),q=e.mul(K,K),U=e.mul(S,m);return U=e.add(U,U),k=e.mul(S,K),k=e.add(k,k),g=e.mul(d,k),B=e.mul(x,q),B=e.add(g,B),g=e.sub(Z,B),B=e.add(Z,B),B=e.mul(g,B),g=e.mul(U,g),k=e.mul(x,k),q=e.mul(d,q),U=e.sub(I,q),U=e.mul(d,U),U=e.add(U,k),k=e.add(I,I),I=e.add(k,I),I=e.add(I,q),I=e.mul(I,U),B=e.add(B,I),q=e.mul(m,K),q=e.add(q,q),I=e.mul(q,U),g=e.sub(g,I),k=e.mul(q,Z),k=e.add(k,k),k=e.add(k,k),new l(g,B,k)}add(d){f(d);let{px:b,py:x,pz:S}=this,{px:m,py:K,pz:g}=d,B=e.ZERO,k=e.ZERO,I=e.ZERO,Z=t.a,q=e.mul(t.b,gr),U=e.mul(b,m),$=e.mul(x,K),Y=e.mul(S,g),it=e.add(b,x),p=e.add(m,K);it=e.mul(it,p),p=e.add(U,$),it=e.sub(it,p),p=e.add(b,S);let _=e.add(m,g);return p=e.mul(p,_),_=e.add(U,Y),p=e.sub(p,_),_=e.add(x,S),B=e.add(K,g),_=e.mul(_,B),B=e.add($,Y),_=e.sub(_,B),I=e.mul(Z,p),B=e.mul(q,Y),I=e.add(B,I),B=e.sub($,I),I=e.add($,I),k=e.mul(B,I),$=e.add(U,U),$=e.add($,U),Y=e.mul(Z,Y),p=e.mul(q,p),$=e.add($,Y),Y=e.sub(U,Y),Y=e.mul(Z,Y),p=e.add(p,Y),U=e.mul($,p),k=e.add(k,U),U=e.mul(_,p),B=e.mul(it,B),B=e.sub(B,U),U=e.mul(it,$),I=e.mul(_,I),I=e.add(I,U),new l(B,k,I)}subtract(d){return this.add(d.negate())}is0(){return this.equals(l.ZERO)}wNAF(d){return P.wNAFCached(this,u,d,b=>{let x=e.invertBatch(b.map(S=>S.pz));return b.map((S,m)=>S.toAffine(x[m])).map(l.fromAffine)})}multiplyUnsafe(d){let b=l.ZERO;if(d===xt)return b;if(s(d),d===st)return this;let{endo:x}=t;if(!x)return P.unsafeLadder(this,d);let{k1neg:S,k1:m,k2neg:K,k2:g}=x.splitScalar(d),B=b,k=b,I=this;for(;m>xt||g>xt;)m&st&&(B=B.add(I)),g&st&&(k=k.add(I)),I=I.double(),m>>=st,g>>=st;return S&&(B=B.negate()),K&&(k=k.negate()),k=new l(e.mul(k.px,x.beta),k.py,k.pz),B.add(k)}multiply(d){s(d);let b=d,x,S,{endo:m}=t;if(m){let{k1neg:K,k1:g,k2neg:B,k2:k}=m.splitScalar(b),{p:I,f:Z}=this.wNAF(g),{p:q,f:U}=this.wNAF(k);I=P.constTimeNegate(K,I),q=P.constTimeNegate(B,q),q=new l(e.mul(q.px,m.beta),q.py,q.pz),x=I.add(q),S=Z.add(U)}else{let{p:K,f:g}=this.wNAF(b);x=K,S=g}return l.normalizeZ([x,S])[0]}multiplyAndAddUnsafe(d,b,x){let S=l.BASE,m=(g,B)=>B===xt||B===st||!g.equals(S)?g.multiplyUnsafe(B):g.multiply(B),K=m(this,b).add(m(d,x));return K.is0()?void 0:K}toAffine(d){let{px:b,py:x,pz:S}=this,m=this.is0();d==null&&(d=m?e.ONE:e.inv(S));let K=e.mul(b,d),g=e.mul(x,d),B=e.mul(S,d);if(m)return{x:e.ZERO,y:e.ZERO};if(!e.eql(B,e.ONE))throw new Error("invZ was invalid");return{x:K,y:g}}isTorsionFree(){let{h:d,isTorsionFree:b}=t;if(d===st)return!0;if(b)return b(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:b}=t;return d===st?this:b?b(l,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),n(l,this,d)}toHex(d=!0){return dt(this.toRawBytes(d))}}l.BASE=new l(t.Gx,t.Gy,e.ONE),l.ZERO=new l(e.ZERO,e.ONE,e.ZERO);let w=t.nBitLength,P=le(l,t.endo?Math.ceil(w/2):w);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:c,isWithinCurveOrder:o}}function Un(r){let t=Gt(r);return ot(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Er(r){let t=Un(r),{Fp:e,n}=t,i=e.BYTES+1,c=2*e.BYTES+1;function o(p){return xt<p&&p<e.ORDER}function s(p){return R(p,n)}function a(p){return fe(p,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:f,weierstrassEquation:l,isWithinCurveOrder:w}=On({...t,toBytes(p,_,H){let y=_.toAffine(),h=e.toBytes(y.x),E=ut;return H?E(Uint8Array.from([_.hasEvenY()?2:3]),h):E(Uint8Array.from([4]),h,e.toBytes(y.y))},fromBytes(p){let _=p.length,H=p[0],y=p.subarray(1);if(_===i&&(H===2||H===3)){let h=ft(y);if(!o(h))throw new Error("Point is not on curve");let E=l(h),A=e.sqrt(E),O=(A&st)===st;return(H&1)===1!==O&&(A=e.neg(A)),{x:h,y:A}}else if(_===c&&H===4){let h=e.fromBytes(y.subarray(0,e.BYTES)),E=e.fromBytes(y.subarray(e.BYTES,2*e.BYTES));return{x:h,y:E}}else throw new Error(`Point of length ${_} was invalid. Expected ${i} compressed bytes or ${c} uncompressed bytes`)}}),P=p=>dt(yt(p,t.nByteLength));function v(p){let _=n>>st;return p>_}function d(p){return v(p)?s(-p):p}let b=(p,_,H)=>ft(p.slice(_,H));class x{constructor(_,H,y){this.r=_,this.s=H,this.recovery=y,this.assertValidity()}static fromCompact(_){let H=t.nByteLength;return _=M("compactSignature",_,H*2),new x(b(_,0,H),b(_,H,2*H))}static fromDER(_){let{r:H,s:y}=Ht.toSig(M("DER",_));return new x(H,y)}assertValidity(){if(!w(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!w(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(_){return new x(this.r,this.s,_)}recoverPublicKey(_){let{r:H,s:y,recovery:h}=this,E=k(M("msgHash",_));if(h==null||![0,1,2,3].includes(h))throw new Error("recovery id invalid");let A=h===2||h===3?H+t.n:H;if(A>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let O=h&1?"03":"02",T=u.fromHex(O+P(A)),D=a(A),j=s(-E*D),N=s(y*D),z=u.BASE.multiplyAndAddUnsafe(T,j,N);if(!z)throw new Error("point at infinify");return z.assertValidity(),z}hasHighS(){return v(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Ot(this.toDERHex())}toDERHex(){return Ht.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ot(this.toCompactHex())}toCompactHex(){return P(this.r)+P(this.s)}}let S={isValidPrivateKey(p){try{return f(p),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let p=t.randomBytes(e.BYTES+8),_=mr(p,n);return yt(_,t.nByteLength)},precompute(p=8,_=u.BASE){return _._setWindowSize(p),_.multiply(BigInt(3)),_}};function m(p,_=!0){return u.fromPrivateKey(p).toRawBytes(_)}function K(p){let _=p instanceof Uint8Array,H=typeof p=="string",y=(_||H)&&p.length;return _?y===i||y===c:H?y===2*i||y===2*c:p instanceof u}function g(p,_,H=!0){if(K(p))throw new Error("first arg must be private key");if(!K(_))throw new Error("second arg must be public key");return u.fromHex(_).multiply(f(p)).toRawBytes(H)}let B=t.bits2int||function(p){let _=ft(p),H=p.length*8-t.nBitLength;return H>0?_>>BigInt(H):_},k=t.bits2int_modN||function(p){return s(B(p))},I=Zt(t.nBitLength);function Z(p){if(typeof p!="bigint")throw new Error("bigint expected");if(!(xt<=p&&p<I))throw new Error(`bigint expected < 2^${t.nBitLength}`);return yt(p,t.nByteLength)}function q(p,_,H=U){if(["recovered","canonical"].some(V=>V in H))throw new Error("sign() legacy options not supported");let{hash:y,randomBytes:h}=t,{lowS:E,prehash:A,extraEntropy:O}=H;E==null&&(E=!0),p=M("msgHash",p),A&&(p=M("prehashed msgHash",y(p)));let T=k(p),D=f(_),j=[Z(D),Z(T)];if(O!=null){let V=O===!0?h(e.BYTES):O;j.push(M("extraEntropy",V,e.BYTES))}let N=ut(...j),z=T;function X(V){let Q=B(V);if(!w(Q))return;let J=a(Q),W=u.BASE.multiply(Q).toAffine(),tt=s(W.x);if(tt===xt)return;let pt=s(J*s(z+tt*D));if(pt===xt)return;let Lt=(W.x===tt?0:2)|Number(W.y&st),jt=pt;return E&&v(pt)&&(jt=d(pt),Lt^=1),new x(tt,jt,Lt)}return{seed:N,k2sig:X}}let U={lowS:t.lowS,prehash:!1},$={lowS:t.lowS,prehash:!1};function Y(p,_,H=U){let{seed:y,k2sig:h}=q(p,_,H),E=t;return Le(E.hash.outputLen,E.nByteLength,E.hmac)(y,h)}u.BASE._setWindowSize(8);function it(p,_,H,y=$){let h=p;if(_=M("msgHash",_),H=M("publicKey",H),"strict"in y)throw new Error("options.strict was renamed to lowS");let{lowS:E,prehash:A}=y,O,T;try{if(typeof h=="string"||h instanceof Uint8Array)try{O=x.fromDER(h)}catch(W){if(!(W instanceof Ht.Err))throw W;O=x.fromCompact(h)}else if(typeof h=="object"&&typeof h.r=="bigint"&&typeof h.s=="bigint"){let{r:W,s:tt}=h;O=new x(W,tt)}else throw new Error("PARSE");T=u.fromHex(H)}catch(W){if(W.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(E&&O.hasHighS())return!1;A&&(_=t.hash(_));let{r:D,s:j}=O,N=k(_),z=a(j),X=s(N*z),V=s(D*z),Q=u.BASE.multiplyAndAddUnsafe(T,X,V)?.toAffine();return Q?s(Q.x)===D:!1}return{CURVE:t,getPublicKey:m,getSharedSecret:g,sign:Y,verify:it,ProjectivePoint:u,Signature:x,utils:S}}var de=class extends gt{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,et.hash(t);let n=Et(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,c=new Uint8Array(i);c.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<c.length;o++)c[o]^=54;this.iHash.update(c),this.oHash=t.create();for(let o=0;o<c.length;o++)c[o]^=106;this.oHash.update(c),c.fill(0)}update(t){return et.exists(this),this.iHash.update(t),this}digestInto(t){et.exists(this),et.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:i,destroyed:c,blockLen:o,outputLen:s}=this;return t=t,t.finished=i,t.destroyed=c,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Tt=(r,t,e)=>new de(r,t).update(e).digest();Tt.create=(r,t)=>new de(r,t);function Hn(r){return{hash:r,hmac:(t,...e)=>Tt(r,t,Ct(...e)),randomBytes:Kt}}function _r(r,t){let e=n=>Er({...r,...Hn(n)});return Object.freeze({...e(t),create:e})}var Ar=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),vr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Tn=BigInt(1),He=BigInt(2),Br=(r,t)=>(r+t/He)/t;function Rn(r){let t=Ar,e=BigInt(3),n=BigInt(6),i=BigInt(11),c=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),u=r*r*r%t,f=u*u*r%t,l=C(f,e,t)*f%t,w=C(l,e,t)*f%t,P=C(w,He,t)*u%t,v=C(P,i,t)*P%t,d=C(v,c,t)*v%t,b=C(d,s,t)*d%t,x=C(b,a,t)*b%t,S=C(x,s,t)*d%t,m=C(S,e,t)*f%t,K=C(m,o,t)*v%t,g=C(K,n,t)*u%t,B=C(g,He,t);if(!Te.eql(Te.sqr(B),r))throw new Error("Cannot find square root");return B}var Te=Nt(Ar,void 0,void 0,{sqrt:Rn}),Vt=_r({a:BigInt(0),b:BigInt(7),Fp:Te,n:vr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=vr,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Tn*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=e,o=BigInt("0x100000000000000000000000000000000"),s=Br(c*r,t),a=Br(-n*r,t),u=R(r-s*e-a*i,t),f=R(-s*n-a*c,t),l=u>o,w=f>o;if(l&&(u=t-u),w&&(f=t-f),u>o||f>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:u,k2neg:w,k2:f}}}},oe),Ho=BigInt(0);var To=Vt.ProjectivePoint;var Yt=["deriveBits"];var ct=new Uint8Array(0),Re=new Uint8Array([72,80,75,69,45,118,49]),Co=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),Pr=new Uint8Array([75,69,77,0,0]),$t=new Uint8Array([100,107,112,95,112,114,107]),Ir=new Uint8Array([101,97,101,95,112,114,107]),Do=new Uint8Array([105,110,102,111,95,104,97,115,104]),No=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),qo=new Uint8Array([115,101,99,114,101,116]),kr=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),zo=new Uint8Array([107,101,121]),jo=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),Mo=new Uint8Array([101,120,112]),Zo=new Uint8Array([115,101,99]),Cn=new Uint8Array([99,97,110,100,105,100,97,116,101]),he=new Uint8Array([115,107]),Dn=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Nn=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),qn=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var be=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}checkInit(){if(typeof this._api>"u")throw new Error("Not initialized. Call init()")}},wt=class extends be{constructor(){super()}init(t){this._api=t}},pe=class extends be{constructor(){super(),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:ct})}init(t,e){this._api=t,this._suiteId=e}};var zn={DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256K1HkdfSha256:19,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33},Xt=zn,jn={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},Ce=jn;var bt=class{constructor(t,e,n){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:Yt}),this.key=e,this.type=n,this.algorithm={name:t},n==="public"&&(this.usages=[])}};var ye=BigInt(4294967295),De=BigInt(32);function Lr(r,t=!1){return t?{h:Number(r&ye),l:Number(r>>De&ye)}:{h:Number(r>>De&ye)|0,l:Number(r&ye)|0}}function Mn(r,t=!1){let e=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){let{h:c,l:o}=Lr(r[i],t);[e[i],n[i]]=[c,o]}return[e,n]}var Zn=(r,t)=>BigInt(r>>>0)<<De|BigInt(t>>>0),Gn=(r,t,e)=>r>>>e,Vn=(r,t,e)=>r<<32-e|t>>>e,Yn=(r,t,e)=>r>>>e|t<<32-e,$n=(r,t,e)=>r<<32-e|t>>>e,Xn=(r,t,e)=>r<<64-e|t>>>e-32,Wn=(r,t,e)=>r>>>e-32|t<<64-e,Fn=(r,t)=>t,Qn=(r,t)=>r,Jn=(r,t,e)=>r<<e|t>>>32-e,ti=(r,t,e)=>t<<e|r>>>32-e,ei=(r,t,e)=>t<<e-32|r>>>64-e,ri=(r,t,e)=>r<<e-32|t>>>64-e;function ni(r,t,e,n){let i=(t>>>0)+(n>>>0);return{h:r+e+(i/2**32|0)|0,l:i|0}}var ii=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),oi=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,si=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),ci=(r,t,e,n,i)=>t+e+n+i+(r/2**32|0)|0,ai=(r,t,e,n,i)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),fi=(r,t,e,n,i,c)=>t+e+n+i+c+(r/2**32|0)|0,ui={fromBig:Lr,split:Mn,toBig:Zn,shrSH:Gn,shrSL:Vn,rotrSH:Yn,rotrSL:$n,rotrBH:Xn,rotrBL:Wn,rotr32H:Fn,rotr32L:Qn,rotlSH:Jn,rotlSL:ti,rotlBH:ei,rotlBL:ri,add:ni,add3L:ii,add3H:oi,add4L:si,add4H:ci,add5H:fi,add5L:ai},L=ui;var[li,di]=L.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),At=new Uint32Array(80),Pt=new Uint32Array(80),qt=class extends Dt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:n,Bl:i,Ch:c,Cl:o,Dh:s,Dl:a,Eh:u,El:f,Fh:l,Fl:w,Gh:P,Gl:v,Hh:d,Hl:b}=this;return[t,e,n,i,c,o,s,a,u,f,l,w,P,v,d,b]}set(t,e,n,i,c,o,s,a,u,f,l,w,P,v,d,b){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=i|0,this.Ch=c|0,this.Cl=o|0,this.Dh=s|0,this.Dl=a|0,this.Eh=u|0,this.El=f|0,this.Fh=l|0,this.Fl=w|0,this.Gh=P|0,this.Gl=v|0,this.Hh=d|0,this.Hl=b|0}process(t,e){for(let m=0;m<16;m++,e+=4)At[m]=t.getUint32(e),Pt[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){let K=At[m-15]|0,g=Pt[m-15]|0,B=L.rotrSH(K,g,1)^L.rotrSH(K,g,8)^L.shrSH(K,g,7),k=L.rotrSL(K,g,1)^L.rotrSL(K,g,8)^L.shrSL(K,g,7),I=At[m-2]|0,Z=Pt[m-2]|0,q=L.rotrSH(I,Z,19)^L.rotrBH(I,Z,61)^L.shrSH(I,Z,6),U=L.rotrSL(I,Z,19)^L.rotrBL(I,Z,61)^L.shrSL(I,Z,6),$=L.add4L(k,U,Pt[m-7],Pt[m-16]),Y=L.add4H($,B,q,At[m-7],At[m-16]);At[m]=Y|0,Pt[m]=$|0}let{Ah:n,Al:i,Bh:c,Bl:o,Ch:s,Cl:a,Dh:u,Dl:f,Eh:l,El:w,Fh:P,Fl:v,Gh:d,Gl:b,Hh:x,Hl:S}=this;for(let m=0;m<80;m++){let K=L.rotrSH(l,w,14)^L.rotrSH(l,w,18)^L.rotrBH(l,w,41),g=L.rotrSL(l,w,14)^L.rotrSL(l,w,18)^L.rotrBL(l,w,41),B=l&P^~l&d,k=w&v^~w&b,I=L.add5L(S,g,k,di[m],Pt[m]),Z=L.add5H(I,x,K,B,li[m],At[m]),q=I|0,U=L.rotrSH(n,i,28)^L.rotrBH(n,i,34)^L.rotrBH(n,i,39),$=L.rotrSL(n,i,28)^L.rotrBL(n,i,34)^L.rotrBL(n,i,39),Y=n&c^n&s^c&s,it=i&o^i&a^o&a;x=d|0,S=b|0,d=P|0,b=v|0,P=l|0,v=w|0,{h:l,l:w}=L.add(u|0,f|0,Z|0,q|0),u=s|0,f=a|0,s=c|0,a=o|0,c=n|0,o=i|0;let p=L.add3L(q,$,it);n=L.add3H(p,Z,U,Y),i=p|0}({h:n,l:i}=L.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:c,l:o}=L.add(this.Bh|0,this.Bl|0,c|0,o|0),{h:s,l:a}=L.add(this.Ch|0,this.Cl|0,s|0,a|0),{h:u,l:f}=L.add(this.Dh|0,this.Dl|0,u|0,f|0),{h:l,l:w}=L.add(this.Eh|0,this.El|0,l|0,w|0),{h:P,l:v}=L.add(this.Fh|0,this.Fl|0,P|0,v|0),{h:d,l:b}=L.add(this.Gh|0,this.Gl|0,d|0,b|0),{h:x,l:S}=L.add(this.Hh|0,this.Hl|0,x|0,S|0),this.set(n,i,c,o,s,a,u,f,l,w,P,v,d,b,x,S)}roundClean(){At.fill(0),Pt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Ne=class extends qt{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},qe=class extends qt{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},ze=class extends qt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},Wt=rt(()=>new qt),Qo=rt(()=>new Ne),Jo=rt(()=>new qe),Kr=rt(()=>new ze);var je=class extends pe{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ce.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}buildLabeledIkm(t,e){let n=new Uint8Array(7+this._suiteId.byteLength+t.byteLength+e.byteLength);return n.set(Re,0),n.set(this._suiteId,7),n.set(t,7+this._suiteId.byteLength),n.set(e,7+this._suiteId.byteLength+t.byteLength),n}buildLabeledInfo(t,e,n){let i=new Uint8Array(9+this._suiteId.byteLength+t.byteLength+e.byteLength);return i.set(new Uint8Array([0,n]),0),i.set(Re,2),i.set(this._suiteId,9),i.set(t,9+this._suiteId.byteLength),i.set(e,9+this._suiteId.byteLength+t.byteLength),i}async extract(t,e){if(this.checkInit(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return Tt(oe,new Uint8Array(t),new Uint8Array(e));case"SHA-384":return Tt(Kr,new Uint8Array(t),new Uint8Array(e));default:return Tt(Wt,new Uint8Array(t),new Uint8Array(e))}let n=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,e)}async expand(t,e,n){this.checkInit();let i=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),c=new ArrayBuffer(n),o=new Uint8Array(c),s=ct,a=new Uint8Array(e),u=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+a.length+1);for(let l=1,w=0;w<o.length;l++)u[0]=l,f.set(s,0),f.set(a,s.length),f.set(u,s.length+a.length),s=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,s.length+a.length+1))),o.length-w>=s.length?(o.set(s,w),w+=s.length):(o.set(s.slice(0,o.length-w),w),w+=o.length-w);return c}async extractAndExpand(t,e,n,i){this.checkInit();let c=await this._api.importKey("raw",e,"HKDF",!1,Yt);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:n},c,i*8)}async labeledExtract(t,e,n){return await this.extract(t,this.buildLabeledIkm(e,n))}async labeledExpand(t,e,n,i){return await this.expand(t,this.buildLabeledInfo(e,n,i),i)}},Ft=class extends je{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ce.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}};var hi={},bi=pi(globalThis,hi);function pi(r,t){return new Proxy(r,{get(e,n,i){return n in t?t[n]:r[n]},set(e,n,i){return n in t&&delete t[n],r[n]=i,!0},deleteProperty(e,n){let i=!1;return n in t&&(delete t[n],i=!0),n in r&&(delete r[n],i=!0),i},ownKeys(e){let n=Reflect.ownKeys(r),i=Reflect.ownKeys(t),c=new Set(i);return[...n.filter(o=>!c.has(o)),...i]},defineProperty(e,n,i){return n in t&&delete t[n],Reflect.defineProperty(r,n,i),!0},getOwnPropertyDescriptor(e,n){return n in t?Reflect.getOwnPropertyDescriptor(t,n):Reflect.getOwnPropertyDescriptor(r,n)},has(e,n){return n in t||n in r}})}var Qt=r=>typeof r=="object"&&r!==null&&typeof r.privateKey=="object"&&typeof r.publicKey=="object";function Me(r,t){if(t<=0)throw new Error("i2Osp: too small size");if(r>=256**t)throw new Error("i2Osp: too large integer");let e=new Uint8Array(t);for(let n=0;n<t&&r;n++)e[t-(n+1)]=r%256,r=r>>8;return e}function Jt(r,t){let e=new Uint8Array(r.length+t.length);return e.set(r,0),e.set(t,r.length),e}function Or(r,t,e){let n=new Uint8Array(r.length+t.length+e.length);return n.set(r,0),n.set(t,r.length),n.set(e,r.length+t.length),n}var bs=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),ps=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),ys=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var lt=BigInt(0),nt=BigInt(1),xe=BigInt(2),xi=BigInt(8),wi={zip215:!0};function mi(r){let t=Gt(r);return ot(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Rt(r){let t=mi(r),{Fp:e,n,prehash:i,hash:c,randomBytes:o,nByteLength:s,h:a}=t,u=xe<<BigInt(s*8)-nt,f=e.create,l=t.uvRatio||((y,h)=>{try{return{isValid:!0,value:e.sqrt(y*e.inv(h))}}catch{return{isValid:!1,value:lt}}}),w=t.adjustScalarBytes||(y=>y),P=t.domain||((y,h,E)=>{if(h.length||E)throw new Error("Contexts/pre-hash are not supported");return y}),v=y=>typeof y=="bigint"&&lt<y,d=(y,h)=>v(y)&&v(h)&&y<h,b=y=>y===lt||d(y,u);function x(y,h){if(d(y,h))return y;throw new Error(`Expected valid scalar < ${h}, got ${typeof y} ${y}`)}function S(y){return y===lt?y:x(y,n)}let m=new Map;function K(y){if(!(y instanceof g))throw new Error("ExtendedPoint expected")}class g{constructor(h,E,A,O){if(this.ex=h,this.ey=E,this.ez=A,this.et=O,!b(h))throw new Error("x required");if(!b(E))throw new Error("y required");if(!b(A))throw new Error("z required");if(!b(O))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(h){if(h instanceof g)throw new Error("extended point not allowed");let{x:E,y:A}=h||{};if(!b(E)||!b(A))throw new Error("invalid affine point");return new g(E,A,nt,f(E*A))}static normalizeZ(h){let E=e.invertBatch(h.map(A=>A.ez));return h.map((A,O)=>A.toAffine(E[O])).map(g.fromAffine)}_setWindowSize(h){this._WINDOW_SIZE=h,m.delete(this)}assertValidity(){let{a:h,d:E}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:A,ey:O,ez:T,et:D}=this,j=f(A*A),N=f(O*O),z=f(T*T),X=f(z*z),V=f(j*h),Q=f(z*f(V+N)),J=f(X+f(E*f(j*N)));if(Q!==J)throw new Error("bad point: equation left != right (1)");let W=f(A*O),tt=f(T*D);if(W!==tt)throw new Error("bad point: equation left != right (2)")}equals(h){K(h);let{ex:E,ey:A,ez:O}=this,{ex:T,ey:D,ez:j}=h,N=f(E*j),z=f(T*O),X=f(A*j),V=f(D*O);return N===z&&X===V}is0(){return this.equals(g.ZERO)}negate(){return new g(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:h}=t,{ex:E,ey:A,ez:O}=this,T=f(E*E),D=f(A*A),j=f(xe*f(O*O)),N=f(h*T),z=E+A,X=f(f(z*z)-T-D),V=N+D,Q=V-j,J=N-D,W=f(X*Q),tt=f(V*J),pt=f(X*J),Lt=f(Q*V);return new g(W,tt,Lt,pt)}add(h){K(h);let{a:E,d:A}=t,{ex:O,ey:T,ez:D,et:j}=this,{ex:N,ey:z,ez:X,et:V}=h;if(E===BigInt(-1)){let Qe=f((T-O)*(z+N)),Je=f((T+O)*(z-N)),Se=f(Je-Qe);if(Se===lt)return this.double();let tr=f(D*xe*V),er=f(j*xe*X),rr=er+tr,nr=Je+Qe,ir=er-tr,Xr=f(rr*Se),Wr=f(nr*ir),Fr=f(rr*ir),Qr=f(Se*nr);return new g(Xr,Wr,Qr,Fr)}let Q=f(O*N),J=f(T*z),W=f(j*A*V),tt=f(D*X),pt=f((O+T)*(N+z)-Q-J),Lt=tt-W,jt=tt+W,Fe=f(J-E*Q),Gr=f(pt*Lt),Vr=f(jt*Fe),Yr=f(pt*Fe),$r=f(Lt*jt);return new g(Gr,Vr,$r,Yr)}subtract(h){return this.add(h.negate())}wNAF(h){return I.wNAFCached(this,m,h,g.normalizeZ)}multiply(h){let{p:E,f:A}=this.wNAF(x(h,n));return g.normalizeZ([E,A])[0]}multiplyUnsafe(h){let E=S(h);return E===lt?k:this.equals(k)||E===nt?this:this.equals(B)?this.wNAF(E).p:I.unsafeLadder(this,E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return I.unsafeLadder(this,n).is0()}toAffine(h){let{ex:E,ey:A,ez:O}=this,T=this.is0();h==null&&(h=T?xi:e.inv(O));let D=f(E*h),j=f(A*h),N=f(O*h);if(T)return{x:lt,y:nt};if(N!==nt)throw new Error("invZ was invalid");return{x:D,y:j}}clearCofactor(){let{h}=t;return h===nt?this:this.multiplyUnsafe(h)}static fromHex(h,E=!1){let{d:A,a:O}=t,T=e.BYTES;h=M("pointHex",h,T);let D=h.slice(),j=h[T-1];D[T-1]=j&-129;let N=ht(D);N===lt||(E?x(N,u):x(N,e.ORDER));let z=f(N*N),X=f(z-nt),V=f(A*z-O),{isValid:Q,value:J}=l(X,V);if(!Q)throw new Error("Point.fromHex: invalid y coordinate");let W=(J&nt)===nt,tt=(j&128)!==0;if(!E&&J===lt&&tt)throw new Error("Point.fromHex: x=0 and x_0=1");return tt!==W&&(J=f(-J)),g.fromAffine({x:J,y:N})}static fromPrivateKey(h){return U(h).point}toRawBytes(){let{x:h,y:E}=this.toAffine(),A=Bt(E,e.BYTES);return A[A.length-1]|=h&nt?128:0,A}toHex(){return dt(this.toRawBytes())}}g.BASE=new g(t.Gx,t.Gy,nt,f(t.Gx*t.Gy)),g.ZERO=new g(lt,nt,nt,lt);let{BASE:B,ZERO:k}=g,I=le(g,s*8);function Z(y){return R(y,n)}function q(y){return Z(ht(y))}function U(y){let h=s;y=M("private key",y,h);let E=M("hashed private key",c(y),2*h),A=w(E.slice(0,h)),O=E.slice(h,2*h),T=q(A),D=B.multiply(T),j=D.toRawBytes();return{head:A,prefix:O,scalar:T,point:D,pointBytes:j}}function $(y){return U(y).pointBytes}function Y(y=new Uint8Array,...h){let E=ut(...h);return q(c(P(E,M("context",y),!!i)))}function it(y,h,E={}){y=M("message",y),i&&(y=i(y));let{prefix:A,scalar:O,pointBytes:T}=U(h),D=Y(E.context,A,y),j=B.multiply(D).toRawBytes(),N=Y(E.context,j,T,y),z=Z(D+N*O);S(z);let X=ut(j,Bt(z,e.BYTES));return M("result",X,s*2)}let p=wi;function _(y,h,E,A=p){let{context:O,zip215:T}=A,D=e.BYTES;y=M("signature",y,2*D),h=M("message",h),i&&(h=i(h));let j=ht(y.slice(D,2*D)),N,z,X;try{N=g.fromHex(E,T),z=g.fromHex(y.slice(0,D),T),X=B.multiplyUnsafe(j)}catch{return!1}if(!T&&N.isSmallOrder())return!1;let V=Y(O,z.toRawBytes(),N.toRawBytes(),h);return z.add(N.multiplyUnsafe(V)).subtract(X).clearCofactor().equals(g.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:$,sign:it,verify:_,ExtendedPoint:g,utils:{getExtendedPublicKey:U,randomPrivateKey:()=>o(e.BYTES),precompute(y=8,h=g.BASE){return h._setWindowSize(y),h.multiply(BigInt(3)),h}}}}var Bs=BigInt(0),Ss=BigInt(1);var Ge=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ur=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ts=BigInt(0),Ei=BigInt(1),Ze=BigInt(2),_i=BigInt(5),Hr=BigInt(10),vi=BigInt(20),Bi=BigInt(40),Tr=BigInt(80);function Si(r){let t=Ge,n=r*r%t*r%t,i=C(n,Ze,t)*n%t,c=C(i,Ei,t)*r%t,o=C(c,_i,t)*c%t,s=C(o,Hr,t)*o%t,a=C(s,vi,t)*s%t,u=C(a,Bi,t)*a%t,f=C(u,Tr,t)*u%t,l=C(f,Tr,t)*u%t,w=C(l,Hr,t)*o%t;return{pow_p_5_8:C(w,Ze,t)*r%t,b2:n}}function Ai(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Pi(r,t){let e=Ge,n=R(t*t*t,e),i=R(n*n*t,e),c=Si(r*i).pow_p_5_8,o=R(r*n*c,e),s=R(t*o*o,e),a=o,u=R(o*Ur,e),f=s===r,l=s===R(-r,e),w=s===R(-r*Ur,e);return f&&(o=a),(l||w)&&(o=u),xr(o,e)&&(o=R(-o,e)),{isValid:f||l,value:o}}var mt=Nt(Ge,void 0,!0),Ve={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:mt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Wt,randomBytes:Kt,adjustScalarBytes:Ai,uvRatio:Pi},Ii=Rt(Ve);function Rr(r,t,e){if(t.length>255)throw new Error("Context is too big");return Ct(Mt("SigEd25519 no Ed25519 collisions"),new Uint8Array([e?1:0,t.length]),t,r)}var Rs=Rt({...Ve,domain:Rr}),Cs=Rt({...Ve,domain:Rr,prehash:Wt});var ki=(mt.ORDER+BigInt(3))/BigInt(8),Ds=mt.pow(Ze,ki),Ns=mt.sqrt(mt.neg(mt.ONE)),qs=(mt.ORDER-BigInt(5))/BigInt(8),zs=BigInt(486662);var js=wr(mt,mt.neg(BigInt(486664)));var Ms=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Zs=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Gs=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Vs=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Ys=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var[Nr,qr,zr]=[[],[],[]],Ki=BigInt(0),te=BigInt(1),Oi=BigInt(2),Ui=BigInt(7),Hi=BigInt(256),Ti=BigInt(113);for(let r=0,t=te,e=1,n=0;r<24;r++){[e,n]=[n,(2*e+3*n)%5],Nr.push(2*(5*n+e)),qr.push((r+1)*(r+2)/2%64);let i=Ki;for(let c=0;c<7;c++)t=(t<<te^(t>>Ui)*Ti)%Hi,t&Oi&&(i^=te<<(te<<BigInt(c))-te);zr.push(i)}var[Ri,Ci]=L.split(zr,!0),Cr=(r,t,e)=>e>32?L.rotlBH(r,t,e):L.rotlSH(r,t,e),Dr=(r,t,e)=>e>32?L.rotlBL(r,t,e):L.rotlSL(r,t,e);function Di(r,t=24){let e=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)e[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){let s=(o+8)%10,a=(o+2)%10,u=e[a],f=e[a+1],l=Cr(u,f,1)^e[s],w=Dr(u,f,1)^e[s+1];for(let P=0;P<50;P+=10)r[o+P]^=l,r[o+P+1]^=w}let i=r[2],c=r[3];for(let o=0;o<24;o++){let s=qr[o],a=Cr(i,c,s),u=Dr(i,c,s),f=Nr[o];i=r[f],c=r[f+1],r[f]=a,r[f+1]=u}for(let o=0;o<50;o+=10){for(let s=0;s<10;s++)e[s]=r[o+s];for(let s=0;s<10;s++)r[o+s]^=~e[(s+2)%10]&e[(s+4)%10]}r[0]^=Ri[n],r[1]^=Ci[n]}e.fill(0)}var we=class r extends gt{constructor(t,e,n,i=!1,c=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=i,this.rounds=c,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,et.number(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=cr(this.state)}keccak(){Di(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){et.exists(this);let{blockLen:e,state:n}=this;t=Et(t);let i=t.length;for(let c=0;c<i;){let o=Math.min(e-this.pos,i-c);for(let s=0;s<o;s++)n[this.pos++]^=t[c++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:n,blockLen:i}=this;t[n]^=e,e&128&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){et.exists(this,!1),et.bytes(t),this.finish();let e=this.state,{blockLen:n}=this;for(let i=0,c=t.length;i<c;){this.posOut>=n&&this.keccak();let o=Math.min(n-this.posOut,c-i);t.set(e.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return et.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(et.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:n,outputLen:i,rounds:c,enableXOF:o}=this;return t||(t=new r(e,n,i,o,c)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=c,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}},It=(r,t,e)=>rt(()=>new we(t,r,e)),ic=It(6,144,224/8),oc=It(6,136,256/8),sc=It(6,104,384/8),cc=It(6,72,512/8),ac=It(1,144,224/8),fc=It(1,136,256/8),uc=It(1,104,384/8),lc=It(1,72,512/8),jr=(r,t,e)=>ar((n={})=>new we(t,r,n.dkLen===void 0?e:n.dkLen,!0)),dc=jr(31,168,128/8),Ye=jr(31,136,256/8);var Ni=rt(()=>Ye.create({dkLen:114})),qi=rt(()=>Ye.create({dkLen:64})),$e=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function zi(r){let t=$e,e=BigInt(1),n=BigInt(2),i=BigInt(3),c=BigInt(11),o=BigInt(22),s=BigInt(44),a=BigInt(88),u=BigInt(223),f=r*r*r%t,l=f*f*r%t,w=C(l,i,t)*l%t,P=C(w,i,t)*l%t,v=C(P,n,t)*f%t,d=C(v,c,t)*v%t,b=C(d,o,t)*d%t,x=C(b,s,t)*b%t,S=C(x,a,t)*x%t,m=C(S,s,t)*b%t,K=C(m,n,t)*f%t,g=C(K,e,t)*r%t;return C(g,u,t)*K%t}function ji(r){return r[0]&=252,r[55]|=128,r[56]=0,r}var Mr=Nt($e,456,!0),gc=BigInt(4),Zr={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Mr,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:Ni,randomBytes:Kt,adjustScalarBytes:ji,domain:(r,t,e)=>{if(t.length>255)throw new Error(`Context is too big: ${t.length}`);return Ct(Mt("SigEd448"),new Uint8Array([e?1:0,t.length]),t,r)},uvRatio:(r,t)=>{let e=$e,n=R(r*r*t,e),i=R(n*r,e),c=R(i*n*t,e),o=zi(c),s=R(i*o,e),a=R(s*s,e);return{isValid:R(a*t,e)===r,value:s}}},Mi=Rt(Zr),Ec=Rt({...Zr,prehash:qi});var _c=(Mr.ORDER-BigInt(3))/BigInt(4),vc=BigInt(156326);var kt=class extends Error{constructor(t){let e;t instanceof Error?e=t.message:typeof t=="string"?e=t:e="",super(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}};var me=class extends kt{},zt=class extends kt{},ge=class extends kt{},Ee=class extends kt{};var _e=class extends kt{},ve=class extends kt{};var Be=class extends wt{constructor(t,e){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Xt.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=t,this._kdf=e}init(t){super.init(t);let e=new Uint8Array(Pr);e.set(Me(this.id,2),3),this._prim.init(t),this._kdf.init(t,e),super.init(t)}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(t){throw new ve(t)}}async deriveKeyPair(t){try{return await this._prim.deriveKeyPair(t)}catch(e){throw new _e(e)}}async serializePublicKey(t){try{return await this._prim.serializePublicKey(t)}catch(e){throw new me(e)}}async deserializePublicKey(t){try{return await this._prim.deserializePublicKey(t)}catch(e){throw new zt(e)}}async importKey(t,e,n){try{return await this._prim.importKey(t,e,n)}catch(i){throw new zt(i)}}async encap(t){try{let e=t.nonEphemeralKeyPair===void 0?await this.generateKeyPair():t.nonEphemeralKeyPair,n=await this._prim.serializePublicKey(e.publicKey),i=await this._prim.serializePublicKey(t.recipientPublicKey),c;if(t.senderKey===void 0)c=new Uint8Array(await this._prim.dh(e.privateKey,t.recipientPublicKey));else{let a=Qt(t.senderKey)?t.senderKey.privateKey:t.senderKey,u=new Uint8Array(await this._prim.dh(e.privateKey,t.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(a,t.recipientPublicKey));c=Jt(u,f)}let o;if(t.senderKey===void 0)o=Jt(new Uint8Array(n),new Uint8Array(i));else{let a=Qt(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),u=await this._prim.serializePublicKey(a);o=Or(new Uint8Array(n),new Uint8Array(i),new Uint8Array(u))}let s=await this.generateSharedSecret(c,o);return{enc:n,sharedSecret:s}}catch(e){throw new ge(e)}}async decap(t){let e;try{e=await this._prim.deserializePublicKey(t.enc)}catch(n){throw new zt(n)}try{let n=Qt(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,i=Qt(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),c=await this._prim.serializePublicKey(i),o;if(t.senderPublicKey===void 0)o=new Uint8Array(await this._prim.dh(n,e));else{let a=new Uint8Array(await this._prim.dh(n,e)),u=new Uint8Array(await this._prim.dh(n,t.senderPublicKey));o=Jt(a,u)}let s;if(t.senderPublicKey===void 0)s=Jt(new Uint8Array(t.enc),new Uint8Array(c));else{let a=await this._prim.serializePublicKey(t.senderPublicKey);s=new Uint8Array(t.enc.byteLength+c.byteLength+a.byteLength),s.set(new Uint8Array(t.enc),0),s.set(new Uint8Array(c),t.enc.byteLength),s.set(new Uint8Array(a),t.enc.byteLength+c.byteLength)}return await this.generateSharedSecret(o,s)}catch(n){throw new Ee(n)}}async generateSharedSecret(t,e){let n=this._kdf.buildLabeledIkm(Ir,t),i=this._kdf.buildLabeledInfo(kr,e,this.secretSize);return await this._kdf.extractAndExpand(ct,n,i,this.secretSize)}};var ee="ECDH",Xe=class extends wt{constructor(t){super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=33,this._nSk=32}async serializePublicKey(t){return await this._serializePublicKey(t)}async deserializePublicKey(t){return await this._deserializePublicKey(t)}async importKey(t,e,n){if(t!=="raw")throw new Error("Unsupported format");return await this._importKey(e,n)}async derivePublicKey(t){return await this._derivePublicKey(t)}async generateKeyPair(){let t=Vt.utils.randomPrivateKey(),e=new bt(ee,t,"private");return{publicKey:await this.derivePublicKey(e),privateKey:e}}async deriveKeyPair(t){let e=await this._hkdf.labeledExtract(ct,$t,new Uint8Array(t)),n=await this._hkdf.labeledExpand(e,he,ct,this._nSk),i=new bt(ee,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(t,e){return await this._dh(t,e)}_serializePublicKey(t){return new Promise(e=>{e(t.key.buffer)})}_deserializePublicKey(t){return new Promise((e,n)=>{t.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):e(new bt(ee,new Uint8Array(t),"public"))})}_importKey(t,e){return new Promise((n,i)=>{e&&t.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!e&&t.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new bt(ee,new Uint8Array(t),e?"public":"private"))})}_derivePublicKey(t){return new Promise(e=>{let n=Vt.getPublicKey(t.key);e(new bt(ee,n,"public"))})}_dh(t,e){return new Promise((n,i)=>{try{n(Vt.getSharedSecret(t.key,e.key).buffer)}catch(c){i(c)}})}},We=class extends Be{constructor(){let t=new Ft,e=new Xe(t);super(e,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Xt.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};export{We as DhkemSecp256k1HkdfSha256};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed448.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
