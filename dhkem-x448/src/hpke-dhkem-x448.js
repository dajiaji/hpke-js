var X=class extends Error{constructor(e){let r;e instanceof Error?r=e.message:typeof e=="string"?r=e:r="",super(r),this.name=this.constructor.name}},ae=class extends X{};var Q=class extends X{},V=class extends X{},qe=class extends X{},Fe=class extends X{};var Ie=class extends X{},ee=class extends X{};var Mr={},lt=jr(globalThis,Mr);function jr(t,e){return new Proxy(t,{get(r,n,i){return n in e?e[n]:t[n]},set(r,n,i){return n in e&&delete e[n],t[n]=i,!0},deleteProperty(r,n){let i=!1;return n in e&&(delete e[n],i=!0),n in t&&(delete t[n],i=!0),i},ownKeys(r){let n=Reflect.ownKeys(t),i=Reflect.ownKeys(e),o=new Set(i);return[...n.filter(a=>!o.has(a)),...i]},defineProperty(r,n,i){return n in e&&delete e[n],Reflect.defineProperty(t,n,i),!0},getOwnPropertyDescriptor(r,n){return n in e?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(t,n)},has(r,n){return n in e||n in t}})}async function Gr(){if(lt!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:t}=await import("crypto");return t.subtle}catch(t){throw new ee(t)}}var me=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await Gr())}};var fe={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48,MlKem512:64,MlKem768:65,MlKem1024:66,XWing:25722},Ze={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3};var M=new Uint8Array(0);var Xe=new Uint8Array([75,69,77,0,0]);var te=t=>typeof t=="object"&&t!==null&&typeof t.privateKey=="object"&&typeof t.publicKey=="object";function Pe(t,e){if(e<=0)throw new Error("i2Osp: too small size");if(t>=256**e)throw new Error("i2Osp: too large integer");let r=new Uint8Array(e);for(let n=0;n<e&&t;n++)r[e-(n+1)]=t%256,t=t>>8;return r}function ce(t,e){let r=new Uint8Array(t.length+e.length);return r.set(t,0),r.set(e,t.length),r}function ke(t){let e=t.replace(/-/g,"+").replace(/_/g,"/"),r=atob(e),n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}var qr=new Uint8Array([101,97,101,95,112,114,107]),Fr=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function Zr(t,e,r){let n=new Uint8Array(t.length+e.length+r.length);return n.set(t,0),n.set(e,t.length),n.set(r,t.length+e.length),n}var He=class{constructor(e,r,n){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e,this._prim=r,this._kdf=n;let i=new Uint8Array(Xe);i.set(Pe(this.id,2),3),this._kdf.init(i)}async serializePublicKey(e){return await this._prim.serializePublicKey(e)}async deserializePublicKey(e){return await this._prim.deserializePublicKey(e)}async serializePrivateKey(e){return await this._prim.serializePrivateKey(e)}async deserializePrivateKey(e){return await this._prim.deserializePrivateKey(e)}async importKey(e,r,n=!0){return await this._prim.importKey(e,r,n)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>8192)throw new ae("Too long ikm");return await this._prim.deriveKeyPair(e)}async encap(e){let r;e.ekm===void 0?r=await this.generateKeyPair():te(e.ekm)?r=e.ekm:r=await this.deriveKeyPair(e.ekm);let n=await this._prim.serializePublicKey(r.publicKey),i=await this._prim.serializePublicKey(e.recipientPublicKey);try{let o;if(e.senderKey===void 0)o=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey));else{let c=te(e.senderKey)?e.senderKey.privateKey:e.senderKey,h=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,e.recipientPublicKey));o=ce(h,f)}let a;if(e.senderKey===void 0)a=ce(new Uint8Array(n),new Uint8Array(i));else{let c=te(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),h=await this._prim.serializePublicKey(c);a=Zr(new Uint8Array(n),new Uint8Array(i),new Uint8Array(h))}let s=await this._generateSharedSecret(o,a);return{enc:n,sharedSecret:s}}catch(o){throw new qe(o)}}async decap(e){let r=await this._prim.deserializePublicKey(e.enc),n=te(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,i=te(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),o=await this._prim.serializePublicKey(i);try{let a;if(e.senderPublicKey===void 0)a=new Uint8Array(await this._prim.dh(n,r));else{let c=new Uint8Array(await this._prim.dh(n,r)),h=new Uint8Array(await this._prim.dh(n,e.senderPublicKey));a=ce(c,h)}let s;if(e.senderPublicKey===void 0)s=ce(new Uint8Array(e.enc),new Uint8Array(o));else{let c=await this._prim.serializePublicKey(e.senderPublicKey);s=new Uint8Array(e.enc.byteLength+o.byteLength+c.byteLength),s.set(new Uint8Array(e.enc),0),s.set(new Uint8Array(o),e.enc.byteLength),s.set(new Uint8Array(c),e.enc.byteLength+o.byteLength)}return await this._generateSharedSecret(a,s)}catch(a){throw new Fe(a)}}async _generateSharedSecret(e,r){let n=this._kdf.buildLabeledIkm(qr,e),i=this._kdf.buildLabeledInfo(Fr,r,this.secretSize);return await this._kdf.extractAndExpand(M.buffer,n.buffer,i.buffer,this.secretSize)}};var ue=["deriveBits"],Le=new Uint8Array([100,107,112,95,112,114,107]),Ve=new Uint8Array([115,107]);var ai=new Uint8Array([99,97,110,100,105,100,97,116,101]),fi=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),ci=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),ui=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),li=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),hi=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),di=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var j=class{constructor(e,r,n,i=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=r,this.type=n,this.algorithm={name:e},this.usages=i,n==="public"&&(this.usages=[])}};var Rt=new Uint8Array([72,80,75,69,45,118,49]),ht=class extends me{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ze.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:M}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(e){this._suiteId=e}buildLabeledIkm(e,r){this._checkInit();let n=new Uint8Array(7+this._suiteId.byteLength+e.byteLength+r.byteLength);return n.set(Rt,0),n.set(this._suiteId,7),n.set(e,7+this._suiteId.byteLength),n.set(r,7+this._suiteId.byteLength+e.byteLength),n}buildLabeledInfo(e,r,n){this._checkInit();let i=new Uint8Array(9+this._suiteId.byteLength+e.byteLength+r.byteLength);return i.set(new Uint8Array([0,n]),0),i.set(Rt,2),i.set(this._suiteId,9),i.set(e,9+this._suiteId.byteLength),i.set(r,9+this._suiteId.byteLength+e.byteLength),i}async extract(e,r){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)throw new ae("The salt length must be the same as the hashSize");let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}async expand(e,r,n){await this._setup();let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),o=new ArrayBuffer(n),a=new Uint8Array(o),s=M,c=new Uint8Array(r),h=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let l=1,d=0;d<a.length;l++)h[0]=l,f.set(s,0),f.set(c,s.length),f.set(h,s.length+c.length),s=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,s.length+c.length+1))),a.length-d>=s.length?(a.set(s,d),d+=s.length):(a.set(s.slice(0,a.length-d),d),d+=a.length-d);return o}async extractAndExpand(e,r,n,i){await this._setup();let o=await this._api.importKey("raw",r,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:n},o,i*8)}async labeledExtract(e,r,n){return await this.extract(e,this.buildLabeledIkm(r,n).buffer)}async labeledExpand(e,r,n,i){return await this.expand(e,this.buildLabeledInfo(r,n,i).buffer,i)}_checkInit(){if(this._suiteId===M)throw new Error("Not initialized. Call init()")}};var Ue=class extends ht{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Ze.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var le=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ye(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function re(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function U(t,...e){if(!Ye(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function jt(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");re(t.outputLen),re(t.blockLen)}function W(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function We(t,e){U(t);let r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Gt(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function q(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function $e(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}var Xr=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Vr(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Yr(t){for(let e=0;e<t.length;e++)t[e]=Vr(t[e]);return t}var dt=Xr?t=>t:Yr,qt=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Wr=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ge(t){if(U(t),qt)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Wr[t[r]];return e}var Y={_0:48,_9:57,A:65,F:70,a:97,f:102};function Mt(t){if(t>=Y._0&&t<=Y._9)return t-Y._0;if(t>=Y.A&&t<=Y.F)return t-(Y.A-10);if(t>=Y.a&&t<=Y.f)return t-(Y.a-10)}function Je(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(qt)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let a=Mt(t.charCodeAt(o)),s=Mt(t.charCodeAt(o+1));if(a===void 0||s===void 0){let c=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}n[i]=a*16+s}return n}function Qe(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ie(t){return typeof t=="string"&&(t=Qe(t)),U(t),t}function he(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];U(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var ne=class{};function Te(t){let e=n=>t().update(ie(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Ft(t){let e=(n,i)=>t(i).update(ie(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function Oe(t=32){if(le&&typeof le.getRandomValues=="function")return le.getRandomValues(new Uint8Array(t));if(le&&typeof le.randomBytes=="function")return Uint8Array.from(le.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}var et=class extends ne{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,jt(e);let n=ie(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=e.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),q(o)}update(e){return W(this),this.iHash.update(e),this}digestInto(e){W(this),U(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:a,outputLen:s}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=a,e.outputLen=s,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},pt=(t,e,r)=>new et(t,e).update(r).digest();pt.create=(t,e)=>new et(t,e);function $r(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),c=n?4:0,h=n?0:4;t.setUint32(e+c,a,n),t.setUint32(e+h,s,n)}var tt=class extends ne{constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=$e(this.buffer)}update(e){W(this),e=ie(e),U(e);let{view:r,buffer:n,blockLen:i}=this,o=e.length;for(let a=0;a<o;){let s=Math.min(i-this.pos,o-a);if(s===i){let c=$e(e);for(;i<=o-a;a+=i)this.process(c,a);continue}n.set(e.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){W(this),We(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:a}=this;r[a++]=128,q(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(n,0),a=0);for(let l=a;l<i;l++)r[l]=0;$r(n,i-8,BigInt(this.length*8),o),this.process(n,0);let s=$e(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let h=c/4,f=this.get();if(h>f.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<h;l++)s.setUint32(4*l,f[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:a,pos:s}=this;return e.destroyed=a,e.finished=o,e.length=i,e.pos=s,i%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}};var T=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var rt=BigInt(4294967295),Zt=BigInt(32);function Jr(t,e=!1){return e?{h:Number(t&rt),l:Number(t>>Zt&rt)}:{h:Number(t>>Zt&rt)|0,l:Number(t&rt)|0}}function nt(t,e=!1){let r=t.length,n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){let{h:a,l:s}=Jr(t[o],e);[n[o],i[o]]=[a,s]}return[n,i]}var yt=(t,e,r)=>t>>>r,xt=(t,e,r)=>t<<32-r|e>>>r,de=(t,e,r)=>t>>>r|e<<32-r,pe=(t,e,r)=>t<<32-r|e>>>r,ze=(t,e,r)=>t<<64-r|e>>>r-32,De=(t,e,r)=>t>>>r-32|e<<64-r;var Xt=(t,e,r)=>t<<r|e>>>32-r,Vt=(t,e,r)=>e<<r|t>>>32-r,Yt=(t,e,r)=>e<<r-32|t>>>64-r,Wt=(t,e,r)=>t<<r-32|e>>>64-r;function F(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var $t=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Jt=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Qt=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),er=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,tr=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),rr=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var nr=nt(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),en=nr[0],tn=nr[1],se=new Uint32Array(80),oe=new Uint32Array(80),it=class extends tt{constructor(e=64){super(128,e,16,!1),this.Ah=T[0]|0,this.Al=T[1]|0,this.Bh=T[2]|0,this.Bl=T[3]|0,this.Ch=T[4]|0,this.Cl=T[5]|0,this.Dh=T[6]|0,this.Dl=T[7]|0,this.Eh=T[8]|0,this.El=T[9]|0,this.Fh=T[10]|0,this.Fl=T[11]|0,this.Gh=T[12]|0,this.Gl=T[13]|0,this.Hh=T[14]|0,this.Hl=T[15]|0}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:a,Dh:s,Dl:c,Eh:h,El:f,Fh:l,Fl:d,Gh:p,Gl:B,Hh:g,Hl:u}=this;return[e,r,n,i,o,a,s,c,h,f,l,d,p,B,g,u]}set(e,r,n,i,o,a,s,c,h,f,l,d,p,B,g,u){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=a|0,this.Dh=s|0,this.Dl=c|0,this.Eh=h|0,this.El=f|0,this.Fh=l|0,this.Fl=d|0,this.Gh=p|0,this.Gl=B|0,this.Hh=g|0,this.Hl=u|0}process(e,r){for(let w=0;w<16;w++,r+=4)se[w]=e.getUint32(r),oe[w]=e.getUint32(r+=4);for(let w=16;w<80;w++){let I=se[w-15]|0,y=oe[w-15]|0,_=de(I,y,1)^de(I,y,8)^yt(I,y,7),E=pe(I,y,1)^pe(I,y,8)^xt(I,y,7),A=se[w-2]|0,b=oe[w-2]|0,v=de(A,b,19)^ze(A,b,61)^yt(A,b,6),S=pe(A,b,19)^De(A,b,61)^xt(A,b,6),k=Qt(E,S,oe[w-7],oe[w-16]),K=er(k,_,v,se[w-7],se[w-16]);se[w]=K|0,oe[w]=k|0}let{Ah:n,Al:i,Bh:o,Bl:a,Ch:s,Cl:c,Dh:h,Dl:f,Eh:l,El:d,Fh:p,Fl:B,Gh:g,Gl:u,Hh:x,Hl:m}=this;for(let w=0;w<80;w++){let I=de(l,d,14)^de(l,d,18)^ze(l,d,41),y=pe(l,d,14)^pe(l,d,18)^De(l,d,41),_=l&p^~l&g,E=d&B^~d&u,A=tr(m,y,E,tn[w],oe[w]),b=rr(A,x,I,_,en[w],se[w]),v=A|0,S=de(n,i,28)^ze(n,i,34)^ze(n,i,39),k=pe(n,i,28)^De(n,i,34)^De(n,i,39),K=n&o^n&s^o&s,P=i&a^i&c^a&c;x=g|0,m=u|0,g=p|0,u=B|0,p=l|0,B=d|0,{h:l,l:d}=F(h|0,f|0,b|0,v|0),h=s|0,f=c|0,s=o|0,c=a|0,o=n|0,a=i|0;let H=$t(v,k,P);n=Jt(H,b,S,K),i=H|0}({h:n,l:i}=F(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:a}=F(this.Bh|0,this.Bl|0,o|0,a|0),{h:s,l:c}=F(this.Ch|0,this.Cl|0,s|0,c|0),{h,l:f}=F(this.Dh|0,this.Dl|0,h|0,f|0),{h:l,l:d}=F(this.Eh|0,this.El|0,l|0,d|0),{h:p,l:B}=F(this.Fh|0,this.Fl|0,p|0,B|0),{h:g,l:u}=F(this.Gh|0,this.Gl|0,g|0,u|0),{h:x,l:m}=F(this.Hh|0,this.Hl|0,x|0,m|0),this.set(n,i,o,a,s,c,h,f,l,d,p,B,g,u,x,m)}roundClean(){q(se,oe)}destroy(){q(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var ir=Te(()=>new it);var sr=ir;var Ne=class extends Ue{async extract(e,r){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)return pt(sr,new Uint8Array(e),new Uint8Array(r)).buffer;let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}};var rn=BigInt(0),Ce=BigInt(1),nn=BigInt(2),sn=BigInt(7),on=BigInt(256),an=BigInt(113),fr=[],cr=[],ur=[];for(let t=0,e=Ce,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],fr.push(2*(5*n+r)),cr.push((t+1)*(t+2)/2%64);let i=rn;for(let o=0;o<7;o++)e=(e<<Ce^(e>>sn)*an)%on,e&nn&&(i^=Ce<<(Ce<<BigInt(o))-Ce);ur.push(i)}var lr=nt(ur,!0),fn=lr[0],cn=lr[1],or=(t,e,r)=>r>32?Yt(t,e,r):Xt(t,e,r),ar=(t,e,r)=>r>32?Wt(t,e,r):Vt(t,e,r);function un(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)r[a]=t[a]^t[a+10]^t[a+20]^t[a+30]^t[a+40];for(let a=0;a<10;a+=2){let s=(a+8)%10,c=(a+2)%10,h=r[c],f=r[c+1],l=or(h,f,1)^r[s],d=ar(h,f,1)^r[s+1];for(let p=0;p<50;p+=10)t[a+p]^=l,t[a+p+1]^=d}let i=t[2],o=t[3];for(let a=0;a<24;a++){let s=cr[a],c=or(i,o,s),h=ar(i,o,s),f=fr[a];i=t[f],o=t[f+1],t[f]=c,t[f+1]=h}for(let a=0;a<50;a+=10){for(let s=0;s<10;s++)r[s]=t[a+s];for(let s=0;s<10;s++)t[a+s]^=~r[(s+2)%10]&r[(s+4)%10]}t[0]^=fn[n],t[1]^=cn[n]}q(r)}var bt=class t extends ne{constructor(e,r,n,i=!1,o=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=o,re(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Gt(this.state)}clone(){return this._cloneInto()}keccak(){dt(this.state32),un(this.state32,this.rounds),dt(this.state32),this.posOut=0,this.pos=0}update(e){W(this),e=ie(e),U(e);let{blockLen:r,state:n}=this,i=e.length;for(let o=0;o<i;){let a=Math.min(r-this.pos,i-o);for(let s=0;s<a;s++)n[this.pos++]^=e[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){W(this,!1),U(e),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,o=e.length;i<o;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,o-i);e.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return re(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(We(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,q(this.state)}_cloneInto(e){let{blockLen:r,suffix:n,outputLen:i,rounds:o,enableXOF:a}=this;return e||(e=new t(r,n,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}};var ln=(t,e,r)=>Ft((n={})=>new bt(e,t,n.dkLen===void 0?r:n.dkLen,!0));var hr=ln(31,136,256/8);var gt=BigInt(0),mt=BigInt(1);function st(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function dr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?gt:BigInt("0x"+t)}function pr(t){return dr(ge(t))}function $(t){return U(t),dr(ge(Uint8Array.from(t).reverse()))}function _t(t,e){return Je(t.toString(16).padStart(e*2,"0"))}function ye(t,e){return _t(t,e).reverse()}function N(t,e,r){let n;if(typeof e=="string")try{n=Je(e)}catch(o){throw new Error(t+" must be hex string or Uint8Array, cause: "+o)}else if(Ye(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}var wt=t=>typeof t=="bigint"&&gt<=t;function hn(t,e,r){return wt(t)&&wt(e)&&wt(r)&&e<=t&&t<r}function J(t,e,r,n){if(!hn(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function yr(t){let e;for(e=0;t>gt;t>>=mt,e+=1);return e}var Re=t=>(mt<<BigInt(t))-mt;function xe(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(i,o,a){let s=t[i];if(a&&s===void 0)return;let c=typeof s;if(c!==o||s===null)throw new Error(`param "${i}" is invalid: expected ${o}, got ${c}`)}Object.entries(e).forEach(([i,o])=>n(i,o,!1)),Object.entries(r).forEach(([i,o])=>n(i,o,!0))}function Et(t){let e=new WeakMap;return(r,...n)=>{let i=e.get(r);if(i!==void 0)return i;let o=t(r,...n);return e.set(r,o),o}}var z=BigInt(0),C=BigInt(1),be=BigInt(2),dn=BigInt(3),wr=BigInt(4),mr=BigInt(5),gr=BigInt(8);function L(t,e){let r=t%e;return r>=z?r:e+r}function R(t,e,r){let n=t;for(;e-- >z;)n*=n,n%=r;return n}function xr(t,e){if(t===z)throw new Error("invert: expected non-zero number");if(e<=z)throw new Error("invert: expected positive modulus, got "+e);let r=L(t,e),n=e,i=z,o=C,a=C,s=z;for(;r!==z;){let h=n/r,f=n%r,l=i-a*h,d=o-s*h;n=r,r=f,i=a,o=s,a=l,s=d}if(n!==C)throw new Error("invert: does not exist");return L(i,e)}function _r(t,e){let r=(t.ORDER+C)/wr,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function pn(t,e){let r=(t.ORDER-mr)/gr,n=t.mul(e,be),i=t.pow(n,r),o=t.mul(e,i),a=t.mul(t.mul(o,be),i),s=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(s),e))throw new Error("Cannot find square root");return s}function yn(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-C,r=0;for(;e%be===z;)e/=be,r++;let n=be,i=we(t);for(;br(i,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return _r;let o=i.pow(n,e),a=(e+C)/be;return function(c,h){if(c.is0(h))return h;if(br(c,h)!==1)throw new Error("Cannot find square root");let f=r,l=c.mul(c.ONE,o),d=c.pow(h,e),p=c.pow(h,a);for(;!c.eql(d,c.ONE);){if(c.is0(d))return c.ZERO;let B=1,g=c.sqr(d);for(;!c.eql(g,c.ONE);)if(B++,g=c.sqr(g),B===f)throw new Error("Cannot find square root");let u=C<<BigInt(f-B-1),x=c.pow(l,u);f=B,l=c.sqr(x),d=c.mul(d,l),p=c.mul(p,x)}return p}}function xn(t){return t%wr===dn?_r:t%gr===mr?pn:yn(t)}var bn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Er(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=bn.reduce((n,i)=>(n[i]="function",n),e);return xe(t,r),t}function wn(t,e,r){if(r<z)throw new Error("invalid exponent, negatives unsupported");if(r===z)return t.ONE;if(r===C)return e;let n=t.ONE,i=e;for(;r>z;)r&C&&(n=t.mul(n,i)),i=t.sqr(i),r>>=C;return n}function ot(t,e,r=!1){let n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((a,s,c)=>t.is0(s)?a:(n[c]=a,t.mul(a,s)),t.ONE),o=t.inv(i);return e.reduceRight((a,s,c)=>t.is0(s)?a:(n[c]=t.mul(a,n[c]),t.mul(a,s)),o),n}function br(t,e){let r=(t.ORDER-C)/be,n=t.pow(e,r),i=t.eql(n,t.ONE),o=t.eql(n,t.ZERO),a=t.eql(n,t.neg(t.ONE));if(!i&&!o&&!a)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function vr(t,e){e!==void 0&&re(e);let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function we(t,e,r=!1,n={}){if(t<=z)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,o;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");let f=e;f.BITS&&(i=f.BITS),f.sqrt&&(o=f.sqrt),typeof f.isLE=="boolean"&&(r=f.isLE)}else typeof e=="number"&&(i=e),n.sqrt&&(o=n.sqrt);let{nBitLength:a,nByteLength:s}=vr(t,i);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c,h=Object.freeze({ORDER:t,isLE:r,BITS:a,BYTES:s,MASK:Re(a),ZERO:z,ONE:C,create:f=>L(f,t),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return z<=f&&f<t},is0:f=>f===z,isValidNot0:f=>!h.is0(f)&&h.isValid(f),isOdd:f=>(f&C)===C,neg:f=>L(-f,t),eql:(f,l)=>f===l,sqr:f=>L(f*f,t),add:(f,l)=>L(f+l,t),sub:(f,l)=>L(f-l,t),mul:(f,l)=>L(f*l,t),pow:(f,l)=>wn(h,f,l),div:(f,l)=>L(f*xr(l,t),t),sqrN:f=>f*f,addN:(f,l)=>f+l,subN:(f,l)=>f-l,mulN:(f,l)=>f*l,inv:f=>xr(f,t),sqrt:o||(f=>(c||(c=xn(t)),c(h,f))),toBytes:f=>r?ye(f,s):_t(f,s),fromBytes:f=>{if(f.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+f.length);return r?$(f):pr(f)},invertBatch:f=>ot(h,f),cmov:(f,l,d)=>d?l:f});return Object.freeze(h)}var at=BigInt(0),Kt=BigInt(1);function vt(t,e){let r=e.negate();return t?r:e}function Kr(t,e,r){let n=e==="pz"?a=>a.pz:a=>a.ez,i=ot(t.Fp,r.map(n));return r.map((a,s)=>a.toAffine(i[s])).map(t.fromAffine)}function Ir(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function At(t,e){Ir(t,e);let r=Math.ceil(e/t)+1,n=2**(t-1),i=2**t,o=Re(t),a=BigInt(t);return{windows:r,windowSize:n,mask:o,maxNumber:i,shiftBy:a}}function Ar(t,e,r){let{windowSize:n,mask:i,maxNumber:o,shiftBy:a}=r,s=Number(t&i),c=t>>a;s>n&&(s-=o,c+=Kt);let h=e*n,f=h+Math.abs(s)-1,l=s===0,d=s<0,p=e%2!==0;return{nextN:c,offset:f,isZero:l,isNeg:d,isNegF:p,offsetF:h}}function mn(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function gn(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}var Bt=new WeakMap,Pr=new WeakMap;function St(t){return Pr.get(t)||1}function Br(t){if(t!==at)throw new Error("invalid wNAF")}function kr(t,e){return{constTimeNegate:vt,hasPrecomputes(r){return St(r)!==1},unsafeLadder(r,n,i=t.ZERO){let o=r;for(;n>at;)n&Kt&&(i=i.add(o)),o=o.double(),n>>=Kt;return i},precomputeWindow(r,n){let{windows:i,windowSize:o}=At(n,e),a=[],s=r,c=s;for(let h=0;h<i;h++){c=s,a.push(c);for(let f=1;f<o;f++)c=c.add(s),a.push(c);s=c.double()}return a},wNAF(r,n,i){let o=t.ZERO,a=t.BASE,s=At(r,e);for(let c=0;c<s.windows;c++){let{nextN:h,offset:f,isZero:l,isNeg:d,isNegF:p,offsetF:B}=Ar(i,c,s);i=h,l?a=a.add(vt(p,n[B])):o=o.add(vt(d,n[f]))}return Br(i),{p:o,f:a}},wNAFUnsafe(r,n,i,o=t.ZERO){let a=At(r,e);for(let s=0;s<a.windows&&i!==at;s++){let{nextN:c,offset:h,isZero:f,isNeg:l}=Ar(i,s,a);if(i=c,!f){let d=n[h];o=o.add(l?d.negate():d)}}return Br(i),o},getPrecomputes(r,n,i){let o=Bt.get(n);return o||(o=this.precomputeWindow(n,r),r!==1&&(typeof i=="function"&&(o=i(o)),Bt.set(n,o))),o},wNAFCached(r,n,i){let o=St(r);return this.wNAF(o,this.getPrecomputes(o,r,i),n)},wNAFCachedUnsafe(r,n,i,o){let a=St(r);return a===1?this.unsafeLadder(r,n,o):this.wNAFUnsafe(a,this.getPrecomputes(a,r,i),n,o)},setWindowSize(r,n){Ir(n,e),Pr.set(r,n),Bt.delete(r)}}}function Hr(t,e,r,n){mn(r,t),gn(n,e);let i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");let a=t.ZERO,s=yr(BigInt(i)),c=1;s>12?c=s-3:s>4?c=s-2:s>0&&(c=2);let h=Re(c),f=new Array(Number(h)+1).fill(a),l=Math.floor((e.BITS-1)/c)*c,d=a;for(let p=l;p>=0;p-=c){f.fill(a);for(let g=0;g<o;g++){let u=n[g],x=Number(u>>BigInt(p)&h);f[x]=f[x].add(r[g])}let B=a;for(let g=f.length-1,u=a;g>0;g--)u=u.add(f[g]),B=B.add(u);if(d=d.add(B),p!==0)for(let g=0;g<c;g++)d=d.double()}return d}function Sr(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Er(e),e}else return we(t)}function Lr(t,e,r={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(let s of["p","n","h"]){let c=e[s];if(!(typeof c=="bigint"&&c>at))throw new Error(`CURVE.${s} must be positive bigint`)}let n=Sr(e.p,r.Fp),i=Sr(e.n,r.Fn),a=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(let s of a)if(!n.isValid(e[s]))throw new Error(`CURVE.${s} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}var Z=BigInt(0),D=BigInt(1),It=BigInt(2),_n=BigInt(8),En={zip215:!0};function vn(t,e,r,n){let i=t.sqr(r),o=t.sqr(n),a=t.add(t.mul(e.a,i),o),s=t.add(t.ONE,t.mul(e.d,t.mul(i,o)));return t.eql(a,s)}function Pt(t,e={}){let{Fp:r,Fn:n}=Lr("edwards",t,e),{h:i,n:o}=t;xe(e,{},{uvRatio:"function"});let a=It<<BigInt(n.BYTES*8)-D,s=g=>r.create(g),c=e.uvRatio||((g,u)=>{try{return{isValid:!0,value:r.sqrt(r.div(g,u))}}catch{return{isValid:!1,value:Z}}});if(!vn(r,t,t.Gx,t.Gy))throw new Error("bad curve params: generator point");function h(g,u,x=!1){let m=x?D:Z;return J("coordinate "+g,u,m,a),u}function f(g){if(!(g instanceof p))throw new Error("ExtendedPoint expected")}let l=Et((g,u)=>{let{ex:x,ey:m,ez:w}=g,I=g.is0();u==null&&(u=I?_n:r.inv(w));let y=s(x*u),_=s(m*u),E=s(w*u);if(I)return{x:Z,y:D};if(E!==D)throw new Error("invZ was invalid");return{x:y,y:_}}),d=Et(g=>{let{a:u,d:x}=t;if(g.is0())throw new Error("bad point: ZERO");let{ex:m,ey:w,ez:I,et:y}=g,_=s(m*m),E=s(w*w),A=s(I*I),b=s(A*A),v=s(_*u),S=s(A*s(v+E)),k=s(b+s(x*s(_*E)));if(S!==k)throw new Error("bad point: equation left != right (1)");let K=s(m*w),P=s(I*y);if(K!==P)throw new Error("bad point: equation left != right (2)");return!0});class p{constructor(u,x,m,w){this.ex=h("x",u),this.ey=h("y",x),this.ez=h("z",m,!0),this.et=h("t",w),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(u){if(u instanceof p)throw new Error("extended point not allowed");let{x,y:m}=u||{};return h("x",x),h("y",m),new p(x,m,D,s(x*m))}static normalizeZ(u){return Kr(p,"ez",u)}static msm(u,x){return Hr(p,n,u,x)}_setWindowSize(u){this.precompute(u)}precompute(u=8,x=!0){return B.setWindowSize(this,u),x||this.multiply(It),this}assertValidity(){d(this)}equals(u){f(u);let{ex:x,ey:m,ez:w}=this,{ex:I,ey:y,ez:_}=u,E=s(x*_),A=s(I*w),b=s(m*_),v=s(y*w);return E===A&&b===v}is0(){return this.equals(p.ZERO)}negate(){return new p(s(-this.ex),this.ey,this.ez,s(-this.et))}double(){let{a:u}=t,{ex:x,ey:m,ez:w}=this,I=s(x*x),y=s(m*m),_=s(It*s(w*w)),E=s(u*I),A=x+m,b=s(s(A*A)-I-y),v=E+y,S=v-_,k=E-y,K=s(b*S),P=s(v*k),H=s(b*k),O=s(S*v);return new p(K,P,O,H)}add(u){f(u);let{a:x,d:m}=t,{ex:w,ey:I,ez:y,et:_}=this,{ex:E,ey:A,ez:b,et:v}=u,S=s(w*E),k=s(I*A),K=s(_*m*v),P=s(y*b),H=s((w+I)*(E+A)-S-k),O=P-K,G=P+K,Ae=s(k-x*S),Be=s(H*O),Ge=s(G*Ae),Se=s(H*Ae),Ke=s(O*G);return new p(Be,Ge,Ke,Se)}subtract(u){return this.add(u.negate())}multiply(u){let x=u;J("scalar",x,D,o);let{p:m,f:w}=B.wNAFCached(this,x,p.normalizeZ);return p.normalizeZ([m,w])[0]}multiplyUnsafe(u,x=p.ZERO){let m=u;return J("scalar",m,Z,o),m===Z?p.ZERO:this.is0()||m===D?this:B.wNAFCachedUnsafe(this,m,p.normalizeZ,x)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return B.wNAFCachedUnsafe(this,o).is0()}toAffine(u){return l(this,u)}clearCofactor(){return i===D?this:this.multiplyUnsafe(i)}static fromBytes(u,x=!1){return U(u),this.fromHex(u,x)}static fromHex(u,x=!1){let{d:m,a:w}=t,I=r.BYTES;u=N("pointHex",u,I),st("zip215",x);let y=u.slice(),_=u[I-1];y[I-1]=_&-129;let E=$(y),A=x?a:r.ORDER;J("pointHex.y",E,Z,A);let b=s(E*E),v=s(b-D),S=s(m*b-w),{isValid:k,value:K}=c(v,S);if(!k)throw new Error("Point.fromHex: invalid y coordinate");let P=(K&D)===D,H=(_&128)!==0;if(!x&&K===Z&&H)throw new Error("Point.fromHex: x=0 and x_0=1");return H!==P&&(K=s(-K)),p.fromAffine({x:K,y:E})}static fromPrivateScalar(u){return p.BASE.multiply(u)}toBytes(){let{x:u,y:x}=this.toAffine(),m=ye(x,r.BYTES);return m[m.length-1]|=u&D?128:0,m}toRawBytes(){return this.toBytes()}toHex(){return ge(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}p.BASE=new p(t.Gx,t.Gy,D,s(t.Gx*t.Gy)),p.ZERO=new p(Z,D,D,Z),p.Fp=r,p.Fn=n;let B=kr(p,n.BYTES*8);return p}function An(t,e){xe(e,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r,hash:n}=e,{BASE:i,Fp:o,Fn:a}=t,s=a.ORDER,c=e.randomBytes||Oe,h=e.adjustScalarBytes||(y=>y),f=e.domain||((y,_,E)=>{if(st("phflag",E),_.length||E)throw new Error("Contexts/pre-hash are not supported");return y});function l(y){return a.create(y)}function d(y){return l($(y))}function p(y){let _=o.BYTES;y=N("private key",y,_);let E=N("hashed private key",n(y),2*_),A=h(E.slice(0,_)),b=E.slice(_,2*_),v=d(A);return{head:A,prefix:b,scalar:v}}function B(y){let{head:_,prefix:E,scalar:A}=p(y),b=i.multiply(A),v=b.toBytes();return{head:_,prefix:E,scalar:A,point:b,pointBytes:v}}function g(y){return B(y).pointBytes}function u(y=Uint8Array.of(),..._){let E=he(..._);return d(n(f(E,N("context",y),!!r)))}function x(y,_,E={}){y=N("message",y),r&&(y=r(y));let{prefix:A,scalar:b,pointBytes:v}=B(_),S=u(E.context,A,y),k=i.multiply(S).toBytes(),K=u(E.context,k,v,y),P=l(S+K*b);J("signature.s",P,Z,s);let H=o.BYTES,O=he(k,ye(P,H));return N("result",O,H*2)}let m=En;function w(y,_,E,A=m){let{context:b,zip215:v}=A,S=o.BYTES;y=N("signature",y,2*S),_=N("message",_),E=N("publicKey",E,S),v!==void 0&&st("zip215",v),r&&(_=r(_));let k=$(y.slice(S,2*S)),K,P,H;try{K=t.fromHex(E,v),P=t.fromHex(y.slice(0,S),v),H=i.multiplyUnsafe(k)}catch{return!1}if(!v&&K.isSmallOrder())return!1;let O=u(b,P.toBytes(),K.toBytes(),_);return P.add(K.multiplyUnsafe(O)).subtract(H).clearCofactor().is0()}return i.precompute(8),{getPublicKey:g,sign:x,verify:w,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>c(o.BYTES),precompute(y=8,_=t.BASE){return _.precompute(y,!1)}},Point:t}}function Bn(t){let e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp,n=we(e.n,t.nBitLength,!0),i={Fp:r,Fn:n,uvRatio:t.uvRatio},o={hash:t.hash,randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:i,eddsaOpts:o}}function Sn(t,e){return Object.assign({},e,{ExtendedPoint:e.Point,CURVE:t})}function Ur(t){let{CURVE:e,curveOpts:r,eddsaOpts:n}=Bn(t),i=Pt(e,r),o=An(i,n);return Sn(t,o)}var Me=BigInt(0),_e=BigInt(1),ft=BigInt(2);function Kn(t){return xe(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function Tr(t){let e=Kn(t),{P:r,type:n,adjustScalarBytes:i,powPminus2:o,randomBytes:a}=e,s=n==="x25519";if(!s&&n!=="x448")throw new Error("invalid type");let c=a||Oe,h=s?255:448,f=s?32:56,l=BigInt(s?9:5),d=BigInt(s?121665:39081),p=s?ft**BigInt(254):ft**BigInt(447),B=s?BigInt(8)*ft**BigInt(251)-_e:BigInt(4)*ft**BigInt(445)-_e,g=p+B+_e,u=b=>L(b,r),x=m(l);function m(b){return ye(u(b),f)}function w(b){let v=N("u coordinate",b,f);return s&&(v[31]&=127),u($(v))}function I(b){return $(i(N("scalar",b,f)))}function y(b,v){let S=A(w(v),I(b));if(S===Me)throw new Error("invalid private or public key received");return m(S)}function _(b){return y(b,x)}function E(b,v,S){let k=u(b*(v-S));return v=u(v-k),S=u(S+k),{x_2:v,x_3:S}}function A(b,v){J("u",b,Me,r),J("scalar",v,p,g);let S=v,k=b,K=_e,P=Me,H=b,O=_e,G=Me;for(let Be=BigInt(h-1);Be>=Me;Be--){let Ge=S>>Be&_e;G^=Ge,{x_2:K,x_3:H}=E(G,K,H),{x_2:P,x_3:O}=E(G,P,O),G=Ge;let Se=K+P,Ke=u(Se*Se),ut=K-P,Lt=u(ut*ut),Ut=Ke-Lt,Cr=H+O,Rr=H-O,Tt=u(Rr*Se),Ot=u(Cr*ut),zt=Tt+Ot,Dt=Tt-Ot;H=u(zt*zt),O=u(k*u(Dt*Dt)),K=u(Ke*Lt),P=u(Ut*(Ke+u(d*Ut)))}({x_2:K,x_3:H}=E(G,K,H)),{x_2:P,x_3:O}=E(G,P,O);let Ae=o(P);return u(K*Ae)}return{scalarMult:y,scalarMultBase:_,getSharedSecret:(b,v)=>y(b,v),getPublicKey:b=>_(b),utils:{randomPrivateKey:()=>c(f)},GuBytes:x.slice()}}var Ee={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},In=Object.assign({},Ee,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),ao=Pt(In),Pn=Te(()=>hr.create({dkLen:114}));var kn=BigInt(1),kt=BigInt(2),Or=BigInt(3),fo=BigInt(4),Hn=BigInt(11),Ln=BigInt(22),zr=BigInt(44),Un=BigInt(88),Tn=BigInt(223);function Dr(t){let e=Ee.p,r=t*t*t%e,n=r*r*t%e,i=R(n,Or,e)*n%e,o=R(i,Or,e)*n%e,a=R(o,kt,e)*r%e,s=R(a,Hn,e)*a%e,c=R(s,Ln,e)*s%e,h=R(c,zr,e)*c%e,f=R(h,Un,e)*h%e,l=R(f,zr,e)*c%e,d=R(l,kt,e)*r%e,p=R(d,kn,e)*t%e;return R(p,Tn,e)*d%e}function Nr(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function On(t,e){let r=Ee.p,n=L(t*t*e,r),i=L(n*t,r),o=L(i*n*e,r),a=Dr(o),s=L(i*a,r),c=L(s*s,r);return{isValid:L(c*e,r)===t,value:s}}var zn=we(Ee.p,456,!0),Dn={...Ee,Fp:zn,nBitLength:456,hash:Pn,adjustScalarBytes:Nr,domain:(t,e,r)=>{if(e.length>255)throw new Error("context must be smaller than 255, got: "+e.length);return he(Qe("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)},uvRatio:On},co=Ur(Dn);var ct=(()=>{let t=Ee.p;return Tr({P:t,type:"x448",powPminus2:e=>{let r=Dr(e),n=R(r,kt,t);return L(n*e,t)},adjustScalarBytes:Nr})})();var ve="X448",je=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){try{return await this._serializePublicKey(e)}catch(r){throw new Q(r)}}async deserializePublicKey(e){try{return await this._importRawKey(e,!0)}catch(r){throw new V(r)}}async serializePrivateKey(e){try{return await this._serializePrivateKey(e)}catch(r){throw new Q(r)}}async deserializePrivateKey(e){try{return await this._importRawKey(e,!1)}catch(r){throw new V(r)}}async importKey(e,r,n){try{if(e==="raw")return await this._importRawKey(r,n);if(r instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(r,n)}catch(i){throw new V(i)}}async generateKeyPair(){try{let e=ct.utils.randomPrivateKey(),r=new j(ve,e,"private",ue);return{publicKey:await this.derivePublicKey(r),privateKey:r}}catch(e){throw new ee(e)}}async deriveKeyPair(e){try{let r=await this._hkdf.labeledExtract(M.buffer,Le,new Uint8Array(e)),n=await this._hkdf.labeledExpand(r,Ve,M,this._nSk),i=new j(ve,new Uint8Array(n),"private",ue);return{privateKey:i,publicKey:await this.derivePublicKey(i)}}catch(r){throw new Ie(r)}}async derivePublicKey(e){try{return await this._derivePublicKey(e)}catch(r){throw new V(r)}}async dh(e,r){try{return await this._dh(e,r)}catch(n){throw new Q(n)}}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_serializePrivateKey(e){return new Promise(r=>{r(e.key.buffer)})}_importRawKey(e,r){return new Promise((n,i)=>{r&&e.byteLength!==this._nPk&&i(new Error("Invalid length of the key")),!r&&e.byteLength!==this._nSk&&i(new Error("Invalid length of the key")),n(new j(ve,new Uint8Array(e),r?"public":"private",r?[]:ue))})}_importJWK(e,r){return new Promise((n,i)=>{e.kty!=="OKP"&&i(new Error(`Invalid kty: ${e.kty}`)),e.crv!=="X448"&&i(new Error(`Invalid crv: ${e.crv}`)),r?(typeof e.d<"u"&&i(new Error("Invalid key: `d` should not be set")),typeof e.x!="string"&&i(new Error("Invalid key: `x` not found")),n(new j(ve,ke(e.x),"public"))):(typeof e.d!="string"&&i(new Error("Invalid key: `d` not found")),n(new j(ve,ke(e.d),"private",ue)))})}_derivePublicKey(e){return new Promise((r,n)=>{try{let i=ct.getPublicKey(e.key);r(new j(ve,i,"public"))}catch(i){n(i)}})}_dh(e,r){return new Promise((n,i)=>{try{n(ct.getSharedSecret(e.key,r.key).buffer)}catch(o){i(o)}})}};var Ht=class extends He{constructor(){let e=new Ne;super(fe.DhkemX448HkdfSha512,new je(e),e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:fe.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};export{Ht as DhkemX448HkdfSha512,Ne as HkdfSha512,je as X448};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/edwards.js:
@noble/curves/esm/abstract/montgomery.js:
@noble/curves/esm/ed448.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
