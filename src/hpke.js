var gs=Object.create;var Un=Object.defineProperty;var ms=Object.getOwnPropertyDescriptor;var _s=Object.getOwnPropertyNames;var Es=Object.getPrototypeOf,vs=Object.prototype.hasOwnProperty;var Ke=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ss=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _s(e))!vs.call(t,i)&&i!==r&&Un(t,i,{get:()=>e[i],enumerable:!(n=ms(e,i))||n.enumerable});return t};var On=(t,e,r)=>(r=t!=null?gs(Es(t)):{},Ss(e||!t||!t.__esModule?Un(r,"default",{value:t,enumerable:!0}):r,t));var ti=Ke(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});function Bs(t,e){var r=t>>>16&65535,n=t&65535,i=e>>>16&65535,s=e&65535;return n*s+(r*s+n*i<<16>>>0)|0}ye.mul=Math.imul||Bs;function Is(t,e){return t+e|0}ye.add=Is;function Ls(t,e){return t-e|0}ye.sub=Ls;function Us(t,e){return t<<e|t>>>32-e}ye.rotl=Us;function Os(t,e){return t<<32-e|t>>>e}ye.rotr=Os;function Hs(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}ye.isInteger=Number.isInteger||Hs;ye.MAX_SAFE_INTEGER=9007199254740991;ye.isSafeInteger=function(t){return ye.isInteger(t)&&t>=-ye.MAX_SAFE_INTEGER&&t<=ye.MAX_SAFE_INTEGER}});var Vr=Ke(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});var ri=ti();function Ks(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}R.readInt16BE=Ks;function Ts(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}R.readUint16BE=Ts;function Ns(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}R.readInt16LE=Ns;function zs(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}R.readUint16LE=zs;function ni(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}R.writeUint16BE=ni;R.writeInt16BE=ni;function ii(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}R.writeUint16LE=ii;R.writeInt16LE=ii;function Mr(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}R.readInt32BE=Mr;function Gr(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}R.readUint32BE=Gr;function Fr(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}R.readInt32LE=Fr;function Zr(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}R.readUint32LE=Zr;function Jt(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}R.writeUint32BE=Jt;R.writeInt32BE=Jt;function er(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}R.writeUint32LE=er;R.writeInt32LE=er;function Ds(t,e){e===void 0&&(e=0);var r=Mr(t,e),n=Mr(t,e+4);return r*4294967296+n-(n>>31)*4294967296}R.readInt64BE=Ds;function Cs(t,e){e===void 0&&(e=0);var r=Gr(t,e),n=Gr(t,e+4);return r*4294967296+n}R.readUint64BE=Cs;function Rs(t,e){e===void 0&&(e=0);var r=Fr(t,e),n=Fr(t,e+4);return n*4294967296+r-(r>>31)*4294967296}R.readInt64LE=Rs;function js(t,e){e===void 0&&(e=0);var r=Zr(t,e),n=Zr(t,e+4);return n*4294967296+r}R.readUint64LE=js;function si(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Jt(t/4294967296>>>0,e,r),Jt(t>>>0,e,r+4),e}R.writeUint64BE=si;R.writeInt64BE=si;function oi(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),er(t>>>0,e,r),er(t/4294967296>>>0,e,r+4),e}R.writeUint64LE=oi;R.writeInt64LE=oi;function qs(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}R.readUintBE=qs;function Ms(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}R.readUintLE=Ms;function Gs(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ri.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}R.writeUintBE=Gs;function Fs(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ri.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}R.writeUintLE=Fs;function Zs(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}R.readFloat32BE=Zs;function Vs(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}R.readFloat32LE=Vs;function Xs(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}R.readFloat64BE=Xs;function $s(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}R.readFloat64LE=$s;function Ys(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}R.writeFloat32BE=Ys;function Ws(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}R.writeFloat32LE=Ws;function Qs(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}R.writeFloat64BE=Qs;function Js(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}R.writeFloat64LE=Js});var tr=Ke(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});function eo(t){for(var e=0;e<t.length;e++)t[e]=0;return t}Xr.wipe=eo});var ci=Ke(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});var oe=Vr(),$r=tr(),to=20;function ro(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],x=r[31]<<24|r[30]<<16|r[29]<<8|r[28],S=e[3]<<24|e[2]<<16|e[1]<<8|e[0],P=e[7]<<24|e[6]<<16|e[5]<<8|e[4],N=e[11]<<24|e[10]<<16|e[9]<<8|e[8],j=e[15]<<24|e[14]<<16|e[13]<<8|e[12],w=n,_=i,y=s,K=a,H=o,A=c,U=u,D=f,M=h,X=l,C=p,Q=x,G=S,$=P,g=N,b=j,d=0;d<to;d+=2)w=w+H|0,G^=w,G=G>>>32-16|G<<16,M=M+G|0,H^=M,H=H>>>32-12|H<<12,_=_+A|0,$^=_,$=$>>>32-16|$<<16,X=X+$|0,A^=X,A=A>>>32-12|A<<12,y=y+U|0,g^=y,g=g>>>32-16|g<<16,C=C+g|0,U^=C,U=U>>>32-12|U<<12,K=K+D|0,b^=K,b=b>>>32-16|b<<16,Q=Q+b|0,D^=Q,D=D>>>32-12|D<<12,y=y+U|0,g^=y,g=g>>>32-8|g<<8,C=C+g|0,U^=C,U=U>>>32-7|U<<7,K=K+D|0,b^=K,b=b>>>32-8|b<<8,Q=Q+b|0,D^=Q,D=D>>>32-7|D<<7,_=_+A|0,$^=_,$=$>>>32-8|$<<8,X=X+$|0,A^=X,A=A>>>32-7|A<<7,w=w+H|0,G^=w,G=G>>>32-8|G<<8,M=M+G|0,H^=M,H=H>>>32-7|H<<7,w=w+A|0,b^=w,b=b>>>32-16|b<<16,C=C+b|0,A^=C,A=A>>>32-12|A<<12,_=_+U|0,G^=_,G=G>>>32-16|G<<16,Q=Q+G|0,U^=Q,U=U>>>32-12|U<<12,y=y+D|0,$^=y,$=$>>>32-16|$<<16,M=M+$|0,D^=M,D=D>>>32-12|D<<12,K=K+H|0,g^=K,g=g>>>32-16|g<<16,X=X+g|0,H^=X,H=H>>>32-12|H<<12,y=y+D|0,$^=y,$=$>>>32-8|$<<8,M=M+$|0,D^=M,D=D>>>32-7|D<<7,K=K+H|0,g^=K,g=g>>>32-8|g<<8,X=X+g|0,H^=X,H=H>>>32-7|H<<7,_=_+U|0,G^=_,G=G>>>32-8|G<<8,Q=Q+G|0,U^=Q,U=U>>>32-7|U<<7,w=w+A|0,b^=w,b=b>>>32-8|b<<8,C=C+b|0,A^=C,A=A>>>32-7|A<<7;oe.writeUint32LE(w+n|0,t,0),oe.writeUint32LE(_+i|0,t,4),oe.writeUint32LE(y+s|0,t,8),oe.writeUint32LE(K+a|0,t,12),oe.writeUint32LE(H+o|0,t,16),oe.writeUint32LE(A+c|0,t,20),oe.writeUint32LE(U+u|0,t,24),oe.writeUint32LE(D+f|0,t,28),oe.writeUint32LE(M+h|0,t,32),oe.writeUint32LE(X+l|0,t,36),oe.writeUint32LE(C+p|0,t,40),oe.writeUint32LE(Q+x|0,t,44),oe.writeUint32LE(G+S|0,t,48),oe.writeUint32LE($+P|0,t,52),oe.writeUint32LE(g+N|0,t,56),oe.writeUint32LE(b+j|0,t,60)}function ai(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=i}for(var o=new Uint8Array(64),c=0;c<r.length;c+=64){ro(o,s,t);for(var u=c;u<c+64&&u<r.length;u++)n[u]=r[u]^o[u-c];io(s,0,a)}return $r.wipe(o),i===0&&$r.wipe(s),n}rr.streamXOR=ai;function no(t,e,r,n){return n===void 0&&(n=0),$r.wipe(r),ai(t,e,r,r,n)}rr.stream=no;function io(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}});var Yr=Ke(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});function so(t,e,r){return~(t-1)&e|t-1&r}ut.select=so;function oo(t,e){return(t|0)-(e|0)-1>>>31&1}ut.lessOrEqual=oo;function ui(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}ut.compare=ui;function ao(t,e){return t.length===0||e.length===0?!1:ui(t,e)!==0}ut.equal=ao});var hi=Ke(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});var co=Yr(),nr=tr();Ie.DIGEST_LENGTH=16;var fi=function(){function t(e){this.digestLength=Ie.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var n=e[2]|e[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=e[4]|e[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var a=e[8]|e[9]<<8;this._r[4]=(s>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var o=e[10]|e[11]<<8;this._r[6]=(a>>>14|o<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(o>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,n){for(var i=this._fin?0:2048,s=this._h[0],a=this._h[1],o=this._h[2],c=this._h[3],u=this._h[4],f=this._h[5],h=this._h[6],l=this._h[7],p=this._h[8],x=this._h[9],S=this._r[0],P=this._r[1],N=this._r[2],j=this._r[3],w=this._r[4],_=this._r[5],y=this._r[6],K=this._r[7],H=this._r[8],A=this._r[9];n>=16;){var U=e[r+0]|e[r+1]<<8;s+=U&8191;var D=e[r+2]|e[r+3]<<8;a+=(U>>>13|D<<3)&8191;var M=e[r+4]|e[r+5]<<8;o+=(D>>>10|M<<6)&8191;var X=e[r+6]|e[r+7]<<8;c+=(M>>>7|X<<9)&8191;var C=e[r+8]|e[r+9]<<8;u+=(X>>>4|C<<12)&8191,f+=C>>>1&8191;var Q=e[r+10]|e[r+11]<<8;h+=(C>>>14|Q<<2)&8191;var G=e[r+12]|e[r+13]<<8;l+=(Q>>>11|G<<5)&8191;var $=e[r+14]|e[r+15]<<8;p+=(G>>>8|$<<8)&8191,x+=$>>>5|i;var g=0,b=g;b+=s*S,b+=a*(5*A),b+=o*(5*H),b+=c*(5*K),b+=u*(5*y),g=b>>>13,b&=8191,b+=f*(5*_),b+=h*(5*w),b+=l*(5*j),b+=p*(5*N),b+=x*(5*P),g+=b>>>13,b&=8191;var d=g;d+=s*P,d+=a*S,d+=o*(5*A),d+=c*(5*H),d+=u*(5*K),g=d>>>13,d&=8191,d+=f*(5*y),d+=h*(5*_),d+=l*(5*w),d+=p*(5*j),d+=x*(5*N),g+=d>>>13,d&=8191;var m=g;m+=s*N,m+=a*P,m+=o*S,m+=c*(5*A),m+=u*(5*H),g=m>>>13,m&=8191,m+=f*(5*K),m+=h*(5*y),m+=l*(5*_),m+=p*(5*w),m+=x*(5*j),g+=m>>>13,m&=8191;var v=g;v+=s*j,v+=a*N,v+=o*P,v+=c*S,v+=u*(5*A),g=v>>>13,v&=8191,v+=f*(5*H),v+=h*(5*K),v+=l*(5*y),v+=p*(5*_),v+=x*(5*w),g+=v>>>13,v&=8191;var k=g;k+=s*w,k+=a*j,k+=o*N,k+=c*P,k+=u*S,g=k>>>13,k&=8191,k+=f*(5*A),k+=h*(5*H),k+=l*(5*K),k+=p*(5*y),k+=x*(5*_),g+=k>>>13,k&=8191;var B=g;B+=s*_,B+=a*w,B+=o*j,B+=c*N,B+=u*P,g=B>>>13,B&=8191,B+=f*S,B+=h*(5*A),B+=l*(5*H),B+=p*(5*K),B+=x*(5*y),g+=B>>>13,B&=8191;var O=g;O+=s*y,O+=a*_,O+=o*w,O+=c*j,O+=u*N,g=O>>>13,O&=8191,O+=f*P,O+=h*S,O+=l*(5*A),O+=p*(5*H),O+=x*(5*K),g+=O>>>13,O&=8191;var z=g;z+=s*K,z+=a*y,z+=o*_,z+=c*w,z+=u*j,g=z>>>13,z&=8191,z+=f*N,z+=h*P,z+=l*S,z+=p*(5*A),z+=x*(5*H),g+=z>>>13,z&=8191;var I=g;I+=s*H,I+=a*K,I+=o*y,I+=c*_,I+=u*w,g=I>>>13,I&=8191,I+=f*j,I+=h*N,I+=l*P,I+=p*S,I+=x*(5*A),g+=I>>>13,I&=8191;var T=g;T+=s*A,T+=a*H,T+=o*K,T+=c*y,T+=u*_,g=T>>>13,T&=8191,T+=f*w,T+=h*j,T+=l*N,T+=p*P,T+=x*S,g+=T>>>13,T&=8191,g=(g<<2)+g|0,g=g+b|0,b=g&8191,g=g>>>13,d+=g,s=b,a=d,o=m,c=v,u=k,f=B,h=O,l=z,p=I,x=T,r+=16,n-=16}this._h[0]=s,this._h[1]=a,this._h[2]=o,this._h[3]=c,this._h[4]=u,this._h[5]=f,this._h[6]=h,this._h[7]=l,this._h[8]=p,this._h[9]=x},t.prototype.finish=function(e,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,s,a,o;if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=i,i=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,o=1;o<10;o++)n[o]=this._h[o]+i,i=n[o]>>>13,n[o]&=8191;for(n[9]-=8192,s=(i^1)-1,o=0;o<10;o++)n[o]&=s;for(s=~s,o=0;o<10;o++)this._h[o]=this._h[o]&s|n[o];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,o=1;o<8;o++)a=(this._h[o]+this._pad[o]|0)+(a>>>16)|0,this._h[o]=a&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,n=e.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(e,r,i),r+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=n}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return nr.wipe(this._buffer),nr.wipe(this._r),nr.wipe(this._h),nr.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();Ie.Poly1305=fi;function uo(t,e){var r=new fi(t);r.update(e);var n=r.digest();return r.clean(),n}Ie.oneTimeAuth=uo;function fo(t,e){return t.length!==Ie.DIGEST_LENGTH||e.length!==Ie.DIGEST_LENGTH?!1:co.equal(t,e)}Ie.equal=fo});var bi=Ke(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});var ir=ci(),ho=hi(),Et=tr(),li=Vr(),lo=Yr();Le.KEY_LENGTH=32;Le.NONCE_LENGTH=12;Le.TAG_LENGTH=16;var di=new Uint8Array(16),bo=function(){function t(e){if(this.nonceLength=Le.NONCE_LENGTH,this.tagLength=Le.TAG_LENGTH,e.length!==Le.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var a=new Uint8Array(32);ir.stream(this._key,s,a,4);var o=r.length+this.tagLength,c;if(i){if(i.length!==o)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(o);return ir.streamXOR(this._key,s,r,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),n),Et.wipe(s),c},t.prototype.open=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var a=new Uint8Array(32);ir.stream(this._key,s,a,4);var o=new Uint8Array(this.tagLength);if(this._authenticate(o,a,r.subarray(0,r.length-this.tagLength),n),!lo.equal(o,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,u;if(i){if(i.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(c);return ir.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),u,4),Et.wipe(s),u},t.prototype.clean=function(){return Et.wipe(this._key),this},t.prototype._authenticate=function(e,r,n,i){var s=new ho.Poly1305(r);i&&(s.update(i),i.length%16>0&&s.update(di.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(di.subarray(n.length%16));var a=new Uint8Array(8);i&&li.writeUint64LE(i.length,a),s.update(a),li.writeUint64LE(n.length,a),s.update(a);for(var o=s.digest(),c=0;c<o.length;c++)e[c]=o[c];s.clean(),Et.wipe(o),Et.wipe(a)},t}();Le.ChaCha20Poly1305=bo});var vi=Ke(()=>{});var le=class extends Error{constructor(e){let r;e instanceof Error?r=e.message:typeof e=="string"?r=e:r="",super(r),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}},we=class extends le{},Hn=class extends le{},qt=class extends le{},st=class extends le{},Mt=class extends le{},Gt=class extends le{},Ft=class extends le{},$e=class extends le{},Ye=class extends le{},Zt=class extends le{},Vt=class extends le{},Be=class extends le{};var _e;(function(t){t[t.Base=0]="Base",t[t.Psk=1]="Psk",t[t.Auth=2]="Auth",t[t.AuthPsk=3]="AuthPsk"})(_e||(_e={}));var q;(function(t){t[t.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",t[t.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",t[t.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",t[t.DhkemSecp256K1HkdfSha256=19]="DhkemSecp256K1HkdfSha256",t[t.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",t[t.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512"})(q||(q={}));var de;(function(t){t[t.HkdfSha256=1]="HkdfSha256",t[t.HkdfSha384=2]="HkdfSha384",t[t.HkdfSha512=3]="HkdfSha512"})(de||(de={}));var J;(function(t){t[t.Aes128Gcm=1]="Aes128Gcm",t[t.Aes256Gcm=2]="Aes256Gcm",t[t.Chacha20Poly1305=3]="Chacha20Poly1305",t[t.ExportOnly=65535]="ExportOnly"})(J||(J={}));var As={},Kn=Ps(globalThis,As);function Ps(t,e){return new Proxy(t,{get(r,n,i){return n in e?e[n]:t[n]},set(r,n,i){return n in e&&delete e[n],t[n]=i,!0},deleteProperty(r,n){let i=!1;return n in e&&(delete e[n],i=!0),n in t&&(delete t[n],i=!0),i},ownKeys(r){let n=Reflect.ownKeys(t),i=Reflect.ownKeys(e),s=new Set(i);return[...n.filter(a=>!s.has(a)),...i]},defineProperty(r,n,i){return n in e&&delete e[n],Reflect.defineProperty(t,n,i),!0},getOwnPropertyDescriptor(r,n){return n in e?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(t,n)},has(r,n){return n in e||n in t}})}var Tn=()=>typeof Kn<"u",Nn=()=>typeof caches<"u";var mt=t=>typeof t=="object"&&t!==null&&typeof t.privateKey=="object"&&typeof t.publicKey=="object";function ce(t,e){if(e<=0)throw new Error("i2Osp: too small size");if(t>=256**e)throw new Error("i2Osp: too large integer");let r=new Uint8Array(e);for(let n=0;n<e&&t;n++)r[e-(n+1)]=t%256,t=t>>8;return r}function zn(t,e){if(t.byteLength!==e.byteLength)throw new Error("xor: different length inputs");let r=new Uint8Array(t.byteLength);for(let n=0;n<t.byteLength;n++)r[n]=t[n]^e[n];return r}function _t(t,e){let r=new Uint8Array(t.length+e.length);return r.set(t,0),r.set(e,t.length),r}function Dn(t,e,r){let n=new Uint8Array(t.length+e.length+r.length);return n.set(t,0),n.set(e,t.length),n.set(r,t.length+e.length),n}var Te=class{constructor(e){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=e}};async function Cn(){if((Tn()||Nn())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:t}=await import("crypto");return t.subtle}catch{throw new Be("Web Cryptograph API not supported")}}var Ne=["deriveBits"],Rn=["encrypt","decrypt"];var Z=new Uint8Array(0),qr=new Uint8Array([72,80,75,69,45,118,49]),jn=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),Qe=new Uint8Array([75,69,77,0,0]),ze=new Uint8Array([100,107,112,95,112,114,107]),qn=new Uint8Array([101,97,101,95,112,114,107]),Mn=new Uint8Array([105,110,102,111,95,104,97,115,104]),Gn=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),Fn=new Uint8Array([115,101,99,114,101,116]),Zn=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),Vn=new Uint8Array([107,101,121]),Xn=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),$n=new Uint8Array([101,120,112]),Yn=new Uint8Array([115,101,99]),Wn=new Uint8Array([99,97,110,100,105,100,97,116,101]),ot=new Uint8Array([115,107]),Qn=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Jn=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),ei=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var at=class extends Te{constructor(e,r,n){super(e),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=r,this.exporterSecret=n}async seal(e,r){return await this._emitError1()}async open(e,r){return await this._emitError1()}async setupBidirectional(e,r){return await this._emitError2()}async export(e,r){if(e.byteLength>128)throw new we("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,Yn,new Uint8Array(e),r)}catch(n){throw new Ft(n)}}_emitError1(){return new Promise((e,r)=>{r(new Be("Not available on export-only mode"))})}_emitError2(){return new Promise((e,r)=>{r(new Be("Not available on export-only mode"))})}},Xt=class extends at{},$t=class extends at{constructor(e,r,n,i){super(e,r,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i}};var Yt=class{constructor(e,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=e,this._api=r}async seal(e,r,n){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i={name:"AES-GCM",iv:e,additionalData:n};return await this._api.encrypt(i,this._key,r)}async open(e,r,n){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i={name:"AES-GCM",iv:e,additionalData:n};return await this._api.decrypt(i,this._key,r)}async importKey(e){return await this._api.importKey("raw",e,{name:"AES-GCM"},!0,Rn)}},Wt=class extends Yt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}},Qt=class extends Yt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var wi=On(bi(),1);var sr=class{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:J.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new wi.ChaCha20Poly1305(new Uint8Array(e))}async seal(e,r,n){return await this._seal(e,r,n)}async open(e,r,n){return await this._open(e,r,n)}_seal(e,r,n){return new Promise(i=>{let s=this._key.seal(new Uint8Array(e),new Uint8Array(r),new Uint8Array(n));i(s.buffer)})}_open(e,r,n){return new Promise((i,s)=>{let a=this._key.open(new Uint8Array(e),new Uint8Array(r),new Uint8Array(n));a instanceof Uint8Array?i(a.buffer):s(new Error("failed to open."))})}};var ft=class extends at{constructor(e,r,n){if(super(e,r,n.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.key===void 0||n.baseNonce===void 0||n.seq===void 0)throw new Error("Required parameters are missing");switch(this._aead=n.aead,this._aead){case J.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case J.Aes256Gcm:this._nK=32,this._nN=12,this._nT=16;break;case J.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0;break}let i=or(this._aead,n.key,this._api);this._f={key:i,baseNonce:n.baseNonce,seq:n.seq},this._r={key:i,baseNonce:Z,seq:0}}computeNonce(e){let r=ce(e.seq,e.baseNonce.byteLength);return zn(e.baseNonce,r)}incrementSeq(e){if(e.seq>Number.MAX_SAFE_INTEGER)throw new Zt("Message limit reached");e.seq+=1}async setupBidirectional(e,r){try{this._r.baseNonce=new Uint8Array(await this.export(r,this._nN));let n=await this.export(e,this._nK);this._r.key=or(this._aead,n,this._api),this._r.seq=0}catch(n){throw this._r.baseNonce=Z,n}}};function or(t,e,r){switch(t){case J.Aes128Gcm:return new Wt(e,r);case J.Aes256Gcm:return new Qt(e,r);case J.Chacha20Poly1305:return new sr(e);default:throw new Error("Invalid or unsupported AEAD id")}}function Wr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function wo(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function yi(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function yo(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Wr(t.outputLen),Wr(t.blockLen)}function po(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function xo(t,e){yi(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var go={number:Wr,bool:wo,bytes:yi,hash:yo,exists:po,output:xo},ae=go;var ar=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var pi=t=>t instanceof Uint8Array;var xi=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),cr=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ve=(t,e)=>t<<32-e|t>>>e,mo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!mo)throw new Error("Non little-endian hardware is not supported");var pc=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function vt(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ce(t){if(typeof t=="string"&&(t=vt(t)),!pi(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function ur(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!pi(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var De=class{clone(){return this._cloneInto()}};function pe(t){let e=n=>t().update(Ce(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function gi(t){let e=(n,i)=>t(i).update(Ce(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}function ht(t=32){if(ar&&typeof ar.getRandomValues=="function")return ar.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}var fr=class extends De{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ae.hash(e);let n=Ce(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(e){return ae.exists(this),this.iHash.update(e),this}digestInto(e){ae.exists(this),ae.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},St=(t,e,r)=>new fr(t,e).update(r).digest();St.create=(t,e)=>new fr(t,e);function _o(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,a,n),t.setUint32(e+u,o,n)}var lt=class extends De{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=cr(this.buffer)}update(e){ae.exists(this);let{view:r,buffer:n,blockLen:i}=this;e=Ce(e);let s=e.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o===i){let c=cr(e);for(;i<=s-a;a+=i)this.process(c,a);continue}n.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ae.exists(this),ae.output(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)r[h]=0;_o(n,i-8,BigInt(this.length*8),s),this.process(n,0);let o=cr(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)o.setUint32(4*h,f[h],s)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=a,i%r&&e.buffer.set(n),e}};var Eo=(t,e,r)=>t&e^~t&r,vo=(t,e,r)=>t&e^t&r^e&r,So=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Re=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),je=new Uint32Array(64),hr=class extends lt{constructor(){super(64,32,8,!1),this.A=Re[0]|0,this.B=Re[1]|0,this.C=Re[2]|0,this.D=Re[3]|0,this.E=Re[4]|0,this.F=Re[5]|0,this.G=Re[6]|0,this.H=Re[7]|0}get(){let{A:e,B:r,C:n,D:i,E:s,F:a,G:o,H:c}=this;return[e,r,n,i,s,a,o,c]}set(e,r,n,i,s,a,o,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)je[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){let l=je[h-15],p=je[h-2],x=ve(l,7)^ve(l,18)^l>>>3,S=ve(p,17)^ve(p,19)^p>>>10;je[h]=S+je[h-7]+x+je[h-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:c,G:u,H:f}=this;for(let h=0;h<64;h++){let l=ve(o,6)^ve(o,11)^ve(o,25),p=f+l+Eo(o,c,u)+So[h]+je[h]|0,S=(ve(n,2)^ve(n,13)^ve(n,22))+vo(n,i,s)|0;f=u,u=c,c=o,o=a+p|0,a=s,s=i,i=n,n=p+S|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,i,s,a,o,c,u,f)}roundClean(){je.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Qr=class extends hr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},mi=pe(()=>new hr),kc=pe(()=>new Qr);var lr=BigInt(4294967295),Jr=BigInt(32);function _i(t,e=!1){return e?{h:Number(t&lr),l:Number(t>>Jr&lr)}:{h:Number(t>>Jr&lr)|0,l:Number(t&lr)|0}}function Ao(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:s,l:a}=_i(t[i],e);[r[i],n[i]]=[s,a]}return[r,n]}var Po=(t,e)=>BigInt(t>>>0)<<Jr|BigInt(e>>>0),ko=(t,e,r)=>t>>>r,Bo=(t,e,r)=>t<<32-r|e>>>r,Io=(t,e,r)=>t>>>r|e<<32-r,Lo=(t,e,r)=>t<<32-r|e>>>r,Uo=(t,e,r)=>t<<64-r|e>>>r-32,Oo=(t,e,r)=>t>>>r-32|e<<64-r,Ho=(t,e)=>e,Ko=(t,e)=>t,To=(t,e,r)=>t<<r|e>>>32-r,No=(t,e,r)=>e<<r|t>>>32-r,zo=(t,e,r)=>e<<r-32|t>>>64-r,Do=(t,e,r)=>t<<r-32|e>>>64-r;function Co(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var Ro=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),jo=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,qo=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Mo=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,Go=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Fo=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,Zo={fromBig:_i,split:Ao,toBig:Po,shrSH:ko,shrSL:Bo,rotrSH:Io,rotrSL:Lo,rotrBH:Uo,rotrBL:Oo,rotr32H:Ho,rotr32L:Ko,rotlSH:To,rotlSL:No,rotlBH:zo,rotlBL:Do,add:Co,add3L:Ro,add3H:jo,add4L:qo,add4H:Mo,add5H:Fo,add5L:Go},L=Zo;var[Vo,Xo]=L.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),qe=new Uint32Array(80),Me=new Uint32Array(80),dt=class extends lt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:f,Fh:h,Fl:l,Gh:p,Gl:x,Hh:S,Hl:P}=this;return[e,r,n,i,s,a,o,c,u,f,h,l,p,x,S,P]}set(e,r,n,i,s,a,o,c,u,f,h,l,p,x,S,P){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=c|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=l|0,this.Gh=p|0,this.Gl=x|0,this.Hh=S|0,this.Hl=P|0}process(e,r){for(let w=0;w<16;w++,r+=4)qe[w]=e.getUint32(r),Me[w]=e.getUint32(r+=4);for(let w=16;w<80;w++){let _=qe[w-15]|0,y=Me[w-15]|0,K=L.rotrSH(_,y,1)^L.rotrSH(_,y,8)^L.shrSH(_,y,7),H=L.rotrSL(_,y,1)^L.rotrSL(_,y,8)^L.shrSL(_,y,7),A=qe[w-2]|0,U=Me[w-2]|0,D=L.rotrSH(A,U,19)^L.rotrBH(A,U,61)^L.shrSH(A,U,6),M=L.rotrSL(A,U,19)^L.rotrBL(A,U,61)^L.shrSL(A,U,6),X=L.add4L(H,M,Me[w-7],Me[w-16]),C=L.add4H(X,K,D,qe[w-7],qe[w-16]);qe[w]=C|0,Me[w]=X|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:f,Eh:h,El:l,Fh:p,Fl:x,Gh:S,Gl:P,Hh:N,Hl:j}=this;for(let w=0;w<80;w++){let _=L.rotrSH(h,l,14)^L.rotrSH(h,l,18)^L.rotrBH(h,l,41),y=L.rotrSL(h,l,14)^L.rotrSL(h,l,18)^L.rotrBL(h,l,41),K=h&p^~h&S,H=l&x^~l&P,A=L.add5L(j,y,H,Xo[w],Me[w]),U=L.add5H(A,N,_,K,Vo[w],qe[w]),D=A|0,M=L.rotrSH(n,i,28)^L.rotrBH(n,i,34)^L.rotrBH(n,i,39),X=L.rotrSL(n,i,28)^L.rotrBL(n,i,34)^L.rotrBL(n,i,39),C=n&s^n&o^s&o,Q=i&a^i&c^a&c;N=S|0,j=P|0,S=p|0,P=x|0,p=h|0,x=l|0,{h,l}=L.add(u|0,f|0,U|0,D|0),u=o|0,f=c|0,o=s|0,c=a|0,s=n|0,a=i|0;let G=L.add3L(D,X,Q);n=L.add3H(G,U,M,C),i=G|0}({h:n,l:i}=L.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=L.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:c}=L.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:u,l:f}=L.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l}=L.add(this.Eh|0,this.El|0,h|0,l|0),{h:p,l:x}=L.add(this.Fh|0,this.Fl|0,p|0,x|0),{h:S,l:P}=L.add(this.Gh|0,this.Gl|0,S|0,P|0),{h:N,l:j}=L.add(this.Hh|0,this.Hl|0,N|0,j|0),this.set(n,i,s,a,o,c,u,f,h,l,p,x,S,P,N,j)}roundClean(){qe.fill(0),Me.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},en=class extends dt{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},tn=class extends dt{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},rn=class extends dt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},At=pe(()=>new dt),Hc=pe(()=>new en),Kc=pe(()=>new tn),Ei=pe(()=>new rn);var Pt=class extends Te{constructor(e,r){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=r}buildLabeledIkm(e,r){let n=new Uint8Array(7+this.suiteId.byteLength+e.byteLength+r.byteLength);return n.set(qr,0),n.set(this.suiteId,7),n.set(e,7+this.suiteId.byteLength),n.set(r,7+this.suiteId.byteLength+e.byteLength),n}buildLabeledInfo(e,r,n){let i=new Uint8Array(9+this.suiteId.byteLength+e.byteLength+r.byteLength);return i.set(new Uint8Array([0,n]),0),i.set(qr,2),i.set(this.suiteId,9),i.set(e,9+this.suiteId.byteLength),i.set(r,9+this.suiteId.byteLength+e.byteLength),i}async extract(e,r){if(e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return St(mi,new Uint8Array(e),new Uint8Array(r));case"SHA-384":return St(Ei,new Uint8Array(e),new Uint8Array(r));default:return St(At,new Uint8Array(e),new Uint8Array(r))}let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,r)}async expand(e,r,n){let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),s=new ArrayBuffer(n),a=new Uint8Array(s),o=Z,c=new Uint8Array(r),u=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let h=1,l=0;l<a.length;h++)u[0]=h,f.set(o,0),f.set(c,o.length),f.set(u,o.length+c.length),o=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,o.length+c.length+1))),a.length-l>=o.length?(a.set(o,l),l+=o.length):(a.set(o.slice(0,a.length-l),l),l+=a.length-l);return s}async extractAndExpand(e,r,n,i){let s=await this._api.importKey("raw",r,"HKDF",!1,Ne);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:n},s,i*8)}async labeledExtract(e,r,n){return await this.extract(e,this.buildLabeledIkm(r,n))}async labeledExpand(e,r,n,i){return await this.expand(e,this.buildLabeledInfo(r,n,i),i)}},Ge=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},bt=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},Je=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var dr=class extends ft{async seal(e,r=Z){if(this._r.baseNonce.length===0)throw new $e("Bidirectional encryption is not setup");let n;try{n=await this._r.key.seal(this.computeNonce(this._r),e,r)}catch(i){throw new $e(i)}return this.incrementSeq(this._r),n}async open(e,r=Z){let n;try{n=await this._f.key.open(this.computeNonce(this._f),e,r)}catch(i){throw new Ye(i)}return this.incrementSeq(this._f),n}};var br=class extends ft{constructor(e,r,n,i){super(e,r,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i}async seal(e,r=Z){let n;try{n=await this._f.key.seal(this.computeNonce(this._f),e,r)}catch(i){throw new $e(i)}return this.incrementSeq(this._f),n}async open(e,r=Z){if(this._r.baseNonce.length===0)throw new Ye("Bidirectional encryption is not setup");let n;try{n=await this._r.key.open(this.computeNonce(this._r),e,r)}catch(i){throw new Ye(i)}return this.incrementSeq(this._r),n}};var wr=class{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(this._num[e]!==0)return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let r=0;r<this._num.length;r++){if(this._num[r]<e[r])return!0;if(this._num[r]>e[r])return!1}return!1}};var $o=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),Yo=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Wo=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),wt=class{constructor(e,r,n){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=r,this._api=n,e){case q.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=Qn,this._bitmask=255,this._pkcs8AlgId=$o;break;case q.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=Jn,this._bitmask=255,this._pkcs8AlgId=Yo;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=ei,this._bitmask=1,this._pkcs8AlgId=Wo;break}}async serializePublicKey(e){let r=await this._api.exportKey("raw",e);if(r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");return r}async deserializePublicKey(e){if(e.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",e,this._alg,!0,[])}catch{throw new Error("Invalid public key for the ciphersuite")}}async importKey(e,r,n){if(e!=="raw")throw new Error("Unsupported format");if(n&&r.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!n&&r.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");try{if(n)return await this._api.importKey(e,r,this._alg,!0,[]);let i=new Uint8Array(r),s=new Uint8Array(this._pkcs8AlgId.length+i.length);return s.set(this._pkcs8AlgId,0),s.set(i,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",s,this._alg,!0,Ne)}catch{throw new Error("Invalid key for the ciphersuite")}}async derivePublicKey(e){let r=await this._api.exportKey("jwk",e);return delete r.d,delete r.key_ops,await this._api.importKey("jwk",r,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,Ne)}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(Z,ze,new Uint8Array(e)),n=new wr(this._nSk);for(let a=0;n.isZero()||!n.lessThan(this._order);a++){if(a>255)throw new Error("Faild to derive a key pair");let o=new Uint8Array(await this._hkdf.labeledExpand(r,Wn,ce(a,1),this._nSk));o[0]=o[0]&this._bitmask,n.set(o)}let i=new Uint8Array(this._pkcs8AlgId.length+n.val().length);i.set(this._pkcs8AlgId,0),i.set(n.val(),this._pkcs8AlgId.length);let s=await this._api.importKey("pkcs8",i,this._alg,!0,Ne);return n.reset(),{privateKey:s,publicKey:await this.derivePublicKey(s)}}async dh(e,r){return await this._api.deriveBits({name:"ECDH",public:r},e,this._nDh*8)}};var Qo=On(vi(),1);var V=BigInt(0),W=BigInt(1),Fe=BigInt(2),It=BigInt(3),Si=BigInt(8),ne=Object.freeze({a:V,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:W,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Ai=(t,e)=>(t+e/Fe)/e,yr={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=ne,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-W*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=Ai(s*t,e),c=Ai(-n*t,e),u=E(t-o*r-c*i,e),f=E(-o*n-c*s,e),h=u>a,l=f>a;if(h&&(u=e-u),l&&(f=e-f),u>a||f>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:u,k2neg:l,k2:f}}},yt=32,Ut=32;var mr=yt+1,_r=2*yt+1;function Pi(t){let{a:e,b:r}=ne,n=E(t*t),i=E(n*t);return E(i+e*t+r)}var pr=ne.a===V,on=class extends Error{constructor(e){super(e)}};function ki(t){if(!(t instanceof ue))throw new TypeError("JacobianPoint expected")}var ue=class t{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof re))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(re.ZERO)?t.ZERO:new t(e.x,e.y,W)}static toAffineBatch(e){let r=na(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return t.toAffineBatch(e).map(t.fromAffine)}equals(e){ki(e);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=e,c=E(i*i),u=E(o*o),f=E(r*u),h=E(s*c),l=E(E(n*o)*u),p=E(E(a*i)*c);return f===h&&l===p}negate(){return new t(this.x,E(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=E(e*e),s=E(r*r),a=E(s*s),o=e+s,c=E(Fe*(E(o*o)-i-a)),u=E(It*i),f=E(u*u),h=E(f-Fe*c),l=E(u*(c-h)-Si*a),p=E(Fe*r*n);return new t(h,l,p)}add(e){ki(e);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=e;if(s===V||a===V)return this;if(r===V||n===V)return e;let c=E(i*i),u=E(o*o),f=E(r*u),h=E(s*c),l=E(E(n*o)*u),p=E(E(a*i)*c),x=E(h-f),S=E(p-l);if(x===V)return S===V?this.double():t.ZERO;let P=E(x*x),N=E(x*P),j=E(f*P),w=E(S*S-N-Fe*j),_=E(S*(j-w)-l*N),y=E(i*o*x);return new t(w,_,y)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=t.ZERO;if(typeof e=="bigint"&&e===V)return r;let n=Ui(e);if(n===W)return this;if(!pr){let h=r,l=this;for(;n>V;)n&W&&(h=h.add(l)),l=l.double(),n>>=W;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=yr.splitScalar(n),c=r,u=r,f=this;for(;s>V||o>V;)s&W&&(c=c.add(f)),o&W&&(u=u.add(f)),f=f.double(),s>>=W,o>>=W;return i&&(c=c.negate()),a&&(u=u.negate()),u=new t(E(u.x*yr.beta),u.y,u.z),c.add(u)}precomputeWindow(e){let r=pr?128/e+1:256/e+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(t.BASE)&&(r=re.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&an.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=t.normalizeZ(i),an.set(r,i)));let s=t.ZERO,a=t.BASE,o=1+(pr?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<o;l++){let p=l*c,x=Number(e&u);e>>=h,x>c&&(x-=f,e+=W);let S=p,P=p+Math.abs(x)-1,N=l%2!==0,j=x<0;x===0?a=a.add(xr(N,i[S])):s=s.add(xr(j,i[P]))}return{p:s,f:a}}multiply(e,r){let n=Ui(e),i,s;if(pr){let{k1neg:a,k1:o,k2neg:c,k2:u}=yr.splitScalar(n),{p:f,f:h}=this.wNAF(o,r),{p:l,f:p}=this.wNAF(u,r);f=xr(a,f),l=xr(c,l),l=new t(E(l.x*yr.beta),l.y,l.z),i=f.add(l),s=h.add(p)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return t.normalizeZ([i,s])[0]}toAffine(e){let{x:r,y:n,z:i}=this,s=this.equals(t.ZERO);e==null&&(e=s?Si:Ar(i));let a=e,o=E(a*a),c=E(o*a),u=E(r*o),f=E(n*c),h=E(i*a);if(s)return re.ZERO;if(h!==W)throw new Error("invZ was invalid");return new re(u,f)}};ue.BASE=new ue(ne.Gx,ne.Gy,W);ue.ZERO=new ue(V,W,V);function xr(t,e){let r=e.negate();return t?r:e}var an=new WeakMap,re=class t{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,an.delete(this)}hasEvenY(){return this.y%Fe===V}static fromCompressedHex(e){let r=e.length===32,n=rt(r?e:e.subarray(1));if(!sn(n))throw new Error("Point is not on curve");let i=Pi(n),s=ra(i),a=(s&W)===W;r?a&&(s=E(-s)):(e[0]&1)===1!==a&&(s=E(-s));let o=new t(n,s);return o.assertValidity(),o}static fromUncompressedHex(e){let r=rt(e.subarray(1,yt+1)),n=rt(e.subarray(yt+1,yt*2+1)),i=new t(r,n);return i.assertValidity(),i}static fromHex(e){let r=cn(e),n=r.length,i=r[0];if(n===yt)return this.fromCompressedHex(r);if(n===mr&&(i===2||i===3))return this.fromCompressedHex(r);if(n===_r&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${mr} compressed bytes or ${_r} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return t.BASE.multiply(Sr(e))}static fromSignature(e,r,n){let{r:i,s}=aa(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=sa(cn(e)),{n:o}=ne,c=n===2||n===3?i+o:i,u=Ar(c,o),f=E(-a*u,o),h=E(s*u,o),l=n&1?"03":"02",p=t.fromHex(l+pt(c)),x=t.BASE.multiplyAndAddUnsafe(p,f,h);if(!x)throw new Error("Cannot recover signature: point at infinify");return x.assertValidity(),x}toRawBytes(e=!1){return tt(this.toHex(e))}toHex(e=!1){let r=pt(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${pt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!sn(r)||!sn(n))throw new Error(e);let i=E(n*n),s=Pi(r);if(E(i-s)!==V)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new t(this.x,E(-this.y))}double(){return ue.fromAffine(this).double().toAffine()}add(e){return ue.fromAffine(this).add(ue.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ue.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=ue.fromAffine(this),s=r===V||r===W||this!==t.BASE?i.multiplyUnsafe(r):i.multiply(r),a=ue.fromAffine(e).multiplyUnsafe(n),o=s.add(a);return o.equals(ue.ZERO)?void 0:o.toAffine()}};re.BASE=new re(ne.Gx,ne.Gy);re.ZERO=new re(V,V);function Bi(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function Ii(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${gt(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:rt(r),left:t.subarray(e+2)}}function Jo(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${gt(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=Ii(t.subarray(2)),{data:n,left:i}=Ii(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${gt(i)}`);return{r:e,s:n}}var Lt=class t{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?gt(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new t(Er(i.slice(0,64)),Er(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Jo(r?e:tt(e));return new t(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!vr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!vr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ne.n>>W;return this.s>e}normalizeS(){return this.hasHighS()?new t(this.r,E(-this.s,ne.n)):this}toDERRawBytes(){return tt(this.toDERHex())}toDERHex(){let e=Bi(Bt(this.s)),r=Bi(Bt(this.r)),n=e.length/2,i=r.length/2,s=Bt(n),a=Bt(i);return`30${Bt(i+n+4)}02${a}${r}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return tt(this.toCompactHex())}toCompactHex(){return pt(this.r)+pt(this.s)}};function kt(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var ea=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gt(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=ea[t[r]];return e}var ta=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function pt(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(V<=t&&t<ta))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function Li(t){let e=tt(pt(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Bt(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Er(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function tt(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function rt(t){return Er(gt(t))}function cn(t){return t instanceof Uint8Array?Uint8Array.from(t):tt(t)}function Ui(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&vr(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function E(t,e=ne.P){let r=t%e;return r>=V?r:e+r}function me(t,e){let{P:r}=ne,n=t;for(;e-- >V;)n*=n,n%=r;return n}function ra(t){let{P:e}=ne,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),c=t*t*t%e,u=c*c*t%e,f=me(u,It)*u%e,h=me(f,It)*u%e,l=me(h,Fe)*c%e,p=me(l,n)*l%e,x=me(p,i)*p%e,S=me(x,a)*x%e,P=me(S,o)*S%e,N=me(P,a)*x%e,j=me(N,It)*u%e,w=me(j,s)*p%e,_=me(w,r)*c%e,y=me(_,Fe);if(y*y%e!==t)throw new Error("Cannot find square root");return y}function Ar(t,e=ne.P){if(t===V||e<=V)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=E(t,e),n=e,i=V,s=W,a=W,o=V;for(;r!==V;){let u=n/r,f=n%r,h=i-a*u,l=s-o*u;n=r,r=f,i=a,s=o,a=h,o=l}if(n!==W)throw new Error("invert: does not exist");return E(i,e)}function na(t,e=ne.P){let r=new Array(t.length),n=t.reduce((s,a,o)=>a===V?s:(r[o]=s,E(s*a,e)),W),i=Ar(n,e);return t.reduceRight((s,a,o)=>a===V?s:(r[o]=E(s*r[o],e),E(s*a,e)),i),r}function ia(t){let e=t.length*8-Ut*8,r=rt(t);return e>0?r>>BigInt(e):r}function sa(t,e=!1){let r=ia(t);if(e)return r;let{n}=ne;return r>=n?r-n:r}var xt,nn;function vr(t){return V<t&&t<ne.n}function sn(t){return V<t&&t<ne.P}function Sr(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*Ut)throw new Error("Expected 32 bytes of private key");e=Er(t)}else if(t instanceof Uint8Array){if(t.length!==Ut)throw new Error("Expected 32 bytes of private key");e=rt(t)}else throw new TypeError("Expected valid private key");if(!vr(e))throw new Error("Expected private key: 0 < key < n");return e}function oa(t){return t instanceof re?(t.assertValidity(),t):re.fromHex(t)}function aa(t){if(t instanceof Lt)return t.assertValidity(),t;try{return Lt.fromDER(t)}catch{return Lt.fromCompact(t)}}function Hi(t,e=!1){return re.fromPrivateKey(t).toRawBytes(e)}function Oi(t){let e=t instanceof Uint8Array,r=typeof t=="string",n=(e||r)&&t.length;return e?n===mr||n===_r:r?n===mr*2||n===_r*2:t instanceof re}function Ki(t,e,r=!1){if(Oi(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!Oi(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=oa(e);return n.assertValidity(),n.multiply(Sr(t)).toRawBytes(r)}re.BASE._setWindowSize(8);var xe={node:Qo,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var gr={},et={bytesToHex:gt,hexToBytes:tt,concatBytes:kt,mod:E,invert:Ar,isValidPrivateKey(t){try{return Sr(t),!0}catch{return!1}},_bigintTo32Bytes:Li,_normalizePrivateKey:Sr,hashToPrivateKey:t=>{t=cn(t);let e=Ut+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=E(rt(t),ne.n-W)+W;return Li(r)},randomBytes:(t=32)=>{if(xe.web)return xe.web.getRandomValues(new Uint8Array(t));if(xe.node){let{randomBytes:e}=xe.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>et.hashToPrivateKey(et.randomBytes(Ut+8)),precompute(t=8,e=re.BASE){let r=e===re.BASE?e:new re(e.x,e.y);return r._setWindowSize(t),r.multiply(It),r},sha256:async(...t)=>{if(xe.web){let e=await xe.web.subtle.digest("SHA-256",kt(...t));return new Uint8Array(e)}else if(xe.node){let{createHash:e}=xe.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(xe.web){let r=await xe.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=kt(...e),i=await xe.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(xe.node){let{createHmac:r}=xe.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=gr[t];if(r===void 0){let n=await et.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=kt(n,n),gr[t]=r}return et.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof xt!="function")throw new on("sha256Sync is undefined, you need to set it");let r=gr[t];if(r===void 0){let n=xt(Uint8Array.from(t,i=>i.charCodeAt(0)));r=kt(n,n),gr[t]=r}return xt(r,...e)},_JacobianPoint:ue};Object.defineProperties(et,{sha256Sync:{configurable:!1,get(){return xt},set(t){xt||(xt=t)}},hmacSha256Sync:{configurable:!1,get(){return nn},set(t){nn||(nn=t)}}});var te=class{constructor(e,r,n){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:Ne}),this.key=r,this.type=n,this.algorithm={name:e}}};var Ot="ECDH",Pr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=65,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=et.randomPrivateKey(),r=new te(Ot,e,"private");return{publicKey:await this.derivePublicKey(r),privateKey:r}}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(Z,ze,new Uint8Array(e)),n=await this._hkdf.labeledExpand(r,ot,Z,this._nSk),i=new te(Ot,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):r(new te(Ot,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((n,i)=>{r&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new te(Ot,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{let n=Hi(e.key);r(new te(Ot,n,"public"))})}_dh(e,r){return new Promise((n,i)=>{try{n(Ki(e.key,r.key).buffer)}catch(s){i(s)}})}};var iu=BigInt(0),ua=BigInt(1),fa=BigInt(2),kr=t=>t instanceof Uint8Array,ha=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ht(t){if(!kr(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=ha[t[r]];return e}function Ti(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Ni(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,s=t.slice(i,i+2),a=Number.parseInt(s,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");r[n]=a}return r}function un(t){return Ti(Ht(t))}function Pe(t){if(!kr(t))throw new Error("Uint8Array expected");return Ti(Ht(Uint8Array.from(t).reverse()))}function fn(t,e){return Ni(t.toString(16).padStart(e*2,"0"))}function Ze(t,e){return fn(t,e).reverse()}function be(t,e,r){let n;if(typeof e=="string")try{n=Ni(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(kr(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Br(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!kr(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}var zi=t=>(fa<<BigInt(t-1))-ua;var la={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ue(t,e,r={}){let n=(i,s,a)=>{let o=la[s];if(typeof o!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=t[i];if(!(a&&c===void 0)&&!o(c,t))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return t}var ie=BigInt(0),ee=BigInt(1),nt=BigInt(2),ba=BigInt(3),hn=BigInt(4),Di=BigInt(5),Ci=BigInt(8),wa=BigInt(9),ya=BigInt(16);function F(t,e){let r=t%e;return r>=ie?r:e+r}function ln(t,e,r){if(r<=ie||e<ie)throw new Error("Expected power/modulo > 0");if(r===ee)return ie;let n=ee;for(;e>ie;)e&ee&&(n=n*t%r),t=t*t%r,e>>=ee;return n}function Y(t,e,r){let n=t;for(;e-- >ie;)n*=n,n%=r;return n}function Ri(t,e){if(t===ie||e<=ie)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=F(t,e),n=e,i=ie,s=ee,a=ee,o=ie;for(;r!==ie;){let u=n/r,f=n%r,h=i-a*u,l=s-o*u;n=r,r=f,i=a,s=o,a=h,o=l}if(n!==ee)throw new Error("invert: does not exist");return F(i,e)}function pa(t){let e=(t-ee)/nt,r,n,i;for(r=t-ee,n=0;r%nt===ie;r/=nt,n++);for(i=nt;i<t&&ln(i,e,t)!==t-ee;i++);if(n===1){let a=(t+ee)/hn;return function(c,u){let f=c.pow(u,a);if(!c.eql(c.sqr(f),u))throw new Error("Cannot find square root");return f}}let s=(r+ee)/nt;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let u=n,f=o.pow(o.mul(o.ONE,i),r),h=o.pow(c,s),l=o.pow(c,r);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let p=1;for(let S=o.sqr(l);p<u&&!o.eql(S,o.ONE);p++)S=o.sqr(S);let x=o.pow(f,ee<<BigInt(u-p-1));f=o.sqr(x),h=o.mul(h,x),l=o.mul(l,f),u=p}return h}}function xa(t){if(t%hn===ba){let e=(t+ee)/hn;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Ci===Di){let e=(t-Di)/Ci;return function(n,i){let s=n.mul(i,nt),a=n.pow(s,e),o=n.mul(i,a),c=n.mul(n.mul(o,nt),a),u=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return t%ya,pa(t)}var ji=(t,e)=>(F(t,e)&ee)===ee,ga=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qi(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=ga.reduce((n,i)=>(n[i]="function",n),e);return Ue(t,r)}function ma(t,e,r){if(r<ie)throw new Error("Expected power > 0");if(r===ie)return t.ONE;if(r===ee)return e;let n=t.ONE,i=e;for(;r>ie;)r&ee&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ee;return n}function _a(t,e){let r=new Array(e.length),n=e.reduce((s,a,o)=>t.is0(a)?s:(r[o]=s,t.mul(s,a)),t.ONE),i=t.inv(n);return e.reduceRight((s,a,o)=>t.is0(a)?s:(r[o]=t.mul(s,r[o]),t.mul(s,a)),i),r}function dn(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Ir(t,e,r=!1,n={}){if(t<=ie)throw new Error(`Expected Fp ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:s}=dn(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=xa(t),o=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:zi(i),ZERO:ie,ONE:ee,create:c=>F(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return ie<=c&&c<t},is0:c=>c===ie,isOdd:c=>(c&ee)===ee,neg:c=>F(-c,t),eql:(c,u)=>c===u,sqr:c=>F(c*c,t),add:(c,u)=>F(c+u,t),sub:(c,u)=>F(c-u,t),mul:(c,u)=>F(c*u,t),pow:(c,u)=>ma(o,c,u),div:(c,u)=>F(c*Ri(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Ri(c,t),sqrt:n.sqrt||(c=>a(o,c)),invertBatch:c=>_a(o,c),cmov:(c,u,f)=>f?u:c,toBytes:c=>r?Ze(c,s):fn(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return r?Pe(c):un(c)}});return Object.freeze(o)}function Mi(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}var Ea=BigInt(0),bn=BigInt(1);function Gi(t,e){let r=(i,s)=>{let a=s.negate();return i?a:s},n=i=>{let s=Math.ceil(e/i)+1,a=2**(i-1);return{windows:s,windowSize:a}};return{constTimeNegate:r,unsafeLadder(i,s){let a=t.ZERO,o=i;for(;s>Ea;)s&bn&&(a=a.add(o)),o=o.double(),s>>=bn;return a},precomputeWindow(i,s){let{windows:a,windowSize:o}=n(s),c=[],u=i,f=u;for(let h=0;h<a;h++){f=u,c.push(f);for(let l=1;l<o;l++)f=f.add(u),c.push(f);u=f.double()}return c},wNAF(i,s,a){let{windows:o,windowSize:c}=n(i),u=t.ZERO,f=t.BASE,h=BigInt(2**i-1),l=2**i,p=BigInt(i);for(let x=0;x<o;x++){let S=x*c,P=Number(a&h);a>>=p,P>c&&(P-=l,a+=bn);let N=S,j=S+Math.abs(P)-1,w=x%2!==0,_=P<0;P===0?f=f.add(r(w,s[N])):u=u.add(r(_,s[j]))}return{p:u,f}},wNAFCached(i,s,a,o){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,o(u))),this.wNAF(c,u,a)}}}function Fi(t){return qi(t.Fp),Ue(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}var Se=BigInt(0),ge=BigInt(1),Lr=BigInt(2),va=BigInt(8),Sa={zip215:!0};function Aa(t){let e=Fi(t);return Ue(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function it(t){let e=Aa(t),{Fp:r,n,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=e,u=Lr<<BigInt(o*8)-ge,f=r.create,h=e.uvRatio||((b,d)=>{try{return{isValid:!0,value:r.sqrt(b*r.inv(d))}}catch{return{isValid:!1,value:Se}}}),l=e.adjustScalarBytes||(b=>b),p=e.domain||((b,d,m)=>{if(d.length||m)throw new Error("Contexts/pre-hash are not supported");return b}),x=b=>typeof b=="bigint"&&Se<b,S=(b,d)=>x(b)&&x(d)&&b<d,P=b=>b===Se||S(b,u);function N(b,d){if(S(b,d))return b;throw new Error(`Expected valid scalar < ${d}, got ${typeof b} ${b}`)}function j(b){return b===Se?b:N(b,n)}let w=new Map;function _(b){if(!(b instanceof y))throw new Error("ExtendedPoint expected")}class y{constructor(d,m,v,k){if(this.ex=d,this.ey=m,this.ez=v,this.et=k,!P(d))throw new Error("x required");if(!P(m))throw new Error("y required");if(!P(v))throw new Error("z required");if(!P(k))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(d){if(d instanceof y)throw new Error("extended point not allowed");let{x:m,y:v}=d||{};if(!P(m)||!P(v))throw new Error("invalid affine point");return new y(m,v,ge,f(m*v))}static normalizeZ(d){let m=r.invertBatch(d.map(v=>v.ez));return d.map((v,k)=>v.toAffine(m[k])).map(y.fromAffine)}_setWindowSize(d){this._WINDOW_SIZE=d,w.delete(this)}assertValidity(){let{a:d,d:m}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:v,ey:k,ez:B,et:O}=this,z=f(v*v),I=f(k*k),T=f(B*B),se=f(T*T),fe=f(z*d),Ae=f(T*f(fe+I)),he=f(se+f(m*f(z*I)));if(Ae!==he)throw new Error("bad point: equation left != right (1)");let He=f(v*k),ke=f(B*O);if(He!==ke)throw new Error("bad point: equation left != right (2)")}equals(d){_(d);let{ex:m,ey:v,ez:k}=this,{ex:B,ey:O,ez:z}=d,I=f(m*z),T=f(B*k),se=f(v*z),fe=f(O*k);return I===T&&se===fe}is0(){return this.equals(y.ZERO)}negate(){return new y(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:d}=e,{ex:m,ey:v,ez:k}=this,B=f(m*m),O=f(v*v),z=f(Lr*f(k*k)),I=f(d*B),T=m+v,se=f(f(T*T)-B-O),fe=I+O,Ae=fe-z,he=I-O,He=f(se*Ae),ke=f(fe*he),Rt=f(se*he),jt=f(Ae*fe);return new y(He,ke,jt,Rt)}add(d){_(d);let{a:m,d:v}=e,{ex:k,ey:B,ez:O,et:z}=this,{ex:I,ey:T,ez:se,et:fe}=d;if(m===BigInt(-1)){let Sn=f((B-k)*(T+I)),An=f((B+k)*(T-I)),jr=f(An-Sn);if(jr===Se)return this.double();let Pn=f(O*Lr*fe),kn=f(z*Lr*se),Bn=kn+Pn,In=An+Sn,Ln=kn-Pn,ws=f(Bn*jr),ys=f(In*Ln),ps=f(Bn*Ln),xs=f(jr*In);return new y(ws,ys,xs,ps)}let Ae=f(k*I),he=f(B*T),He=f(z*v*fe),ke=f(O*se),Rt=f((k+B)*(I+T)-Ae-he),jt=ke-He,En=ke+He,vn=f(he-m*Ae),hs=f(Rt*jt),ls=f(En*vn),ds=f(Rt*vn),bs=f(jt*En);return new y(hs,ls,bs,ds)}subtract(d){return this.add(d.negate())}wNAF(d){return A.wNAFCached(this,w,d,y.normalizeZ)}multiply(d){let{p:m,f:v}=this.wNAF(N(d,n));return y.normalizeZ([m,v])[0]}multiplyUnsafe(d){let m=j(d);return m===Se?H:this.equals(H)||m===ge?this:this.equals(K)?this.wNAF(m).p:A.unsafeLadder(this,m)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(d){let{ex:m,ey:v,ez:k}=this,B=this.is0();d==null&&(d=B?va:r.inv(k));let O=f(m*d),z=f(v*d),I=f(k*d);if(B)return{x:Se,y:ge};if(I!==ge)throw new Error("invZ was invalid");return{x:O,y:z}}clearCofactor(){let{h:d}=e;return d===ge?this:this.multiplyUnsafe(d)}static fromHex(d,m=!1){let{d:v,a:k}=e,B=r.BYTES;d=be("pointHex",d,B);let O=d.slice(),z=d[B-1];O[B-1]=z&-129;let I=Pe(O);I===Se||(m?N(I,u):N(I,r.ORDER));let T=f(I*I),se=f(T-ge),fe=f(v*T-k),{isValid:Ae,value:he}=h(se,fe);if(!Ae)throw new Error("Point.fromHex: invalid y coordinate");let He=(he&ge)===ge,ke=(z&128)!==0;if(!m&&he===Se&&ke)throw new Error("Point.fromHex: x=0 and x_0=1");return ke!==He&&(he=f(-he)),y.fromAffine({x:he,y:I})}static fromPrivateKey(d){return M(d).point}toRawBytes(){let{x:d,y:m}=this.toAffine(),v=Ze(m,r.BYTES);return v[v.length-1]|=d&ge?128:0,v}toHex(){return Ht(this.toRawBytes())}}y.BASE=new y(e.Gx,e.Gy,ge,f(e.Gx*e.Gy)),y.ZERO=new y(Se,ge,ge,Se);let{BASE:K,ZERO:H}=y,A=Gi(y,o*8);function U(b){return F(b,n)}function D(b){return U(Pe(b))}function M(b){let d=o;b=be("private key",b,d);let m=be("hashed private key",s(b),2*d),v=l(m.slice(0,d)),k=m.slice(d,2*d),B=D(v),O=K.multiply(B),z=O.toRawBytes();return{head:v,prefix:k,scalar:B,point:O,pointBytes:z}}function X(b){return M(b).pointBytes}function C(b=new Uint8Array,...d){let m=Br(...d);return D(s(p(m,be("context",b),!!i)))}function Q(b,d,m={}){b=be("message",b),i&&(b=i(b));let{prefix:v,scalar:k,pointBytes:B}=M(d),O=C(m.context,v,b),z=K.multiply(O).toRawBytes(),I=C(m.context,z,B,b),T=U(O+I*k);j(T);let se=Br(z,Ze(T,r.BYTES));return be("result",se,o*2)}let G=Sa;function $(b,d,m,v=G){let{context:k,zip215:B}=v,O=r.BYTES;b=be("signature",b,2*O),d=be("message",d),i&&(d=i(d));let z=Pe(b.slice(O,2*O)),I,T,se;try{I=y.fromHex(m,B),T=y.fromHex(b.slice(0,O),B),se=K.multiplyUnsafe(z)}catch{return!1}if(!B&&I.isSmallOrder())return!1;let fe=C(k,T.toRawBytes(),I.toRawBytes(),d);return T.add(I.multiplyUnsafe(fe)).subtract(se).clearCofactor().equals(y.ZERO)}return K._setWindowSize(8),{CURVE:e,getPublicKey:X,sign:Q,verify:$,ExtendedPoint:y,utils:{getExtendedPublicKey:M,randomPrivateKey:()=>a(r.BYTES),precompute(b=8,d=y.BASE){return d._setWindowSize(b),d.multiply(BigInt(3)),d}}}}var Kt=BigInt(0),wn=BigInt(1);function Pa(t){return Ue(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Ur(t){let e=Pa(t),{P:r}=e,n=w=>F(w,r),i=e.montgomeryBits,s=Math.ceil(i/8),a=e.nByteLength,o=e.adjustScalarBytes||(w=>w),c=e.powPminus2||(w=>ln(w,r-BigInt(2),r));function u(w,_,y){let K=n(w*(_-y));return _=n(_-K),y=n(y+K),[_,y]}function f(w){if(typeof w=="bigint"&&Kt<=w&&w<r)return w;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function l(w,_){let y=f(w),K=f(_),H=y,A=wn,U=Kt,D=y,M=wn,X=Kt,C;for(let G=BigInt(i-1);G>=Kt;G--){let $=K>>G&wn;X^=$,C=u(X,A,D),A=C[0],D=C[1],C=u(X,U,M),U=C[0],M=C[1],X=$;let g=A+U,b=n(g*g),d=A-U,m=n(d*d),v=b-m,k=D+M,B=D-M,O=n(B*g),z=n(k*d),I=O+z,T=O-z;D=n(I*I),M=n(H*n(T*T)),A=n(b*m),U=n(v*(b+n(h*v)))}C=u(X,A,D),A=C[0],D=C[1],C=u(X,U,M),U=C[0],M=C[1];let Q=c(U);return n(A*Q)}function p(w){return Ze(n(w),s)}function x(w){let _=be("u coordinate",w,s);return a===s&&(_[a-1]&=127),Pe(_)}function S(w){let _=be("scalar",w);if(_.length!==s&&_.length!==a)throw new Error(`Expected ${s} or ${a} bytes, got ${_.length}`);return Pe(o(_))}function P(w,_){let y=x(_),K=S(w),H=l(y,K);if(H===Kt)throw new Error("Invalid private or public key received");return p(H)}let N=p(e.Gu);function j(w){return P(w,N)}return{scalarMult:P,scalarMultBase:j,getSharedSecret:(w,_)=>P(w,_),getPublicKey:w=>j(w),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:N}}var Tt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Zi=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Lu=BigInt(0),Ba=BigInt(1),yn=BigInt(2),Ia=BigInt(5),Vi=BigInt(10),La=BigInt(20),Ua=BigInt(40),Xi=BigInt(80);function $i(t){let e=Tt,n=t*t%e*t%e,i=Y(n,yn,e)*n%e,s=Y(i,Ba,e)*t%e,a=Y(s,Ia,e)*s%e,o=Y(a,Vi,e)*a%e,c=Y(o,La,e)*o%e,u=Y(c,Ua,e)*c%e,f=Y(u,Xi,e)*u%e,h=Y(f,Xi,e)*u%e,l=Y(h,Vi,e)*a%e;return{pow_p_5_8:Y(l,yn,e)*t%e,b2:n}}function Yi(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Oa(t,e){let r=Tt,n=F(e*e*e,r),i=F(n*n*e,r),s=$i(t*i).pow_p_5_8,a=F(t*n*s,r),o=F(e*a*a,r),c=a,u=F(a*Zi,r),f=o===t,h=o===F(-t,r),l=o===F(-t*Zi,r);return f&&(a=c),(h||l)&&(a=u),ji(a,r)&&(a=F(-a,r)),{isValid:f||h,value:a}}var Oe=Ir(Tt,void 0,!0),pn={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Oe,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:At,randomBytes:ht,adjustScalarBytes:Yi,uvRatio:Oa},Wi=it(pn);function Qi(t,e,r){if(e.length>255)throw new Error("Context is too big");return ur(vt("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var Uu=it({...pn,domain:Qi}),Ou=it({...pn,domain:Qi,prehash:At}),xn=(()=>Ur({P:Tt,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=Tt,{pow_p_5_8:r,b2:n}=$i(t);return F(Y(r,BigInt(3),e)*n,e)},adjustScalarBytes:Yi,randomBytes:ht}))();var Ha=(Oe.ORDER+BigInt(3))/BigInt(8),Hu=Oe.pow(yn,Ha),Ku=Oe.sqrt(Oe.neg(Oe.ONE)),Tu=(Oe.ORDER-BigInt(5))/BigInt(8),Nu=BigInt(486662);var zu=Mi(Oe,Oe.neg(BigInt(486664)));var Du=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Cu=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ru=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ju=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var qu=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Nt="X25519",Or=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=32,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=Wi.utils.randomPrivateKey(),r=new te(Nt,e,"private");return{publicKey:await this.derivePublicKey(r),privateKey:r}}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(Z,ze,new Uint8Array(e)),n=await this._hkdf.labeledExpand(r,ot,Z,this._nSk),i=new te(Nt,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):r(new te(Nt,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((n,i)=>{r&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new te(Nt,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{let n=xn.getPublicKey(e.key);r(new te(Nt,n,"public"))})}_dh(e,r){return new Promise((n,i)=>{try{n(xn.getSharedSecret(e.key,r.key).buffer)}catch(s){i(s)}})}};var[ts,rs,ns]=[[],[],[]],Ka=BigInt(0),zt=BigInt(1),Ta=BigInt(2),Na=BigInt(7),za=BigInt(256),Da=BigInt(113);for(let t=0,e=zt,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],ts.push(2*(5*n+r)),rs.push((t+1)*(t+2)/2%64);let i=Ka;for(let s=0;s<7;s++)e=(e<<zt^(e>>Na)*Da)%za,e&Ta&&(i^=zt<<(zt<<BigInt(s))-zt);ns.push(i)}var[Ca,Ra]=L.split(ns,!0),Ji=(t,e,r)=>r>32?L.rotlBH(t,e,r):L.rotlSH(t,e,r),es=(t,e,r)=>r>32?L.rotlBL(t,e,r):L.rotlSL(t,e,r);function ja(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)r[a]=t[a]^t[a+10]^t[a+20]^t[a+30]^t[a+40];for(let a=0;a<10;a+=2){let o=(a+8)%10,c=(a+2)%10,u=r[c],f=r[c+1],h=Ji(u,f,1)^r[o],l=es(u,f,1)^r[o+1];for(let p=0;p<50;p+=10)t[a+p]^=h,t[a+p+1]^=l}let i=t[2],s=t[3];for(let a=0;a<24;a++){let o=rs[a],c=Ji(i,s,o),u=es(i,s,o),f=ts[a];i=t[f],s=t[f+1],t[f]=c,t[f+1]=u}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)r[o]=t[a+o];for(let o=0;o<10;o++)t[a+o]^=~r[(o+2)%10]&r[(o+4)%10]}t[0]^=Ca[n],t[1]^=Ra[n]}r.fill(0)}var Hr=class t extends De{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ae.number(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=xi(this.state)}keccak(){ja(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ae.exists(this);let{blockLen:r,state:n}=this;e=Ce(e);let i=e.length;for(let s=0;s<i;){let a=Math.min(r-this.pos,i-s);for(let o=0;o<a;o++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,r&128&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){ae.exists(this,!1),ae.bytes(e),this.finish();let r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ae.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ae.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:a}=this;return e||(e=new t(r,n,i,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}},Ve=(t,e,r)=>pe(()=>new Hr(e,t,r)),Yu=Ve(6,144,224/8),Wu=Ve(6,136,256/8),Qu=Ve(6,104,384/8),Ju=Ve(6,72,512/8),ef=Ve(1,144,224/8),tf=Ve(1,136,256/8),rf=Ve(1,104,384/8),nf=Ve(1,72,512/8),is=(t,e,r)=>gi((n={})=>new Hr(e,t,n.dkLen===void 0?r:n.dkLen,!0)),sf=is(31,168,128/8),gn=is(31,136,256/8);var qa=pe(()=>gn.create({dkLen:114})),Ma=pe(()=>gn.create({dkLen:64})),Dt=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function ss(t){let e=Dt,r=BigInt(1),n=BigInt(2),i=BigInt(3),s=BigInt(11),a=BigInt(22),o=BigInt(44),c=BigInt(88),u=BigInt(223),f=t*t*t%e,h=f*f*t%e,l=Y(h,i,e)*h%e,p=Y(l,i,e)*h%e,x=Y(p,n,e)*f%e,S=Y(x,s,e)*x%e,P=Y(S,a,e)*S%e,N=Y(P,o,e)*P%e,j=Y(N,c,e)*N%e,w=Y(j,o,e)*P%e,_=Y(w,n,e)*f%e,y=Y(_,r,e)*t%e;return Y(y,u,e)*_%e}function os(t){return t[0]&=252,t[55]|=128,t[56]=0,t}var as=Ir(Dt,456,!0),df=BigInt(4),cs={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:as,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:qa,randomBytes:ht,adjustScalarBytes:os,domain:(t,e,r)=>{if(e.length>255)throw new Error(`Context is too big: ${e.length}`);return ur(vt("SigEd448"),new Uint8Array([r?1:0,e.length]),e,t)},uvRatio:(t,e)=>{let r=Dt,n=F(t*t*e,r),i=F(n*t,r),s=F(i*n*e,r),a=ss(s),o=F(i*a,r),c=F(o*o,r);return{isValid:F(c*e,r)===t,value:o}}},us=it(cs),bf=it({...cs,prehash:Ma}),mn=(()=>Ur({a:BigInt(156326),montgomeryBits:448,nByteLength:57,P:Dt,Gu:BigInt(5),powPminus2:t=>{let e=Dt,r=ss(t),n=Y(r,BigInt(2),e);return F(n*t,e)},adjustScalarBytes:os,randomBytes:ht}))();var wf=(as.ORDER-BigInt(3))/BigInt(4),yf=BigInt(156326);var Ct="X448",Kr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,r,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(r,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=us.utils.randomPrivateKey(),r=new te(Ct,e,"private");return{publicKey:await this.derivePublicKey(r),privateKey:r}}async deriveKeyPair(e){let r=await this._hkdf.labeledExtract(Z,ze,new Uint8Array(e)),n=await this._hkdf.labeledExpand(r,ot,Z,this._nSk),i=new te(Ct,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,r){return await this._dh(e,r)}_serializePublicKey(e){return new Promise(r=>{r(e.key.buffer)})}_deserializePublicKey(e){return new Promise((r,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):r(new te(Ct,new Uint8Array(e),"public"))})}_importKey(e,r){return new Promise((n,i)=>{r&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!r&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new te(Ct,new Uint8Array(e),r?"public":"private"))})}_derivePublicKey(e){return new Promise(r=>{let n=mn.getPublicKey(e.key);r(new te(Ct,n,"public"))})}_dh(e,r){return new Promise((n,i)=>{try{n(mn.getSharedSecret(e.key,r.key).buffer)}catch(s){i(s)}})}};var Xe=class extends Te{constructor(e,r,n){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=r,this._kdf=n}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(e){throw new Be(e)}}async deriveKeyPair(e){try{return await this._prim.deriveKeyPair(e)}catch(r){throw new Vt(r)}}async serializePublicKey(e){try{return await this._prim.serializePublicKey(e)}catch(r){throw new qt(r)}}async deserializePublicKey(e){try{return await this._prim.deserializePublicKey(e)}catch(r){throw new st(r)}}async importKey(e,r,n){try{return await this._prim.importKey(e,r,n)}catch(i){throw new st(i)}}async encap(e){try{let r=e.nonEphemeralKeyPair===void 0?await this.generateKeyPair():e.nonEphemeralKeyPair,n=await this._prim.serializePublicKey(r.publicKey),i=await this._prim.serializePublicKey(e.recipientPublicKey),s;if(e.senderKey===void 0)s=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey));else{let c=mt(e.senderKey)?e.senderKey.privateKey:e.senderKey,u=new Uint8Array(await this._prim.dh(r.privateKey,e.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,e.recipientPublicKey));s=_t(u,f)}let a;if(e.senderKey===void 0)a=_t(new Uint8Array(n),new Uint8Array(i));else{let c=mt(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),u=await this._prim.serializePublicKey(c);a=Dn(new Uint8Array(n),new Uint8Array(i),new Uint8Array(u))}let o=await this.generateSharedSecret(s,a);return{enc:n,sharedSecret:o}}catch(r){throw new Mt(r)}}async decap(e){let r;try{r=await this._prim.deserializePublicKey(e.enc)}catch(n){throw new st(n)}try{let n=mt(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,i=mt(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),s=await this._prim.serializePublicKey(i),a;if(e.senderPublicKey===void 0)a=new Uint8Array(await this._prim.dh(n,r));else{let c=new Uint8Array(await this._prim.dh(n,r)),u=new Uint8Array(await this._prim.dh(n,e.senderPublicKey));a=_t(c,u)}let o;if(e.senderPublicKey===void 0)o=_t(new Uint8Array(e.enc),new Uint8Array(s));else{let c=await this._prim.serializePublicKey(e.senderPublicKey);o=new Uint8Array(e.enc.byteLength+s.byteLength+c.byteLength),o.set(new Uint8Array(e.enc),0),o.set(new Uint8Array(s),e.enc.byteLength),o.set(new Uint8Array(c),e.enc.byteLength+s.byteLength)}return await this.generateSharedSecret(a,o)}catch(n){throw new Gt(n)}}async generateSharedSecret(e,r){let n=this._kdf.buildLabeledIkm(qn,e),i=this._kdf.buildLabeledInfo(Zn,r,this.secretSize);return await this._kdf.extractAndExpand(Z,n,i,this.secretSize)}},Tr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemP256HkdfSha256,2),3);let n=new Ge(e,r),i=new wt(q.DhkemP256HkdfSha256,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Nr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemP384HkdfSha384,2),3);let n=new bt(e,r),i=new wt(q.DhkemP384HkdfSha384,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},zr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemP521HkdfSha512,2),3);let n=new Je(e,r),i=new wt(q.DhkemP521HkdfSha512,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}},Dr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemSecp256K1HkdfSha256,2),3);let n=new Ge(e,r),i=new Pr(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Cr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemX25519HkdfSha256,2),3);let n=new Ge(e,r),i=new Or(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Rr=class extends Xe{constructor(e){let r=new Uint8Array(Qe);r.set(ce(q.DhkemX448HkdfSha512,2),3);let n=new Je(e,r),i=new Kr(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};var _n=class{constructor(e){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.kem){case q.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case q.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case q.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case q.DhkemSecp256K1HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case q.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case q.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new we("Invalid KEM id")}switch(this.kem=e.kem,e.kdf){case de.HkdfSha256:case de.HkdfSha384:case de.HkdfSha512:break;default:throw new we("Invalid KDF id")}switch(this.kdf=e.kdf,e.aead){case J.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case J.Aes256Gcm:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case J.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case J.ExportOnly:break;default:throw new we("Invalid AEAD id")}this.aead=e.aead,this._suiteId=new Uint8Array(jn),this._suiteId.set(ce(this.kem,2),4),this._suiteId.set(ce(this.kdf,2),6),this._suiteId.set(ce(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(e){return await this.setup(),or(this.aead,e,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>128)throw new we("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(e)}async importKey(e,r,n=!0){return await this.setup(),await this._kem.importKey(e,r,n)}async createSenderContext(e){this.validateInputLength(e),await this.setup();let r=await this._kem.encap(e),n;return e.psk!==void 0?n=e.senderKey!==void 0?_e.AuthPsk:_e.Psk:n=e.senderKey!==void 0?_e.Auth:_e.Base,await this.keyScheduleS(n,r.sharedSecret,r.enc,e)}async createRecipientContext(e){this.validateInputLength(e),await this.setup();let r=await this._kem.decap(e),n;return e.psk!==void 0?n=e.senderPublicKey!==void 0?_e.AuthPsk:_e.Psk:n=e.senderPublicKey!==void 0?_e.Auth:_e.Base,await this.keyScheduleR(n,r,e)}async seal(e,r,n=Z){let i=await this.createSenderContext(e);return{ct:await i.seal(r,n),enc:i.enc}}async open(e,r,n=Z){return await(await this.createRecipientContext(e)).open(r,n)}async setup(){this._api=await Cn(),(this._kem===void 0||this._kdf===void 0)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(e,r,n){let i=this.createKdfContext(),s=n.psk===void 0?Z:new Uint8Array(n.psk.id),a=await i.labeledExtract(Z,Gn,s),o=n.info===void 0?Z:new Uint8Array(n.info),c=await i.labeledExtract(Z,Mn,o),u=new Uint8Array(1+a.byteLength+c.byteLength);u.set(new Uint8Array([e]),0),u.set(new Uint8Array(a),1),u.set(new Uint8Array(c),1+a.byteLength);let f=n.psk===void 0?Z:new Uint8Array(n.psk.key),h=i.buildLabeledIkm(Fn,f),l=i.buildLabeledInfo($n,u,i.hashSize),p=await i.extractAndExpand(r,h,l,i.hashSize);if(this.aead===J.ExportOnly)return{params:{aead:this.aead,exporterSecret:p},kdf:i};let x=i.buildLabeledInfo(Vn,u,this.aeadKeySize),S=await i.extractAndExpand(r,h,x,this.aeadKeySize),P=i.buildLabeledInfo(Xn,u,this.aeadNonceSize),N=await i.extractAndExpand(r,h,P,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:p,key:S,baseNonce:new Uint8Array(N),seq:0},kdf:i}}async keyScheduleS(e,r,n,i){let s=await this.keySchedule(e,r,i);return s.params.key===void 0?new $t(this._api,s.kdf,s.params.exporterSecret,n):new br(this._api,s.kdf,s.params,n)}async keyScheduleR(e,r,n){let i=await this.keySchedule(e,r,n);return i.params.key===void 0?new Xt(this._api,i.kdf,i.params.exporterSecret):new dr(this._api,i.kdf,i.params)}validateInputLength(e){if(e.info!==void 0&&e.info.byteLength>128)throw new we("Too long info");if(e.psk!==void 0){if(e.psk.key.byteLength<32)throw new we(`PSK must have at least ${32} bytes`);if(e.psk.key.byteLength>128)throw new we("Too long psk.key");if(e.psk.id.byteLength>128)throw new we("Too long psk.id")}}createKemContext(){switch(this.kem){case q.DhkemP256HkdfSha256:return new Tr(this._api);case q.DhkemP384HkdfSha384:return new Nr(this._api);case q.DhkemP521HkdfSha512:return new zr(this._api);case q.DhkemX25519HkdfSha256:return new Cr(this._api);case q.DhkemX448HkdfSha512:return new Rr(this._api);default:return new Dr(this._api)}}createKdfContext(){switch(this.kdf){case de.HkdfSha256:return new Ge(this._api,this._suiteId);case de.HkdfSha384:return new bt(this._api,this._suiteId);default:return new Je(this._api,this._suiteId)}}};export{J as Aead,_n as CipherSuite,Gt as DecapError,Vt as DeriveKeyPairError,st as DeserializeError,Mt as EncapError,Ft as ExportError,we as InvalidParamError,de as Kdf,q as Kem,Zt as MessageLimitReachedError,Be as NotSupportedError,Ye as OpenError,$e as SealError,qt as SerializeError,Hn as ValidationError};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed448.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
