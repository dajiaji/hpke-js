function Q(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function ne(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function ae(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function M(t,...e){if(!ae(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function se(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function be(t,e){M(t);let s=e.outputLen;if(t.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}var G=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),we=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ne=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ne)throw new Error("Non little-endian hardware is not supported");function Re(t){if(typeof t!="string")throw new Error(`string expected, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ee(t){if(typeof t=="string")t=Re(t);else if(ae(t))t=t.slice();else throw new Error(`Uint8Array expected, got ${typeof t}`);return t}function Ae(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function _e(t,e){if(t.length!==e.length)return!1;let s=0;for(let r=0;r<t.length;r++)s|=t[r]^e[r];return s===0}var oe=(t,e)=>(Object.assign(e,t),e);function fe(t,e,s,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,s,r);let f=BigInt(32),i=BigInt(4294967295),a=Number(s>>f&i),n=Number(s&i),c=r?4:0,p=r?0:4;t.setUint32(e+c,a,r),t.setUint32(e+p,n,r)}var D=(t,e)=>t[e++]&255|(t[e++]&255)<<8,ce=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=ee(e),M(e,32);let s=D(e,0),r=D(e,2),f=D(e,4),i=D(e,6),a=D(e,8),n=D(e,10),c=D(e,12),p=D(e,14);this.r[0]=s&8191,this.r[1]=(s>>>13|r<<3)&8191,this.r[2]=(r>>>10|f<<6)&7939,this.r[3]=(f>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|n<<2)&8191,this.r[7]=(n>>>11|c<<5)&8065,this.r[8]=(c>>>8|p<<8)&8191,this.r[9]=p>>>5&127;for(let u=0;u<8;u++)this.pad[u]=D(e,16+2*u)}process(e,s,r=!1){let f=r?0:2048,{h:i,r:a}=this,n=a[0],c=a[1],p=a[2],u=a[3],m=a[4],b=a[5],x=a[6],h=a[7],d=a[8],l=a[9],w=D(e,s+0),A=D(e,s+2),L=D(e,s+4),H=D(e,s+6),O=D(e,s+8),T=D(e,s+10),N=D(e,s+12),R=D(e,s+14),_=i[0]+(w&8191),K=i[1]+((w>>>13|A<<3)&8191),P=i[2]+((A>>>10|L<<6)&8191),g=i[3]+((L>>>7|H<<9)&8191),k=i[4]+((H>>>4|O<<12)&8191),S=i[5]+(O>>>1&8191),I=i[6]+((O>>>14|T<<2)&8191),C=i[7]+((T>>>11|N<<5)&8191),U=i[8]+((N>>>8|R<<8)&8191),B=i[9]+(R>>>5|f),y=0,v=y+_*n+K*(5*l)+P*(5*d)+g*(5*h)+k*(5*x);y=v>>>13,v&=8191,v+=S*(5*b)+I*(5*m)+C*(5*u)+U*(5*p)+B*(5*c),y+=v>>>13,v&=8191;let z=y+_*c+K*n+P*(5*l)+g*(5*d)+k*(5*h);y=z>>>13,z&=8191,z+=S*(5*x)+I*(5*b)+C*(5*m)+U*(5*u)+B*(5*p),y+=z>>>13,z&=8191;let E=y+_*p+K*c+P*n+g*(5*l)+k*(5*d);y=E>>>13,E&=8191,E+=S*(5*h)+I*(5*x)+C*(5*b)+U*(5*m)+B*(5*u),y+=E>>>13,E&=8191;let j=y+_*u+K*p+P*c+g*n+k*(5*l);y=j>>>13,j&=8191,j+=S*(5*d)+I*(5*h)+C*(5*x)+U*(5*b)+B*(5*m),y+=j>>>13,j&=8191;let F=y+_*m+K*u+P*p+g*c+k*n;y=F>>>13,F&=8191,F+=S*(5*l)+I*(5*d)+C*(5*h)+U*(5*x)+B*(5*b),y+=F>>>13,F&=8191;let q=y+_*b+K*m+P*u+g*p+k*c;y=q>>>13,q&=8191,q+=S*n+I*(5*l)+C*(5*d)+U*(5*h)+B*(5*x),y+=q>>>13,q&=8191;let X=y+_*x+K*b+P*m+g*u+k*p;y=X>>>13,X&=8191,X+=S*c+I*n+C*(5*l)+U*(5*d)+B*(5*h),y+=X>>>13,X&=8191;let W=y+_*h+K*x+P*b+g*m+k*u;y=W>>>13,W&=8191,W+=S*p+I*c+C*n+U*(5*l)+B*(5*d),y+=W>>>13,W&=8191;let Y=y+_*d+K*h+P*x+g*b+k*m;y=Y>>>13,Y&=8191,Y+=S*u+I*p+C*c+U*n+B*(5*l),y+=Y>>>13,Y&=8191;let J=y+_*l+K*d+P*h+g*x+k*b;y=J>>>13,J&=8191,J+=S*m+I*u+C*p+U*c+B*n,y+=J>>>13,J&=8191,y=(y<<2)+y|0,y=y+v|0,v=y&8191,y=y>>>13,z+=y,i[0]=v,i[1]=z,i[2]=E,i[3]=j,i[4]=F,i[5]=q,i[6]=X,i[7]=W,i[8]=Y,i[9]=J}finalize(){let{h:e,pad:s}=this,r=new Uint16Array(10),f=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=f,f=e[n]>>>13,e[n]&=8191;e[0]+=f*5,f=e[0]>>>13,e[0]&=8191,e[1]+=f,f=e[1]>>>13,e[1]&=8191,e[2]+=f,r[0]=e[0]+5,f=r[0]>>>13,r[0]&=8191;for(let n=1;n<10;n++)r[n]=e[n]+f,f=r[n]>>>13,r[n]&=8191;r[9]-=8192;let i=(f^1)-1;for(let n=0;n<10;n++)r[n]&=i;i=~i;for(let n=0;n<10;n++)e[n]=e[n]&i|r[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+s[0];e[0]=a&65535;for(let n=1;n<8;n++)a=(e[n]+s[n]|0)+(a>>>16)|0,e[n]=a&65535}update(e){se(this);let{buffer:s,blockLen:r}=this;e=ee(e);let f=e.length;for(let i=0;i<f;){let a=Math.min(r-this.pos,f-i);if(a===r){for(;r<=f-i;i+=r)this.process(e,i);continue}s.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(s,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){se(this),be(e,this),this.finished=!0;let{buffer:s,h:r}=this,{pos:f}=this;if(f){for(s[f++]=1;f<16;f++)s[f]=0;this.process(s,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)e[i++]=r[a]>>>0,e[i++]=r[a]>>>8;return e}digest(){let{buffer:e,outputLen:s}=this;this.digestInto(e);let r=e.slice(0,s);return this.destroy(),r}};function Me(t){let e=(r,f)=>t(f).update(ee(r)).digest(),s=t(new Uint8Array(32));return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=r=>t(r),e}var Ke=Me(t=>new ce(t));var ge=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Oe=ge("expand 16-byte k"),je=ge("expand 32-byte k"),Ge=G(Oe),ke=G(je),dt=ke.slice();function o(t,e){return t<<e|t>>>32-e}function ye(t){return t.byteOffset%4===0}var te=64,$e=16,Se=2**32-1,Pe=new Uint32Array;function Fe(t,e,s,r,f,i,a,n){let c=f.length,p=new Uint8Array(te),u=G(p),m=ye(f)&&ye(i),b=m?G(f):Pe,x=m?G(i):Pe;for(let h=0;h<c;a++){if(t(e,s,r,u,a,n),a>=Se)throw new Error("arx: counter overflow");let d=Math.min(te,c-h);if(m&&d===te){let l=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let w=0,A;w<$e;w++)A=l+w,x[A]=b[A]^u[w];h+=te;continue}for(let l=0,w;l<d;l++)w=h+l,i[w]=f[w]^p[l];h+=d}}function pe(t,e){let{allowShortKeys:s,extendNonceFn:r,counterLength:f,counterRight:i,rounds:a}=Ae({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Q(f),Q(a),ne(i),ne(s),(n,c,p,u,m=0)=>{M(n),M(c),M(p);let b=p.length;if(u||(u=new Uint8Array(b)),M(u),Q(m),m<0||m>=Se)throw new Error("arx: counter overflow");if(u.length<b)throw new Error(`arx: output (${u.length}) is shorter than data (${b})`);let x=[],h=n.length,d,l;if(h===32)d=n.slice(),x.push(d),l=ke;else if(h===16&&s)d=new Uint8Array(32),d.set(n),d.set(n,16),l=Ge,x.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);ye(c)||(c=c.slice(),x.push(c));let w=G(d);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(l,w,G(c.subarray(0,16)),w),c=c.subarray(16)}let A=16-f;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){let H=new Uint8Array(12);H.set(c,i?0:12-c.length),c=H,x.push(c)}let L=G(c);for(Fe(t,l,w,L,p,u,m,a);x.length>0;)x.pop().fill(0);return u}}function Ue(t,e,s,r,f,i=20){let a=t[0],n=t[1],c=t[2],p=t[3],u=e[0],m=e[1],b=e[2],x=e[3],h=e[4],d=e[5],l=e[6],w=e[7],A=f,L=s[0],H=s[1],O=s[2],T=a,N=n,R=c,_=p,K=u,P=m,g=b,k=x,S=h,I=d,C=l,U=w,B=A,y=L,v=H,z=O;for(let j=0;j<i;j+=2)T=T+K|0,B=o(B^T,16),S=S+B|0,K=o(K^S,12),T=T+K|0,B=o(B^T,8),S=S+B|0,K=o(K^S,7),N=N+P|0,y=o(y^N,16),I=I+y|0,P=o(P^I,12),N=N+P|0,y=o(y^N,8),I=I+y|0,P=o(P^I,7),R=R+g|0,v=o(v^R,16),C=C+v|0,g=o(g^C,12),R=R+g|0,v=o(v^R,8),C=C+v|0,g=o(g^C,7),_=_+k|0,z=o(z^_,16),U=U+z|0,k=o(k^U,12),_=_+k|0,z=o(z^_,8),U=U+z|0,k=o(k^U,7),T=T+P|0,z=o(z^T,16),C=C+z|0,P=o(P^C,12),T=T+P|0,z=o(z^T,8),C=C+z|0,P=o(P^C,7),N=N+g|0,B=o(B^N,16),U=U+B|0,g=o(g^U,12),N=N+g|0,B=o(B^N,8),U=U+B|0,g=o(g^U,7),R=R+k|0,y=o(y^R,16),S=S+y|0,k=o(k^S,12),R=R+k|0,y=o(y^R,8),S=S+y|0,k=o(k^S,7),_=_+K|0,v=o(v^_,16),I=I+v|0,K=o(K^I,12),_=_+K|0,v=o(v^_,8),I=I+v|0,K=o(K^I,7);let E=0;r[E++]=a+T|0,r[E++]=n+N|0,r[E++]=c+R|0,r[E++]=p+_|0,r[E++]=u+K|0,r[E++]=m+P|0,r[E++]=b+g|0,r[E++]=x+k|0,r[E++]=h+S|0,r[E++]=d+I|0,r[E++]=l+C|0,r[E++]=w+U|0,r[E++]=A+B|0,r[E++]=L+y|0,r[E++]=H+v|0,r[E++]=O+z|0}function qe(t,e,s,r){let f=t[0],i=t[1],a=t[2],n=t[3],c=e[0],p=e[1],u=e[2],m=e[3],b=e[4],x=e[5],h=e[6],d=e[7],l=s[0],w=s[1],A=s[2],L=s[3];for(let O=0;O<20;O+=2)f=f+c|0,l=o(l^f,16),b=b+l|0,c=o(c^b,12),f=f+c|0,l=o(l^f,8),b=b+l|0,c=o(c^b,7),i=i+p|0,w=o(w^i,16),x=x+w|0,p=o(p^x,12),i=i+p|0,w=o(w^i,8),x=x+w|0,p=o(p^x,7),a=a+u|0,A=o(A^a,16),h=h+A|0,u=o(u^h,12),a=a+u|0,A=o(A^a,8),h=h+A|0,u=o(u^h,7),n=n+m|0,L=o(L^n,16),d=d+L|0,m=o(m^d,12),n=n+m|0,L=o(L^n,8),d=d+L|0,m=o(m^d,7),f=f+p|0,L=o(L^f,16),h=h+L|0,p=o(p^h,12),f=f+p|0,L=o(L^f,8),h=h+L|0,p=o(p^h,7),i=i+u|0,l=o(l^i,16),d=d+l|0,u=o(u^d,12),i=i+u|0,l=o(l^i,8),d=d+l|0,u=o(u^d,7),a=a+m|0,w=o(w^a,16),b=b+w|0,m=o(m^b,12),a=a+m|0,w=o(w^a,8),b=b+w|0,m=o(m^b,7),n=n+c|0,A=o(A^n,16),x=x+A|0,c=o(c^x,12),n=n+c|0,A=o(A^n,8),x=x+A|0,c=o(c^x,7);let H=0;r[H++]=f,r[H++]=i,r[H++]=a,r[H++]=n,r[H++]=l,r[H++]=w,r[H++]=A,r[H++]=L}var Xe=pe(Ue,{counterRight:!1,counterLength:4,allowShortKeys:!1}),We=pe(Ue,{counterRight:!1,counterLength:8,extendNonceFn:qe,allowShortKeys:!1});var Ye=new Uint8Array(16),Ie=(t,e)=>{t.update(e);let s=e.length%16;s&&t.update(Ye.subarray(s))},Je=new Uint8Array(32);function Ce(t,e,s,r,f){let i=t(e,s,Je),a=Ke.create(i);f&&Ie(a,f),Ie(a,r);let n=new Uint8Array(16),c=we(n);fe(c,0,BigInt(f?f.length:0),!0),fe(c,8,BigInt(r.length),!0),a.update(n);let p=a.digest();return i.fill(0),p}var Be=t=>(e,s,r)=>(M(e,32),M(s),{encrypt:(i,a)=>{let n=i.length,c=n+16;a?M(a,c):a=new Uint8Array(c),t(e,s,i,a,1);let p=Ce(t,e,s,a.subarray(0,-16),r);return a.set(p,n),a},decrypt:(i,a)=>{let n=i.length,c=n-16;if(n<16)throw new Error("encrypted data must be at least 16 bytes");a?M(a,c):a=new Uint8Array(c);let p=i.subarray(0,-16),u=i.subarray(-16),m=Ce(t,e,s,p,r);if(!_e(u,m))throw new Error("invalid tag");return t(e,s,p,a,1),a}}),ue=oe({blockSize:64,nonceLength:12,tagLength:16},Be(Xe)),_t=oe({blockSize:64,nonceLength:24,tagLength:16},Be(We));var Ze={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535},Z=Ze;var $=new Uint8Array(0);var Ot=new Uint8Array([72,80,75,69,45,118,49]);var Ee=new Uint8Array([75,69,77,0,0]);var Zt=new Uint8Array([101,97,101,95,112,114,107]),Vt=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var ze=new Uint8Array([100,107,112,95,112,114,107]),Qe=new Uint8Array([115,107]);var ur=new Uint8Array([99,97,110,100,105,100,97,116,101]),lr=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),hr=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),dr=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),mr=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),xr=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),br=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var Dr=new Uint8Array([115,101,99]);var hi=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),di=new Uint8Array([101,120,112]),mi=new Uint8Array([105,110,102,111,95,104,97,115,104]),xi=new Uint8Array([107,101,121]),bi=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),wi=new Uint8Array([115,101,99,114,101,116]),Ai=new Uint8Array([72,80,75,69,0,0,0,0,0,0]);var me=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,s,r){return await this._seal(e,s,r)}async open(e,s,r){return await this._open(e,s,r)}_seal(e,s,r){return new Promise(f=>{let i=ue(this._key,new Uint8Array(e),new Uint8Array(r)).encrypt(new Uint8Array(s));f(i.buffer)})}_open(e,s,r){return new Promise(f=>{let i=ue(this._key,new Uint8Array(e),new Uint8Array(r)).decrypt(new Uint8Array(s));f(i.buffer)})}},xe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Z.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new me(e)}};export{xe as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
