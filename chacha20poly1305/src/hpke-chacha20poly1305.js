function J(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function re(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function R(t,...e){if(!re(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ie(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ge(t,e){R(t);let a=e.outputLen;if(t.length<a)throw new Error("digestInto() expects output buffer of length at least "+a)}function ne(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}var G=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),me=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),je=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!je)throw new Error("Non little-endian hardware is not supported");function Re(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Q(t){if(typeof t=="string")t=Re(t);else if(re(t))t=ee(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function _e(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Ke(t,e){if(t.length!==e.length)return!1;let a=0;for(let r=0;r<t.length;r++)a|=t[r]^e[r];return a===0}var se=(t,e)=>{function a(r,...s){if(R(r),t.nonceLength!==void 0){let l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?R(l):R(l,t.nonceLength)}let i=t.tagLength;i&&s[1]!==void 0&&R(s[1]);let o=e(r,...s),n=!1;return{encrypt(l,u){if(n)throw new Error("cannot encrypt() twice with same key + nonce");return n=!0,R(l),o.encrypt(l,u)},decrypt(l,u){if(R(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return o.decrypt(l,u)}}}return Object.assign(a,t),a};function ae(t,e){if(!e)return new Uint8Array(t);if(R(e,t),!Me(e))throw new Error("unaligned output");return e}function oe(t,e,a,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,a,r);let s=BigInt(32),i=BigInt(4294967295),o=Number(a>>s&i),n=Number(a&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,n,r)}function Me(t){return t.byteOffset%4===0}function ee(t){return Uint8Array.from(t)}function F(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}var Ae=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Ne=Ae("expand 16-byte k"),Ge=Ae("expand 32-byte k"),Fe=G(Ne),$e=G(Ge);function f(t,e){return t<<e|t>>>32-e}function fe(t){return t.byteOffset%4===0}var te=64,Xe=16,ve=2**32-1,Pe=new Uint32Array;function Ye(t,e,a,r,s,i,o,n){let c=s.length,l=new Uint8Array(te),u=G(l),w=fe(s)&&fe(i),x=w?G(s):Pe,b=w?G(i):Pe;for(let d=0;d<c;o++){if(t(e,a,r,u,o,n),o>=ve)throw new Error("arx: counter overflow");let p=Math.min(te,c-d);if(w&&p===te){let y=d/4;if(d%4!==0)throw new Error("arx: invalid block position");for(let g=0,m;g<Xe;g++)m=y+g,b[m]=x[m]^u[g];d+=te;continue}for(let y=0,g;y<p;y++)g=d+y,i[g]=s[g]^l[y];d+=p}}function ce(t,e){let{allowShortKeys:a,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=_e({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return J(s),J(o),ne(i),ne(a),(n,c,l,u,w=0)=>{R(n),R(c),R(l);let x=l.length;if(u===void 0&&(u=new Uint8Array(x)),R(u),J(w),w<0||w>=ve)throw new Error("arx: counter overflow");if(u.length<x)throw new Error(`arx: output (${u.length}) is shorter than data (${x})`);let b=[],d=n.length,p,y;if(d===32)b.push(p=ee(n)),y=$e;else if(d===16&&a)p=new Uint8Array(32),p.set(n),p.set(n,16),y=Fe,b.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${d}`);fe(c)||b.push(c=ee(c));let g=G(p);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(y,g,G(c.subarray(0,16)),g),c=c.subarray(16)}let m=16-s;if(m!==c.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let C=new Uint8Array(12);C.set(c,i?0:12-c.length),c=C,b.push(c)}let B=G(c);return Ye(t,y,g,B,l,u,w,o),F(...b),u}}var H=(t,e)=>t[e++]&255|(t[e++]&255)<<8,le=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Q(e),R(e,32);let a=H(e,0),r=H(e,2),s=H(e,4),i=H(e,6),o=H(e,8),n=H(e,10),c=H(e,12),l=H(e,14);this.r[0]=a&8191,this.r[1]=(a>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|n<<2)&8191,this.r[7]=(n>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=H(e,16+2*u)}process(e,a,r=!1){let s=r?0:2048,{h:i,r:o}=this,n=o[0],c=o[1],l=o[2],u=o[3],w=o[4],x=o[5],b=o[6],d=o[7],p=o[8],y=o[9],g=H(e,a+0),m=H(e,a+2),B=H(e,a+4),C=H(e,a+6),M=H(e,a+8),D=H(e,a+10),O=H(e,a+12),j=H(e,a+14),_=i[0]+(g&8191),K=i[1]+((g>>>13|m<<3)&8191),P=i[2]+((m>>>10|B<<6)&8191),A=i[3]+((B>>>7|C<<9)&8191),v=i[4]+((C>>>4|M<<12)&8191),E=i[5]+(M>>>1&8191),U=i[6]+((M>>>14|D<<2)&8191),k=i[7]+((D>>>11|O<<5)&8191),S=i[8]+((O>>>8|j<<8)&8191),L=i[9]+(j>>>5|s),h=0,z=h+_*n+K*(5*y)+P*(5*p)+A*(5*d)+v*(5*b);h=z>>>13,z&=8191,z+=E*(5*x)+U*(5*w)+k*(5*u)+S*(5*l)+L*(5*c),h+=z>>>13,z&=8191;let T=h+_*c+K*n+P*(5*y)+A*(5*p)+v*(5*d);h=T>>>13,T&=8191,T+=E*(5*b)+U*(5*x)+k*(5*w)+S*(5*u)+L*(5*l),h+=T>>>13,T&=8191;let I=h+_*l+K*c+P*n+A*(5*y)+v*(5*p);h=I>>>13,I&=8191,I+=E*(5*d)+U*(5*b)+k*(5*x)+S*(5*w)+L*(5*u),h+=I>>>13,I&=8191;let N=h+_*u+K*l+P*c+A*n+v*(5*y);h=N>>>13,N&=8191,N+=E*(5*p)+U*(5*d)+k*(5*b)+S*(5*x)+L*(5*w),h+=N>>>13,N&=8191;let $=h+_*w+K*u+P*l+A*c+v*n;h=$>>>13,$&=8191,$+=E*(5*y)+U*(5*p)+k*(5*d)+S*(5*b)+L*(5*x),h+=$>>>13,$&=8191;let X=h+_*x+K*w+P*u+A*l+v*c;h=X>>>13,X&=8191,X+=E*n+U*(5*y)+k*(5*p)+S*(5*d)+L*(5*b),h+=X>>>13,X&=8191;let Y=h+_*b+K*x+P*w+A*u+v*l;h=Y>>>13,Y&=8191,Y+=E*c+U*n+k*(5*y)+S*(5*p)+L*(5*d),h+=Y>>>13,Y&=8191;let V=h+_*d+K*b+P*x+A*w+v*u;h=V>>>13,V&=8191,V+=E*l+U*c+k*n+S*(5*y)+L*(5*p),h+=V>>>13,V&=8191;let W=h+_*p+K*d+P*b+A*x+v*w;h=W>>>13,W&=8191,W+=E*u+U*l+k*c+S*n+L*(5*y),h+=W>>>13,W&=8191;let Z=h+_*y+K*p+P*d+A*b+v*x;h=Z>>>13,Z&=8191,Z+=E*w+U*u+k*l+S*c+L*n,h+=Z>>>13,Z&=8191,h=(h<<2)+h|0,h=h+z|0,z=h&8191,h=h>>>13,T+=h,i[0]=z,i[1]=T,i[2]=I,i[3]=N,i[4]=$,i[5]=X,i[6]=Y,i[7]=V,i[8]=W,i[9]=Z}finalize(){let{h:e,pad:a}=this,r=new Uint16Array(10),s=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=s,s=e[n]>>>13,e[n]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let n=1;n<10;n++)r[n]=e[n]+s,s=r[n]>>>13,r[n]&=8191;r[9]-=8192;let i=(s^1)-1;for(let n=0;n<10;n++)r[n]&=i;i=~i;for(let n=0;n<10;n++)e[n]=e[n]&i|r[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+a[0];e[0]=o&65535;for(let n=1;n<8;n++)o=(e[n]+a[n]|0)+(o>>>16)|0,e[n]=o&65535;F(r)}update(e){ie(this);let{buffer:a,blockLen:r}=this;e=Q(e);let s=e.length;for(let i=0;i<s;){let o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}a.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(a,0,!1),this.pos=0)}return this}destroy(){F(this.h,this.r,this.buffer,this.pad)}digestInto(e){ie(this),ge(e,this),this.finished=!0;let{buffer:a,h:r}=this,{pos:s}=this;if(s){for(a[s++]=1;s<16;s++)a[s]=0;this.process(a,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){let{buffer:e,outputLen:a}=this;this.digestInto(e);let r=e.slice(0,a);return this.destroy(),r}};function Ve(t){let e=(r,s)=>t(s).update(Q(r)).digest(),a=t(new Uint8Array(32));return e.outputLen=a.outputLen,e.blockLen=a.blockLen,e.create=r=>t(r),e}var Ee=Ve(t=>new le(t));function Se(t,e,a,r,s,i=20){let o=t[0],n=t[1],c=t[2],l=t[3],u=e[0],w=e[1],x=e[2],b=e[3],d=e[4],p=e[5],y=e[6],g=e[7],m=s,B=a[0],C=a[1],M=a[2],D=o,O=n,j=c,_=l,K=u,P=w,A=x,v=b,E=d,U=p,k=y,S=g,L=m,h=B,z=C,T=M;for(let N=0;N<i;N+=2)D=D+K|0,L=f(L^D,16),E=E+L|0,K=f(K^E,12),D=D+K|0,L=f(L^D,8),E=E+L|0,K=f(K^E,7),O=O+P|0,h=f(h^O,16),U=U+h|0,P=f(P^U,12),O=O+P|0,h=f(h^O,8),U=U+h|0,P=f(P^U,7),j=j+A|0,z=f(z^j,16),k=k+z|0,A=f(A^k,12),j=j+A|0,z=f(z^j,8),k=k+z|0,A=f(A^k,7),_=_+v|0,T=f(T^_,16),S=S+T|0,v=f(v^S,12),_=_+v|0,T=f(T^_,8),S=S+T|0,v=f(v^S,7),D=D+P|0,T=f(T^D,16),k=k+T|0,P=f(P^k,12),D=D+P|0,T=f(T^D,8),k=k+T|0,P=f(P^k,7),O=O+A|0,L=f(L^O,16),S=S+L|0,A=f(A^S,12),O=O+A|0,L=f(L^O,8),S=S+L|0,A=f(A^S,7),j=j+v|0,h=f(h^j,16),E=E+h|0,v=f(v^E,12),j=j+v|0,h=f(h^j,8),E=E+h|0,v=f(v^E,7),_=_+K|0,z=f(z^_,16),U=U+z|0,K=f(K^U,12),_=_+K|0,z=f(z^_,8),U=U+z|0,K=f(K^U,7);let I=0;r[I++]=o+D|0,r[I++]=n+O|0,r[I++]=c+j|0,r[I++]=l+_|0,r[I++]=u+K|0,r[I++]=w+P|0,r[I++]=x+A|0,r[I++]=b+v|0,r[I++]=d+E|0,r[I++]=p+U|0,r[I++]=y+k|0,r[I++]=g+S|0,r[I++]=m+L|0,r[I++]=B+h|0,r[I++]=C+z|0,r[I++]=M+T|0}function We(t,e,a,r){let s=t[0],i=t[1],o=t[2],n=t[3],c=e[0],l=e[1],u=e[2],w=e[3],x=e[4],b=e[5],d=e[6],p=e[7],y=a[0],g=a[1],m=a[2],B=a[3];for(let M=0;M<20;M+=2)s=s+c|0,y=f(y^s,16),x=x+y|0,c=f(c^x,12),s=s+c|0,y=f(y^s,8),x=x+y|0,c=f(c^x,7),i=i+l|0,g=f(g^i,16),b=b+g|0,l=f(l^b,12),i=i+l|0,g=f(g^i,8),b=b+g|0,l=f(l^b,7),o=o+u|0,m=f(m^o,16),d=d+m|0,u=f(u^d,12),o=o+u|0,m=f(m^o,8),d=d+m|0,u=f(u^d,7),n=n+w|0,B=f(B^n,16),p=p+B|0,w=f(w^p,12),n=n+w|0,B=f(B^n,8),p=p+B|0,w=f(w^p,7),s=s+l|0,B=f(B^s,16),d=d+B|0,l=f(l^d,12),s=s+l|0,B=f(B^s,8),d=d+B|0,l=f(l^d,7),i=i+u|0,y=f(y^i,16),p=p+y|0,u=f(u^p,12),i=i+u|0,y=f(y^i,8),p=p+y|0,u=f(u^p,7),o=o+w|0,g=f(g^o,16),x=x+g|0,w=f(w^x,12),o=o+w|0,g=f(g^o,8),x=x+g|0,w=f(w^x,7),n=n+c|0,m=f(m^n,16),b=b+m|0,c=f(c^b,12),n=n+c|0,m=f(m^n,8),b=b+m|0,c=f(c^b,7);let C=0;r[C++]=s,r[C++]=i,r[C++]=o,r[C++]=n,r[C++]=y,r[C++]=g,r[C++]=m,r[C++]=B}var Ze=ce(Se,{counterRight:!1,counterLength:4,allowShortKeys:!1}),qe=ce(Se,{counterRight:!1,counterLength:8,extendNonceFn:We,allowShortKeys:!1});var Je=new Uint8Array(16),Ue=(t,e)=>{t.update(e);let a=e.length%16;a&&t.update(Je.subarray(a))},Qe=new Uint8Array(32);function ke(t,e,a,r,s){let i=t(e,a,Qe),o=Ee.create(i);s&&Ue(o,s),Ue(o,r);let n=new Uint8Array(16),c=me(n);oe(c,0,BigInt(s?s.length:0),!0),oe(c,8,BigInt(r.length),!0),o.update(n);let l=o.digest();return F(i,n),l}var Le=t=>(e,a,r)=>({encrypt(i,o){let n=i.length;o=ae(n+16,o),t(e,a,i,o,1);let c=ke(t,e,a,o.subarray(0,-16),r);return o.set(c,n),F(c),o},decrypt(i,o){o=ae(i.length-16,o);let n=i.subarray(0,-16),c=i.subarray(-16),l=ke(t,e,a,n,r);if(!Ke(c,l))throw new Error("invalid tag");return t(e,a,n,o,1),F(l),o}}),he=se({blockSize:64,nonceLength:12,tagLength:16},Le(Ze)),_t=se({blockSize:64,nonceLength:24,tagLength:16},Le(qe));var et={},Ie=tt(globalThis,et);function tt(t,e){return new Proxy(t,{get(a,r,s){return r in e?e[r]:t[r]},set(a,r,s){return r in e&&delete e[r],t[r]=s,!0},deleteProperty(a,r){let s=!1;return r in e&&(delete e[r],s=!0),r in t&&(delete t[r],s=!0),s},ownKeys(a){let r=Reflect.ownKeys(t),s=Reflect.ownKeys(e),i=new Set(s);return[...r.filter(o=>!i.has(o)),...s]},defineProperty(a,r,s){return r in e&&delete e[r],Reflect.defineProperty(t,r,s),!0},getOwnPropertyDescriptor(a,r){return r in e?Reflect.getOwnPropertyDescriptor(e,r):Reflect.getOwnPropertyDescriptor(t,r)},has(a,r){return r in e||r in t}})}var ue={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var q=new Uint8Array(0);var ye=new Uint8Array([75,69,77,0,0]);var Dt=new Uint8Array([101,97,101,95,112,114,107]),Ot=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var we=new Uint8Array([100,107,112,95,112,114,107]),De=new Uint8Array([115,107]);var qt=new Uint8Array([99,97,110,100,105,100,97,116,101]),Jt=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Qt=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),er=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),tr=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),rr=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),ir=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var xr=new Uint8Array([72,80,75,69,45,118,49]);var be=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,a,r){return await this._seal(e,a,r)}async open(e,a,r){return await this._open(e,a,r)}_seal(e,a,r){return new Promise(s=>{let i=he(this._key,new Uint8Array(e),new Uint8Array(r)).encrypt(new Uint8Array(a));s(i.buffer)})}_open(e,a,r){return new Promise(s=>{let i=he(this._key,new Uint8Array(e),new Uint8Array(r)).decrypt(new Uint8Array(a));s(i.buffer)})}},xe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ue.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new be(e)}};export{xe as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
