var gn={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48},Wt=gn,mn={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},Qt=mn;function Pe(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Jt(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Ue(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Pe(e.outputLen),Pe(e.blockLen)}function bt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ke(e,t){Jt(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var kt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var ke=e=>e instanceof Uint8Array;var Tt=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Y=(e,t)=>e<<32-t|e>>>t,En=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!En)throw new Error("Non little-endian hardware is not supported");function te(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function At(e){if(typeof e=="string"&&(e=te(e)),!ke(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Te(...e){let t=new Uint8Array(e.reduce((r,i)=>r+i.length,0)),n=0;return e.forEach(r=>{if(!ke(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var yt=class{clone(){return this._cloneInto()}},Kr={}.toString;function Ot(e){let t=r=>e().update(At(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ee(e=32){if(kt&&typeof kt.getRandomValues=="function")return kt.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}var Ct=class extends yt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Ue(t);let r=At(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?t.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return bt(this),this.iHash.update(t),this}digestInto(t){bt(this),Jt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ne=(e,t,n)=>new Ct(e,t).update(n).digest();ne.create=(e,t)=>new Ct(e,t);function Bn(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}var xt=class extends yt{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Tt(this.buffer)}update(t){bt(this);let{view:n,buffer:r,blockLen:i}=this;t=At(t);let o=t.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=Tt(t);for(;i<=o-s;s+=i)this.process(c,s);continue}r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){bt(this),Ke(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:i,isLE:o}=this,{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(r,0),s=0);for(let h=s;h<i;h++)n[h]=0;Bn(r,i-8,BigInt(this.length*8),o),this.process(r,0);let a=Tt(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,f[h],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:i,finished:o,destroyed:s,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=s,i%n&&t.buffer.set(r),t}};var _n=(e,t,n)=>e&t^~e&n,An=(e,t,n)=>e&t^e&n^t&n,vn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ct=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),at=new Uint32Array(64),re=class extends xt{constructor(){super(64,32,8,!1),this.A=ct[0]|0,this.B=ct[1]|0,this.C=ct[2]|0,this.D=ct[3]|0,this.E=ct[4]|0,this.F=ct[5]|0,this.G=ct[6]|0,this.H=ct[7]|0}get(){let{A:t,B:n,C:r,D:i,E:o,F:s,G:a,H:c}=this;return[t,n,r,i,o,s,a,c]}set(t,n,r,i,o,s,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,n){for(let h=0;h<16;h++,n+=4)at[h]=t.getUint32(n,!1);for(let h=16;h<64;h++){let b=at[h-15],A=at[h-2],I=Y(b,7)^Y(b,18)^b>>>3,L=Y(A,17)^Y(A,19)^A>>>10;at[h]=L+at[h-7]+I+at[h-16]|0}let{A:r,B:i,C:o,D:s,E:a,F:c,G:u,H:f}=this;for(let h=0;h<64;h++){let b=Y(a,6)^Y(a,11)^Y(a,25),A=f+b+_n(a,c,u)+vn[h]+at[h]|0,L=(Y(r,2)^Y(r,13)^Y(r,22))+An(r,i,o)|0;f=u,u=c,c=a,a=s+A|0,s=o,o=i,i=r,r=A+L|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(r,i,o,s,a,c,u,f)}roundClean(){at.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Oe=Ot(()=>new re);var Sn={},Ce=In(globalThis,Sn);function In(e,t){return new Proxy(e,{get(n,r,i){return r in t?t[r]:e[r]},set(n,r,i){return r in t&&delete t[r],e[r]=i,!0},deleteProperty(n,r){let i=!1;return r in t&&(delete t[r],i=!0),r in e&&(delete e[r],i=!0),i},ownKeys(n){let r=Reflect.ownKeys(e),i=Reflect.ownKeys(t),o=new Set(i);return[...r.filter(s=>!o.has(s)),...i]},defineProperty(n,r,i){return r in t&&delete t[r],Reflect.defineProperty(e,r,i),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}var ie=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}},tt=class extends ie{},wt=class extends tt{};var gt=class extends tt{},ht=class extends tt{},Nt=class extends tt{},Rt=class extends tt{};var Dt=class extends tt{},mt=class extends tt{};async function Hn(){if(Ce!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:e}=await import("crypto");return e.subtle}catch(e){throw new mt(e)}}var zt=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await Hn())}};var et=new Uint8Array(0);var Ne=new Uint8Array([72,80,75,69,45,118,49]),oe=class extends zt{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Qt.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:et}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(t){this._suiteId=t}buildLabeledIkm(t,n){this._checkInit();let r=new Uint8Array(7+this._suiteId.byteLength+t.byteLength+n.byteLength);return r.set(Ne,0),r.set(this._suiteId,7),r.set(t,7+this._suiteId.byteLength),r.set(n,7+this._suiteId.byteLength+t.byteLength),r}buildLabeledInfo(t,n,r){this._checkInit();let i=new Uint8Array(9+this._suiteId.byteLength+t.byteLength+n.byteLength);return i.set(new Uint8Array([0,r]),0),i.set(Ne,2),i.set(this._suiteId,9),i.set(t,9+this._suiteId.byteLength),i.set(n,9+this._suiteId.byteLength+t.byteLength),i}async extract(t,n){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)throw new wt("The salt length must be the same as the hashSize");let r=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,n)}async expand(t,n,r){await this._setup();let i=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),o=new ArrayBuffer(r),s=new Uint8Array(o),a=et,c=new Uint8Array(n),u=new Uint8Array(1);if(r>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let h=1,b=0;b<s.length;h++)u[0]=h,f.set(a,0),f.set(c,a.length),f.set(u,a.length+c.length),a=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,a.length+c.length+1))),s.length-b>=a.length?(s.set(a,b),b+=a.length):(s.set(a.slice(0,s.length-b),b),b+=s.length-b);return o}async extractAndExpand(t,n,r,i){await this._setup();let o=await this._api.importKey("raw",n,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:r},o,i*8)}async labeledExtract(t,n,r){return await this.extract(t,this.buildLabeledIkm(n,r))}async labeledExpand(t,n,r,i){return await this.expand(t,this.buildLabeledInfo(n,r,i),i)}_checkInit(){if(this._suiteId===et)throw new Error("Not initialized. Call init()")}},qt=class extends oe{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Qt.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}};var Mt=class extends qt{async extract(t,n){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)return ne(Oe,new Uint8Array(t),new Uint8Array(n));let r=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,n)}};var Re=new Uint8Array([75,69,77,0,0]);var Et=e=>typeof e=="object"&&e!==null&&typeof e.privateKey=="object"&&typeof e.publicKey=="object";function De(e,t){if(t<=0)throw new Error("i2Osp: too small size");if(e>=256**t)throw new Error("i2Osp: too large integer");let n=new Uint8Array(t);for(let r=0;r<t&&e;r++)n[t-(r+1)]=e%256,e=e>>8;return n}function vt(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}function se(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var Un=new Uint8Array([101,97,101,95,112,114,107]),Kn=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function kn(e,t,n){let r=new Uint8Array(e.length+t.length+n.length);return r.set(e,0),r.set(t,e.length),r.set(n,e.length+t.length),r}var Gt=class{constructor(t,n,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this._prim=n,this._kdf=r;let i=new Uint8Array(Re);i.set(De(this.id,2),3),this._kdf.init(i)}async serializePublicKey(t){return await this._prim.serializePublicKey(t)}async deserializePublicKey(t){return await this._prim.deserializePublicKey(t)}async serializePrivateKey(t){return await this._prim.serializePrivateKey(t)}async deserializePrivateKey(t){return await this._prim.deserializePrivateKey(t)}async importKey(t,n,r=!0){return await this._prim.importKey(t,n,r)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>8192)throw new wt("Too long ikm");return await this._prim.deriveKeyPair(t)}async encap(t){let n;t.ekm===void 0?n=await this.generateKeyPair():Et(t.ekm)?n=t.ekm:n=await this.deriveKeyPair(t.ekm);let r=await this._prim.serializePublicKey(n.publicKey),i=await this._prim.serializePublicKey(t.recipientPublicKey);try{let o;if(t.senderKey===void 0)o=new Uint8Array(await this._prim.dh(n.privateKey,t.recipientPublicKey));else{let c=Et(t.senderKey)?t.senderKey.privateKey:t.senderKey,u=new Uint8Array(await this._prim.dh(n.privateKey,t.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,t.recipientPublicKey));o=vt(u,f)}let s;if(t.senderKey===void 0)s=vt(new Uint8Array(r),new Uint8Array(i));else{let c=Et(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),u=await this._prim.serializePublicKey(c);s=kn(new Uint8Array(r),new Uint8Array(i),new Uint8Array(u))}let a=await this._generateSharedSecret(o,s);return{enc:r,sharedSecret:a}}catch(o){throw new Nt(o)}}async decap(t){let n=await this._prim.deserializePublicKey(t.enc),r=Et(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,i=Et(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),o=await this._prim.serializePublicKey(i);try{let s;if(t.senderPublicKey===void 0)s=new Uint8Array(await this._prim.dh(r,n));else{let c=new Uint8Array(await this._prim.dh(r,n)),u=new Uint8Array(await this._prim.dh(r,t.senderPublicKey));s=vt(c,u)}let a;if(t.senderPublicKey===void 0)a=vt(new Uint8Array(t.enc),new Uint8Array(o));else{let c=await this._prim.serializePublicKey(t.senderPublicKey);a=new Uint8Array(t.enc.byteLength+o.byteLength+c.byteLength),a.set(new Uint8Array(t.enc),0),a.set(new Uint8Array(o),t.enc.byteLength),a.set(new Uint8Array(c),t.enc.byteLength+o.byteLength)}return await this._generateSharedSecret(s,a)}catch(s){throw new Rt(s)}}async _generateSharedSecret(t,n){let r=this._kdf.buildLabeledIkm(Un,t),i=this._kdf.buildLabeledInfo(Kn,n,this.secretSize);return await this._kdf.extractAndExpand(et,r,i,this.secretSize)}};var Ft=BigInt(4294967295),ce=BigInt(32);function ze(e,t=!1){return t?{h:Number(e&Ft),l:Number(e>>ce&Ft)}:{h:Number(e>>ce&Ft)|0,l:Number(e&Ft)|0}}function Tn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:o,l:s}=ze(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]}var On=(e,t)=>BigInt(e>>>0)<<ce|BigInt(t>>>0),Cn=(e,t,n)=>e>>>n,Nn=(e,t,n)=>e<<32-n|t>>>n,Rn=(e,t,n)=>e>>>n|t<<32-n,Dn=(e,t,n)=>e<<32-n|t>>>n,zn=(e,t,n)=>e<<64-n|t>>>n-32,qn=(e,t,n)=>e>>>n-32|t<<64-n,Mn=(e,t)=>t,Gn=(e,t)=>e,Fn=(e,t,n)=>e<<n|t>>>32-n,jn=(e,t,n)=>t<<n|e>>>32-n,$n=(e,t,n)=>t<<n-32|e>>>64-n,Zn=(e,t,n)=>e<<n-32|t>>>64-n;function Vn(e,t,n,r){let i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}var Xn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Yn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Wn=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Qn=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,Jn=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),tr=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0;var er={fromBig:ze,split:Tn,toBig:On,shrSH:Cn,shrSL:Nn,rotrSH:Rn,rotrSL:Dn,rotrBH:zn,rotrBL:qn,rotr32H:Mn,rotr32L:Gn,rotlSH:Fn,rotlSL:jn,rotlBH:$n,rotlBL:Zn,add:Vn,add3L:Xn,add3H:Yn,add4L:Wn,add4H:Qn,add5H:tr,add5L:Jn},g=er;var[nr,rr]=g.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ft=new Uint32Array(80),ut=new Uint32Array(80),ae=class extends xt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:i,Ch:o,Cl:s,Dh:a,Dl:c,Eh:u,El:f,Fh:h,Fl:b,Gh:A,Gl:I,Hh:L,Hl:S}=this;return[t,n,r,i,o,s,a,c,u,f,h,b,A,I,L,S]}set(t,n,r,i,o,s,a,c,u,f,h,b,A,I,L,S){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=b|0,this.Gh=A|0,this.Gl=I|0,this.Hh=L|0,this.Hl=S|0}process(t,n){for(let d=0;d<16;d++,n+=4)ft[d]=t.getUint32(n),ut[d]=t.getUint32(n+=4);for(let d=16;d<80;d++){let m=ft[d-15]|0,x=ut[d-15]|0,N=g.rotrSH(m,x,1)^g.rotrSH(m,x,8)^g.shrSH(m,x,7),X=g.rotrSL(m,x,1)^g.rotrSL(m,x,8)^g.shrSL(m,x,7),K=ft[d-2]|0,T=ut[d-2]|0,q=g.rotrSH(K,T,19)^g.rotrBH(K,T,61)^g.shrSH(K,T,6),R=g.rotrSL(K,T,19)^g.rotrBL(K,T,61)^g.shrSL(K,T,6),j=g.add4L(X,R,ut[d-7],ut[d-16]),O=g.add4H(j,N,q,ft[d-7],ft[d-16]);ft[d]=O|0,ut[d]=j|0}let{Ah:r,Al:i,Bh:o,Bl:s,Ch:a,Cl:c,Dh:u,Dl:f,Eh:h,El:b,Fh:A,Fl:I,Gh:L,Gl:S,Hh:z,Hl:F}=this;for(let d=0;d<80;d++){let m=g.rotrSH(h,b,14)^g.rotrSH(h,b,18)^g.rotrBH(h,b,41),x=g.rotrSL(h,b,14)^g.rotrSL(h,b,18)^g.rotrBL(h,b,41),N=h&A^~h&L,X=b&I^~b&S,K=g.add5L(F,x,X,rr[d],ut[d]),T=g.add5H(K,z,m,N,nr[d],ft[d]),q=K|0,R=g.rotrSH(r,i,28)^g.rotrBH(r,i,34)^g.rotrBH(r,i,39),j=g.rotrSL(r,i,28)^g.rotrBL(r,i,34)^g.rotrBL(r,i,39),O=r&o^r&a^o&a,_t=i&s^i&c^s&c;z=L|0,F=S|0,L=A|0,S=I|0,A=h|0,I=b|0,{h,l:b}=g.add(u|0,f|0,T|0,q|0),u=a|0,f=c|0,a=o|0,c=s|0,o=r|0,s=i|0;let ot=g.add3L(q,j,_t);r=g.add3H(ot,T,R,O),i=ot|0}({h:r,l:i}=g.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:o,l:s}=g.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:c}=g.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:f}=g.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l:b}=g.add(this.Eh|0,this.El|0,h|0,b|0),{h:A,l:I}=g.add(this.Fh|0,this.Fl|0,A|0,I|0),{h:L,l:S}=g.add(this.Gh|0,this.Gl|0,L|0,S|0),{h:z,l:F}=g.add(this.Hh|0,this.Hl|0,z|0,F|0),this.set(r,i,o,s,a,c,u,f,h,b,A,I,L,S,z,F)}roundClean(){ft.fill(0),ut.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var fe=Ot(()=>new ae);var pi=BigInt(0),ir=BigInt(1),or=BigInt(2),jt=e=>e instanceof Uint8Array,sr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function $t(e){if(!jt(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=sr[e[n]];return t}function qe(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Me(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(t/2);for(let r=0;r<n.length;r++){let i=r*2,o=e.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function Ge(e){return qe($t(e))}function nt(e){if(!jt(e))throw new Error("Uint8Array expected");return qe($t(Uint8Array.from(e).reverse()))}function ue(e,t){return Me(e.toString(16).padStart(t*2,"0"))}function dt(e,t){return ue(e,t).reverse()}function $(e,t,n){let r;if(typeof t=="string")try{r=Me(t)}catch(o){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${o}`)}else if(jt(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=r.length;if(typeof n=="number"&&i!==n)throw new Error(`${e} expected ${n} bytes, got ${i}`);return r}function le(...e){let t=new Uint8Array(e.reduce((r,i)=>r+i.length,0)),n=0;return e.forEach(r=>{if(!jt(r))throw new Error("Uint8Array expected");t.set(r,n),n+=r.length}),t}var Fe=e=>(or<<BigInt(e-1))-ir;var cr={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function lt(e,t,n={}){let r=(i,o,s)=>{let a=cr[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let c=e[i];if(!(s&&c===void 0)&&!a(c,e))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(let[i,o]of Object.entries(t))r(i,o,!1);for(let[i,o]of Object.entries(n))r(i,o,!0);return e}var C=BigInt(0),k=BigInt(1),pt=BigInt(2),fr=BigInt(3),he=BigInt(4),je=BigInt(5),$e=BigInt(8),ur=BigInt(9),lr=BigInt(16);function U(e,t){let n=e%t;return n>=C?n:t+n}function de(e,t,n){if(n<=C||t<C)throw new Error("Expected power/modulo > 0");if(n===k)return C;let r=k;for(;t>C;)t&k&&(r=r*e%n),e=e*e%n,t>>=k;return r}function V(e,t,n){let r=e;for(;t-- >C;)r*=r,r%=n;return r}function Ze(e,t){if(e===C||t<=C)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=U(e,t),r=t,i=C,o=k,s=k,a=C;for(;n!==C;){let u=r/n,f=r%n,h=i-s*u,b=o-a*u;r=n,n=f,i=s,o=a,s=h,a=b}if(r!==k)throw new Error("invert: does not exist");return U(i,t)}function hr(e){let t=(e-k)/pt,n,r,i;for(n=e-k,r=0;n%pt===C;n/=pt,r++);for(i=pt;i<e&&de(i,t,e)!==e-k;i++);if(r===1){let s=(e+k)/he;return function(c,u){let f=c.pow(u,s);if(!c.eql(c.sqr(f),u))throw new Error("Cannot find square root");return f}}let o=(n+k)/pt;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,f=a.pow(a.mul(a.ONE,i),n),h=a.pow(c,o),b=a.pow(c,n);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let A=1;for(let L=a.sqr(b);A<u&&!a.eql(L,a.ONE);A++)L=a.sqr(L);let I=a.pow(f,k<<BigInt(u-A-1));f=a.sqr(I),h=a.mul(h,I),b=a.mul(b,f),u=A}return h}}function dr(e){if(e%he===fr){let t=(e+k)/he;return function(r,i){let o=r.pow(i,t);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(e%$e===je){let t=(e-je)/$e;return function(r,i){let o=r.mul(i,pt),s=r.pow(o,t),a=r.mul(i,s),c=r.mul(r.mul(a,pt),s),u=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%lr,hr(e)}var Ve=(e,t)=>(U(e,t)&k)===k,pr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Xe(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=pr.reduce((r,i)=>(r[i]="function",r),t);return lt(e,n)}function br(e,t,n){if(n<C)throw new Error("Expected power > 0");if(n===C)return e.ONE;if(n===k)return t;let r=e.ONE,i=t;for(;n>C;)n&k&&(r=e.mul(r,i)),i=e.sqr(i),n>>=k;return r}function yr(e,t){let n=new Array(t.length),r=t.reduce((o,s,a)=>e.is0(s)?o:(n[a]=o,e.mul(o,s)),e.ONE),i=e.inv(r);return t.reduceRight((o,s,a)=>e.is0(s)?o:(n[a]=e.mul(o,n[a]),e.mul(o,s)),i),n}function pe(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Ye(e,t,n=!1,r={}){if(e<=C)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:o}=pe(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=dr(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:Fe(i),ZERO:C,ONE:k,create:c=>U(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return C<=c&&c<e},is0:c=>c===C,isOdd:c=>(c&k)===k,neg:c=>U(-c,e),eql:(c,u)=>c===u,sqr:c=>U(c*c,e),add:(c,u)=>U(c+u,e),sub:(c,u)=>U(c-u,e),mul:(c,u)=>U(c*u,e),pow:(c,u)=>br(a,c,u),div:(c,u)=>U(c*Ze(u,e),e),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Ze(c,e),sqrt:r.sqrt||(c=>s(a,c)),invertBatch:c=>yr(a,c),cmov:(c,u,f)=>f?u:c,toBytes:c=>n?dt(c,o):ue(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return n?nt(c):Ge(c)}});return Object.freeze(a)}function We(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}var xr=BigInt(0),be=BigInt(1);function Qe(e,t){let n=(i,o)=>{let s=o.negate();return i?s:o},r=i=>{let o=Math.ceil(t/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:n,unsafeLadder(i,o){let s=e.ZERO,a=i;for(;o>xr;)o&be&&(s=s.add(a)),a=a.double(),o>>=be;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=r(o),c=[],u=i,f=u;for(let h=0;h<s;h++){f=u,c.push(f);for(let b=1;b<a;b++)f=f.add(u),c.push(f);u=f.double()}return c},wNAF(i,o,s){let{windows:a,windowSize:c}=r(i),u=e.ZERO,f=e.BASE,h=BigInt(2**i-1),b=2**i,A=BigInt(i);for(let I=0;I<a;I++){let L=I*c,S=Number(s&h);s>>=A,S>c&&(S-=b,s+=be);let z=L,F=L+Math.abs(S)-1,d=I%2!==0,m=S<0;S===0?f=f.add(n(d,o[z])):u=u.add(n(m,o[F]))}return{p:u,f}},wNAFCached(i,o,s,a){let c=i._WINDOW_SIZE||1,u=o.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&o.set(i,a(u))),this.wNAF(c,u,s)}}}function Je(e){return Xe(e.Fp),lt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...pe(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var W=BigInt(0),Z=BigInt(1),Zt=BigInt(2),wr=BigInt(8),gr={zip215:!0};function mr(e){let t=Je(e);return lt(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Vt(e){let t=mr(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,u=Zt<<BigInt(a*8)-Z,f=n.create,h=t.uvRatio||((p,l)=>{try{return{isValid:!0,value:n.sqrt(p*n.inv(l))}}catch{return{isValid:!1,value:W}}}),b=t.adjustScalarBytes||(p=>p),A=t.domain||((p,l,y)=>{if(l.length||y)throw new Error("Contexts/pre-hash are not supported");return p}),I=p=>typeof p=="bigint"&&W<p,L=(p,l)=>I(p)&&I(l)&&p<l,S=p=>p===W||L(p,u);function z(p,l){if(L(p,l))return p;throw new Error(`Expected valid scalar < ${l}, got ${typeof p} ${p}`)}function F(p){return p===W?p:z(p,r)}let d=new Map;function m(p){if(!(p instanceof x))throw new Error("ExtendedPoint expected")}class x{constructor(l,y,w,E){if(this.ex=l,this.ey=y,this.ez=w,this.et=E,!S(l))throw new Error("x required");if(!S(y))throw new Error("y required");if(!S(w))throw new Error("z required");if(!S(E))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(l){if(l instanceof x)throw new Error("extended point not allowed");let{x:y,y:w}=l||{};if(!S(y)||!S(w))throw new Error("invalid affine point");return new x(y,w,Z,f(y*w))}static normalizeZ(l){let y=n.invertBatch(l.map(w=>w.ez));return l.map((w,E)=>w.toAffine(y[E])).map(x.fromAffine)}_setWindowSize(l){this._WINDOW_SIZE=l,d.delete(this)}assertValidity(){let{a:l,d:y}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:w,ey:E,ez:B,et:v}=this,P=f(w*w),_=f(E*E),H=f(B*B),D=f(H*H),M=f(P*l),Q=f(H*f(M+_)),G=f(D+f(y*f(P*_)));if(Q!==G)throw new Error("bad point: equation left != right (1)");let st=f(w*E),J=f(B*v);if(st!==J)throw new Error("bad point: equation left != right (2)")}equals(l){m(l);let{ex:y,ey:w,ez:E}=this,{ex:B,ey:v,ez:P}=l,_=f(y*P),H=f(B*E),D=f(w*P),M=f(v*E);return _===H&&D===M}is0(){return this.equals(x.ZERO)}negate(){return new x(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:l}=t,{ex:y,ey:w,ez:E}=this,B=f(y*y),v=f(w*w),P=f(Zt*f(E*E)),_=f(l*B),H=y+w,D=f(f(H*H)-B-v),M=_+v,Q=M-P,G=_-v,st=f(D*Q),J=f(M*G),Ut=f(D*G),Kt=f(Q*M);return new x(st,J,Kt,Ut)}add(l){m(l);let{a:y,d:w}=t,{ex:E,ey:B,ez:v,et:P}=this,{ex:_,ey:H,ez:D,et:M}=l;if(y===BigInt(-1)){let _e=f((B-E)*(H+_)),Ae=f((B+E)*(H-_)),Yt=f(Ae-_e);if(Yt===W)return this.double();let ve=f(v*Zt*M),Se=f(P*Zt*D),Ie=Se+ve,Le=Ae+_e,He=Se-ve,bn=f(Ie*Yt),yn=f(Le*He),xn=f(Ie*He),wn=f(Yt*Le);return new x(bn,yn,wn,xn)}let Q=f(E*_),G=f(B*H),st=f(P*w*M),J=f(v*D),Ut=f((E+B)*(_+H)-Q-G),Kt=J-st,Ee=J+st,Be=f(G-y*Q),ln=f(Ut*Kt),hn=f(Ee*Be),dn=f(Ut*Be),pn=f(Kt*Ee);return new x(ln,hn,pn,dn)}subtract(l){return this.add(l.negate())}wNAF(l){return K.wNAFCached(this,d,l,x.normalizeZ)}multiply(l){let{p:y,f:w}=this.wNAF(z(l,r));return x.normalizeZ([y,w])[0]}multiplyUnsafe(l){let y=F(l);return y===W?X:this.equals(X)||y===Z?this:this.equals(N)?this.wNAF(y).p:K.unsafeLadder(this,y)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return K.unsafeLadder(this,r).is0()}toAffine(l){let{ex:y,ey:w,ez:E}=this,B=this.is0();l==null&&(l=B?wr:n.inv(E));let v=f(y*l),P=f(w*l),_=f(E*l);if(B)return{x:W,y:Z};if(_!==Z)throw new Error("invZ was invalid");return{x:v,y:P}}clearCofactor(){let{h:l}=t;return l===Z?this:this.multiplyUnsafe(l)}static fromHex(l,y=!1){let{d:w,a:E}=t,B=n.BYTES;l=$("pointHex",l,B);let v=l.slice(),P=l[B-1];v[B-1]=P&-129;let _=nt(v);_===W||(y?z(_,u):z(_,n.ORDER));let H=f(_*_),D=f(H-Z),M=f(w*H-E),{isValid:Q,value:G}=h(D,M);if(!Q)throw new Error("Point.fromHex: invalid y coordinate");let st=(G&Z)===Z,J=(P&128)!==0;if(!y&&G===W&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==st&&(G=f(-G)),x.fromAffine({x:G,y:_})}static fromPrivateKey(l){return R(l).point}toRawBytes(){let{x:l,y}=this.toAffine(),w=dt(y,n.BYTES);return w[w.length-1]|=l&Z?128:0,w}toHex(){return $t(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,Z,f(t.Gx*t.Gy)),x.ZERO=new x(W,Z,Z,W);let{BASE:N,ZERO:X}=x,K=Qe(x,a*8);function T(p){return U(p,r)}function q(p){return T(nt(p))}function R(p){let l=a;p=$("private key",p,l);let y=$("hashed private key",o(p),2*l),w=b(y.slice(0,l)),E=y.slice(l,2*l),B=q(w),v=N.multiply(B),P=v.toRawBytes();return{head:w,prefix:E,scalar:B,point:v,pointBytes:P}}function j(p){return R(p).pointBytes}function O(p=new Uint8Array,...l){let y=le(...l);return q(o(A(y,$("context",p),!!i)))}function _t(p,l,y={}){p=$("message",p),i&&(p=i(p));let{prefix:w,scalar:E,pointBytes:B}=R(l),v=O(y.context,w,p),P=N.multiply(v).toRawBytes(),_=O(y.context,P,B,p),H=T(v+_*E);F(H);let D=le(P,dt(H,n.BYTES));return $("result",D,a*2)}let ot=gr;function Ht(p,l,y,w=ot){let{context:E,zip215:B}=w,v=n.BYTES;p=$("signature",p,2*v),l=$("message",l),i&&(l=i(l));let P=nt(p.slice(v,2*v)),_,H,D;try{_=x.fromHex(y,B),H=x.fromHex(p.slice(0,v),B),D=N.multiplyUnsafe(P)}catch{return!1}if(!B&&_.isSmallOrder())return!1;let M=O(E,H.toRawBytes(),_.toRawBytes(),l);return H.add(_.multiplyUnsafe(M)).subtract(D).clearCofactor().equals(x.ZERO)}return N._setWindowSize(8),{CURVE:t,getPublicKey:j,sign:_t,verify:Ht,ExtendedPoint:x,utils:{getExtendedPublicKey:R,randomPrivateKey:()=>s(n.BYTES),precompute(p=8,l=x.BASE){return l._setWindowSize(p),l.multiply(BigInt(3)),l}}}}var St=BigInt(0),ye=BigInt(1);function Er(e){return lt(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function tn(e){let t=Er(e),{P:n}=t,r=d=>U(d,n),i=t.montgomeryBits,o=Math.ceil(i/8),s=t.nByteLength,a=t.adjustScalarBytes||(d=>d),c=t.powPminus2||(d=>de(d,n-BigInt(2),n));function u(d,m,x){let N=r(d*(m-x));return m=r(m-N),x=r(x+N),[m,x]}function f(d){if(typeof d=="bigint"&&St<=d&&d<n)return d;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(t.a-BigInt(2))/BigInt(4);function b(d,m){let x=f(d),N=f(m),X=x,K=ye,T=St,q=x,R=ye,j=St,O;for(let ot=BigInt(i-1);ot>=St;ot--){let Ht=N>>ot&ye;j^=Ht,O=u(j,K,q),K=O[0],q=O[1],O=u(j,T,R),T=O[0],R=O[1],j=Ht;let Pt=K+T,p=r(Pt*Pt),l=K-T,y=r(l*l),w=p-y,E=q+R,B=q-R,v=r(B*Pt),P=r(E*l),_=v+P,H=v-P;q=r(_*_),R=r(X*r(H*H)),K=r(p*y),T=r(w*(p+r(h*w)))}O=u(j,K,q),K=O[0],q=O[1],O=u(j,T,R),T=O[0],R=O[1];let _t=c(T);return r(K*_t)}function A(d){return dt(r(d),o)}function I(d){let m=$("u coordinate",d,o);return s===o&&(m[s-1]&=127),nt(m)}function L(d){let m=$("scalar",d);if(m.length!==o&&m.length!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${m.length}`);return nt(a(m))}function S(d,m){let x=I(m),N=L(d),X=b(x,N);if(X===St)throw new Error("Invalid private or public key received");return A(X)}let z=A(t.Gu);function F(d){return S(d,z)}return{scalarMult:S,scalarMultBase:F,getSharedSecret:(d,m)=>S(d,m),getPublicKey:d=>F(d),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:z}}var It=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),en=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ki=BigInt(0),Br=BigInt(1),xe=BigInt(2),_r=BigInt(5),nn=BigInt(10),Ar=BigInt(20),vr=BigInt(40),rn=BigInt(80);function on(e){let t=It,r=e*e%t*e%t,i=V(r,xe,t)*r%t,o=V(i,Br,t)*e%t,s=V(o,_r,t)*o%t,a=V(s,nn,t)*s%t,c=V(a,Ar,t)*a%t,u=V(c,vr,t)*c%t,f=V(u,rn,t)*u%t,h=V(f,rn,t)*u%t,b=V(h,nn,t)*s%t;return{pow_p_5_8:V(b,xe,t)*e%t,b2:r}}function sn(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Sr(e,t){let n=It,r=U(t*t*t,n),i=U(r*r*t,n),o=on(e*i).pow_p_5_8,s=U(e*r*o,n),a=U(t*s*s,n),c=s,u=U(s*en,n),f=a===e,h=a===U(-e,n),b=a===U(-e*en,n);return f&&(s=c),(h||b)&&(s=u),Ve(s,n)&&(s=U(-s,n)),{isValid:f||h,value:s}}var rt=Ye(It,void 0,!0),we={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:rt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:fe,randomBytes:ee,adjustScalarBytes:sn,uvRatio:Sr},cn=Vt(we);function an(e,t,n){if(t.length>255)throw new Error("Context is too big");return Te(te("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}var ki=Vt({...we,domain:an}),Ti=Vt({...we,domain:an,prehash:fe}),ge=tn({P:It,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=It,{pow_p_5_8:n,b2:r}=on(e);return U(V(n,BigInt(3),t)*r,t)},adjustScalarBytes:sn,randomBytes:ee});var Ir=(rt.ORDER+BigInt(3))/BigInt(8),Oi=rt.pow(xe,Ir),Ci=rt.sqrt(rt.neg(rt.ONE)),Ni=(rt.ORDER-BigInt(5))/BigInt(8),Ri=BigInt(486662);var Di=We(rt,rt.neg(BigInt(486664)));var zi=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),qi=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Mi=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Gi=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var Fi=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Lt=["deriveBits"],fn=new Uint8Array([100,107,112,95,112,114,107]),un=new Uint8Array([115,107]);var it=class{constructor(t,n,r,i=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=n,this.type=r,this.algorithm={name:t},this.usages=i,r==="public"&&(this.usages=[])}};var Bt="X25519",Xt=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=32,this._nSk=32}async serializePublicKey(t){try{return await this._serializePublicKey(t)}catch(n){throw new gt(n)}}async deserializePublicKey(t){try{return await this._importRawKey(t,!0)}catch(n){throw new ht(n)}}async serializePrivateKey(t){try{return await this._serializePrivateKey(t)}catch(n){throw new gt(n)}}async deserializePrivateKey(t){try{return await this._importRawKey(t,!1)}catch(n){throw new ht(n)}}async importKey(t,n,r){try{if(t==="raw")return await this._importRawKey(n,r);if(n instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(n,r)}catch(i){throw new ht(i)}}async generateKeyPair(){try{let t=cn.utils.randomPrivateKey(),n=new it(Bt,t,"private",Lt);return{publicKey:await this.derivePublicKey(n),privateKey:n}}catch(t){throw new mt(t)}}async deriveKeyPair(t){try{let n=await this._hkdf.labeledExtract(et,fn,new Uint8Array(t)),r=await this._hkdf.labeledExpand(n,un,et,this._nSk),i=new it(Bt,new Uint8Array(r),"private",Lt);return{privateKey:i,publicKey:await this.derivePublicKey(i)}}catch(n){throw new Dt(n)}}async derivePublicKey(t){try{return await this._derivePublicKey(t)}catch(n){throw new ht(n)}}async dh(t,n){try{return await this._dh(t,n)}catch(r){throw new gt(r)}}_serializePublicKey(t){return new Promise(n=>{n(t.key.buffer)})}_serializePrivateKey(t){return new Promise(n=>{n(t.key.buffer)})}_importRawKey(t,n){return new Promise((r,i)=>{n&&t.byteLength!==this._nPk&&i(new Error("Invalid length of the key")),!n&&t.byteLength!==this._nSk&&i(new Error("Invalid length of the key")),r(new it(Bt,new Uint8Array(t),n?"public":"private",n?[]:Lt))})}_importJWK(t,n){return new Promise((r,i)=>{(typeof t.kty>"u"||t.kty!=="OKP")&&i(new Error(`Invalid kty: ${t.kty}`)),(typeof t.crv>"u"||t.crv!=="X25519")&&i(new Error(`Invalid crv: ${t.crv}`)),n?(typeof t.d<"u"&&i(new Error("Invalid key: `d` should not be set")),typeof t.x>"u"&&i(new Error("Invalid key: `x` not found")),r(new it(Bt,se(t.x),"public"))):(typeof t.d!="string"&&i(new Error("Invalid key: `d` not found")),r(new it(Bt,se(t.d),"private",Lt)))})}_derivePublicKey(t){return new Promise((n,r)=>{try{let i=ge.getPublicKey(t.key);n(new it(Bt,i,"public"))}catch(i){r(i)}})}_dh(t,n){return new Promise((r,i)=>{try{r(ge.getSharedSecret(t.key,n.key).buffer)}catch(o){i(o)}})}};var me=class extends Gt{constructor(){let t=new Mt;super(Wt.DhkemX25519HkdfSha256,new Xt(t),t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Wt.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};export{me as DhkemX25519HkdfSha256};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
