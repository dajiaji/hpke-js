var mn={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48},Qt=mn,En={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},Jt=En;function Pe(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function _n(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function te(e,...t){if(!_n(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Ue(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Pe(e.outputLen),Pe(e.blockLen)}function yt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ke(e,t){te(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Ot=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ke(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var Ct=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Y=(e,t)=>e<<32-t|e>>>t,Bn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Bn)throw new Error("Non little-endian hardware is not supported");function ee(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function vt(e){if(typeof e=="string"&&(e=ee(e)),!ke(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Te(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];if(!ke(i))throw new Error("Uint8Array expected");t+=i.length}let n=new Uint8Array(t);for(let r=0,i=0;r<e.length;r++){let o=e[r];n.set(o,i),i+=o.length}return n}var xt=class{clone(){return this._cloneInto()}},Tr={}.toString;function Rt(e){let t=r=>e().update(vt(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ne(e=32){if(Ot&&typeof Ot.getRandomValues=="function")return Ot.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}var Nt=class extends xt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Ue(t);let r=vt(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?t.create().update(r).digest():r);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=t.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),o.fill(0)}update(t){return yt(this),this.iHash.update(t),this}digestInto(t){yt(this),te(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:i,destroyed:o,blockLen:c,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=o,t.blockLen=c,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},re=(e,t,n)=>new Nt(e,t).update(n).digest();re.create=(e,t)=>new Nt(e,t);function An(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let i=BigInt(32),o=BigInt(4294967295),c=Number(n>>i&o),a=Number(n&o),s=r?4:0,u=r?0:4;e.setUint32(t+s,c,r),e.setUint32(t+u,a,r)}var wt=class extends xt{constructor(t,n,r,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ct(this.buffer)}update(t){yt(this);let{view:n,buffer:r,blockLen:i}=this;t=vt(t);let o=t.length;for(let c=0;c<o;){let a=Math.min(i-this.pos,o-c);if(a===i){let s=Ct(t);for(;i<=o-c;c+=i)this.process(s,c);continue}r.set(t.subarray(c,c+a),this.pos),this.pos+=a,c+=a,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){yt(this),Ke(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:i,isLE:o}=this,{pos:c}=this;n[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>i-c&&(this.process(r,0),c=0);for(let h=c;h<i;h++)n[h]=0;An(r,i-8,BigInt(this.length*8),o),this.process(r,0);let a=Ct(t),s=this.outputLen;if(s%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=s/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)a.setUint32(4*h,f[h],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:i,finished:o,destroyed:c,pos:a}=this;return t.length=i,t.pos=a,t.finished=o,t.destroyed=c,i%n&&t.buffer.set(r),t}};var vn=(e,t,n)=>e&t^~e&n,Sn=(e,t,n)=>e&t^e&n^t&n,In=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),at=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ft=new Uint32Array(64),ie=class extends wt{constructor(){super(64,32,8,!1),this.A=at[0]|0,this.B=at[1]|0,this.C=at[2]|0,this.D=at[3]|0,this.E=at[4]|0,this.F=at[5]|0,this.G=at[6]|0,this.H=at[7]|0}get(){let{A:t,B:n,C:r,D:i,E:o,F:c,G:a,H:s}=this;return[t,n,r,i,o,c,a,s]}set(t,n,r,i,o,c,a,s){this.A=t|0,this.B=n|0,this.C=r|0,this.D=i|0,this.E=o|0,this.F=c|0,this.G=a|0,this.H=s|0}process(t,n){for(let h=0;h<16;h++,n+=4)ft[h]=t.getUint32(n,!1);for(let h=16;h<64;h++){let b=ft[h-15],B=ft[h-2],I=Y(b,7)^Y(b,18)^b>>>3,L=Y(B,17)^Y(B,19)^B>>>10;ft[h]=L+ft[h-7]+I+ft[h-16]|0}let{A:r,B:i,C:o,D:c,E:a,F:s,G:u,H:f}=this;for(let h=0;h<64;h++){let b=Y(a,6)^Y(a,11)^Y(a,25),B=f+b+vn(a,s,u)+In[h]+ft[h]|0,L=(Y(r,2)^Y(r,13)^Y(r,22))+Sn(r,i,o)|0;f=u,u=s,s=a,a=c+B|0,c=o,o=i,i=r,r=B+L|0}r=r+this.A|0,i=i+this.B|0,o=o+this.C|0,c=c+this.D|0,a=a+this.E|0,s=s+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(r,i,o,c,a,s,u,f)}roundClean(){ft.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Oe=Rt(()=>new ie);var Ln={},Ce=Hn(globalThis,Ln);function Hn(e,t){return new Proxy(e,{get(n,r,i){return r in t?t[r]:e[r]},set(n,r,i){return r in t&&delete t[r],e[r]=i,!0},deleteProperty(n,r){let i=!1;return r in t&&(delete t[r],i=!0),r in e&&(delete e[r],i=!0),i},ownKeys(n){let r=Reflect.ownKeys(e),i=Reflect.ownKeys(t),o=new Set(i);return[...r.filter(c=>!o.has(c)),...i]},defineProperty(n,r,i){return r in t&&delete t[r],Reflect.defineProperty(e,r,i),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}var oe=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}},tt=class extends oe{},gt=class extends tt{};var mt=class extends tt{},dt=class extends tt{},Dt=class extends tt{},zt=class extends tt{};var qt=class extends tt{},Et=class extends tt{};async function Un(){if(Ce!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:e}=await import("crypto");return e.subtle}catch(e){throw new Et(e)}}var Mt=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await Un())}};var et=new Uint8Array(0);var Re=new Uint8Array([72,80,75,69,45,118,49]),se=class extends Mt{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Jt.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:et}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(t){this._suiteId=t}buildLabeledIkm(t,n){this._checkInit();let r=new Uint8Array(7+this._suiteId.byteLength+t.byteLength+n.byteLength);return r.set(Re,0),r.set(this._suiteId,7),r.set(t,7+this._suiteId.byteLength),r.set(n,7+this._suiteId.byteLength+t.byteLength),r}buildLabeledInfo(t,n,r){this._checkInit();let i=new Uint8Array(9+this._suiteId.byteLength+t.byteLength+n.byteLength);return i.set(new Uint8Array([0,r]),0),i.set(Re,2),i.set(this._suiteId,9),i.set(t,9+this._suiteId.byteLength),i.set(n,9+this._suiteId.byteLength+t.byteLength),i}async extract(t,n){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)throw new gt("The salt length must be the same as the hashSize");let r=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,n)}async expand(t,n,r){await this._setup();let i=await this._api.importKey("raw",t,this.algHash,!1,["sign"]),o=new ArrayBuffer(r),c=new Uint8Array(o),a=et,s=new Uint8Array(n),u=new Uint8Array(1);if(r>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+s.length+1);for(let h=1,b=0;b<c.length;h++)u[0]=h,f.set(a,0),f.set(s,a.length),f.set(u,a.length+s.length),a=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,a.length+s.length+1))),c.length-b>=a.length?(c.set(a,b),b+=a.length):(c.set(a.slice(0,c.length-b),b),b+=c.length-b);return o}async extractAndExpand(t,n,r,i){await this._setup();let o=await this._api.importKey("raw",n,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:t,info:r},o,i*8)}async labeledExtract(t,n,r){return await this.extract(t,this.buildLabeledIkm(n,r))}async labeledExpand(t,n,r,i){return await this.expand(t,this.buildLabeledInfo(n,r,i),i)}_checkInit(){if(this._suiteId===et)throw new Error("Not initialized. Call init()")}},Gt=class extends se{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Jt.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}};var Ft=class extends Gt{async extract(t,n){if(await this._setup(),t.byteLength===0&&(t=new ArrayBuffer(this.hashSize)),t.byteLength!==this.hashSize)return re(Oe,new Uint8Array(t),new Uint8Array(n));let r=await this._api.importKey("raw",t,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,n)}};var Ne=new Uint8Array([75,69,77,0,0]);var _t=e=>typeof e=="object"&&e!==null&&typeof e.privateKey=="object"&&typeof e.publicKey=="object";function De(e,t){if(t<=0)throw new Error("i2Osp: too small size");if(e>=256**t)throw new Error("i2Osp: too large integer");let n=new Uint8Array(t);for(let r=0;r<t&&e;r++)n[t-(r+1)]=e%256,e=e>>8;return n}function St(e,t){let n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}function ce(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var kn=new Uint8Array([101,97,101,95,112,114,107]),Tn=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function On(e,t,n){let r=new Uint8Array(e.length+t.length+n.length);return r.set(e,0),r.set(t,e.length),r.set(n,e.length+t.length),r}var jt=class{constructor(t,n,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this._prim=n,this._kdf=r;let i=new Uint8Array(Ne);i.set(De(this.id,2),3),this._kdf.init(i)}async serializePublicKey(t){return await this._prim.serializePublicKey(t)}async deserializePublicKey(t){return await this._prim.deserializePublicKey(t)}async serializePrivateKey(t){return await this._prim.serializePrivateKey(t)}async deserializePrivateKey(t){return await this._prim.deserializePrivateKey(t)}async importKey(t,n,r=!0){return await this._prim.importKey(t,n,r)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(t){if(t.byteLength>8192)throw new gt("Too long ikm");return await this._prim.deriveKeyPair(t)}async encap(t){let n;t.ekm===void 0?n=await this.generateKeyPair():_t(t.ekm)?n=t.ekm:n=await this.deriveKeyPair(t.ekm);let r=await this._prim.serializePublicKey(n.publicKey),i=await this._prim.serializePublicKey(t.recipientPublicKey);try{let o;if(t.senderKey===void 0)o=new Uint8Array(await this._prim.dh(n.privateKey,t.recipientPublicKey));else{let s=_t(t.senderKey)?t.senderKey.privateKey:t.senderKey,u=new Uint8Array(await this._prim.dh(n.privateKey,t.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(s,t.recipientPublicKey));o=St(u,f)}let c;if(t.senderKey===void 0)c=St(new Uint8Array(r),new Uint8Array(i));else{let s=_t(t.senderKey)?t.senderKey.publicKey:await this._prim.derivePublicKey(t.senderKey),u=await this._prim.serializePublicKey(s);c=On(new Uint8Array(r),new Uint8Array(i),new Uint8Array(u))}let a=await this._generateSharedSecret(o,c);return{enc:r,sharedSecret:a}}catch(o){throw new Dt(o)}}async decap(t){let n=await this._prim.deserializePublicKey(t.enc),r=_t(t.recipientKey)?t.recipientKey.privateKey:t.recipientKey,i=_t(t.recipientKey)?t.recipientKey.publicKey:await this._prim.derivePublicKey(t.recipientKey),o=await this._prim.serializePublicKey(i);try{let c;if(t.senderPublicKey===void 0)c=new Uint8Array(await this._prim.dh(r,n));else{let s=new Uint8Array(await this._prim.dh(r,n)),u=new Uint8Array(await this._prim.dh(r,t.senderPublicKey));c=St(s,u)}let a;if(t.senderPublicKey===void 0)a=St(new Uint8Array(t.enc),new Uint8Array(o));else{let s=await this._prim.serializePublicKey(t.senderPublicKey);a=new Uint8Array(t.enc.byteLength+o.byteLength+s.byteLength),a.set(new Uint8Array(t.enc),0),a.set(new Uint8Array(o),t.enc.byteLength),a.set(new Uint8Array(s),t.enc.byteLength+o.byteLength)}return await this._generateSharedSecret(c,a)}catch(c){throw new zt(c)}}async _generateSharedSecret(t,n){let r=this._kdf.buildLabeledIkm(kn,t),i=this._kdf.buildLabeledInfo(Tn,n,this.secretSize);return await this._kdf.extractAndExpand(et,r,i,this.secretSize)}};var $t=BigInt(4294967295),ae=BigInt(32);function ze(e,t=!1){return t?{h:Number(e&$t),l:Number(e>>ae&$t)}:{h:Number(e>>ae&$t)|0,l:Number(e&$t)|0}}function Cn(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:o,l:c}=ze(e[i],t);[n[i],r[i]]=[o,c]}return[n,r]}var Rn=(e,t)=>BigInt(e>>>0)<<ae|BigInt(t>>>0),Nn=(e,t,n)=>e>>>n,Dn=(e,t,n)=>e<<32-n|t>>>n,zn=(e,t,n)=>e>>>n|t<<32-n,qn=(e,t,n)=>e<<32-n|t>>>n,Mn=(e,t,n)=>e<<64-n|t>>>n-32,Gn=(e,t,n)=>e>>>n-32|t<<64-n,Fn=(e,t)=>t,jn=(e,t)=>e,$n=(e,t,n)=>e<<n|t>>>32-n,Zn=(e,t,n)=>t<<n|e>>>32-n,Vn=(e,t,n)=>t<<n-32|e>>>64-n,Xn=(e,t,n)=>e<<n-32|t>>>64-n;function Yn(e,t,n,r){let i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:i|0}}var Wn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Qn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Jn=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),tr=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,er=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),nr=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0;var rr={fromBig:ze,split:Cn,toBig:Rn,shrSH:Nn,shrSL:Dn,rotrSH:zn,rotrSL:qn,rotrBH:Mn,rotrBL:Gn,rotr32H:Fn,rotr32L:jn,rotlSH:$n,rotlSL:Zn,rotlBH:Vn,rotlBL:Xn,add:Yn,add3L:Wn,add3H:Qn,add4L:Jn,add4H:tr,add5H:nr,add5L:er},g=rr;var[ir,or]=g.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ut=new Uint32Array(80),lt=new Uint32Array(80),fe=class extends wt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:i,Ch:o,Cl:c,Dh:a,Dl:s,Eh:u,El:f,Fh:h,Fl:b,Gh:B,Gl:I,Hh:L,Hl:S}=this;return[t,n,r,i,o,c,a,s,u,f,h,b,B,I,L,S]}set(t,n,r,i,o,c,a,s,u,f,h,b,B,I,L,S){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=i|0,this.Ch=o|0,this.Cl=c|0,this.Dh=a|0,this.Dl=s|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=b|0,this.Gh=B|0,this.Gl=I|0,this.Hh=L|0,this.Hl=S|0}process(t,n){for(let d=0;d<16;d++,n+=4)ut[d]=t.getUint32(n),lt[d]=t.getUint32(n+=4);for(let d=16;d<80;d++){let A=ut[d-15]|0,x=lt[d-15]|0,R=g.rotrSH(A,x,1)^g.rotrSH(A,x,8)^g.shrSH(A,x,7),X=g.rotrSL(A,x,1)^g.rotrSL(A,x,8)^g.shrSL(A,x,7),K=ut[d-2]|0,T=lt[d-2]|0,q=g.rotrSH(K,T,19)^g.rotrBH(K,T,61)^g.shrSH(K,T,6),N=g.rotrSL(K,T,19)^g.rotrBL(K,T,61)^g.shrSL(K,T,6),j=g.add4L(X,N,lt[d-7],lt[d-16]),O=g.add4H(j,R,q,ut[d-7],ut[d-16]);ut[d]=O|0,lt[d]=j|0}let{Ah:r,Al:i,Bh:o,Bl:c,Ch:a,Cl:s,Dh:u,Dl:f,Eh:h,El:b,Fh:B,Fl:I,Gh:L,Gl:S,Hh:z,Hl:F}=this;for(let d=0;d<80;d++){let A=g.rotrSH(h,b,14)^g.rotrSH(h,b,18)^g.rotrBH(h,b,41),x=g.rotrSL(h,b,14)^g.rotrSL(h,b,18)^g.rotrBL(h,b,41),R=h&B^~h&L,X=b&I^~b&S,K=g.add5L(F,x,X,or[d],lt[d]),T=g.add5H(K,z,A,R,ir[d],ut[d]),q=K|0,N=g.rotrSH(r,i,28)^g.rotrBH(r,i,34)^g.rotrBH(r,i,39),j=g.rotrSL(r,i,28)^g.rotrBL(r,i,34)^g.rotrBL(r,i,39),O=r&o^r&a^o&a,At=i&c^i&s^c&s;z=L|0,F=S|0,L=B|0,S=I|0,B=h|0,I=b|0,{h,l:b}=g.add(u|0,f|0,T|0,q|0),u=a|0,f=s|0,a=o|0,s=c|0,o=r|0,c=i|0;let st=g.add3L(q,j,At);r=g.add3H(st,T,N,O),i=st|0}({h:r,l:i}=g.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:o,l:c}=g.add(this.Bh|0,this.Bl|0,o|0,c|0),{h:a,l:s}=g.add(this.Ch|0,this.Cl|0,a|0,s|0),{h:u,l:f}=g.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l:b}=g.add(this.Eh|0,this.El|0,h|0,b|0),{h:B,l:I}=g.add(this.Fh|0,this.Fl|0,B|0,I|0),{h:L,l:S}=g.add(this.Gh|0,this.Gl|0,L|0,S|0),{h:z,l:F}=g.add(this.Hh|0,this.Hl|0,z|0,F|0),this.set(r,i,o,c,a,s,u,f,h,b,B,I,L,S,z,F)}roundClean(){ut.fill(0),lt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var ue=Rt(()=>new fe);var yi=BigInt(0),sr=BigInt(1),cr=BigInt(2);function It(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var ar=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Zt(e){if(!It(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=ar[e[n]];return t}function Me(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}var nt={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function qe(e){if(e>=nt._0&&e<=nt._9)return e-nt._0;if(e>=nt._A&&e<=nt._F)return e-(nt._A-10);if(e>=nt._a&&e<=nt._f)return e-(nt._a-10)}function Ge(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let i=0,o=0;i<n;i++,o+=2){let c=qe(e.charCodeAt(o)),a=qe(e.charCodeAt(o+1));if(c===void 0||a===void 0){let s=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+s+'" at index '+o)}r[i]=c*16+a}return r}function Fe(e){return Me(Zt(e))}function rt(e){if(!It(e))throw new Error("Uint8Array expected");return Me(Zt(Uint8Array.from(e).reverse()))}function le(e,t){return Ge(e.toString(16).padStart(t*2,"0"))}function pt(e,t){return le(e,t).reverse()}function $(e,t,n){let r;if(typeof t=="string")try{r=Ge(t)}catch(o){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${o}`)}else if(It(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=r.length;if(typeof n=="number"&&i!==n)throw new Error(`${e} expected ${n} bytes, got ${i}`);return r}function he(...e){let t=0;for(let i=0;i<e.length;i++){let o=e[i];if(!It(o))throw new Error("Uint8Array expected");t+=o.length}let n=new Uint8Array(t),r=0;for(let i=0;i<e.length;i++){let o=e[i];n.set(o,r),r+=o.length}return n}var je=e=>(cr<<BigInt(e-1))-sr;var fr={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||It(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function ht(e,t,n={}){let r=(i,o,c)=>{let a=fr[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let s=e[i];if(!(c&&s===void 0)&&!a(s,e))throw new Error(`Invalid param ${String(i)}=${s} (${typeof s}), expected ${o}`)};for(let[i,o]of Object.entries(t))r(i,o,!1);for(let[i,o]of Object.entries(n))r(i,o,!0);return e}var C=BigInt(0),k=BigInt(1),bt=BigInt(2),lr=BigInt(3),de=BigInt(4),$e=BigInt(5),Ze=BigInt(8),hr=BigInt(9),dr=BigInt(16);function U(e,t){let n=e%t;return n>=C?n:t+n}function pe(e,t,n){if(n<=C||t<C)throw new Error("Expected power/modulo > 0");if(n===k)return C;let r=k;for(;t>C;)t&k&&(r=r*e%n),e=e*e%n,t>>=k;return r}function V(e,t,n){let r=e;for(;t-- >C;)r*=r,r%=n;return r}function Ve(e,t){if(e===C||t<=C)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=U(e,t),r=t,i=C,o=k,c=k,a=C;for(;n!==C;){let u=r/n,f=r%n,h=i-c*u,b=o-a*u;r=n,n=f,i=c,o=a,c=h,a=b}if(r!==k)throw new Error("invert: does not exist");return U(i,t)}function pr(e){let t=(e-k)/bt,n,r,i;for(n=e-k,r=0;n%bt===C;n/=bt,r++);for(i=bt;i<e&&pe(i,t,e)!==e-k;i++);if(r===1){let c=(e+k)/de;return function(s,u){let f=s.pow(u,c);if(!s.eql(s.sqr(f),u))throw new Error("Cannot find square root");return f}}let o=(n+k)/bt;return function(a,s){if(a.pow(s,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=r,f=a.pow(a.mul(a.ONE,i),n),h=a.pow(s,o),b=a.pow(s,n);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let B=1;for(let L=a.sqr(b);B<u&&!a.eql(L,a.ONE);B++)L=a.sqr(L);let I=a.pow(f,k<<BigInt(u-B-1));f=a.sqr(I),h=a.mul(h,I),b=a.mul(b,f),u=B}return h}}function br(e){if(e%de===lr){let t=(e+k)/de;return function(r,i){let o=r.pow(i,t);if(!r.eql(r.sqr(o),i))throw new Error("Cannot find square root");return o}}if(e%Ze===$e){let t=(e-$e)/Ze;return function(r,i){let o=r.mul(i,bt),c=r.pow(o,t),a=r.mul(i,c),s=r.mul(r.mul(a,bt),c),u=r.mul(a,r.sub(s,r.ONE));if(!r.eql(r.sqr(u),i))throw new Error("Cannot find square root");return u}}return e%dr,pr(e)}var Xe=(e,t)=>(U(e,t)&k)===k,yr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ye(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=yr.reduce((r,i)=>(r[i]="function",r),t);return ht(e,n)}function xr(e,t,n){if(n<C)throw new Error("Expected power > 0");if(n===C)return e.ONE;if(n===k)return t;let r=e.ONE,i=t;for(;n>C;)n&k&&(r=e.mul(r,i)),i=e.sqr(i),n>>=k;return r}function wr(e,t){let n=new Array(t.length),r=t.reduce((o,c,a)=>e.is0(c)?o:(n[a]=o,e.mul(o,c)),e.ONE),i=e.inv(r);return t.reduceRight((o,c,a)=>e.is0(c)?o:(n[a]=e.mul(o,n[a]),e.mul(o,c)),i),n}function be(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function We(e,t,n=!1,r={}){if(e<=C)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:o}=be(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let c=br(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:je(i),ZERO:C,ONE:k,create:s=>U(s,e),isValid:s=>{if(typeof s!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof s}`);return C<=s&&s<e},is0:s=>s===C,isOdd:s=>(s&k)===k,neg:s=>U(-s,e),eql:(s,u)=>s===u,sqr:s=>U(s*s,e),add:(s,u)=>U(s+u,e),sub:(s,u)=>U(s-u,e),mul:(s,u)=>U(s*u,e),pow:(s,u)=>xr(a,s,u),div:(s,u)=>U(s*Ve(u,e),e),sqrN:s=>s*s,addN:(s,u)=>s+u,subN:(s,u)=>s-u,mulN:(s,u)=>s*u,inv:s=>Ve(s,e),sqrt:r.sqrt||(s=>c(a,s)),invertBatch:s=>wr(a,s),cmov:(s,u,f)=>f?u:s,toBytes:s=>n?pt(s,o):le(s,o),fromBytes:s=>{if(s.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${s.length}`);return n?rt(s):Fe(s)}});return Object.freeze(a)}function Qe(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}var gr=BigInt(0),ye=BigInt(1);function Je(e,t){let n=(i,o)=>{let c=o.negate();return i?c:o},r=i=>{let o=Math.ceil(t/i)+1,c=2**(i-1);return{windows:o,windowSize:c}};return{constTimeNegate:n,unsafeLadder(i,o){let c=e.ZERO,a=i;for(;o>gr;)o&ye&&(c=c.add(a)),a=a.double(),o>>=ye;return c},precomputeWindow(i,o){let{windows:c,windowSize:a}=r(o),s=[],u=i,f=u;for(let h=0;h<c;h++){f=u,s.push(f);for(let b=1;b<a;b++)f=f.add(u),s.push(f);u=f.double()}return s},wNAF(i,o,c){let{windows:a,windowSize:s}=r(i),u=e.ZERO,f=e.BASE,h=BigInt(2**i-1),b=2**i,B=BigInt(i);for(let I=0;I<a;I++){let L=I*s,S=Number(c&h);c>>=B,S>s&&(S-=b,c+=ye);let z=L,F=L+Math.abs(S)-1,d=I%2!==0,A=S<0;S===0?f=f.add(n(d,o[z])):u=u.add(n(A,o[F]))}return{p:u,f}},wNAFCached(i,o,c,a){let s=i._WINDOW_SIZE||1,u=o.get(i);return u||(u=this.precomputeWindow(i,s),s!==1&&o.set(i,a(u))),this.wNAF(s,u,c)}}}function tn(e){return Ye(e.Fp),ht(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...be(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}var W=BigInt(0),Z=BigInt(1),Vt=BigInt(2),mr=BigInt(8),Er={zip215:!0};function _r(e){let t=tn(e);return ht(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function xe(e){let t=_r(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:c,nByteLength:a,h:s}=t,u=Vt<<BigInt(a*8)-Z,f=n.create,h=t.uvRatio||((p,l)=>{try{return{isValid:!0,value:n.sqrt(p*n.inv(l))}}catch{return{isValid:!1,value:W}}}),b=t.adjustScalarBytes||(p=>p),B=t.domain||((p,l,y)=>{if(l.length||y)throw new Error("Contexts/pre-hash are not supported");return p}),I=p=>typeof p=="bigint"&&W<p,L=(p,l)=>I(p)&&I(l)&&p<l,S=p=>p===W||L(p,u);function z(p,l){if(L(p,l))return p;throw new Error(`Expected valid scalar < ${l}, got ${typeof p} ${p}`)}function F(p){return p===W?p:z(p,r)}let d=new Map;function A(p){if(!(p instanceof x))throw new Error("ExtendedPoint expected")}class x{constructor(l,y,w,m){if(this.ex=l,this.ey=y,this.ez=w,this.et=m,!S(l))throw new Error("x required");if(!S(y))throw new Error("y required");if(!S(w))throw new Error("z required");if(!S(m))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(l){if(l instanceof x)throw new Error("extended point not allowed");let{x:y,y:w}=l||{};if(!S(y)||!S(w))throw new Error("invalid affine point");return new x(y,w,Z,f(y*w))}static normalizeZ(l){let y=n.invertBatch(l.map(w=>w.ez));return l.map((w,m)=>w.toAffine(y[m])).map(x.fromAffine)}_setWindowSize(l){this._WINDOW_SIZE=l,d.delete(this)}assertValidity(){let{a:l,d:y}=t;if(this.is0())throw new Error("bad point: ZERO");let{ex:w,ey:m,ez:E,et:v}=this,P=f(w*w),_=f(m*m),H=f(E*E),D=f(H*H),M=f(P*l),Q=f(H*f(M+_)),G=f(D+f(y*f(P*_)));if(Q!==G)throw new Error("bad point: equation left != right (1)");let ct=f(w*m),J=f(E*v);if(ct!==J)throw new Error("bad point: equation left != right (2)")}equals(l){A(l);let{ex:y,ey:w,ez:m}=this,{ex:E,ey:v,ez:P}=l,_=f(y*P),H=f(E*m),D=f(w*P),M=f(v*m);return _===H&&D===M}is0(){return this.equals(x.ZERO)}negate(){return new x(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:l}=t,{ex:y,ey:w,ez:m}=this,E=f(y*y),v=f(w*w),P=f(Vt*f(m*m)),_=f(l*E),H=y+w,D=f(f(H*H)-E-v),M=_+v,Q=M-P,G=_-v,ct=f(D*Q),J=f(M*G),kt=f(D*G),Tt=f(Q*M);return new x(ct,J,Tt,kt)}add(l){A(l);let{a:y,d:w}=t,{ex:m,ey:E,ez:v,et:P}=this,{ex:_,ey:H,ez:D,et:M}=l;if(y===BigInt(-1)){let Be=f((E-m)*(H+_)),Ae=f((E+m)*(H-_)),Wt=f(Ae-Be);if(Wt===W)return this.double();let ve=f(v*Vt*M),Se=f(P*Vt*D),Ie=Se+ve,Le=Ae+Be,He=Se-ve,yn=f(Ie*Wt),xn=f(Le*He),wn=f(Ie*He),gn=f(Wt*Le);return new x(yn,xn,gn,wn)}let Q=f(m*_),G=f(E*H),ct=f(P*w*M),J=f(v*D),kt=f((m+E)*(_+H)-Q-G),Tt=J-ct,Ee=J+ct,_e=f(G-y*Q),hn=f(kt*Tt),dn=f(Ee*_e),pn=f(kt*_e),bn=f(Tt*Ee);return new x(hn,dn,bn,pn)}subtract(l){return this.add(l.negate())}wNAF(l){return K.wNAFCached(this,d,l,x.normalizeZ)}multiply(l){let{p:y,f:w}=this.wNAF(z(l,r));return x.normalizeZ([y,w])[0]}multiplyUnsafe(l){let y=F(l);return y===W?X:this.equals(X)||y===Z?this:this.equals(R)?this.wNAF(y).p:K.unsafeLadder(this,y)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}isTorsionFree(){return K.unsafeLadder(this,r).is0()}toAffine(l){let{ex:y,ey:w,ez:m}=this,E=this.is0();l==null&&(l=E?mr:n.inv(m));let v=f(y*l),P=f(w*l),_=f(m*l);if(E)return{x:W,y:Z};if(_!==Z)throw new Error("invZ was invalid");return{x:v,y:P}}clearCofactor(){let{h:l}=t;return l===Z?this:this.multiplyUnsafe(l)}static fromHex(l,y=!1){let{d:w,a:m}=t,E=n.BYTES;l=$("pointHex",l,E);let v=l.slice(),P=l[E-1];v[E-1]=P&-129;let _=rt(v);_===W||(y?z(_,u):z(_,n.ORDER));let H=f(_*_),D=f(H-Z),M=f(w*H-m),{isValid:Q,value:G}=h(D,M);if(!Q)throw new Error("Point.fromHex: invalid y coordinate");let ct=(G&Z)===Z,J=(P&128)!==0;if(!y&&G===W&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==ct&&(G=f(-G)),x.fromAffine({x:G,y:_})}static fromPrivateKey(l){return N(l).point}toRawBytes(){let{x:l,y}=this.toAffine(),w=pt(y,n.BYTES);return w[w.length-1]|=l&Z?128:0,w}toHex(){return Zt(this.toRawBytes())}}x.BASE=new x(t.Gx,t.Gy,Z,f(t.Gx*t.Gy)),x.ZERO=new x(W,Z,Z,W);let{BASE:R,ZERO:X}=x,K=Je(x,a*8);function T(p){return U(p,r)}function q(p){return T(rt(p))}function N(p){let l=a;p=$("private key",p,l);let y=$("hashed private key",o(p),2*l),w=b(y.slice(0,l)),m=y.slice(l,2*l),E=q(w),v=R.multiply(E),P=v.toRawBytes();return{head:w,prefix:m,scalar:E,point:v,pointBytes:P}}function j(p){return N(p).pointBytes}function O(p=new Uint8Array,...l){let y=he(...l);return q(o(B(y,$("context",p),!!i)))}function At(p,l,y={}){p=$("message",p),i&&(p=i(p));let{prefix:w,scalar:m,pointBytes:E}=N(l),v=O(y.context,w,p),P=R.multiply(v).toRawBytes(),_=O(y.context,P,E,p),H=T(v+_*m);F(H);let D=he(P,pt(H,n.BYTES));return $("result",D,a*2)}let st=Er;function Ut(p,l,y,w=st){let{context:m,zip215:E}=w,v=n.BYTES;p=$("signature",p,2*v),l=$("message",l),i&&(l=i(l));let P=rt(p.slice(v,2*v)),_,H,D;try{_=x.fromHex(y,E),H=x.fromHex(p.slice(0,v),E),D=R.multiplyUnsafe(P)}catch{return!1}if(!E&&_.isSmallOrder())return!1;let M=O(m,H.toRawBytes(),_.toRawBytes(),l);return H.add(_.multiplyUnsafe(M)).subtract(D).clearCofactor().equals(x.ZERO)}return R._setWindowSize(8),{CURVE:t,getPublicKey:j,sign:At,verify:Ut,ExtendedPoint:x,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>c(n.BYTES),precompute(p=8,l=x.BASE){return l._setWindowSize(p),l.multiply(BigInt(3)),l}}}}var Lt=BigInt(0),we=BigInt(1);function Br(e){return ht(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function en(e){let t=Br(e),{P:n}=t,r=d=>U(d,n),i=t.montgomeryBits,o=Math.ceil(i/8),c=t.nByteLength,a=t.adjustScalarBytes||(d=>d),s=t.powPminus2||(d=>pe(d,n-BigInt(2),n));function u(d,A,x){let R=r(d*(A-x));return A=r(A-R),x=r(x+R),[A,x]}function f(d){if(typeof d=="bigint"&&Lt<=d&&d<n)return d;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(t.a-BigInt(2))/BigInt(4);function b(d,A){let x=f(d),R=f(A),X=x,K=we,T=Lt,q=x,N=we,j=Lt,O;for(let st=BigInt(i-1);st>=Lt;st--){let Ut=R>>st&we;j^=Ut,O=u(j,K,q),K=O[0],q=O[1],O=u(j,T,N),T=O[0],N=O[1],j=Ut;let Kt=K+T,p=r(Kt*Kt),l=K-T,y=r(l*l),w=p-y,m=q+N,E=q-N,v=r(E*Kt),P=r(m*l),_=v+P,H=v-P;q=r(_*_),N=r(X*r(H*H)),K=r(p*y),T=r(w*(p+r(h*w)))}O=u(j,K,q),K=O[0],q=O[1],O=u(j,T,N),T=O[0],N=O[1];let At=s(T);return r(K*At)}function B(d){return pt(r(d),o)}function I(d){let A=$("u coordinate",d,o);return c===32&&(A[31]&=127),rt(A)}function L(d){let A=$("scalar",d),x=A.length;if(x!==o&&x!==c)throw new Error(`Expected ${o} or ${c} bytes, got ${x}`);return rt(a(A))}function S(d,A){let x=I(A),R=L(d),X=b(x,R);if(X===Lt)throw new Error("Invalid private or public key received");return B(X)}let z=B(t.Gu);function F(d){return S(d,z)}return{scalarMult:S,scalarMultBase:F,getSharedSecret:(d,A)=>S(d,A),getPublicKey:d=>F(d),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:z}}var Ht=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),nn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ti=BigInt(0),Ar=BigInt(1),ge=BigInt(2),vr=BigInt(5),rn=BigInt(10),Sr=BigInt(20),Ir=BigInt(40),on=BigInt(80);function sn(e){let t=Ht,r=e*e%t*e%t,i=V(r,ge,t)*r%t,o=V(i,Ar,t)*e%t,c=V(o,vr,t)*o%t,a=V(c,rn,t)*c%t,s=V(a,Sr,t)*a%t,u=V(s,Ir,t)*s%t,f=V(u,on,t)*u%t,h=V(f,on,t)*u%t,b=V(h,rn,t)*c%t;return{pow_p_5_8:V(b,ge,t)*e%t,b2:r}}function cn(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Lr(e,t){let n=Ht,r=U(t*t*t,n),i=U(r*r*t,n),o=sn(e*i).pow_p_5_8,c=U(e*r*o,n),a=U(t*c*c,n),s=c,u=U(c*nn,n),f=a===e,h=a===U(-e,n),b=a===U(-e*nn,n);return f&&(c=s),(h||b)&&(c=u),Xe(c,n)&&(c=U(-c,n)),{isValid:f||h,value:c}}var it=We(Ht,void 0,!0),an={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:it,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:ue,randomBytes:ne,adjustScalarBytes:cn,uvRatio:Lr};function fn(e,t,n){if(t.length>255)throw new Error("Context is too big");return Te(ee("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}var Oi=xe({...an,domain:fn}),Ci=xe({...an,domain:fn,prehash:ue}),Xt=en({P:Ht,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=Ht,{pow_p_5_8:n,b2:r}=sn(e);return U(V(n,BigInt(3),t)*r,t)},adjustScalarBytes:cn,randomBytes:ne});var Hr=(it.ORDER+BigInt(3))/BigInt(8),Ri=it.pow(ge,Hr),Ni=it.sqrt(it.neg(it.ONE)),Di=(it.ORDER-BigInt(5))/BigInt(8),zi=BigInt(486662);var qi=Qe(it,it.neg(BigInt(486664)));var Mi=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Gi=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Fi=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ji=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var $i=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Pt=["deriveBits"],un=new Uint8Array([100,107,112,95,112,114,107]),ln=new Uint8Array([115,107]);var ot=class{constructor(t,n,r,i=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=n,this.type=r,this.algorithm={name:t},this.usages=i,r==="public"&&(this.usages=[])}};var Bt="X25519",Yt=class{constructor(t){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._nPk=32,this._nSk=32}async serializePublicKey(t){try{return await this._serializePublicKey(t)}catch(n){throw new mt(n)}}async deserializePublicKey(t){try{return await this._importRawKey(t,!0)}catch(n){throw new dt(n)}}async serializePrivateKey(t){try{return await this._serializePrivateKey(t)}catch(n){throw new mt(n)}}async deserializePrivateKey(t){try{return await this._importRawKey(t,!1)}catch(n){throw new dt(n)}}async importKey(t,n,r){try{if(t==="raw")return await this._importRawKey(n,r);if(n instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(n,r)}catch(i){throw new dt(i)}}async generateKeyPair(){try{let t=Xt.utils.randomPrivateKey(),n=new ot(Bt,t,"private",Pt);return{publicKey:await this.derivePublicKey(n),privateKey:n}}catch(t){throw new Et(t)}}async deriveKeyPair(t){try{let n=await this._hkdf.labeledExtract(et,un,new Uint8Array(t)),r=await this._hkdf.labeledExpand(n,ln,et,this._nSk),i=new ot(Bt,new Uint8Array(r),"private",Pt);return{privateKey:i,publicKey:await this.derivePublicKey(i)}}catch(n){throw new qt(n)}}async derivePublicKey(t){try{return await this._derivePublicKey(t)}catch(n){throw new dt(n)}}async dh(t,n){try{return await this._dh(t,n)}catch(r){throw new mt(r)}}_serializePublicKey(t){return new Promise(n=>{n(t.key.buffer)})}_serializePrivateKey(t){return new Promise(n=>{n(t.key.buffer)})}_importRawKey(t,n){return new Promise((r,i)=>{n&&t.byteLength!==this._nPk&&i(new Error("Invalid length of the key")),!n&&t.byteLength!==this._nSk&&i(new Error("Invalid length of the key")),r(new ot(Bt,new Uint8Array(t),n?"public":"private",n?[]:Pt))})}_importJWK(t,n){return new Promise((r,i)=>{(typeof t.kty>"u"||t.kty!=="OKP")&&i(new Error(`Invalid kty: ${t.kty}`)),(typeof t.crv>"u"||t.crv!=="X25519")&&i(new Error(`Invalid crv: ${t.crv}`)),n?(typeof t.d<"u"&&i(new Error("Invalid key: `d` should not be set")),typeof t.x>"u"&&i(new Error("Invalid key: `x` not found")),r(new ot(Bt,ce(t.x),"public"))):(typeof t.d!="string"&&i(new Error("Invalid key: `d` not found")),r(new ot(Bt,ce(t.d),"private",Pt)))})}_derivePublicKey(t){return new Promise((n,r)=>{try{let i=Xt.getPublicKey(t.key);n(new ot(Bt,i,"public"))}catch(i){r(i)}})}_dh(t,n){return new Promise((r,i)=>{try{r(Xt.getSharedSecret(t.key,n.key).buffer)}catch(o){i(o)}})}};var me=class extends jt{constructor(){let t=new Ft;super(Qt.DhkemX25519HkdfSha256,new Yt(t),t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:Qt.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};export{me as DhkemX25519HkdfSha256};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
