var gs=Object.create;var Un=Object.defineProperty;var ms=Object.getOwnPropertyDescriptor;var _s=Object.getOwnPropertyNames;var Es=Object.getPrototypeOf,vs=Object.prototype.hasOwnProperty;var Te=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Ss=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _s(e))!vs.call(r,i)&&i!==t&&Un(r,i,{get:()=>e[i],enumerable:!(n=ms(e,i))||n.enumerable});return r};var On=(r,e,t)=>(t=r!=null?gs(Es(r)):{},Ss(e||!r||!r.__esModule?Un(t,"default",{value:r,enumerable:!0}):t,r));var ti=Te(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});function Ps(r,e){var t=r>>>16&65535,n=r&65535,i=e>>>16&65535,s=e&65535;return n*s+(t*s+n*i<<16>>>0)|0}ye.mul=Math.imul||Ps;function Is(r,e){return r+e|0}ye.add=Is;function Ls(r,e){return r-e|0}ye.sub=Ls;function Us(r,e){return r<<e|r>>>32-e}ye.rotl=Us;function Os(r,e){return r<<32-e|r>>>e}ye.rotr=Os;function Hs(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}ye.isInteger=Number.isInteger||Hs;ye.MAX_SAFE_INTEGER=9007199254740991;ye.isSafeInteger=function(r){return ye.isInteger(r)&&r>=-ye.MAX_SAFE_INTEGER&&r<=ye.MAX_SAFE_INTEGER}});var Vr=Te(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});var ri=ti();function Ks(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}R.readInt16BE=Ks;function Ts(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}R.readUint16BE=Ts;function Ns(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}R.readInt16LE=Ns;function zs(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}R.readUint16LE=zs;function ni(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}R.writeUint16BE=ni;R.writeInt16BE=ni;function ii(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}R.writeUint16LE=ii;R.writeInt16LE=ii;function Mr(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}R.readInt32BE=Mr;function Gr(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}R.readUint32BE=Gr;function Fr(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}R.readInt32LE=Fr;function Zr(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}R.readUint32LE=Zr;function er(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}R.writeUint32BE=er;R.writeInt32BE=er;function tr(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}R.writeUint32LE=tr;R.writeInt32LE=tr;function Ds(r,e){e===void 0&&(e=0);var t=Mr(r,e),n=Mr(r,e+4);return t*4294967296+n-(n>>31)*4294967296}R.readInt64BE=Ds;function Cs(r,e){e===void 0&&(e=0);var t=Gr(r,e),n=Gr(r,e+4);return t*4294967296+n}R.readUint64BE=Cs;function Rs(r,e){e===void 0&&(e=0);var t=Fr(r,e),n=Fr(r,e+4);return n*4294967296+t-(t>>31)*4294967296}R.readInt64LE=Rs;function js(r,e){e===void 0&&(e=0);var t=Zr(r,e),n=Zr(r,e+4);return n*4294967296+t}R.readUint64LE=js;function si(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),er(r/4294967296>>>0,e,t),er(r>>>0,e,t+4),e}R.writeUint64BE=si;R.writeInt64BE=si;function oi(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),tr(r>>>0,e,t),tr(r/4294967296>>>0,e,t+4),e}R.writeUint64LE=oi;R.writeInt64LE=oi;function qs(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=r/8+t-1;s>=t;s--)n+=e[s]*i,i*=256;return n}R.readUintBE=qs;function Ms(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=t;s<t+r/8;s++)n+=e[s]*i,i*=256;return n}R.readUintLE=Ms;function Gs(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ri.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=r/8+n-1;s>=n;s--)t[s]=e/i&255,i*=256;return t}R.writeUintBE=Gs;function Fs(r,e,t,n){if(t===void 0&&(t=new Uint8Array(r/8)),n===void 0&&(n=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ri.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+r/8;s++)t[s]=e/i&255,i*=256;return t}R.writeUintLE=Fs;function Zs(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}R.readFloat32BE=Zs;function Vs(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}R.readFloat32LE=Vs;function Xs(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}R.readFloat64BE=Xs;function $s(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}R.readFloat64LE=$s;function Ys(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r),e}R.writeFloat32BE=Ys;function Ws(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(t,r,!0),e}R.writeFloat32LE=Ws;function Qs(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r),e}R.writeFloat64BE=Qs;function Js(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(t,r,!0),e}R.writeFloat64LE=Js});var rr=Te(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});function eo(r){for(var e=0;e<r.length;e++)r[e]=0;return r}Xr.wipe=eo});var ci=Te(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});var ae=Vr(),$r=rr(),to=20;function ro(r,e,t){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,o=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],h=t[19]<<24|t[18]<<16|t[17]<<8|t[16],l=t[23]<<24|t[22]<<16|t[21]<<8|t[20],p=t[27]<<24|t[26]<<16|t[25]<<8|t[24],x=t[31]<<24|t[30]<<16|t[29]<<8|t[28],S=e[3]<<24|e[2]<<16|e[1]<<8|e[0],k=e[7]<<24|e[6]<<16|e[5]<<8|e[4],N=e[11]<<24|e[10]<<16|e[9]<<8|e[8],j=e[15]<<24|e[14]<<16|e[13]<<8|e[12],b=n,_=i,y=s,K=a,H=o,A=c,U=u,D=f,M=h,$=l,C=p,ee=x,G=S,Y=k,g=N,w=j,d=0;d<to;d+=2)b=b+H|0,G^=b,G=G>>>32-16|G<<16,M=M+G|0,H^=M,H=H>>>32-12|H<<12,_=_+A|0,Y^=_,Y=Y>>>32-16|Y<<16,$=$+Y|0,A^=$,A=A>>>32-12|A<<12,y=y+U|0,g^=y,g=g>>>32-16|g<<16,C=C+g|0,U^=C,U=U>>>32-12|U<<12,K=K+D|0,w^=K,w=w>>>32-16|w<<16,ee=ee+w|0,D^=ee,D=D>>>32-12|D<<12,y=y+U|0,g^=y,g=g>>>32-8|g<<8,C=C+g|0,U^=C,U=U>>>32-7|U<<7,K=K+D|0,w^=K,w=w>>>32-8|w<<8,ee=ee+w|0,D^=ee,D=D>>>32-7|D<<7,_=_+A|0,Y^=_,Y=Y>>>32-8|Y<<8,$=$+Y|0,A^=$,A=A>>>32-7|A<<7,b=b+H|0,G^=b,G=G>>>32-8|G<<8,M=M+G|0,H^=M,H=H>>>32-7|H<<7,b=b+A|0,w^=b,w=w>>>32-16|w<<16,C=C+w|0,A^=C,A=A>>>32-12|A<<12,_=_+U|0,G^=_,G=G>>>32-16|G<<16,ee=ee+G|0,U^=ee,U=U>>>32-12|U<<12,y=y+D|0,Y^=y,Y=Y>>>32-16|Y<<16,M=M+Y|0,D^=M,D=D>>>32-12|D<<12,K=K+H|0,g^=K,g=g>>>32-16|g<<16,$=$+g|0,H^=$,H=H>>>32-12|H<<12,y=y+D|0,Y^=y,Y=Y>>>32-8|Y<<8,M=M+Y|0,D^=M,D=D>>>32-7|D<<7,K=K+H|0,g^=K,g=g>>>32-8|g<<8,$=$+g|0,H^=$,H=H>>>32-7|H<<7,_=_+U|0,G^=_,G=G>>>32-8|G<<8,ee=ee+G|0,U^=ee,U=U>>>32-7|U<<7,b=b+A|0,w^=b,w=w>>>32-8|w<<8,C=C+w|0,A^=C,A=A>>>32-7|A<<7;ae.writeUint32LE(b+n|0,r,0),ae.writeUint32LE(_+i|0,r,4),ae.writeUint32LE(y+s|0,r,8),ae.writeUint32LE(K+a|0,r,12),ae.writeUint32LE(H+o|0,r,16),ae.writeUint32LE(A+c|0,r,20),ae.writeUint32LE(U+u|0,r,24),ae.writeUint32LE(D+f|0,r,28),ae.writeUint32LE(M+h|0,r,32),ae.writeUint32LE($+l|0,r,36),ae.writeUint32LE(C+p|0,r,40),ae.writeUint32LE(ee+x|0,r,44),ae.writeUint32LE(G+S|0,r,48),ae.writeUint32LE(Y+k|0,r,52),ae.writeUint32LE(g+N|0,r,56),ae.writeUint32LE(w+j|0,r,60)}function ai(r,e,t,n,i){if(i===void 0&&(i=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=i}for(var o=new Uint8Array(64),c=0;c<t.length;c+=64){ro(o,s,r);for(var u=c;u<c+64&&u<t.length;u++)n[u]=t[u]^o[u-c];io(s,0,a)}return $r.wipe(o),i===0&&$r.wipe(s),n}nr.streamXOR=ai;function no(r,e,t,n){return n===void 0&&(n=0),$r.wipe(t),ai(r,e,t,t,n)}nr.stream=no;function io(r,e,t){for(var n=1;t--;)n=n+(r[e]&255)|0,r[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}});var Yr=Te(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});function so(r,e,t){return~(r-1)&e|r-1&t}ft.select=so;function oo(r,e){return(r|0)-(e|0)-1>>>31&1}ft.lessOrEqual=oo;function ui(r,e){if(r.length!==e.length)return 0;for(var t=0,n=0;n<r.length;n++)t|=r[n]^e[n];return 1&t-1>>>8}ft.compare=ui;function ao(r,e){return r.length===0||e.length===0?!1:ui(r,e)!==0}ft.equal=ao});var hi=Te(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});var co=Yr(),ir=rr();Ie.DIGEST_LENGTH=16;var fi=function(){function r(e){this.digestLength=Ie.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var n=e[2]|e[3]<<8;this._r[1]=(t>>>13|n<<3)&8191;var i=e[4]|e[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var a=e[8]|e[9]<<8;this._r[4]=(s>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var o=e[10]|e[11]<<8;this._r[6]=(a>>>14|o<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(o>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,n){for(var i=this._fin?0:2048,s=this._h[0],a=this._h[1],o=this._h[2],c=this._h[3],u=this._h[4],f=this._h[5],h=this._h[6],l=this._h[7],p=this._h[8],x=this._h[9],S=this._r[0],k=this._r[1],N=this._r[2],j=this._r[3],b=this._r[4],_=this._r[5],y=this._r[6],K=this._r[7],H=this._r[8],A=this._r[9];n>=16;){var U=e[t+0]|e[t+1]<<8;s+=U&8191;var D=e[t+2]|e[t+3]<<8;a+=(U>>>13|D<<3)&8191;var M=e[t+4]|e[t+5]<<8;o+=(D>>>10|M<<6)&8191;var $=e[t+6]|e[t+7]<<8;c+=(M>>>7|$<<9)&8191;var C=e[t+8]|e[t+9]<<8;u+=($>>>4|C<<12)&8191,f+=C>>>1&8191;var ee=e[t+10]|e[t+11]<<8;h+=(C>>>14|ee<<2)&8191;var G=e[t+12]|e[t+13]<<8;l+=(ee>>>11|G<<5)&8191;var Y=e[t+14]|e[t+15]<<8;p+=(G>>>8|Y<<8)&8191,x+=Y>>>5|i;var g=0,w=g;w+=s*S,w+=a*(5*A),w+=o*(5*H),w+=c*(5*K),w+=u*(5*y),g=w>>>13,w&=8191,w+=f*(5*_),w+=h*(5*b),w+=l*(5*j),w+=p*(5*N),w+=x*(5*k),g+=w>>>13,w&=8191;var d=g;d+=s*k,d+=a*S,d+=o*(5*A),d+=c*(5*H),d+=u*(5*K),g=d>>>13,d&=8191,d+=f*(5*y),d+=h*(5*_),d+=l*(5*b),d+=p*(5*j),d+=x*(5*N),g+=d>>>13,d&=8191;var m=g;m+=s*N,m+=a*k,m+=o*S,m+=c*(5*A),m+=u*(5*H),g=m>>>13,m&=8191,m+=f*(5*K),m+=h*(5*y),m+=l*(5*_),m+=p*(5*b),m+=x*(5*j),g+=m>>>13,m&=8191;var v=g;v+=s*j,v+=a*N,v+=o*k,v+=c*S,v+=u*(5*A),g=v>>>13,v&=8191,v+=f*(5*H),v+=h*(5*K),v+=l*(5*y),v+=p*(5*_),v+=x*(5*b),g+=v>>>13,v&=8191;var B=g;B+=s*b,B+=a*j,B+=o*N,B+=c*k,B+=u*S,g=B>>>13,B&=8191,B+=f*(5*A),B+=h*(5*H),B+=l*(5*K),B+=p*(5*y),B+=x*(5*_),g+=B>>>13,B&=8191;var P=g;P+=s*_,P+=a*b,P+=o*j,P+=c*N,P+=u*k,g=P>>>13,P&=8191,P+=f*S,P+=h*(5*A),P+=l*(5*H),P+=p*(5*K),P+=x*(5*y),g+=P>>>13,P&=8191;var O=g;O+=s*y,O+=a*_,O+=o*b,O+=c*j,O+=u*N,g=O>>>13,O&=8191,O+=f*k,O+=h*S,O+=l*(5*A),O+=p*(5*H),O+=x*(5*K),g+=O>>>13,O&=8191;var z=g;z+=s*K,z+=a*y,z+=o*_,z+=c*b,z+=u*j,g=z>>>13,z&=8191,z+=f*N,z+=h*k,z+=l*S,z+=p*(5*A),z+=x*(5*H),g+=z>>>13,z&=8191;var I=g;I+=s*H,I+=a*K,I+=o*y,I+=c*_,I+=u*b,g=I>>>13,I&=8191,I+=f*j,I+=h*N,I+=l*k,I+=p*S,I+=x*(5*A),g+=I>>>13,I&=8191;var T=g;T+=s*A,T+=a*H,T+=o*K,T+=c*y,T+=u*_,g=T>>>13,T&=8191,T+=f*b,T+=h*j,T+=l*N,T+=p*k,T+=x*S,g+=T>>>13,T&=8191,g=(g<<2)+g|0,g=g+w|0,w=g&8191,g=g>>>13,d+=g,s=w,a=d,o=m,c=v,u=B,f=P,h=O,l=z,p=I,x=T,t+=16,n-=16}this._h[0]=s,this._h[1]=a,this._h[2]=o,this._h[3]=c,this._h[4]=u,this._h[5]=f,this._h[6]=h,this._h[7]=l,this._h[8]=p,this._h[9]=x},r.prototype.finish=function(e,t){t===void 0&&(t=0);var n=new Uint16Array(10),i,s,a,o;if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=i,i=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,o=1;o<10;o++)n[o]=this._h[o]+i,i=n[o]>>>13,n[o]&=8191;for(n[9]-=8192,s=(i^1)-1,o=0;o<10;o++)n[o]&=s;for(s=~s,o=0;o<10;o++)this._h[o]=this._h[o]&s|n[o];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,o=1;o<8;o++)a=(this._h[o]+this._pad[o]|0)+(a>>>16)|0,this._h[o]=a&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,n=e.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];if(n-=i,t+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(e,t,i),t+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=n}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return ir.wipe(this._buffer),ir.wipe(this._r),ir.wipe(this._h),ir.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();Ie.Poly1305=fi;function uo(r,e){var t=new fi(r);t.update(e);var n=t.digest();return t.clean(),n}Ie.oneTimeAuth=uo;function fo(r,e){return r.length!==Ie.DIGEST_LENGTH||e.length!==Ie.DIGEST_LENGTH?!1:co.equal(r,e)}Ie.equal=fo});var wi=Te(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});var sr=ci(),ho=hi(),St=rr(),li=Vr(),lo=Yr();Le.KEY_LENGTH=32;Le.NONCE_LENGTH=12;Le.TAG_LENGTH=16;var di=new Uint8Array(16),wo=function(){function r(e){if(this.nonceLength=Le.NONCE_LENGTH,this.tagLength=Le.TAG_LENGTH,e.length!==Le.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var a=new Uint8Array(32);sr.stream(this._key,s,a,4);var o=t.length+this.tagLength,c;if(i){if(i.length!==o)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(o);return sr.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),n),St.wipe(s),c},r.prototype.open=function(e,t,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var a=new Uint8Array(32);sr.stream(this._key,s,a,4);var o=new Uint8Array(this.tagLength);if(this._authenticate(o,a,t.subarray(0,t.length-this.tagLength),n),!lo.equal(o,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,u;if(i){if(i.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(c);return sr.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),u,4),St.wipe(s),u},r.prototype.clean=function(){return St.wipe(this._key),this},r.prototype._authenticate=function(e,t,n,i){var s=new ho.Poly1305(t);i&&(s.update(i),i.length%16>0&&s.update(di.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(di.subarray(n.length%16));var a=new Uint8Array(8);i&&li.writeUint64LE(i.length,a),s.update(a),li.writeUint64LE(n.length,a),s.update(a);for(var o=s.digest(),c=0;c<o.length;c++)e[c]=o[c];s.clean(),St.wipe(o),St.wipe(a)},r}();Le.ChaCha20Poly1305=wo});var vi=Te(()=>{});var le=class extends Error{constructor(e){let t;e instanceof Error?t=e.message:typeof e=="string"?t=e:t="",super(t),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message===""?this.message=this.name:this.message=this.name+": "+this.message}},be=class extends le{},Hn=class extends le{},Mt=class extends le{},ot=class extends le{},Gt=class extends le{},Ft=class extends le{},Zt=class extends le{},Ye=class extends le{},We=class extends le{},Vt=class extends le{},Xt=class extends le{},Pe=class extends le{};var _e;(function(r){r[r.Base=0]="Base",r[r.Psk=1]="Psk",r[r.Auth=2]="Auth",r[r.AuthPsk=3]="AuthPsk"})(_e||(_e={}));var q;(function(r){r[r.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",r[r.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",r[r.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",r[r.DhkemSecp256K1HkdfSha256=19]="DhkemSecp256K1HkdfSha256",r[r.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",r[r.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512"})(q||(q={}));var de;(function(r){r[r.HkdfSha256=1]="HkdfSha256",r[r.HkdfSha384=2]="HkdfSha384",r[r.HkdfSha512=3]="HkdfSha512"})(de||(de={}));var te;(function(r){r[r.Aes128Gcm=1]="Aes128Gcm",r[r.Aes256Gcm=2]="Aes256Gcm",r[r.Chacha20Poly1305=3]="Chacha20Poly1305",r[r.ExportOnly=65535]="ExportOnly"})(te||(te={}));var As={},Kn=ks(globalThis,As);function ks(r,e){return new Proxy(r,{get(t,n,i){return n in e?e[n]:r[n]},set(t,n,i){return n in e&&delete e[n],r[n]=i,!0},deleteProperty(t,n){let i=!1;return n in e&&(delete e[n],i=!0),n in r&&(delete r[n],i=!0),i},ownKeys(t){let n=Reflect.ownKeys(r),i=Reflect.ownKeys(e),s=new Set(i);return[...n.filter(a=>!s.has(a)),...i]},defineProperty(t,n,i){return n in e&&delete e[n],Reflect.defineProperty(r,n,i),!0},getOwnPropertyDescriptor(t,n){return n in e?Reflect.getOwnPropertyDescriptor(e,n):Reflect.getOwnPropertyDescriptor(r,n)},has(t,n){return n in e||n in r}})}var Tn=()=>typeof Kn<"u",Nn=()=>typeof caches<"u";var Et=r=>typeof r=="object"&&r!==null&&typeof r.privateKey=="object"&&typeof r.publicKey=="object";function ue(r,e){if(e<=0)throw new Error("i2Osp: too small size");if(r>=256**e)throw new Error("i2Osp: too large integer");let t=new Uint8Array(e);for(let n=0;n<e&&r;n++)t[e-(n+1)]=r%256,r=r>>8;return t}function zn(r,e){if(r.byteLength!==e.byteLength)throw new Error("xor: different length inputs");let t=new Uint8Array(r.byteLength);for(let n=0;n<r.byteLength;n++)t[n]=r[n]^e[n];return t}function vt(r,e){let t=new Uint8Array(r.length+e.length);return t.set(r,0),t.set(e,r.length),t}function Dn(r,e,t){let n=new Uint8Array(r.length+e.length+t.length);return n.set(r,0),n.set(e,r.length),n.set(t,r.length+e.length),n}var Ne=class{constructor(e){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=e}};async function Cn(){if((Tn()||Nn())&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:r}=await import("crypto");return r.subtle}catch{throw new Pe("Web Cryptograph API not supported")}}var ze=["deriveBits"],Rn=["encrypt","decrypt"];var V=new Uint8Array(0),qr=new Uint8Array([72,80,75,69,45,118,49]),jn=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),Je=new Uint8Array([75,69,77,0,0]),De=new Uint8Array([100,107,112,95,112,114,107]),qn=new Uint8Array([101,97,101,95,112,114,107]),Mn=new Uint8Array([105,110,102,111,95,104,97,115,104]),Gn=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),Fn=new Uint8Array([115,101,99,114,101,116]),Zn=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),Vn=new Uint8Array([107,101,121]),Xn=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),$n=new Uint8Array([101,120,112]),Yn=new Uint8Array([115,101,99]),Wn=new Uint8Array([99,97,110,100,105,100,97,116,101]),at=new Uint8Array([115,107]),Qn=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Jn=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),ei=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);var ct=class extends Ne{constructor(e,t,n){super(e),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=t,this.exporterSecret=n}async seal(e,t){return await this._emitError1()}async open(e,t){return await this._emitError1()}async setupBidirectional(e,t){return await this._emitError2()}async export(e,t){if(e.byteLength>128)throw new be("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,Yn,new Uint8Array(e),t)}catch(n){throw new Zt(n)}}_emitError1(){return new Promise((e,t)=>{t(new Pe("Not available on export-only mode"))})}_emitError2(){return new Promise((e,t)=>{t(new Pe("Not available on export-only mode"))})}},$t=class extends ct{},Yt=class extends ct{constructor(e,t,n,i){super(e,t,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i}};var Wt=class{constructor(e,t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=e,this._api=t}async seal(e,t,n){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i={name:"AES-GCM",iv:e,additionalData:n};return await this._api.encrypt(i,this._key,t)}async open(e,t,n){this._key===void 0&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i={name:"AES-GCM",iv:e,additionalData:n};return await this._api.decrypt(i,this._key,t)}async importKey(e){return await this._api.importKey("raw",e,{name:"AES-GCM"},!0,Rn)}},Qt=class extends Wt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}},Jt=class extends Wt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var bi=On(wi(),1);var or=class{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new bi.ChaCha20Poly1305(new Uint8Array(e))}async seal(e,t,n){return await this._seal(e,t,n)}async open(e,t,n){return await this._open(e,t,n)}_seal(e,t,n){return new Promise(i=>{let s=this._key.seal(new Uint8Array(e),new Uint8Array(t),new Uint8Array(n));i(s.buffer)})}_open(e,t,n){return new Promise((i,s)=>{let a=this._key.open(new Uint8Array(e),new Uint8Array(t),new Uint8Array(n));a instanceof Uint8Array?i(a.buffer):s(new Error("failed to open."))})}};var ht=class extends ct{constructor(e,t,n){if(super(e,t,n.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.key===void 0||n.baseNonce===void 0||n.seq===void 0)throw new Error("Required parameters are missing");switch(this._aead=n.aead,this._aead){case te.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case te.Aes256Gcm:this._nK=32,this._nN=12,this._nT=16;break;case te.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0;break}let i=ar(this._aead,n.key,this._api);this._f={key:i,baseNonce:n.baseNonce,seq:n.seq},this._r={key:i,baseNonce:V,seq:0}}computeNonce(e){let t=ue(e.seq,e.baseNonce.byteLength);return zn(e.baseNonce,t)}incrementSeq(e){if(e.seq>Number.MAX_SAFE_INTEGER)throw new Vt("Message limit reached");e.seq+=1}async setupBidirectional(e,t){try{this._r.baseNonce=new Uint8Array(await this.export(t,this._nN));let n=await this.export(e,this._nK);this._r.key=ar(this._aead,n,this._api),this._r.seq=0}catch(n){throw this._r.baseNonce=V,n}}};function ar(r,e,t){switch(r){case te.Aes128Gcm:return new Qt(e,t);case te.Aes256Gcm:return new Jt(e,t);case te.Chacha20Poly1305:return new or(e);default:throw new Error("Invalid or unsupported AEAD id")}}function Wr(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function bo(r){if(typeof r!="boolean")throw new Error(`Expected boolean, not ${r}`)}function yi(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function yo(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Wr(r.outputLen),Wr(r.blockLen)}function po(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function xo(r,e){yi(r);let t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var go={number:Wr,bool:bo,bytes:yi,hash:yo,exists:po,output:xo},ce=go;var cr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var pi=r=>r instanceof Uint8Array;var xi=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),ur=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),ve=(r,e)=>r<<32-e|r>>>e,mo=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!mo)throw new Error("Non little-endian hardware is not supported");var pc=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function At(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Re(r){if(typeof r=="string"&&(r=At(r)),!pi(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function fr(...r){let e=new Uint8Array(r.reduce((n,i)=>n+i.length,0)),t=0;return r.forEach(n=>{if(!pi(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}var Ce=class{clone(){return this._cloneInto()}};function pe(r){let e=n=>r().update(Re(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function gi(r){let e=(n,i)=>r(i).update(Re(n)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}function lt(r=32){if(cr&&typeof cr.getRandomValues=="function")return cr.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}var hr=class extends Ce{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ce.hash(e);let n=Re(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(e){return ce.exists(this),this.iHash.update(e),this}digestInto(e){ce.exists(this),ce.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:n,finished:i,destroyed:s,blockLen:a,outputLen:o}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=a,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},kt=(r,e,t)=>new hr(r,e).update(t).digest();kt.create=(r,e)=>new hr(r,e);function _o(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);let i=BigInt(32),s=BigInt(4294967295),a=Number(t>>i&s),o=Number(t&s),c=n?4:0,u=n?0:4;r.setUint32(e+c,a,n),r.setUint32(e+u,o,n)}var dt=class extends Ce{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ur(this.buffer)}update(e){ce.exists(this);let{view:t,buffer:n,blockLen:i}=this;e=Re(e);let s=e.length;for(let a=0;a<s;){let o=Math.min(i-this.pos,s-a);if(o===i){let c=ur(e);for(;i<=s-a;a+=i)this.process(c,a);continue}n.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ce.exists(this),ce.output(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:i,isLE:s}=this,{pos:a}=this;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)t[h]=0;_o(n,i-8,BigInt(this.length*8),s),this.process(n,0);let o=ur(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,f=this.get();if(u>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<u;h++)o.setUint32(4*h,f[h],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:i,finished:s,destroyed:a,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=a,i%t&&e.buffer.set(n),e}};var Eo=(r,e,t)=>r&e^~r&t,vo=(r,e,t)=>r&e^r&t^e&t,So=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),je=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qe=new Uint32Array(64),lr=class extends dt{constructor(){super(64,32,8,!1),this.A=je[0]|0,this.B=je[1]|0,this.C=je[2]|0,this.D=je[3]|0,this.E=je[4]|0,this.F=je[5]|0,this.G=je[6]|0,this.H=je[7]|0}get(){let{A:e,B:t,C:n,D:i,E:s,F:a,G:o,H:c}=this;return[e,t,n,i,s,a,o,c]}set(e,t,n,i,s,a,o,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=a|0,this.G=o|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)qe[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){let l=qe[h-15],p=qe[h-2],x=ve(l,7)^ve(l,18)^l>>>3,S=ve(p,17)^ve(p,19)^p>>>10;qe[h]=S+qe[h-7]+x+qe[h-16]|0}let{A:n,B:i,C:s,D:a,E:o,F:c,G:u,H:f}=this;for(let h=0;h<64;h++){let l=ve(o,6)^ve(o,11)^ve(o,25),p=f+l+Eo(o,c,u)+So[h]+qe[h]|0,S=(ve(n,2)^ve(n,13)^ve(n,22))+vo(n,i,s)|0;f=u,u=c,c=o,o=a+p|0,a=s,s=i,i=n,n=p+S|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,a=a+this.D|0,o=o+this.E|0,c=c+this.F|0,u=u+this.G|0,f=f+this.H|0,this.set(n,i,s,a,o,c,u,f)}roundClean(){qe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Qr=class extends lr{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},mi=pe(()=>new lr),Bc=pe(()=>new Qr);var dr=BigInt(4294967295),Jr=BigInt(32);function _i(r,e=!1){return e?{h:Number(r&dr),l:Number(r>>Jr&dr)}:{h:Number(r>>Jr&dr)|0,l:Number(r&dr)|0}}function Ao(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){let{h:s,l:a}=_i(r[i],e);[t[i],n[i]]=[s,a]}return[t,n]}var ko=(r,e)=>BigInt(r>>>0)<<Jr|BigInt(e>>>0),Bo=(r,e,t)=>r>>>t,Po=(r,e,t)=>r<<32-t|e>>>t,Io=(r,e,t)=>r>>>t|e<<32-t,Lo=(r,e,t)=>r<<32-t|e>>>t,Uo=(r,e,t)=>r<<64-t|e>>>t-32,Oo=(r,e,t)=>r>>>t-32|e<<64-t,Ho=(r,e)=>e,Ko=(r,e)=>r,To=(r,e,t)=>r<<t|e>>>32-t,No=(r,e,t)=>e<<t|r>>>32-t,zo=(r,e,t)=>e<<t-32|r>>>64-t,Do=(r,e,t)=>r<<t-32|e>>>64-t;function Co(r,e,t,n){let i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}var Ro=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),jo=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,qo=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),Mo=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,Go=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),Fo=(r,e,t,n,i,s)=>e+t+n+i+s+(r/2**32|0)|0,Zo={fromBig:_i,split:Ao,toBig:ko,shrSH:Bo,shrSL:Po,rotrSH:Io,rotrSL:Lo,rotrBH:Uo,rotrBL:Oo,rotr32H:Ho,rotr32L:Ko,rotlSH:To,rotlSL:No,rotlBH:zo,rotlBL:Do,add:Co,add3L:Ro,add3H:jo,add4L:qo,add4H:Mo,add5H:Fo,add5L:Go},L=Zo;var[Vo,Xo]=L.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Me=new Uint32Array(80),Ge=new Uint32Array(80),wt=class extends dt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:n,Bl:i,Ch:s,Cl:a,Dh:o,Dl:c,Eh:u,El:f,Fh:h,Fl:l,Gh:p,Gl:x,Hh:S,Hl:k}=this;return[e,t,n,i,s,a,o,c,u,f,h,l,p,x,S,k]}set(e,t,n,i,s,a,o,c,u,f,h,l,p,x,S,k){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=a|0,this.Dh=o|0,this.Dl=c|0,this.Eh=u|0,this.El=f|0,this.Fh=h|0,this.Fl=l|0,this.Gh=p|0,this.Gl=x|0,this.Hh=S|0,this.Hl=k|0}process(e,t){for(let b=0;b<16;b++,t+=4)Me[b]=e.getUint32(t),Ge[b]=e.getUint32(t+=4);for(let b=16;b<80;b++){let _=Me[b-15]|0,y=Ge[b-15]|0,K=L.rotrSH(_,y,1)^L.rotrSH(_,y,8)^L.shrSH(_,y,7),H=L.rotrSL(_,y,1)^L.rotrSL(_,y,8)^L.shrSL(_,y,7),A=Me[b-2]|0,U=Ge[b-2]|0,D=L.rotrSH(A,U,19)^L.rotrBH(A,U,61)^L.shrSH(A,U,6),M=L.rotrSL(A,U,19)^L.rotrBL(A,U,61)^L.shrSL(A,U,6),$=L.add4L(H,M,Ge[b-7],Ge[b-16]),C=L.add4H($,K,D,Me[b-7],Me[b-16]);Me[b]=C|0,Ge[b]=$|0}let{Ah:n,Al:i,Bh:s,Bl:a,Ch:o,Cl:c,Dh:u,Dl:f,Eh:h,El:l,Fh:p,Fl:x,Gh:S,Gl:k,Hh:N,Hl:j}=this;for(let b=0;b<80;b++){let _=L.rotrSH(h,l,14)^L.rotrSH(h,l,18)^L.rotrBH(h,l,41),y=L.rotrSL(h,l,14)^L.rotrSL(h,l,18)^L.rotrBL(h,l,41),K=h&p^~h&S,H=l&x^~l&k,A=L.add5L(j,y,H,Xo[b],Ge[b]),U=L.add5H(A,N,_,K,Vo[b],Me[b]),D=A|0,M=L.rotrSH(n,i,28)^L.rotrBH(n,i,34)^L.rotrBH(n,i,39),$=L.rotrSL(n,i,28)^L.rotrBL(n,i,34)^L.rotrBL(n,i,39),C=n&s^n&o^s&o,ee=i&a^i&c^a&c;N=S|0,j=k|0,S=p|0,k=x|0,p=h|0,x=l|0,{h,l}=L.add(u|0,f|0,U|0,D|0),u=o|0,f=c|0,o=s|0,c=a|0,s=n|0,a=i|0;let G=L.add3L(D,$,ee);n=L.add3H(G,U,M,C),i=G|0}({h:n,l:i}=L.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:a}=L.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:o,l:c}=L.add(this.Ch|0,this.Cl|0,o|0,c|0),{h:u,l:f}=L.add(this.Dh|0,this.Dl|0,u|0,f|0),{h,l}=L.add(this.Eh|0,this.El|0,h|0,l|0),{h:p,l:x}=L.add(this.Fh|0,this.Fl|0,p|0,x|0),{h:S,l:k}=L.add(this.Gh|0,this.Gl|0,S|0,k|0),{h:N,l:j}=L.add(this.Hh|0,this.Hl|0,N|0,j|0),this.set(n,i,s,a,o,c,u,f,h,l,p,x,S,k,N,j)}roundClean(){Me.fill(0),Ge.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},en=class extends wt{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},tn=class extends wt{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},rn=class extends wt{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}},Bt=pe(()=>new wt),Hc=pe(()=>new en),Kc=pe(()=>new tn),Ei=pe(()=>new rn);var Pt=class extends Ne{constructor(e,t){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=t}buildLabeledIkm(e,t){let n=new Uint8Array(7+this.suiteId.byteLength+e.byteLength+t.byteLength);return n.set(qr,0),n.set(this.suiteId,7),n.set(e,7+this.suiteId.byteLength),n.set(t,7+this.suiteId.byteLength+e.byteLength),n}buildLabeledInfo(e,t,n){let i=new Uint8Array(9+this.suiteId.byteLength+e.byteLength+t.byteLength);return i.set(new Uint8Array([0,n]),0),i.set(qr,2),i.set(this.suiteId,9),i.set(e,9+this.suiteId.byteLength),i.set(t,9+this.suiteId.byteLength+e.byteLength),i}async extract(e,t){if(e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return kt(mi,new Uint8Array(e),new Uint8Array(t));case"SHA-384":return kt(Ei,new Uint8Array(e),new Uint8Array(t));default:return kt(Bt,new Uint8Array(e),new Uint8Array(t))}let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",n,t)}async expand(e,t,n){let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),s=new ArrayBuffer(n),a=new Uint8Array(s),o=V,c=new Uint8Array(t),u=new Uint8Array(1);if(n>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let h=1,l=0;l<a.length;h++)u[0]=h,f.set(o,0),f.set(c,o.length),f.set(u,o.length+c.length),o=new Uint8Array(await this._api.sign("HMAC",i,f.slice(0,o.length+c.length+1))),a.length-l>=o.length?(a.set(o,l),l+=o.length):(a.set(o.slice(0,a.length-l),l),l+=a.length-l);return s}async extractAndExpand(e,t,n,i){let s=await this._api.importKey("raw",t,"HKDF",!1,ze);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:n},s,i*8)}async labeledExtract(e,t,n){return await this.extract(e,this.buildLabeledIkm(t,n))}async labeledExpand(e,t,n,i){return await this.expand(e,this.buildLabeledInfo(t,n,i),i)}},Fe=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},bt=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},et=class extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:de.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var wr=class extends ht{async seal(e,t=V){if(this._r.baseNonce.length===0)throw new Ye("Bidirectional encryption is not setup");let n;try{n=await this._r.key.seal(this.computeNonce(this._r),e,t)}catch(i){throw new Ye(i)}return this.incrementSeq(this._r),n}async open(e,t=V){let n;try{n=await this._f.key.open(this.computeNonce(this._f),e,t)}catch(i){throw new We(i)}return this.incrementSeq(this._f),n}};var br=class extends ht{constructor(e,t,n,i){super(e,t,n),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i}async seal(e,t=V){let n;try{n=await this._f.key.seal(this.computeNonce(this._f),e,t)}catch(i){throw new Ye(i)}return this.incrementSeq(this._f),n}async open(e,t=V){if(this._r.baseNonce.length===0)throw new We("Bidirectional encryption is not setup");let n;try{n=await this._r.key.open(this.computeNonce(this._r),e,t)}catch(i){throw new We(i)}return this.incrementSeq(this._r),n}};var yr=class{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(this._num[e]!==0)return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let t=0;t<this._num.length;t++){if(this._num[t]<e[t])return!0;if(this._num[t]>e[t])return!1}return!1}};var $o=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),Yo=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Wo=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),yt=class{constructor(e,t,n){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._api=n,e){case q.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=Qn,this._bitmask=255,this._pkcs8AlgId=$o;break;case q.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=Jn,this._bitmask=255,this._pkcs8AlgId=Yo;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=ei,this._bitmask=1,this._pkcs8AlgId=Wo;break}}async serializePublicKey(e){let t=await this._api.exportKey("raw",e);if(t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");return t}async deserializePublicKey(e){if(e.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",e,this._alg,!0,[])}catch{throw new Error("Invalid public key for the ciphersuite")}}async importKey(e,t,n){if(e!=="raw")throw new Error("Unsupported format");if(n&&t.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!n&&t.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");try{if(n)return await this._api.importKey(e,t,this._alg,!0,[]);let i=new Uint8Array(t),s=new Uint8Array(this._pkcs8AlgId.length+i.length);return s.set(this._pkcs8AlgId,0),s.set(i,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",s,this._alg,!0,ze)}catch{throw new Error("Invalid key for the ciphersuite")}}async derivePublicKey(e){let t=await this._api.exportKey("jwk",e);return delete t.d,delete t.key_ops,await this._api.importKey("jwk",t,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,ze)}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(V,De,new Uint8Array(e)),n=new yr(this._nSk);for(let a=0;n.isZero()||!n.lessThan(this._order);a++){if(a>255)throw new Error("Faild to derive a key pair");let o=new Uint8Array(await this._hkdf.labeledExpand(t,Wn,ue(a,1),this._nSk));o[0]=o[0]&this._bitmask,n.set(o)}let i=new Uint8Array(this._pkcs8AlgId.length+n.val().length);i.set(this._pkcs8AlgId,0),i.set(n.val(),this._pkcs8AlgId.length);let s=await this._api.importKey("pkcs8",i,this._alg,!0,ze);return n.reset(),{privateKey:s,publicKey:await this.derivePublicKey(s)}}async dh(e,t){return await this._api.deriveBits({name:"ECDH",public:t},e,this._nDh*8)}};var Qo=On(vi(),1);var X=BigInt(0),J=BigInt(1),Ze=BigInt(2),Ut=BigInt(3),Si=BigInt(8),ie=Object.freeze({a:X,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:J,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Ai=(r,e)=>(r+e/Ze)/e,pr={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(r){let{n:e}=ie,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-J*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,a=BigInt("0x100000000000000000000000000000000"),o=Ai(s*r,e),c=Ai(-n*r,e),u=E(r-o*t-c*i,e),f=E(-o*n-c*s,e),h=u>a,l=f>a;if(h&&(u=e-u),l&&(f=e-f),u>a||f>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+r);return{k1neg:h,k1:u,k2neg:l,k2:f}}},pt=32,Ot=32;var _r=pt+1,Er=2*pt+1;function ki(r){let{a:e,b:t}=ie,n=E(r*r),i=E(n*r);return E(i+e*r+t)}var xr=ie.a===X,on=class extends Error{constructor(e){super(e)}};function Bi(r){if(!(r instanceof F))throw new TypeError("JacobianPoint expected")}var F=class{constructor(e,t,n){this.x=e,this.y=t,this.z=n}static fromAffine(e){if(!(e instanceof W))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(W.ZERO)?F.ZERO:new F(e.x,e.y,J)}static toAffineBatch(e){let t=na(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(t[i]))}static normalizeZ(e){return F.toAffineBatch(e).map(F.fromAffine)}equals(e){Bi(e);let{x:t,y:n,z:i}=this,{x:s,y:a,z:o}=e,c=E(i*i),u=E(o*o),f=E(t*u),h=E(s*c),l=E(E(n*o)*u),p=E(E(a*i)*c);return f===h&&l===p}negate(){return new F(this.x,E(-this.y),this.z)}double(){let{x:e,y:t,z:n}=this,i=E(e*e),s=E(t*t),a=E(s*s),o=e+s,c=E(Ze*(E(o*o)-i-a)),u=E(Ut*i),f=E(u*u),h=E(f-Ze*c),l=E(u*(c-h)-Si*a),p=E(Ze*t*n);return new F(h,l,p)}add(e){Bi(e);let{x:t,y:n,z:i}=this,{x:s,y:a,z:o}=e;if(s===X||a===X)return this;if(t===X||n===X)return e;let c=E(i*i),u=E(o*o),f=E(t*u),h=E(s*c),l=E(E(n*o)*u),p=E(E(a*i)*c),x=E(h-f),S=E(p-l);if(x===X)return S===X?this.double():F.ZERO;let k=E(x*x),N=E(x*k),j=E(f*k),b=E(S*S-N-Ze*j),_=E(S*(j-b)-l*N),y=E(i*o*x);return new F(b,_,y)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=F.ZERO;if(typeof e=="bigint"&&e===X)return t;let n=Ui(e);if(n===J)return this;if(!xr){let h=t,l=this;for(;n>X;)n&J&&(h=h.add(l)),l=l.double(),n>>=J;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=pr.splitScalar(n),c=t,u=t,f=this;for(;s>X||o>X;)s&J&&(c=c.add(f)),o&J&&(u=u.add(f)),f=f.double(),s>>=J,o>>=J;return i&&(c=c.negate()),a&&(u=u.negate()),u=new F(E(u.x*pr.beta),u.y,u.z),c.add(u)}precomputeWindow(e){let t=xr?128/e+1:256/e+1,n=[],i=this,s=i;for(let a=0;a<t;a++){s=i,n.push(s);for(let o=1;o<2**(e-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,t){!t&&this.equals(F.BASE)&&(t=W.BASE);let n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=t&&an.get(t);i||(i=this.precomputeWindow(n),t&&n!==1&&(i=F.normalizeZ(i),an.set(t,i)));let s=F.ZERO,a=F.BASE,o=1+(xr?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let l=0;l<o;l++){let p=l*c,x=Number(e&u);e>>=h,x>c&&(x-=f,e+=J);let S=p,k=p+Math.abs(x)-1,N=l%2!==0,j=x<0;x===0?a=a.add(gr(N,i[S])):s=s.add(gr(j,i[k]))}return{p:s,f:a}}multiply(e,t){let n=Ui(e),i,s;if(xr){let{k1neg:a,k1:o,k2neg:c,k2:u}=pr.splitScalar(n),{p:f,f:h}=this.wNAF(o,t),{p:l,f:p}=this.wNAF(u,t);f=gr(a,f),l=gr(c,l),l=new F(E(l.x*pr.beta),l.y,l.z),i=f.add(l),s=h.add(p)}else{let{p:a,f:o}=this.wNAF(n,t);i=a,s=o}return F.normalizeZ([i,s])[0]}toAffine(e){let{x:t,y:n,z:i}=this,s=this.equals(F.ZERO);e==null&&(e=s?Si:kr(i));let a=e,o=E(a*a),c=E(o*a),u=E(t*o),f=E(n*c),h=E(i*a);if(s)return W.ZERO;if(h!==J)throw new Error("invZ was invalid");return new W(u,f)}};F.BASE=new F(ie.Gx,ie.Gy,J);F.ZERO=new F(X,J,X);function gr(r,e){let t=e.negate();return r?t:e}var an=new WeakMap,W=class{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,an.delete(this)}hasEvenY(){return this.y%Ze===X}static fromCompressedHex(e){let t=e.length===32,n=nt(t?e:e.subarray(1));if(!sn(n))throw new Error("Point is not on curve");let i=ki(n),s=ra(i),a=(s&J)===J;t?a&&(s=E(-s)):(e[0]&1)===1!==a&&(s=E(-s));let o=new W(n,s);return o.assertValidity(),o}static fromUncompressedHex(e){let t=nt(e.subarray(1,pt+1)),n=nt(e.subarray(pt+1,pt*2+1)),i=new W(t,n);return i.assertValidity(),i}static fromHex(e){let t=cn(e),n=t.length,i=t[0];if(n===pt)return this.fromCompressedHex(t);if(n===_r&&(i===2||i===3))return this.fromCompressedHex(t);if(n===Er&&i===4)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-${_r} compressed bytes or ${Er} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return W.BASE.multiply(Ar(e))}static fromSignature(e,t,n){let{r:i,s}=aa(t);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=sa(cn(e)),{n:o}=ie,c=n===2||n===3?i+o:i,u=kr(c,o),f=E(-a*u,o),h=E(s*u,o),l=n&1?"03":"02",p=W.fromHex(l+xt(c)),x=W.BASE.multiplyAndAddUnsafe(p,f,h);if(!x)throw new Error("Cannot recover signature: point at infinify");return x.assertValidity(),x}toRawBytes(e=!1){return rt(this.toHex(e))}toHex(e=!1){let t=xt(this.x);return e?`${this.hasEvenY()?"02":"03"}${t}`:`04${t}${xt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:t,y:n}=this;if(!sn(t)||!sn(n))throw new Error(e);let i=E(n*n),s=ki(t);if(E(i-s)!==X)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new W(this.x,E(-this.y))}double(){return F.fromAffine(this).double().toAffine()}add(e){return F.fromAffine(this).add(F.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return F.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,n){let i=F.fromAffine(this),s=t===X||t===J||this!==W.BASE?i.multiplyUnsafe(t):i.multiply(t),a=F.fromAffine(e).multiplyUnsafe(n),o=s.add(a);return o.equals(F.ZERO)?void 0:o.toAffine()}};W.BASE=new W(ie.Gx,ie.Gy);W.ZERO=new W(X,X);function Pi(r){return Number.parseInt(r[0],16)>=8?"00"+r:r}function Ii(r){if(r.length<2||r[0]!==2)throw new Error(`Invalid signature integer tag: ${mt(r)}`);let e=r[1],t=r.subarray(2,e+2);if(!e||t.length!==e)throw new Error("Invalid signature integer: wrong length");if(t[0]===0&&t[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:nt(t),left:r.subarray(e+2)}}function Jo(r){if(r.length<2||r[0]!=48)throw new Error(`Invalid signature tag: ${mt(r)}`);if(r[1]!==r.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:t}=Ii(r.subarray(2)),{data:n,left:i}=Ii(t);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${mt(i)}`);return{r:e,s:n}}var Ue=class{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){let t=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!t)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=t?mt(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Ue(vr(i.slice(0,64)),vr(i.slice(64,128)))}static fromDER(e){let t=e instanceof Uint8Array;if(typeof e!="string"&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Jo(t?e:rt(e));return new Ue(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:t}=this;if(!Sr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Sr(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ie.n>>J;return this.s>e}normalizeS(){return this.hasHighS()?new Ue(this.r,E(-this.s,ie.n)):this}toDERRawBytes(){return rt(this.toDERHex())}toDERHex(){let e=Pi(Lt(this.s)),t=Pi(Lt(this.r)),n=e.length/2,i=t.length/2,s=Lt(n),a=Lt(i);return`30${Lt(i+n+4)}02${a}${t}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return rt(this.toCompactHex())}toCompactHex(){return xt(this.r)+xt(this.s)}};function It(...r){if(!r.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(r.length===1)return r[0];let e=r.reduce((n,i)=>n+i.length,0),t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){let s=r[n];t.set(s,i),i+=s.length}return t}var ea=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function mt(r){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let t=0;t<r.length;t++)e+=ea[r[t]];return e}var ta=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function xt(r){if(typeof r!="bigint")throw new Error("Expected bigint");if(!(X<=r&&r<ta))throw new Error("Expected number 0 <= n < 2^256");return r.toString(16).padStart(64,"0")}function Li(r){let e=rt(xt(r));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Lt(r){let e=r.toString(16);return e.length&1?`0${e}`:e}function vr(r){if(typeof r!="string")throw new TypeError("hexToNumber: expected string, got "+typeof r);return BigInt(`0x${r}`)}function rt(r){if(typeof r!="string")throw new TypeError("hexToBytes: expected string, got "+typeof r);if(r.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+r.length);let e=new Uint8Array(r.length/2);for(let t=0;t<e.length;t++){let n=t*2,i=r.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[t]=s}return e}function nt(r){return vr(mt(r))}function cn(r){return r instanceof Uint8Array?Uint8Array.from(r):rt(r)}function Ui(r){if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)return BigInt(r);if(typeof r=="bigint"&&Sr(r))return r;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function E(r,e=ie.P){let t=r%e;return t>=X?t:e+t}function me(r,e){let{P:t}=ie,n=r;for(;e-- >X;)n*=n,n%=t;return n}function ra(r){let{P:e}=ie,t=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),c=r*r*r%e,u=c*c*r%e,f=me(u,Ut)*u%e,h=me(f,Ut)*u%e,l=me(h,Ze)*c%e,p=me(l,n)*l%e,x=me(p,i)*p%e,S=me(x,a)*x%e,k=me(S,o)*S%e,N=me(k,a)*x%e,j=me(N,Ut)*u%e,b=me(j,s)*p%e,_=me(b,t)*c%e,y=me(_,Ze);if(y*y%e!==r)throw new Error("Cannot find square root");return y}function kr(r,e=ie.P){if(r===X||e<=X)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=E(r,e),n=e,i=X,s=J,a=J,o=X;for(;t!==X;){let u=n/t,f=n%t,h=i-a*u,l=s-o*u;n=t,t=f,i=a,s=o,a=h,o=l}if(n!==J)throw new Error("invert: does not exist");return E(i,e)}function na(r,e=ie.P){let t=new Array(r.length),n=r.reduce((s,a,o)=>a===X?s:(t[o]=s,E(s*a,e)),J),i=kr(n,e);return r.reduceRight((s,a,o)=>a===X?s:(t[o]=E(s*t[o],e),E(s*a,e)),i),t}function ia(r){let e=r.length*8-Ot*8,t=nt(r);return e>0?t>>BigInt(e):t}function sa(r,e=!1){let t=ia(r);if(e)return t;let{n}=ie;return t>=n?t-n:t}var gt,nn;function Sr(r){return X<r&&r<ie.n}function sn(r){return X<r&&r<ie.P}function Ar(r){let e;if(typeof r=="bigint")e=r;else if(typeof r=="number"&&Number.isSafeInteger(r)&&r>0)e=BigInt(r);else if(typeof r=="string"){if(r.length!==2*Ot)throw new Error("Expected 32 bytes of private key");e=vr(r)}else if(r instanceof Uint8Array){if(r.length!==Ot)throw new Error("Expected 32 bytes of private key");e=nt(r)}else throw new TypeError("Expected valid private key");if(!Sr(e))throw new Error("Expected private key: 0 < key < n");return e}function oa(r){return r instanceof W?(r.assertValidity(),r):W.fromHex(r)}function aa(r){if(r instanceof Ue)return r.assertValidity(),r;try{return Ue.fromDER(r)}catch{return Ue.fromCompact(r)}}function Hi(r,e=!1){return W.fromPrivateKey(r).toRawBytes(e)}function Oi(r){let e=r instanceof Uint8Array,t=typeof r=="string",n=(e||t)&&r.length;return e?n===_r||n===Er:t?n===_r*2||n===Er*2:r instanceof W}function Ki(r,e,t=!1){if(Oi(r))throw new TypeError("getSharedSecret: first arg must be private key");if(!Oi(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=oa(e);return n.assertValidity(),n.multiply(Ar(r)).toRawBytes(t)}W.BASE._setWindowSize(8);var xe={node:Qo,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var mr={},tt={bytesToHex:mt,hexToBytes:rt,concatBytes:It,mod:E,invert:kr,isValidPrivateKey(r){try{return Ar(r),!0}catch{return!1}},_bigintTo32Bytes:Li,_normalizePrivateKey:Ar,hashToPrivateKey:r=>{r=cn(r);let e=Ot+8;if(r.length<e||r.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let t=E(nt(r),ie.n-J)+J;return Li(t)},randomBytes:(r=32)=>{if(xe.web)return xe.web.getRandomValues(new Uint8Array(r));if(xe.node){let{randomBytes:e}=xe.node;return Uint8Array.from(e(r))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>tt.hashToPrivateKey(tt.randomBytes(Ot+8)),precompute(r=8,e=W.BASE){let t=e===W.BASE?e:new W(e.x,e.y);return t._setWindowSize(r),t.multiply(Ut),t},sha256:async(...r)=>{if(xe.web){let e=await xe.web.subtle.digest("SHA-256",It(...r));return new Uint8Array(e)}else if(xe.node){let{createHash:e}=xe.node,t=e("sha256");return r.forEach(n=>t.update(n)),Uint8Array.from(t.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(r,...e)=>{if(xe.web){let t=await xe.web.subtle.importKey("raw",r,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=It(...e),i=await xe.web.subtle.sign("HMAC",t,n);return new Uint8Array(i)}else if(xe.node){let{createHmac:t}=xe.node,n=t("sha256",r);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(r,...e)=>{let t=mr[r];if(t===void 0){let n=await tt.sha256(Uint8Array.from(r,i=>i.charCodeAt(0)));t=It(n,n),mr[r]=t}return tt.sha256(t,...e)},taggedHashSync:(r,...e)=>{if(typeof gt!="function")throw new on("sha256Sync is undefined, you need to set it");let t=mr[r];if(t===void 0){let n=gt(Uint8Array.from(r,i=>i.charCodeAt(0)));t=It(n,n),mr[r]=t}return gt(t,...e)},_JacobianPoint:F};Object.defineProperties(tt,{sha256Sync:{configurable:!1,get(){return gt},set(r){gt||(gt=r)}},hmacSha256Sync:{configurable:!1,get(){return nn},set(r){nn||(nn=r)}}});var ne=class{constructor(e,t,n){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:ze}),this.key=t,this.type=n,this.algorithm={name:e}}};var Ht="ECDH",Br=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=65,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(t,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=tt.randomPrivateKey(),t=new ne(Ht,e,"private");return{publicKey:await this.derivePublicKey(t),privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(V,De,new Uint8Array(e)),n=await this._hkdf.labeledExpand(t,at,V,this._nSk),i=new ne(Ht,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):t(new ne(Ht,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((n,i)=>{t&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!t&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new ne(Ht,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let n=Hi(e.key);t(new ne(Ht,n,"public"))})}_dh(e,t){return new Promise((n,i)=>{try{n(Ki(e.key,t.key).buffer)}catch(s){i(s)}})}};var iu=BigInt(0),ua=BigInt(1),fa=BigInt(2),Pr=r=>r instanceof Uint8Array,ha=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Kt(r){if(!Pr(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=ha[r[t]];return e}function Ti(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Ni(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);let e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){let i=n*2,s=r.slice(i,i+2),a=Number.parseInt(s,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");t[n]=a}return t}function un(r){return Ti(Kt(r))}function ke(r){if(!Pr(r))throw new Error("Uint8Array expected");return Ti(Kt(Uint8Array.from(r).reverse()))}function fn(r,e){return Ni(r.toString(16).padStart(e*2,"0"))}function Ve(r,e){return fn(r,e).reverse()}function we(r,e,t){let n;if(typeof e=="string")try{n=Ni(e)}catch(s){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Pr(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);let i=n.length;if(typeof t=="number"&&i!==t)throw new Error(`${r} expected ${t} bytes, got ${i}`);return n}function Ir(...r){let e=new Uint8Array(r.reduce((n,i)=>n+i.length,0)),t=0;return r.forEach(n=>{if(!Pr(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}var zi=r=>(fa<<BigInt(r-1))-ua;var la={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Oe(r,e,t={}){let n=(i,s,a)=>{let o=la[s];if(typeof o!="function")throw new Error(`Invalid validator "${s}", expected function`);let c=r[i];if(!(a&&c===void 0)&&!o(c,r))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${s}`)};for(let[i,s]of Object.entries(e))n(i,s,!1);for(let[i,s]of Object.entries(t))n(i,s,!0);return r}var se=BigInt(0),re=BigInt(1),it=BigInt(2),wa=BigInt(3),hn=BigInt(4),Di=BigInt(5),Ci=BigInt(8),ba=BigInt(9),ya=BigInt(16);function Z(r,e){let t=r%e;return t>=se?t:e+t}function ln(r,e,t){if(t<=se||e<se)throw new Error("Expected power/modulo > 0");if(t===re)return se;let n=re;for(;e>se;)e&re&&(n=n*r%t),r=r*r%t,e>>=re;return n}function Q(r,e,t){let n=r;for(;e-- >se;)n*=n,n%=t;return n}function Ri(r,e){if(r===se||e<=se)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Z(r,e),n=e,i=se,s=re,a=re,o=se;for(;t!==se;){let u=n/t,f=n%t,h=i-a*u,l=s-o*u;n=t,t=f,i=a,s=o,a=h,o=l}if(n!==re)throw new Error("invert: does not exist");return Z(i,e)}function pa(r){let e=(r-re)/it,t,n,i;for(t=r-re,n=0;t%it===se;t/=it,n++);for(i=it;i<r&&ln(i,e,r)!==r-re;i++);if(n===1){let a=(r+re)/hn;return function(c,u){let f=c.pow(u,a);if(!c.eql(c.sqr(f),u))throw new Error("Cannot find square root");return f}}let s=(t+re)/it;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let u=n,f=o.pow(o.mul(o.ONE,i),t),h=o.pow(c,s),l=o.pow(c,t);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let p=1;for(let S=o.sqr(l);p<u&&!o.eql(S,o.ONE);p++)S=o.sqr(S);let x=o.pow(f,re<<BigInt(u-p-1));f=o.sqr(x),h=o.mul(h,x),l=o.mul(l,f),u=p}return h}}function xa(r){if(r%hn===wa){let e=(r+re)/hn;return function(n,i){let s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(r%Ci===Di){let e=(r-Di)/Ci;return function(n,i){let s=n.mul(i,it),a=n.pow(s,e),o=n.mul(i,a),c=n.mul(n.mul(o,it),a),u=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return r%ya,pa(r)}var ji=(r,e)=>(Z(r,e)&re)===re,ga=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qi(r){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=ga.reduce((n,i)=>(n[i]="function",n),e);return Oe(r,t)}function ma(r,e,t){if(t<se)throw new Error("Expected power > 0");if(t===se)return r.ONE;if(t===re)return e;let n=r.ONE,i=e;for(;t>se;)t&re&&(n=r.mul(n,i)),i=r.sqr(i),t>>=re;return n}function _a(r,e){let t=new Array(e.length),n=e.reduce((s,a,o)=>r.is0(a)?s:(t[o]=s,r.mul(s,a)),r.ONE),i=r.inv(n);return e.reduceRight((s,a,o)=>r.is0(a)?s:(t[o]=r.mul(s,t[o]),r.mul(s,a)),i),t}function dn(r,e){let t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Lr(r,e,t=!1,n={}){if(r<=se)throw new Error(`Expected Fp ORDER > 0, got ${r}`);let{nBitLength:i,nByteLength:s}=dn(r,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let a=xa(r),o=Object.freeze({ORDER:r,BITS:i,BYTES:s,MASK:zi(i),ZERO:se,ONE:re,create:c=>Z(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return se<=c&&c<r},is0:c=>c===se,isOdd:c=>(c&re)===re,neg:c=>Z(-c,r),eql:(c,u)=>c===u,sqr:c=>Z(c*c,r),add:(c,u)=>Z(c+u,r),sub:(c,u)=>Z(c-u,r),mul:(c,u)=>Z(c*u,r),pow:(c,u)=>ma(o,c,u),div:(c,u)=>Z(c*Ri(u,r),r),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Ri(c,r),sqrt:n.sqrt||(c=>a(o,c)),invertBatch:c=>_a(o,c),cmov:(c,u,f)=>f?u:c,toBytes:c=>t?Ve(c,s):fn(c,s),fromBytes:c=>{if(c.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${c.length}`);return t?ke(c):un(c)}});return Object.freeze(o)}function Mi(r,e){if(!r.isOdd)throw new Error("Field doesn't have isOdd");let t=r.sqrt(e);return r.isOdd(t)?r.neg(t):t}var Ea=BigInt(0),wn=BigInt(1);function Gi(r,e){let t=(i,s)=>{let a=s.negate();return i?a:s},n=i=>{let s=Math.ceil(e/i)+1,a=2**(i-1);return{windows:s,windowSize:a}};return{constTimeNegate:t,unsafeLadder(i,s){let a=r.ZERO,o=i;for(;s>Ea;)s&wn&&(a=a.add(o)),o=o.double(),s>>=wn;return a},precomputeWindow(i,s){let{windows:a,windowSize:o}=n(s),c=[],u=i,f=u;for(let h=0;h<a;h++){f=u,c.push(f);for(let l=1;l<o;l++)f=f.add(u),c.push(f);u=f.double()}return c},wNAF(i,s,a){let{windows:o,windowSize:c}=n(i),u=r.ZERO,f=r.BASE,h=BigInt(2**i-1),l=2**i,p=BigInt(i);for(let x=0;x<o;x++){let S=x*c,k=Number(a&h);a>>=p,k>c&&(k-=l,a+=wn);let N=S,j=S+Math.abs(k)-1,b=x%2!==0,_=k<0;k===0?f=f.add(t(b,s[N])):u=u.add(t(_,s[j]))}return{p:u,f}},wNAFCached(i,s,a,o){let c=i._WINDOW_SIZE||1,u=s.get(i);return u||(u=this.precomputeWindow(i,c),c!==1&&s.set(i,o(u))),this.wNAF(c,u,a)}}}function Fi(r){return qi(r.Fp),Oe(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dn(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var Se=BigInt(0),ge=BigInt(1),Ur=BigInt(2),va=BigInt(8),Sa={zip215:!0};function Aa(r){let e=Fi(r);return Oe(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function st(r){let e=Aa(r),{Fp:t,n,prehash:i,hash:s,randomBytes:a,nByteLength:o,h:c}=e,u=Ur<<BigInt(o*8)-ge,f=t.create,h=e.uvRatio||((w,d)=>{try{return{isValid:!0,value:t.sqrt(w*t.inv(d))}}catch{return{isValid:!1,value:Se}}}),l=e.adjustScalarBytes||(w=>w),p=e.domain||((w,d,m)=>{if(d.length||m)throw new Error("Contexts/pre-hash are not supported");return w}),x=w=>typeof w=="bigint"&&Se<w,S=(w,d)=>x(w)&&x(d)&&w<d,k=w=>w===Se||S(w,u);function N(w,d){if(S(w,d))return w;throw new Error(`Expected valid scalar < ${d}, got ${typeof w} ${w}`)}function j(w){return w===Se?w:N(w,n)}let b=new Map;function _(w){if(!(w instanceof y))throw new Error("ExtendedPoint expected")}class y{constructor(d,m,v,B){if(this.ex=d,this.ey=m,this.ez=v,this.et=B,!k(d))throw new Error("x required");if(!k(m))throw new Error("y required");if(!k(v))throw new Error("z required");if(!k(B))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(d){if(d instanceof y)throw new Error("extended point not allowed");let{x:m,y:v}=d||{};if(!k(m)||!k(v))throw new Error("invalid affine point");return new y(m,v,ge,f(m*v))}static normalizeZ(d){let m=t.invertBatch(d.map(v=>v.ez));return d.map((v,B)=>v.toAffine(m[B])).map(y.fromAffine)}_setWindowSize(d){this._WINDOW_SIZE=d,b.delete(this)}assertValidity(){let{a:d,d:m}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:v,ey:B,ez:P,et:O}=this,z=f(v*v),I=f(B*B),T=f(P*P),oe=f(T*T),fe=f(z*d),Ae=f(T*f(fe+I)),he=f(oe+f(m*f(z*I)));if(Ae!==he)throw new Error("bad point: equation left != right (1)");let Ke=f(v*B),Be=f(P*O);if(Ke!==Be)throw new Error("bad point: equation left != right (2)")}equals(d){_(d);let{ex:m,ey:v,ez:B}=this,{ex:P,ey:O,ez:z}=d,I=f(m*z),T=f(P*B),oe=f(v*z),fe=f(O*B);return I===T&&oe===fe}is0(){return this.equals(y.ZERO)}negate(){return new y(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){let{a:d}=e,{ex:m,ey:v,ez:B}=this,P=f(m*m),O=f(v*v),z=f(Ur*f(B*B)),I=f(d*P),T=m+v,oe=f(f(T*T)-P-O),fe=I+O,Ae=fe-z,he=I-O,Ke=f(oe*Ae),Be=f(fe*he),jt=f(oe*he),qt=f(Ae*fe);return new y(Ke,Be,qt,jt)}add(d){_(d);let{a:m,d:v}=e,{ex:B,ey:P,ez:O,et:z}=this,{ex:I,ey:T,ez:oe,et:fe}=d;if(m===BigInt(-1)){let Sn=f((P-B)*(T+I)),An=f((P+B)*(T-I)),jr=f(An-Sn);if(jr===Se)return this.double();let kn=f(O*Ur*fe),Bn=f(z*Ur*oe),Pn=Bn+kn,In=An+Sn,Ln=Bn-kn,bs=f(Pn*jr),ys=f(In*Ln),ps=f(Pn*Ln),xs=f(jr*In);return new y(bs,ys,xs,ps)}let Ae=f(B*I),he=f(P*T),Ke=f(z*v*fe),Be=f(O*oe),jt=f((B+P)*(I+T)-Ae-he),qt=Be-Ke,En=Be+Ke,vn=f(he-m*Ae),hs=f(jt*qt),ls=f(En*vn),ds=f(jt*vn),ws=f(qt*En);return new y(hs,ls,ws,ds)}subtract(d){return this.add(d.negate())}wNAF(d){return A.wNAFCached(this,b,d,y.normalizeZ)}multiply(d){let{p:m,f:v}=this.wNAF(N(d,n));return y.normalizeZ([m,v])[0]}multiplyUnsafe(d){let m=j(d);return m===Se?H:this.equals(H)||m===ge?this:this.equals(K)?this.wNAF(m).p:A.unsafeLadder(this,m)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(d){let{ex:m,ey:v,ez:B}=this,P=this.is0();d==null&&(d=P?va:t.inv(B));let O=f(m*d),z=f(v*d),I=f(B*d);if(P)return{x:Se,y:ge};if(I!==ge)throw new Error("invZ was invalid");return{x:O,y:z}}clearCofactor(){let{h:d}=e;return d===ge?this:this.multiplyUnsafe(d)}static fromHex(d,m=!1){let{d:v,a:B}=e,P=t.BYTES;d=we("pointHex",d,P);let O=d.slice(),z=d[P-1];O[P-1]=z&-129;let I=ke(O);I===Se||(m?N(I,u):N(I,t.ORDER));let T=f(I*I),oe=f(T-ge),fe=f(v*T-B),{isValid:Ae,value:he}=h(oe,fe);if(!Ae)throw new Error("Point.fromHex: invalid y coordinate");let Ke=(he&ge)===ge,Be=(z&128)!==0;if(!m&&he===Se&&Be)throw new Error("Point.fromHex: x=0 and x_0=1");return Be!==Ke&&(he=f(-he)),y.fromAffine({x:he,y:I})}static fromPrivateKey(d){return M(d).point}toRawBytes(){let{x:d,y:m}=this.toAffine(),v=Ve(m,t.BYTES);return v[v.length-1]|=d&ge?128:0,v}toHex(){return Kt(this.toRawBytes())}}y.BASE=new y(e.Gx,e.Gy,ge,f(e.Gx*e.Gy)),y.ZERO=new y(Se,ge,ge,Se);let{BASE:K,ZERO:H}=y,A=Gi(y,o*8);function U(w){return Z(w,n)}function D(w){return U(ke(w))}function M(w){let d=o;w=we("private key",w,d);let m=we("hashed private key",s(w),2*d),v=l(m.slice(0,d)),B=m.slice(d,2*d),P=D(v),O=K.multiply(P),z=O.toRawBytes();return{head:v,prefix:B,scalar:P,point:O,pointBytes:z}}function $(w){return M(w).pointBytes}function C(w=new Uint8Array,...d){let m=Ir(...d);return D(s(p(m,we("context",w),!!i)))}function ee(w,d,m={}){w=we("message",w),i&&(w=i(w));let{prefix:v,scalar:B,pointBytes:P}=M(d),O=C(m.context,v,w),z=K.multiply(O).toRawBytes(),I=C(m.context,z,P,w),T=U(O+I*B);j(T);let oe=Ir(z,Ve(T,t.BYTES));return we("result",oe,o*2)}let G=Sa;function Y(w,d,m,v=G){let{context:B,zip215:P}=v,O=t.BYTES;w=we("signature",w,2*O),d=we("message",d),i&&(d=i(d));let z=ke(w.slice(O,2*O)),I,T,oe;try{I=y.fromHex(m,P),T=y.fromHex(w.slice(0,O),P),oe=K.multiplyUnsafe(z)}catch{return!1}if(!P&&I.isSmallOrder())return!1;let fe=C(B,T.toRawBytes(),I.toRawBytes(),d);return T.add(I.multiplyUnsafe(fe)).subtract(oe).clearCofactor().equals(y.ZERO)}return K._setWindowSize(8),{CURVE:e,getPublicKey:$,sign:ee,verify:Y,ExtendedPoint:y,utils:{getExtendedPublicKey:M,randomPrivateKey:()=>a(t.BYTES),precompute(w=8,d=y.BASE){return d._setWindowSize(w),d.multiply(BigInt(3)),d}}}}var Tt=BigInt(0),bn=BigInt(1);function ka(r){return Oe(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function Or(r){let e=ka(r),{P:t}=e,n=b=>Z(b,t),i=e.montgomeryBits,s=Math.ceil(i/8),a=e.nByteLength,o=e.adjustScalarBytes||(b=>b),c=e.powPminus2||(b=>ln(b,t-BigInt(2),t));function u(b,_,y){let K=n(b*(_-y));return _=n(_-K),y=n(y+K),[_,y]}function f(b){if(typeof b=="bigint"&&Tt<=b&&b<t)return b;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function l(b,_){let y=f(b),K=f(_),H=y,A=bn,U=Tt,D=y,M=bn,$=Tt,C;for(let G=BigInt(i-1);G>=Tt;G--){let Y=K>>G&bn;$^=Y,C=u($,A,D),A=C[0],D=C[1],C=u($,U,M),U=C[0],M=C[1],$=Y;let g=A+U,w=n(g*g),d=A-U,m=n(d*d),v=w-m,B=D+M,P=D-M,O=n(P*g),z=n(B*d),I=O+z,T=O-z;D=n(I*I),M=n(H*n(T*T)),A=n(w*m),U=n(v*(w+n(h*v)))}C=u($,A,D),A=C[0],D=C[1],C=u($,U,M),U=C[0],M=C[1];let ee=c(U);return n(A*ee)}function p(b){return Ve(n(b),s)}function x(b){let _=we("u coordinate",b,s);return a===s&&(_[a-1]&=127),ke(_)}function S(b){let _=we("scalar",b);if(_.length!==s&&_.length!==a)throw new Error(`Expected ${s} or ${a} bytes, got ${_.length}`);return ke(o(_))}function k(b,_){let y=x(_),K=S(b),H=l(y,K);if(H===Tt)throw new Error("Invalid private or public key received");return p(H)}let N=p(e.Gu);function j(b){return k(b,N)}return{scalarMult:k,scalarMultBase:j,getSharedSecret:(b,_)=>k(b,_),getPublicKey:b=>j(b),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:N}}var Nt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Zi=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Lu=BigInt(0),Pa=BigInt(1),yn=BigInt(2),Ia=BigInt(5),Vi=BigInt(10),La=BigInt(20),Ua=BigInt(40),Xi=BigInt(80);function $i(r){let e=Nt,n=r*r%e*r%e,i=Q(n,yn,e)*n%e,s=Q(i,Pa,e)*r%e,a=Q(s,Ia,e)*s%e,o=Q(a,Vi,e)*a%e,c=Q(o,La,e)*o%e,u=Q(c,Ua,e)*c%e,f=Q(u,Xi,e)*u%e,h=Q(f,Xi,e)*u%e,l=Q(h,Vi,e)*a%e;return{pow_p_5_8:Q(l,yn,e)*r%e,b2:n}}function Yi(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Oa(r,e){let t=Nt,n=Z(e*e*e,t),i=Z(n*n*e,t),s=$i(r*i).pow_p_5_8,a=Z(r*n*s,t),o=Z(e*a*a,t),c=a,u=Z(a*Zi,t),f=o===r,h=o===Z(-r,t),l=o===Z(-r*Zi,t);return f&&(a=c),(h||l)&&(a=u),ji(a,t)&&(a=Z(-a,t)),{isValid:f||h,value:a}}var He=Lr(Nt,void 0,!0),pn={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:He,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Bt,randomBytes:lt,adjustScalarBytes:Yi,uvRatio:Oa},Wi=st(pn);function Qi(r,e,t){if(e.length>255)throw new Error("Context is too big");return fr(At("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,r)}var Uu=st({...pn,domain:Qi}),Ou=st({...pn,domain:Qi,prehash:Bt}),xn=(()=>Or({P:Nt,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{let e=Nt,{pow_p_5_8:t,b2:n}=$i(r);return Z(Q(t,BigInt(3),e)*n,e)},adjustScalarBytes:Yi,randomBytes:lt}))();var Ha=(He.ORDER+BigInt(3))/BigInt(8),Hu=He.pow(yn,Ha),Ku=He.sqrt(He.neg(He.ONE)),Tu=(He.ORDER-BigInt(5))/BigInt(8),Nu=BigInt(486662);var zu=Mi(He,He.neg(BigInt(486664)));var Du=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Cu=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Ru=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ju=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var qu=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var zt="X25519",Hr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=32,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(t,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=Wi.utils.randomPrivateKey(),t=new ne(zt,e,"private");return{publicKey:await this.derivePublicKey(t),privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(V,De,new Uint8Array(e)),n=await this._hkdf.labeledExpand(t,at,V,this._nSk),i=new ne(zt,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):t(new ne(zt,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((n,i)=>{t&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!t&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new ne(zt,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let n=xn.getPublicKey(e.key);t(new ne(zt,n,"public"))})}_dh(e,t){return new Promise((n,i)=>{try{n(xn.getSharedSecret(e.key,t.key).buffer)}catch(s){i(s)}})}};var[ts,rs,ns]=[[],[],[]],Ka=BigInt(0),Dt=BigInt(1),Ta=BigInt(2),Na=BigInt(7),za=BigInt(256),Da=BigInt(113);for(let r=0,e=Dt,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],ts.push(2*(5*n+t)),rs.push((r+1)*(r+2)/2%64);let i=Ka;for(let s=0;s<7;s++)e=(e<<Dt^(e>>Na)*Da)%za,e&Ta&&(i^=Dt<<(Dt<<BigInt(s))-Dt);ns.push(i)}var[Ca,Ra]=L.split(ns,!0),Ji=(r,e,t)=>t>32?L.rotlBH(r,e,t):L.rotlSH(r,e,t),es=(r,e,t)=>t>32?L.rotlBL(r,e,t):L.rotlSL(r,e,t);function ja(r,e=24){let t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)t[a]=r[a]^r[a+10]^r[a+20]^r[a+30]^r[a+40];for(let a=0;a<10;a+=2){let o=(a+8)%10,c=(a+2)%10,u=t[c],f=t[c+1],h=Ji(u,f,1)^t[o],l=es(u,f,1)^t[o+1];for(let p=0;p<50;p+=10)r[a+p]^=h,r[a+p+1]^=l}let i=r[2],s=r[3];for(let a=0;a<24;a++){let o=rs[a],c=Ji(i,s,o),u=es(i,s,o),f=ts[a];i=r[f],s=r[f+1],r[f]=c,r[f+1]=u}for(let a=0;a<50;a+=10){for(let o=0;o<10;o++)t[o]=r[a+o];for(let o=0;o<10;o++)r[a+o]^=~t[(o+2)%10]&t[(o+4)%10]}r[0]^=Ca[n],r[1]^=Ra[n]}t.fill(0)}var _t=class extends Ce{constructor(e,t,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ce.number(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=xi(this.state)}keccak(){ja(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ce.exists(this);let{blockLen:t,state:n}=this;e=Re(e);let i=e.length;for(let s=0;s<i;){let a=Math.min(t-this.pos,i-s);for(let o=0;o<a;o++)n[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,t&128&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){ce.exists(this,!1),ce.bytes(e),this.finish();let t=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();let a=Math.min(n-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ce.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ce.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:n,outputLen:i,rounds:s,enableXOF:a}=this;return e||(e=new _t(t,n,i,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}},Xe=(r,e,t)=>pe(()=>new _t(e,r,t)),Yu=Xe(6,144,224/8),Wu=Xe(6,136,256/8),Qu=Xe(6,104,384/8),Ju=Xe(6,72,512/8),ef=Xe(1,144,224/8),tf=Xe(1,136,256/8),rf=Xe(1,104,384/8),nf=Xe(1,72,512/8),is=(r,e,t)=>gi((n={})=>new _t(e,r,n.dkLen===void 0?t:n.dkLen,!0)),sf=is(31,168,128/8),gn=is(31,136,256/8);var qa=pe(()=>gn.create({dkLen:114})),Ma=pe(()=>gn.create({dkLen:64})),Ct=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function ss(r){let e=Ct,t=BigInt(1),n=BigInt(2),i=BigInt(3),s=BigInt(11),a=BigInt(22),o=BigInt(44),c=BigInt(88),u=BigInt(223),f=r*r*r%e,h=f*f*r%e,l=Q(h,i,e)*h%e,p=Q(l,i,e)*h%e,x=Q(p,n,e)*f%e,S=Q(x,s,e)*x%e,k=Q(S,a,e)*S%e,N=Q(k,o,e)*k%e,j=Q(N,c,e)*N%e,b=Q(j,o,e)*k%e,_=Q(b,n,e)*f%e,y=Q(_,t,e)*r%e;return Q(y,u,e)*_%e}function os(r){return r[0]&=252,r[55]|=128,r[56]=0,r}var as=Lr(Ct,456,!0),df=BigInt(4),cs={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:as,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:qa,randomBytes:lt,adjustScalarBytes:os,domain:(r,e,t)=>{if(e.length>255)throw new Error(`Context is too big: ${e.length}`);return fr(At("SigEd448"),new Uint8Array([t?1:0,e.length]),e,r)},uvRatio:(r,e)=>{let t=Ct,n=Z(r*r*e,t),i=Z(n*r,t),s=Z(i*n*e,t),a=ss(s),o=Z(i*a,t),c=Z(o*o,t);return{isValid:Z(c*e,t)===r,value:o}}},us=st(cs),wf=st({...cs,prehash:Ma}),mn=(()=>Or({a:BigInt(156326),montgomeryBits:448,nByteLength:57,P:Ct,Gu:BigInt(5),powPminus2:r=>{let e=Ct,t=ss(r),n=Q(t,BigInt(2),e);return Z(n*r,e)},adjustScalarBytes:os,randomBytes:lt}))();var bf=(as.ORDER-BigInt(3))/BigInt(4),yf=BigInt(156326);var Rt="X448",Kr=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,n){if(e!=="raw")throw new Error("Unsupported format");return await this._importKey(t,n)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=us.utils.randomPrivateKey(),t=new ne(Rt,e,"private");return{publicKey:await this.derivePublicKey(t),privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(V,De,new Uint8Array(e)),n=await this._hkdf.labeledExpand(t,at,V,this._nSk),i=new ne(Rt,new Uint8Array(n),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,n)=>{e.byteLength!==this._nPk?n(new Error("Invalid public key for the ciphersuite")):t(new ne(Rt,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((n,i)=>{t&&e.byteLength!==this._nPk&&i(new Error("Invalid public key for the ciphersuite")),!t&&e.byteLength!==this._nSk&&i(new Error("Invalid private key for the ciphersuite")),n(new ne(Rt,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let n=mn.getPublicKey(e.key);t(new ne(Rt,n,"public"))})}_dh(e,t){return new Promise((n,i)=>{try{n(mn.getSharedSecret(e.key,t.key).buffer)}catch(s){i(s)}})}};var $e=class extends Ne{constructor(e,t,n){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=t,this._kdf=n}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(e){throw new Pe(e)}}async deriveKeyPair(e){try{return await this._prim.deriveKeyPair(e)}catch(t){throw new Xt(t)}}async serializePublicKey(e){try{return await this._prim.serializePublicKey(e)}catch(t){throw new Mt(t)}}async deserializePublicKey(e){try{return await this._prim.deserializePublicKey(e)}catch(t){throw new ot(t)}}async importKey(e,t,n){try{return await this._prim.importKey(e,t,n)}catch(i){throw new ot(i)}}async encap(e){try{let t=e.nonEphemeralKeyPair===void 0?await this.generateKeyPair():e.nonEphemeralKeyPair,n=await this._prim.serializePublicKey(t.publicKey),i=await this._prim.serializePublicKey(e.recipientPublicKey),s;if(e.senderKey===void 0)s=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey));else{let c=Et(e.senderKey)?e.senderKey.privateKey:e.senderKey,u=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,e.recipientPublicKey));s=vt(u,f)}let a;if(e.senderKey===void 0)a=vt(new Uint8Array(n),new Uint8Array(i));else{let c=Et(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),u=await this._prim.serializePublicKey(c);a=Dn(new Uint8Array(n),new Uint8Array(i),new Uint8Array(u))}let o=await this.generateSharedSecret(s,a);return{enc:n,sharedSecret:o}}catch(t){throw new Gt(t)}}async decap(e){let t;try{t=await this._prim.deserializePublicKey(e.enc)}catch(n){throw new ot(n)}try{let n=Et(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,i=Et(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),s=await this._prim.serializePublicKey(i),a;if(e.senderPublicKey===void 0)a=new Uint8Array(await this._prim.dh(n,t));else{let c=new Uint8Array(await this._prim.dh(n,t)),u=new Uint8Array(await this._prim.dh(n,e.senderPublicKey));a=vt(c,u)}let o;if(e.senderPublicKey===void 0)o=vt(new Uint8Array(e.enc),new Uint8Array(s));else{let c=await this._prim.serializePublicKey(e.senderPublicKey);o=new Uint8Array(e.enc.byteLength+s.byteLength+c.byteLength),o.set(new Uint8Array(e.enc),0),o.set(new Uint8Array(s),e.enc.byteLength),o.set(new Uint8Array(c),e.enc.byteLength+s.byteLength)}return await this.generateSharedSecret(a,o)}catch(n){throw new Ft(n)}}async generateSharedSecret(e,t){let n=this._kdf.buildLabeledIkm(qn,e),i=this._kdf.buildLabeledInfo(Zn,t,this.secretSize);return await this._kdf.extractAndExpand(V,n,i,this.secretSize)}},Tr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemP256HkdfSha256,2),3);let n=new Fe(e,t),i=new yt(q.DhkemP256HkdfSha256,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Nr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemP384HkdfSha384,2),3);let n=new bt(e,t),i=new yt(q.DhkemP384HkdfSha384,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}},zr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemP521HkdfSha512,2),3);let n=new et(e,t),i=new yt(q.DhkemP521HkdfSha512,n,e);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}},Dr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemSecp256K1HkdfSha256,2),3);let n=new Fe(e,t),i=new Br(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Cr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemX25519HkdfSha256,2),3);let n=new Fe(e,t),i=new Hr(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}},Rr=class extends $e{constructor(e){let t=new Uint8Array(Je);t.set(ue(q.DhkemX448HkdfSha512,2),3);let n=new et(e,t),i=new Kr(n);super(e,i,n),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:q.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};var _n=class{constructor(e){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.kem){case q.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case q.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case q.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case q.DhkemSecp256K1HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case q.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case q.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new be("Invalid KEM id")}switch(this.kem=e.kem,e.kdf){case de.HkdfSha256:case de.HkdfSha384:case de.HkdfSha512:break;default:throw new be("Invalid KDF id")}switch(this.kdf=e.kdf,e.aead){case te.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case te.Aes256Gcm:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case te.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case te.ExportOnly:break;default:throw new be("Invalid AEAD id")}this.aead=e.aead,this._suiteId=new Uint8Array(jn),this._suiteId.set(ue(this.kem,2),4),this._suiteId.set(ue(this.kdf,2),6),this._suiteId.set(ue(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(e){return await this.setup(),ar(this.aead,e,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>128)throw new be("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(e)}async importKey(e,t,n=!0){return await this.setup(),await this._kem.importKey(e,t,n)}async createSenderContext(e){this.validateInputLength(e),await this.setup();let t=await this._kem.encap(e),n;return e.psk!==void 0?n=e.senderKey!==void 0?_e.AuthPsk:_e.Psk:n=e.senderKey!==void 0?_e.Auth:_e.Base,await this.keyScheduleS(n,t.sharedSecret,t.enc,e)}async createRecipientContext(e){this.validateInputLength(e),await this.setup();let t=await this._kem.decap(e),n;return e.psk!==void 0?n=e.senderPublicKey!==void 0?_e.AuthPsk:_e.Psk:n=e.senderPublicKey!==void 0?_e.Auth:_e.Base,await this.keyScheduleR(n,t,e)}async seal(e,t,n=V){let i=await this.createSenderContext(e);return{ct:await i.seal(t,n),enc:i.enc}}async open(e,t,n=V){return await(await this.createRecipientContext(e)).open(t,n)}async setup(){this._api=await Cn(),(this._kem===void 0||this._kdf===void 0)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(e,t,n){let i=this.createKdfContext(),s=n.psk===void 0?V:new Uint8Array(n.psk.id),a=await i.labeledExtract(V,Gn,s),o=n.info===void 0?V:new Uint8Array(n.info),c=await i.labeledExtract(V,Mn,o),u=new Uint8Array(1+a.byteLength+c.byteLength);u.set(new Uint8Array([e]),0),u.set(new Uint8Array(a),1),u.set(new Uint8Array(c),1+a.byteLength);let f=n.psk===void 0?V:new Uint8Array(n.psk.key),h=i.buildLabeledIkm(Fn,f),l=i.buildLabeledInfo($n,u,i.hashSize),p=await i.extractAndExpand(t,h,l,i.hashSize);if(this.aead===te.ExportOnly)return{params:{aead:this.aead,exporterSecret:p},kdf:i};let x=i.buildLabeledInfo(Vn,u,this.aeadKeySize),S=await i.extractAndExpand(t,h,x,this.aeadKeySize),k=i.buildLabeledInfo(Xn,u,this.aeadNonceSize),N=await i.extractAndExpand(t,h,k,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:p,key:S,baseNonce:new Uint8Array(N),seq:0},kdf:i}}async keyScheduleS(e,t,n,i){let s=await this.keySchedule(e,t,i);return s.params.key===void 0?new Yt(this._api,s.kdf,s.params.exporterSecret,n):new br(this._api,s.kdf,s.params,n)}async keyScheduleR(e,t,n){let i=await this.keySchedule(e,t,n);return i.params.key===void 0?new $t(this._api,i.kdf,i.params.exporterSecret):new wr(this._api,i.kdf,i.params)}validateInputLength(e){if(e.info!==void 0&&e.info.byteLength>128)throw new be("Too long info");if(e.psk!==void 0){if(e.psk.key.byteLength<32)throw new be(`PSK must have at least ${32} bytes`);if(e.psk.key.byteLength>128)throw new be("Too long psk.key");if(e.psk.id.byteLength>128)throw new be("Too long psk.id")}}createKemContext(){switch(this.kem){case q.DhkemP256HkdfSha256:return new Tr(this._api);case q.DhkemP384HkdfSha384:return new Nr(this._api);case q.DhkemP521HkdfSha512:return new zr(this._api);case q.DhkemX25519HkdfSha256:return new Cr(this._api);case q.DhkemX448HkdfSha512:return new Rr(this._api);default:return new Dr(this._api)}}createKdfContext(){switch(this.kdf){case de.HkdfSha256:return new Fe(this._api,this._suiteId);case de.HkdfSha384:return new bt(this._api,this._suiteId);default:return new et(this._api,this._suiteId)}}};export{te as Aead,_n as CipherSuite,Ft as DecapError,Xt as DeriveKeyPairError,ot as DeserializeError,Gt as EncapError,Zt as ExportError,be as InvalidParamError,de as Kdf,q as Kem,Vt as MessageLimitReachedError,Pe as NotSupportedError,We as OpenError,Ye as SealError,Mt as SerializeError,Hn as ValidationError};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed448.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
