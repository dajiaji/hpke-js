var ee=class extends Error{constructor(e){let t;e instanceof Error?t=e.message:typeof e=="string"?t=e:t="",super(t),this.name=this.constructor.name}},F=class extends ee{},Ht=class extends ee{},V=class extends ee{},R=class extends ee{},$e=class extends ee{},We=class extends ee{},Ye=class extends ee{},qe=class extends ee{},Je=class extends ee{},Ze=class extends ee{},ne=class extends ee{},X=class extends ee{};var Ri={},Lt=Fi(globalThis,Ri);function Fi(r,e){return new Proxy(r,{get(t,i,n){return i in e?e[i]:r[i]},set(t,i,n){return i in e&&delete e[i],r[i]=n,!0},deleteProperty(t,i){let n=!1;return i in e&&(delete e[i],n=!0),i in r&&(delete r[i],n=!0),n},ownKeys(t){let i=Reflect.ownKeys(r),n=Reflect.ownKeys(e),a=new Set(n);return[...i.filter(o=>!a.has(o)),...n]},defineProperty(t,i,n){return i in e&&delete e[i],Reflect.defineProperty(r,i,n),!0},getOwnPropertyDescriptor(t,i){return i in e?Reflect.getOwnPropertyDescriptor(e,i):Reflect.getOwnPropertyDescriptor(r,i)},has(t,i){return i in e||i in r}})}async function Vi(){if(Lt!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto.subtle;try{let{webcrypto:r}=await import("crypto");return r.subtle}catch(r){throw new X(r)}}var ie=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){this._api===void 0&&(this._api=await Vi())}};var pe={Base:0,Psk:1,Auth:2,AuthPsk:3},S={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48,MlKem512:64,MlKem768:65,MlKem1024:66,XWing:25722},ce={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},te={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var B=new Uint8Array(0);var It=new Uint8Array([75,69,77,0,0]);var He=r=>typeof r=="object"&&r!==null&&typeof r.privateKey=="object"&&typeof r.publicKey=="object";function ae(r,e){if(e<=0)throw new Error("i2Osp: too small size");if(r>=256**e)throw new Error("i2Osp: too large integer");let t=new Uint8Array(e);for(let i=0;i<e&&r;i++)t[e-(i+1)]=r%256,r=r>>8;return t}function Ce(r,e){let t=new Uint8Array(r.length+e.length);return t.set(r,0),t.set(e,r.length),t}function ue(r){let e=r.replace(/-/g,"+").replace(/_/g,"/"),t=atob(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i}async function ar(){if(Lt!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:r}=await import("crypto");return r}catch{throw new Error("Web Cryptograph API not supported")}}function or(r,e){if(r.byteLength!==e.byteLength)throw new Error("xor: different length inputs");let t=new Uint8Array(r.byteLength);for(let i=0;i<r.byteLength;i++)t[i]=r[i]^e[i];return t}var Xi=new Uint8Array([101,97,101,95,112,114,107]),$i=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);function Wi(r,e,t){let i=new Uint8Array(r.length+e.length+t.length);return i.set(r,0),i.set(e,r.length),i.set(t,r.length+e.length),i}var re=class{constructor(e,t,i){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e,this._prim=t,this._kdf=i;let n=new Uint8Array(It);n.set(ae(this.id,2),3),this._kdf.init(n)}async serializePublicKey(e){return await this._prim.serializePublicKey(e)}async deserializePublicKey(e){return await this._prim.deserializePublicKey(e)}async serializePrivateKey(e){return await this._prim.serializePrivateKey(e)}async deserializePrivateKey(e){return await this._prim.deserializePrivateKey(e)}async importKey(e,t,i=!0){return await this._prim.importKey(e,t,i)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>8192)throw new F("Too long ikm");return await this._prim.deriveKeyPair(e)}async encap(e){let t;e.ekm===void 0?t=await this.generateKeyPair():He(e.ekm)?t=e.ekm:t=await this.deriveKeyPair(e.ekm);let i=await this._prim.serializePublicKey(t.publicKey),n=await this._prim.serializePublicKey(e.recipientPublicKey);try{let a;if(e.senderKey===void 0)a=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey));else{let c=He(e.senderKey)?e.senderKey.privateKey:e.senderKey,h=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey)),f=new Uint8Array(await this._prim.dh(c,e.recipientPublicKey));a=Ce(h,f)}let o;if(e.senderKey===void 0)o=Ce(new Uint8Array(i),new Uint8Array(n));else{let c=He(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),h=await this._prim.serializePublicKey(c);o=Wi(new Uint8Array(i),new Uint8Array(n),new Uint8Array(h))}let s=await this._generateSharedSecret(a,o);return{enc:i,sharedSecret:s}}catch(a){throw new $e(a)}}async decap(e){let t=await this._prim.deserializePublicKey(e.enc),i=He(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,n=He(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),a=await this._prim.serializePublicKey(n);try{let o;if(e.senderPublicKey===void 0)o=new Uint8Array(await this._prim.dh(i,t));else{let c=new Uint8Array(await this._prim.dh(i,t)),h=new Uint8Array(await this._prim.dh(i,e.senderPublicKey));o=Ce(c,h)}let s;if(e.senderPublicKey===void 0)s=Ce(new Uint8Array(e.enc),new Uint8Array(a));else{let c=await this._prim.serializePublicKey(e.senderPublicKey);s=new Uint8Array(e.enc.byteLength+a.byteLength+c.byteLength),s.set(new Uint8Array(e.enc),0),s.set(new Uint8Array(a),e.enc.byteLength),s.set(new Uint8Array(c),e.enc.byteLength+a.byteLength)}return await this._generateSharedSecret(o,s)}catch(o){throw new We(o)}}async _generateSharedSecret(e,t){let i=this._kdf.buildLabeledIkm(Xi,e),n=this._kdf.buildLabeledInfo($i,t,this.secretSize);return await this._kdf.extractAndExpand(B.buffer,i.buffer,n.buffer,this.secretSize)}};var Y=["deriveBits"],ye=new Uint8Array([100,107,112,95,112,114,107]),Le=new Uint8Array([115,107]);var Ot=class{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(this._num[e]!==0)return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let t=0;t<this._num.length;t++){if(this._num[t]<e[t])return!0;if(this._num[t]>e[t])return!1}return!1}};var Yi=new Uint8Array([99,97,110,100,105,100,97,116,101]),qi=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Ji=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),Zi=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),Qi=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),en=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),tn=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]),xe=class extends ie{constructor(e,t){switch(super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,e){case S.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=qi,this._bitmask=255,this._pkcs8AlgId=Qi;break;case S.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=Ji,this._bitmask=255,this._pkcs8AlgId=en;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=Zi,this._bitmask=1,this._pkcs8AlgId=tn;break}}async serializePublicKey(e){await this._setup();try{return await this._api.exportKey("raw",e)}catch(t){throw new V(t)}}async deserializePublicKey(e){await this._setup();try{return await this._importRawKey(e,!0)}catch(t){throw new R(t)}}async serializePrivateKey(e){await this._setup();try{let t=await this._api.exportKey("jwk",e);if(!("d"in t))throw new Error("Not private key");return ue(t.d).buffer}catch(t){throw new V(t)}}async deserializePrivateKey(e){await this._setup();try{return await this._importRawKey(e,!1)}catch(t){throw new R(t)}}async importKey(e,t,i){await this._setup();try{if(e==="raw")return await this._importRawKey(t,i);if(t instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(t,i)}catch(n){throw new R(n)}}async generateKeyPair(){await this._setup();try{return await this._api.generateKey(this._alg,!0,Y)}catch(e){throw new X(e)}}async deriveKeyPair(e){await this._setup();try{let t=await this._hkdf.labeledExtract(B.buffer,ye,new Uint8Array(e)),i=new Ot(this._nSk);for(let a=0;i.isZero()||!i.lessThan(this._order);a++){if(a>255)throw new Error("Faild to derive a key pair");let o=new Uint8Array(await this._hkdf.labeledExpand(t,Yi,ae(a,1),this._nSk));o[0]=o[0]&this._bitmask,i.set(o)}let n=await this._deserializePkcs8Key(i.val());return i.reset(),{privateKey:n,publicKey:await this.derivePublicKey(n)}}catch(t){throw new ne(t)}}async derivePublicKey(e){await this._setup();try{let t=await this._api.exportKey("jwk",e);return delete t.d,delete t.key_ops,await this._api.importKey("jwk",t,this._alg,!0,[])}catch(t){throw new R(t)}}async dh(e,t){try{return await this._setup(),await this._api.deriveBits({name:"ECDH",public:t},e,this._nDh*8)}catch(i){throw new V(i)}}async _importRawKey(e,t){if(t&&e.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!t&&e.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");return t?await this._api.importKey("raw",e,this._alg,!0,[]):await this._deserializePkcs8Key(new Uint8Array(e))}async _importJWK(e,t){if(typeof e.crv>"u"||e.crv!==this._alg.namedCurve)throw new Error(`Invalid crv: ${e.crv}`);if(t){if(typeof e.d<"u")throw new Error("Invalid key: `d` should not be set");return await this._api.importKey("jwk",e,this._alg,!0,[])}if(typeof e.d>"u")throw new Error("Invalid key: `d` not found");return await this._api.importKey("jwk",e,this._alg,!0,Y)}async _deserializePkcs8Key(e){let t=new Uint8Array(this._pkcs8AlgId.length+e.length);return t.set(this._pkcs8AlgId,0),t.set(e,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",t,this._alg,!0,Y)}};var $=class{constructor(e,t,i,n=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=t,this.type=i,this.algorithm={name:e},this.usages=n,i==="public"&&(this.usages=[])}};var Nr=new Uint8Array([72,80,75,69,45,118,49]),lt=class extends ie{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:B}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(e){this._suiteId=e}buildLabeledIkm(e,t){this._checkInit();let i=new Uint8Array(7+this._suiteId.byteLength+e.byteLength+t.byteLength);return i.set(Nr,0),i.set(this._suiteId,7),i.set(e,7+this._suiteId.byteLength),i.set(t,7+this._suiteId.byteLength+e.byteLength),i}buildLabeledInfo(e,t,i){this._checkInit();let n=new Uint8Array(9+this._suiteId.byteLength+e.byteLength+t.byteLength);return n.set(new Uint8Array([0,i]),0),n.set(Nr,2),n.set(this._suiteId,9),n.set(e,9+this._suiteId.byteLength),n.set(t,9+this._suiteId.byteLength+e.byteLength),n}async extract(e,t){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)throw new F("The salt length must be the same as the hashSize");let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",i,t)}async expand(e,t,i){await this._setup();let n=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),a=new ArrayBuffer(i),o=new Uint8Array(a),s=B,c=new Uint8Array(t),h=new Uint8Array(1);if(i>255*this.hashSize)throw new Error("Entropy limit reached");let f=new Uint8Array(this.hashSize+c.length+1);for(let u=1,l=0;l<o.length;u++)h[0]=u,f.set(s,0),f.set(c,s.length),f.set(h,s.length+c.length),s=new Uint8Array(await this._api.sign("HMAC",n,f.slice(0,s.length+c.length+1))),o.length-l>=s.length?(o.set(s,l),l+=s.length):(o.set(s.slice(0,o.length-l),l),l+=o.length-l);return a}async extractAndExpand(e,t,i,n){await this._setup();let a=await this._api.importKey("raw",t,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:i},a,n*8)}async labeledExtract(e,t,i){return await this.extract(e,this.buildLabeledIkm(t,i).buffer)}async labeledExpand(e,t,i,n){return await this.expand(e,this.buildLabeledInfo(t,i,n).buffer,n)}_checkInit(){if(this._suiteId===B)throw new Error("Not initialized. Call init()")}},Ie=class extends lt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}},Ne=class extends lt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}},Oe=class extends lt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}};var sr=["encrypt","decrypt"];var Mr=BigInt(0);function rn(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function oe(r,e,t=""){let i=rn(r),n=r?.length,a=e!==void 0;if(!i||a&&n!==e){let o=t&&`"${t}" `,s=a?` of length ${e}`:"",c=i?`length=${n}`:`type=${typeof r}`;throw new Error(o+"expected Uint8Array"+s+", got "+c)}return r}function Rr(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Bt(r.outputLen),Bt(r.blockLen)}function Qe(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Fr(r,e){oe(r,void 0,"digestInto() output");let t=e.outputLen;if(r.length<t)throw new Error('"digestInto() output" expected to be of length >='+t)}function Bt(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function nn(r){if(typeof r=="bigint"){if(!Ut(r))throw new Error("positive bigint expected, got "+r)}else Bt(r);return r}function ke(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function jt(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function fe(r,e){return r<<32-e|r>>>e}var Vr=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",an=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function on(r){if(oe(r),Vr)return r.toHex();let e="";for(let t=0;t<r.length;t++)e+=an[r[t]];return e}var ve={_0:48,_9:57,A:65,F:70,a:97,f:102};function Gr(r){if(r>=ve._0&&r<=ve._9)return r-ve._0;if(r>=ve.A&&r<=ve.F)return r-(ve.A-10);if(r>=ve.a&&r<=ve.f)return r-(ve.a-10)}function sn(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(Vr)return Uint8Array.fromHex(r);let e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);let i=new Uint8Array(t);for(let n=0,a=0;n<t;n++,a+=2){let o=Gr(r.charCodeAt(a)),s=Gr(r.charCodeAt(a+1));if(o===void 0||s===void 0){let c=r[a]+r[a+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+a)}i[n]=o*16+s}return i}function cn(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Mr:BigInt("0x"+r)}function cr(r){return cn(on(zt(oe(r)).reverse()))}function un(r,e){Bt(e),r=nn(r);let t=sn(r.toString(16).padStart(e*2,"0"));if(t.length!==e)throw new Error("number too large");return t}function Xr(r,e){return un(r,e).reverse()}function zt(r){return Uint8Array.from(r)}var Ut=r=>typeof r=="bigint"&&Mr<=r;function fn(r,e,t){return Ut(r)&&Ut(e)&&Ut(t)&&e<=r&&r<t}function ur(r,e,t,i){if(!fn(e,t,i))throw new Error("expected valid "+r+": "+t+" <= n < "+i+", got "+e)}function $r(r,e={},t={}){if(!r||typeof r!="object")throw new Error("expected valid options object");function i(a,o,s){let c=r[a];if(s&&c===void 0)return;let h=typeof c;if(h!==o||c===null)throw new Error(`param "${a}" is invalid: expected ${o}, got ${h}`)}let n=(a,o)=>Object.entries(a).forEach(([s,c])=>i(s,c,o));n(e,!1),n(t,!0)}function fr(r,e={}){let t=(n,a)=>r(a).update(n).digest(),i=r(void 0);return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=n=>r(n),Object.assign(t,e),Object.freeze(t)}async function Wr(r=32){let e=await ar(),t=new Uint8Array(r);return e.getRandomValues(t),t}var hr=r=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,r])});var Dt=class{constructor(e,t){if(Object.defineProperty(this,"oHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Rr(e),oe(t,void 0,"key"),this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,n=new Uint8Array(i);n.set(t.length>i?e.create().update(t).digest():t);for(let a=0;a<n.length;a++)n[a]^=54;this.iHash.update(n),this.oHash=e.create();for(let a=0;a<n.length;a++)n[a]^=106;this.oHash.update(n),ke(n)}update(e){return Qe(this),this.iHash.update(e),this}digestInto(e){Qe(this),oe(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});let{oHash:t,iHash:i,finished:n,destroyed:a,blockLen:o,outputLen:s}=this;return e=e,e.finished=n,e.destroyed=a,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},et=(r,e,t)=>new Dt(r,e).update(t).digest();et.create=(r,e)=>new Dt(r,e);function Yr(r,e,t){return r&e^~r&t}function qr(r,e,t){return r&e^r&t^e&t}var dt=class{constructor(e,t,i,n){Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"padOffset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isLE",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.blockLen=e,this.outputLen=t,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(e),this.view=jt(this.buffer)}update(e){Qe(this),oe(e);let{view:t,buffer:i,blockLen:n}=this,a=e.length;for(let o=0;o<a;){let s=Math.min(n-this.pos,a-o);if(s===n){let c=jt(e);for(;n<=a-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qe(this),Fr(e,this),this.finished=!0;let{buffer:t,view:i,blockLen:n,isLE:a}=this,{pos:o}=this;t[o++]=128,ke(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(i,0),o=0);for(let u=o;u<n;u++)t[u]=0;i.setBigUint64(n-8,BigInt(this.length*8),a),this.process(i,0);let s=jt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let h=c/4,f=this.get();if(h>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<h;u++)s.setUint32(4*u,f[u],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}_cloneInto(e){e||=new this.constructor,e.set(...this.get());let{blockLen:t,buffer:i,length:n,finished:a,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=a,e.length=n,e.pos=s,n%t&&e.buffer.set(i),e}clone(){return this._cloneInto()}},Pe=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var q=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Ct=BigInt(4294967295),Jr=BigInt(32);function hn(r,e=!1){return e?{h:Number(r&Ct),l:Number(r>>Jr&Ct)}:{h:Number(r>>Jr&Ct)|0,l:Number(r&Ct)|0}}function Zr(r,e=!1){let t=r.length,i=new Uint32Array(t),n=new Uint32Array(t);for(let a=0;a<t;a++){let{h:o,l:s}=hn(r[a],e);[i[a],n[a]]=[o,s]}return[i,n]}var lr=(r,e,t)=>r>>>t,dr=(r,e,t)=>r<<32-t|e>>>t,Ge=(r,e,t)=>r>>>t|e<<32-t,Me=(r,e,t)=>r<<32-t|e>>>t,bt=(r,e,t)=>r<<64-t|e>>>t-32,pt=(r,e,t)=>r>>>t-32|e<<64-t;function we(r,e,t,i){let n=(e>>>0)+(i>>>0);return{h:r+t+(n/2**32|0)|0,l:n|0}}var Qr=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),ei=(r,e,t,i)=>e+t+i+(r/2**32|0)|0,ti=(r,e,t,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0),ri=(r,e,t,i,n)=>e+t+i+n+(r/2**32|0)|0,ii=(r,e,t,i,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0)+(n>>>0),ni=(r,e,t,i,n,a)=>e+t+i+n+a+(r/2**32|0)|0;var dn=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ue=new Uint32Array(64),br=class extends dt{constructor(e){super(64,e,8,!1)}get(){let{A:e,B:t,C:i,D:n,E:a,F:o,G:s,H:c}=this;return[e,t,i,n,a,o,s,c]}set(e,t,i,n,a,o,s,c){this.A=e|0,this.B=t|0,this.C=i|0,this.D=n|0,this.E=a|0,this.F=o|0,this.G=s|0,this.H=c|0}process(e,t){for(let u=0;u<16;u++,t+=4)Ue[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){let l=Ue[u-15],p=Ue[u-2],w=fe(l,7)^fe(l,18)^l>>>3,x=fe(p,17)^fe(p,19)^p>>>10;Ue[u]=x+Ue[u-7]+w+Ue[u-16]|0}let{A:i,B:n,C:a,D:o,E:s,F:c,G:h,H:f}=this;for(let u=0;u<64;u++){let l=fe(s,6)^fe(s,11)^fe(s,25),p=f+l+Yr(s,c,h)+dn[u]+Ue[u]|0,x=(fe(i,2)^fe(i,13)^fe(i,22))+qr(i,n,a)|0;f=h,h=c,c=s,s=o+p|0,o=a,a=n,n=i,i=p+x|0}i=i+this.A|0,n=n+this.B|0,a=a+this.C|0,o=o+this.D|0,s=s+this.E|0,c=c+this.F|0,h=h+this.G|0,f=f+this.H|0,this.set(i,n,a,o,s,c,h,f)}roundClean(){ke(Ue)}destroy(){this.set(0,0,0,0,0,0,0,0),ke(this.buffer)}},pr=class extends br{constructor(){super(32),Object.defineProperty(this,"A",{enumerable:!0,configurable:!0,writable:!0,value:Pe[0]|0}),Object.defineProperty(this,"B",{enumerable:!0,configurable:!0,writable:!0,value:Pe[1]|0}),Object.defineProperty(this,"C",{enumerable:!0,configurable:!0,writable:!0,value:Pe[2]|0}),Object.defineProperty(this,"D",{enumerable:!0,configurable:!0,writable:!0,value:Pe[3]|0}),Object.defineProperty(this,"E",{enumerable:!0,configurable:!0,writable:!0,value:Pe[4]|0}),Object.defineProperty(this,"F",{enumerable:!0,configurable:!0,writable:!0,value:Pe[5]|0}),Object.defineProperty(this,"G",{enumerable:!0,configurable:!0,writable:!0,value:Pe[6]|0}),Object.defineProperty(this,"H",{enumerable:!0,configurable:!0,writable:!0,value:Pe[7]|0})}},ai=Zr(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),bn=ai[0],pn=ai[1],Be=new Uint32Array(80),je=new Uint32Array(80),yr=class extends dt{constructor(e){super(128,e,16,!1)}get(){let{Ah:e,Al:t,Bh:i,Bl:n,Ch:a,Cl:o,Dh:s,Dl:c,Eh:h,El:f,Fh:u,Fl:l,Gh:p,Gl:w,Hh:x,Hl:d}=this;return[e,t,i,n,a,o,s,c,h,f,u,l,p,w,x,d]}set(e,t,i,n,a,o,s,c,h,f,u,l,p,w,x,d){this.Ah=e|0,this.Al=t|0,this.Bh=i|0,this.Bl=n|0,this.Ch=a|0,this.Cl=o|0,this.Dh=s|0,this.Dl=c|0,this.Eh=h|0,this.El=f|0,this.Fh=u|0,this.Fl=l|0,this.Gh=p|0,this.Gl=w|0,this.Hh=x|0,this.Hl=d|0}process(e,t){for(let y=0;y<16;y++,t+=4)Be[y]=e.getUint32(t),je[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){let C=Be[y-15]|0,T=je[y-15]|0,N=Ge(C,T,1)^Ge(C,T,8)^lr(C,T,7),G=Me(C,T,1)^Me(C,T,8)^dr(C,T,7),v=Be[y-2]|0,g=je[y-2]|0,P=Ge(v,g,19)^bt(v,g,61)^lr(v,g,6),A=Me(v,g,19)^pt(v,g,61)^dr(v,g,6),k=ti(G,A,je[y-7],je[y-16]),E=ri(k,N,P,Be[y-7],Be[y-16]);Be[y]=E|0,je[y]=k|0}let{Ah:i,Al:n,Bh:a,Bl:o,Ch:s,Cl:c,Dh:h,Dl:f,Eh:u,El:l,Fh:p,Fl:w,Gh:x,Gl:d,Hh:K,Hl:D}=this;for(let y=0;y<80;y++){let C=Ge(u,l,14)^Ge(u,l,18)^bt(u,l,41),T=Me(u,l,14)^Me(u,l,18)^pt(u,l,41),N=u&p^~u&x,G=l&w^~l&d,v=ii(D,T,G,pn[y],je[y]),g=ni(v,K,C,N,bn[y],Be[y]),P=v|0,A=Ge(i,n,28)^bt(i,n,34)^bt(i,n,39),k=Me(i,n,28)^pt(i,n,34)^pt(i,n,39),E=i&a^i&s^a&s,m=n&o^n&c^o&c;K=x|0,D=d|0,x=p|0,d=w|0,p=u|0,w=l|0,{h:u,l}=we(h|0,f|0,g|0,P|0),h=s|0,f=c|0,s=a|0,c=o|0,a=i|0,o=n|0;let _=Qr(P,k,m);i=ei(_,g,A,E),n=_|0}({h:i,l:n}=we(this.Ah|0,this.Al|0,i|0,n|0)),{h:a,l:o}=we(this.Bh|0,this.Bl|0,a|0,o|0),{h:s,l:c}=we(this.Ch|0,this.Cl|0,s|0,c|0),{h,l:f}=we(this.Dh|0,this.Dl|0,h|0,f|0),{h:u,l}=we(this.Eh|0,this.El|0,u|0,l|0),{h:p,l:w}=we(this.Fh|0,this.Fl|0,p|0,w|0),{h:x,l:d}=we(this.Gh|0,this.Gl|0,x|0,d|0),{h:K,l:D}=we(this.Hh|0,this.Hl|0,K|0,D|0),this.set(i,n,a,o,s,c,h,f,u,l,p,w,x,d,K,D)}roundClean(){ke(Be,je)}destroy(){ke(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},xr=class extends yr{constructor(){super(64),Object.defineProperty(this,"Ah",{enumerable:!0,configurable:!0,writable:!0,value:q[0]|0}),Object.defineProperty(this,"Al",{enumerable:!0,configurable:!0,writable:!0,value:q[1]|0}),Object.defineProperty(this,"Bh",{enumerable:!0,configurable:!0,writable:!0,value:q[2]|0}),Object.defineProperty(this,"Bl",{enumerable:!0,configurable:!0,writable:!0,value:q[3]|0}),Object.defineProperty(this,"Ch",{enumerable:!0,configurable:!0,writable:!0,value:q[4]|0}),Object.defineProperty(this,"Cl",{enumerable:!0,configurable:!0,writable:!0,value:q[5]|0}),Object.defineProperty(this,"Dh",{enumerable:!0,configurable:!0,writable:!0,value:q[6]|0}),Object.defineProperty(this,"Dl",{enumerable:!0,configurable:!0,writable:!0,value:q[7]|0}),Object.defineProperty(this,"Eh",{enumerable:!0,configurable:!0,writable:!0,value:q[8]|0}),Object.defineProperty(this,"El",{enumerable:!0,configurable:!0,writable:!0,value:q[9]|0}),Object.defineProperty(this,"Fh",{enumerable:!0,configurable:!0,writable:!0,value:q[10]|0}),Object.defineProperty(this,"Fl",{enumerable:!0,configurable:!0,writable:!0,value:q[11]|0}),Object.defineProperty(this,"Gh",{enumerable:!0,configurable:!0,writable:!0,value:q[12]|0}),Object.defineProperty(this,"Gl",{enumerable:!0,configurable:!0,writable:!0,value:q[13]|0}),Object.defineProperty(this,"Hh",{enumerable:!0,configurable:!0,writable:!0,value:q[14]|0}),Object.defineProperty(this,"Hl",{enumerable:!0,configurable:!0,writable:!0,value:q[15]|0})}};var wr=fr(()=>new pr,hr(1)),mr=fr(()=>new xr,hr(3));var oi=BigInt(0);function Re(r,e){let t=r%e;return t>=oi?t:e+t}function M(r,e,t){let i=r;for(;e-- >oi;)i*=i,i%=t;return i}function si(r,e){return function(i){let n=r(i);return{secretKey:n,publicKey:e(n)}}}var yt=BigInt(0),tt=BigInt(1),Tt=BigInt(2);function yn(r){return $r(r,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r})}function xt(r){let e=yn(r),{P:t,type:i,adjustScalarBytes:n,powPminus2:a,randomBytes:o}=e,s=i==="x25519";if(!s&&i!=="x448")throw new Error("invalid type");let c=o||Wr,h=s?255:448,f=s?32:56,u=BigInt(s?9:5),l=BigInt(s?121665:39081),p=s?Tt**BigInt(254):Tt**BigInt(447),w=s?BigInt(8)*Tt**BigInt(251)-tt:BigInt(4)*Tt**BigInt(445)-tt,x=p+w+tt,d=m=>Re(m,t),K=D(u);function D(m){return Xr(d(m),f)}function y(m){let _=zt(oe(m,f,"uCoordinate"));return s&&(_[31]&=127),d(cr(_))}function C(m){return cr(n(zt(oe(m,f,"scalar"))))}function T(m,_){let H=P(y(_),C(m));if(H===yt)throw new Error("invalid private or public key received");return D(H)}function N(m){return T(m,K)}let G=N,v=T;function g(m,_,H){let j=d(m*(_-H));return _=d(_-j),H=d(H+j),{x_2:_,x_3:H}}function P(m,_){ur("u",m,yt,t),ur("scalar",_,p,x);let H=_,j=m,L=tt,b=yt,O=m,z=tt,U=yt;for(let he=BigInt(h-1);he>=yt;he--){let ge=H>>he&tt;U^=ge,{x_2:L,x_3:O}=g(U,L,O),{x_2:b,x_3:z}=g(U,b,z),U=ge;let le=L+b,de=d(le*le),be=L-b,_e=d(be*be),Br=de-_e,Gi=O+z,Mi=O-z,jr=d(Mi*le),zr=d(Gi*be),Dr=jr+zr,Cr=jr-zr;O=d(Dr*Dr),z=d(j*d(Cr*Cr)),L=d(de*_e),b=d(Br*(de+d(l*Br)))}({x_2:L,x_3:O}=g(U,L,O)),{x_2:b,x_3:z}=g(U,b,z);let se=a(b);return d(L*se)}let A={secretKey:f,publicKey:f,seed:f},k=async m=>(m===void 0&&(m=await c(f)),oe(m,A.seed,"seed"),m),E={randomSecretKey:k};return Object.freeze({keygen:si(k,G),getSharedSecret:v,getPublicKey:G,scalarMult:T,scalarMultBase:N,utils:E,GuBytes:K.slice(),lengths:A})}var _r=class extends ie{constructor(e){super(),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=e}async seal(e,t,i){await this._setupKey();let n={name:"AES-GCM",iv:e,additionalData:i};return await this._api.encrypt(n,this._key,t)}async open(e,t,i){await this._setupKey();let n={name:"AES-GCM",iv:e,additionalData:i};return await this._api.decrypt(n,this._key,t)}async _setupKey(){if(this._key!==void 0)return;await this._setup();let e=await this._importKey(this._rawKey);new Uint8Array(this._rawKey).fill(0),this._key=e}async _importKey(e){return await this._api.importKey("raw",e,{name:"AES-GCM"},!0,sr)}},rt=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new _r(e)}},wt=class extends rt{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}};var mt=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.ExportOnly}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}createEncryptionContext(e){throw new X("Export only")}};function vr(){return new Promise((r,e)=>{e(new X("Not supported"))})}var xn=new Uint8Array([115,101,99]),it=class{constructor(e,t,i){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=e,this._kdf=t,this.exporterSecret=i}async seal(e,t){return await vr()}async open(e,t){return await vr()}async export(e,t){if(e.byteLength>8192)throw new F("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,xn,new Uint8Array(e),t)}catch(i){throw new Ye(i)}}},Nt=class extends it{},Gt=class extends it{constructor(e,t,i,n){super(e,t,i),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}};var nt=class extends it{constructor(e,t,i){if(super(e,t,i.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_ctx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.key===void 0||i.baseNonce===void 0||i.seq===void 0)throw new Error("Required parameters are missing");this._aead=i.aead,this._nK=this._aead.keySize,this._nN=this._aead.nonceSize,this._nT=this._aead.tagSize;let n=this._aead.createEncryptionContext(i.key);this._ctx={key:n,baseNonce:i.baseNonce,seq:i.seq}}computeNonce(e){let t=ae(e.seq,e.baseNonce.byteLength);return or(e.baseNonce,t).buffer}incrementSeq(e){if(e.seq>Number.MAX_SAFE_INTEGER)throw new Ze("Message limit reached");e.seq+=1}};var Mt=class extends nt{async open(e,t=B.buffer){let i;try{i=await this._ctx.key.open(this.computeNonce(this._ctx),e,t)}catch(n){throw new Je(n)}return this.incrementSeq(this._ctx),i}};var Rt=class extends nt{constructor(e,t,i,n){super(e,t,i),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=n}async seal(e,t=B.buffer){let i;try{i=await this._ctx.key.seal(this.computeNonce(this._ctx),e,t)}catch(n){throw new qe(n)}return this.incrementSeq(this._ctx),i}};var wn=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),mn=new Uint8Array([101,120,112]),gn=new Uint8Array([105,110,102,111,95,104,97,115,104]),_n=new Uint8Array([107,101,121]),vn=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),kn=new Uint8Array([115,101,99,114,101,116]),Pn=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),Ft=class extends ie{constructor(e){if(super(),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e.kem=="number")throw new F("KemId cannot be used");if(this._kem=e.kem,typeof e.kdf=="number")throw new F("KdfId cannot be used");if(this._kdf=e.kdf,typeof e.aead=="number")throw new F("AeadId cannot be used");this._aead=e.aead,this._suiteId=new Uint8Array(Pn),this._suiteId.set(ae(this._kem.id,2),4),this._suiteId.set(ae(this._kdf.id,2),6),this._suiteId.set(ae(this._aead.id,2),8),this._kdf.init(this._suiteId)}get kem(){return this._kem}get kdf(){return this._kdf}get aead(){return this._aead}async createSenderContext(e){this._validateInputLength(e),await this._setup();let t=await this._kem.encap(e),i;return e.psk!==void 0?i=e.senderKey!==void 0?pe.AuthPsk:pe.Psk:i=e.senderKey!==void 0?pe.Auth:pe.Base,await this._keyScheduleS(i,t.sharedSecret,t.enc,e)}async createRecipientContext(e){this._validateInputLength(e),await this._setup();let t=await this._kem.decap(e),i;return e.psk!==void 0?i=e.senderPublicKey!==void 0?pe.AuthPsk:pe.Psk:i=e.senderPublicKey!==void 0?pe.Auth:pe.Base,await this._keyScheduleR(i,t,e)}async seal(e,t,i=B.buffer){let n=await this.createSenderContext(e);return{ct:await n.seal(t,i),enc:n.enc}}async open(e,t,i=B.buffer){return await(await this.createRecipientContext(e)).open(t,i)}async _keySchedule(e,t,i){let n=i.psk===void 0?B:new Uint8Array(i.psk.id),a=await this._kdf.labeledExtract(B.buffer,vn,n),o=i.info===void 0?B:new Uint8Array(i.info),s=await this._kdf.labeledExtract(B.buffer,gn,o),c=new Uint8Array(1+a.byteLength+s.byteLength);c.set(new Uint8Array([e]),0),c.set(new Uint8Array(a),1),c.set(new Uint8Array(s),1+a.byteLength);let h=i.psk===void 0?B:new Uint8Array(i.psk.key),f=this._kdf.buildLabeledIkm(kn,h).buffer,u=this._kdf.buildLabeledInfo(mn,c,this._kdf.hashSize).buffer,l=await this._kdf.extractAndExpand(t,f,u,this._kdf.hashSize);if(this._aead.id===te.ExportOnly)return{aead:this._aead,exporterSecret:l};let p=this._kdf.buildLabeledInfo(_n,c,this._aead.keySize).buffer,w=await this._kdf.extractAndExpand(t,f,p,this._aead.keySize),x=this._kdf.buildLabeledInfo(wn,c,this._aead.nonceSize).buffer,d=await this._kdf.extractAndExpand(t,f,x,this._aead.nonceSize);return{aead:this._aead,exporterSecret:l,key:w,baseNonce:new Uint8Array(d),seq:0}}async _keyScheduleS(e,t,i,n){let a=await this._keySchedule(e,t,n);return a.key===void 0?new Gt(this._api,this._kdf,a.exporterSecret,i):new Rt(this._api,this._kdf,a,i)}async _keyScheduleR(e,t,i){let n=await this._keySchedule(e,t,i);return n.key===void 0?new Nt(this._api,this._kdf,n.exporterSecret):new Mt(this._api,this._kdf,n)}_validateInputLength(e){if(e.info!==void 0&&e.info.byteLength>65536)throw new F("Too long info");if(e.psk!==void 0){if(e.psk.key.byteLength<32)throw new F(`PSK must have at least ${32} bytes`);if(e.psk.key.byteLength>8192)throw new F("Too long psk.key");if(e.psk.id.byteLength>8192)throw new F("Too long psk.id")}}};var gt=class extends Ft{};var ps=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);var vs=new Uint8Array([48,70,2,1,0,48,5,6,3,43,101,111,4,58,4,56]);var An={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48},Sn={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},Kn={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};function En(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Vt(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function Xt(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function W(r,e,t=""){let i=En(r),n=r?.length,a=e!==void 0;if(!i||a&&n!==e){let o=t&&`"${t}" `,s=a?` of length ${e}`:"",c=i?`length=${n}`:`type=${typeof r}`;throw new Error(o+"expected Uint8Array"+s+", got "+c)}return r}function kr(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function ui(r,e){W(r,void 0,"output");let t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Ae(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function Se(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function Hn(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}var Ln=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function fi(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function hi(r,e){if(r.length!==e.length)return!1;let t=0;for(let i=0;i<r.length;i++)t|=r[i]^e[i];return t===0}var li=(r,e)=>{function t(i,...n){if(W(i,void 0,"key"),!Ln)throw new Error("Non little-endian hardware is not yet supported");if(r.nonceLength!==void 0){let f=n[0];W(f,r.varSizeNonce?void 0:r.nonceLength,"nonce")}let a=r.tagLength;a&&n[1]!==void 0&&W(n[1],void 0,"AAD");let o=e(i,...n),s=(f,u)=>{if(u!==void 0){if(f!==2)throw new Error("cipher output not supported");W(u,void 0,"output")}},c=!1;return{encrypt(f,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,W(f),s(o.encrypt.length,u),o.encrypt(f,u)},decrypt(f,u){if(W(f),a&&f.length<a)throw new Error('"ciphertext" expected length bigger than tagLength='+a);return s(o.decrypt.length,u),o.decrypt(f,u)}}}return Object.assign(t,r),t};function Pr(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error('"output" expected Uint8Array of length '+r+", got: "+e.length);if(t&&!In(e))throw new Error("invalid output, must be aligned");return e}function di(r,e,t){Vt(t);let i=new Uint8Array(16),n=Hn(i);return n.setBigUint64(0,BigInt(e),t),n.setBigUint64(8,BigInt(r),t),i}function In(r){return r.byteOffset%4===0}function at(r){return Uint8Array.from(r)}var pi=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),On=pi("expand 16-byte k"),Un=pi("expand 32-byte k"),Bn=Ae(On),jn=Ae(Un);function I(r,e){return r<<e|r>>>32-e}function Ar(r){return r.byteOffset%4===0}var $t=64,zn=16,yi=2**32-1,bi=Uint32Array.of();function Dn(r,e,t,i,n,a,o,s){let c=n.length,h=new Uint8Array($t),f=Ae(h),u=Ar(n)&&Ar(a),l=u?Ae(n):bi,p=u?Ae(a):bi;for(let w=0;w<c;o++){if(r(e,t,i,f,o,s),o>=yi)throw new Error("arx: counter overflow");let x=Math.min($t,c-w);if(u&&x===$t){let d=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let K=0,D;K<zn;K++)D=d+K,p[D]=l[D]^f[K];w+=$t;continue}for(let d=0,K;d<x;d++)K=w+d,a[K]=n[K]^h[d];w+=x}}function xi(r,e){let{allowShortKeys:t,extendNonceFn:i,counterLength:n,counterRight:a,rounds:o}=fi({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return Xt(n),Xt(o),Vt(a),Vt(t),(s,c,h,f,u=0)=>{W(s,void 0,"key"),W(c,void 0,"nonce"),W(h,void 0,"data");let l=h.length;if(f===void 0&&(f=new Uint8Array(l)),W(f,void 0,"output"),Xt(u),u<0||u>=yi)throw new Error("arx: counter overflow");if(f.length<l)throw new Error(`arx: output (${f.length}) is shorter than data (${l})`);let p=[],w=s.length,x,d;if(w===32)p.push(x=at(s)),d=jn;else if(w===16&&t)x=new Uint8Array(32),x.set(s),x.set(s,16),d=Bn,p.push(x);else throw W(s,32,"arx key"),new Error("invalid key size");Ar(c)||p.push(c=at(c));let K=Ae(x);if(i){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(d,K,Ae(c.subarray(0,16)),K),c=c.subarray(16)}let D=16-n;if(D!==c.length)throw new Error(`arx: nonce must be ${D} or 16 bytes`);if(D!==12){let C=new Uint8Array(12);C.set(c,a?0:12-c.length),c=C,p.push(c)}let y=Ae(c);return Dn(r,d,K,y,h,f,u,o),Se(...p),f}}function J(r,e){return r[e++]&255|(r[e++]&255)<<8}var Sr=class{constructor(e){Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:new Uint8Array(16)}),Object.defineProperty(this,"r",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(10)}),Object.defineProperty(this,"h",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(10)}),Object.defineProperty(this,"pad",{enumerable:!0,configurable:!0,writable:!0,value:new Uint16Array(8)}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e=at(W(e,32,"key"));let t=J(e,0),i=J(e,2),n=J(e,4),a=J(e,6),o=J(e,8),s=J(e,10),c=J(e,12),h=J(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|a<<9)&8191,this.r[4]=(a>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|s<<2)&8191,this.r[7]=(s>>>11|c<<5)&8065,this.r[8]=(c>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let f=0;f<8;f++)this.pad[f]=J(e,16+2*f)}process(e,t,i=!1){let n=i?0:2048,{h:a,r:o}=this,s=o[0],c=o[1],h=o[2],f=o[3],u=o[4],l=o[5],p=o[6],w=o[7],x=o[8],d=o[9],K=J(e,t+0),D=J(e,t+2),y=J(e,t+4),C=J(e,t+6),T=J(e,t+8),N=J(e,t+10),G=J(e,t+12),v=J(e,t+14),g=a[0]+(K&8191),P=a[1]+((K>>>13|D<<3)&8191),A=a[2]+((D>>>10|y<<6)&8191),k=a[3]+((y>>>7|C<<9)&8191),E=a[4]+((C>>>4|T<<12)&8191),m=a[5]+(T>>>1&8191),_=a[6]+((T>>>14|N<<2)&8191),H=a[7]+((N>>>11|G<<5)&8191),j=a[8]+((G>>>8|v<<8)&8191),L=a[9]+(v>>>5|n),b=0,O=b+g*s+P*(5*d)+A*(5*x)+k*(5*w)+E*(5*p);b=O>>>13,O&=8191,O+=m*(5*l)+_*(5*u)+H*(5*f)+j*(5*h)+L*(5*c),b+=O>>>13,O&=8191;let z=b+g*c+P*s+A*(5*d)+k*(5*x)+E*(5*w);b=z>>>13,z&=8191,z+=m*(5*p)+_*(5*l)+H*(5*u)+j*(5*f)+L*(5*h),b+=z>>>13,z&=8191;let U=b+g*h+P*c+A*s+k*(5*d)+E*(5*x);b=U>>>13,U&=8191,U+=m*(5*w)+_*(5*p)+H*(5*l)+j*(5*u)+L*(5*f),b+=U>>>13,U&=8191;let se=b+g*f+P*h+A*c+k*s+E*(5*d);b=se>>>13,se&=8191,se+=m*(5*x)+_*(5*w)+H*(5*p)+j*(5*l)+L*(5*u),b+=se>>>13,se&=8191;let he=b+g*u+P*f+A*h+k*c+E*s;b=he>>>13,he&=8191,he+=m*(5*d)+_*(5*x)+H*(5*w)+j*(5*p)+L*(5*l),b+=he>>>13,he&=8191;let ge=b+g*l+P*u+A*f+k*h+E*c;b=ge>>>13,ge&=8191,ge+=m*s+_*(5*d)+H*(5*x)+j*(5*w)+L*(5*p),b+=ge>>>13,ge&=8191;let le=b+g*p+P*l+A*u+k*f+E*h;b=le>>>13,le&=8191,le+=m*c+_*s+H*(5*d)+j*(5*x)+L*(5*w),b+=le>>>13,le&=8191;let de=b+g*w+P*p+A*l+k*u+E*f;b=de>>>13,de&=8191,de+=m*h+_*c+H*s+j*(5*d)+L*(5*x),b+=de>>>13,de&=8191;let be=b+g*x+P*w+A*p+k*l+E*u;b=be>>>13,be&=8191,be+=m*f+_*h+H*c+j*s+L*(5*d),b+=be>>>13,be&=8191;let _e=b+g*d+P*x+A*w+k*p+E*l;b=_e>>>13,_e&=8191,_e+=m*u+_*f+H*h+j*c+L*s,b+=_e>>>13,_e&=8191,b=(b<<2)+b|0,b=b+O|0,O=b&8191,b=b>>>13,z+=b,a[0]=O,a[1]=z,a[2]=U,a[3]=se,a[4]=he,a[5]=ge,a[6]=le,a[7]=de,a[8]=be,a[9]=_e}finalize(){let{h:e,pad:t}=this,i=new Uint16Array(10),n=e[1]>>>13;e[1]&=8191;for(let s=2;s<10;s++)e[s]+=n,n=e[s]>>>13,e[s]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let s=1;s<10;s++)i[s]=e[s]+n,n=i[s]>>>13,i[s]&=8191;i[9]-=8192;let a=(n^1)-1;for(let s=0;s<10;s++)i[s]&=a;a=~a;for(let s=0;s<10;s++)e[s]=e[s]&a|i[s];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let s=1;s<8;s++)o=(e[s]+t[s]|0)+(o>>>16)|0,e[s]=o&65535;Se(i)}update(e){kr(this),W(e),e=at(e);let{buffer:t,blockLen:i}=this,n=e.length;for(let a=0;a<n;){let o=Math.min(i-this.pos,n-a);if(o===i){for(;i<=n-a;a+=i)this.process(e,a);continue}t.set(e.subarray(a,a+o),this.pos),this.pos+=o,a+=o,this.pos===i&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){Se(this.h,this.r,this.buffer,this.pad)}digestInto(e){kr(this),ui(e,this),this.finished=!0;let{buffer:t,h:i}=this,{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let a=0;for(let o=0;o<8;o++)e[a++]=i[o]>>>0,e[a++]=i[o]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}};function Cn(r){let e=(i,n)=>r(n).update(i).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=i=>r(i),e}var wi=Cn(r=>new Sr(r));function Tn(r,e,t,i,n,a=20){let o=r[0],s=r[1],c=r[2],h=r[3],f=e[0],u=e[1],l=e[2],p=e[3],w=e[4],x=e[5],d=e[6],K=e[7],D=n,y=t[0],C=t[1],T=t[2],N=o,G=s,v=c,g=h,P=f,A=u,k=l,E=p,m=w,_=x,H=d,j=K,L=D,b=y,O=C,z=T;for(let se=0;se<a;se+=2)N=N+P|0,L=I(L^N,16),m=m+L|0,P=I(P^m,12),N=N+P|0,L=I(L^N,8),m=m+L|0,P=I(P^m,7),G=G+A|0,b=I(b^G,16),_=_+b|0,A=I(A^_,12),G=G+A|0,b=I(b^G,8),_=_+b|0,A=I(A^_,7),v=v+k|0,O=I(O^v,16),H=H+O|0,k=I(k^H,12),v=v+k|0,O=I(O^v,8),H=H+O|0,k=I(k^H,7),g=g+E|0,z=I(z^g,16),j=j+z|0,E=I(E^j,12),g=g+E|0,z=I(z^g,8),j=j+z|0,E=I(E^j,7),N=N+A|0,z=I(z^N,16),H=H+z|0,A=I(A^H,12),N=N+A|0,z=I(z^N,8),H=H+z|0,A=I(A^H,7),G=G+k|0,L=I(L^G,16),j=j+L|0,k=I(k^j,12),G=G+k|0,L=I(L^G,8),j=j+L|0,k=I(k^j,7),v=v+E|0,b=I(b^v,16),m=m+b|0,E=I(E^m,12),v=v+E|0,b=I(b^v,8),m=m+b|0,E=I(E^m,7),g=g+P|0,O=I(O^g,16),_=_+O|0,P=I(P^_,12),g=g+P|0,O=I(O^g,8),_=_+O|0,P=I(P^_,7);let U=0;i[U++]=o+N|0,i[U++]=s+G|0,i[U++]=c+v|0,i[U++]=h+g|0,i[U++]=f+P|0,i[U++]=u+A|0,i[U++]=l+k|0,i[U++]=p+E|0,i[U++]=w+m|0,i[U++]=x+_|0,i[U++]=d+H|0,i[U++]=K+j|0,i[U++]=D+L|0,i[U++]=y+b|0,i[U++]=C+O|0,i[U++]=T+z|0}var Nn=xi(Tn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Gn=new Uint8Array(16),mi=(r,e)=>{r.update(e);let t=e.length%16;t&&r.update(Gn.subarray(t))},Mn=new Uint8Array(32);function gi(r,e,t,i,n){n!==void 0&&W(n,void 0,"AAD");let a=r(e,t,Mn),o=di(i.length,n?n.length:0,!0),s=wi.create(a);n&&mi(s,n),mi(s,i),s.update(o);let c=s.digest();return Se(a,o),c}var Rn=r=>(e,t,i)=>({encrypt(a,o){let s=a.length;o=Pr(s+16,o,!1),o.set(a);let c=o.subarray(0,-16);r(e,t,c,c,1);let h=gi(r,e,t,c,i);return o.set(h,s),Se(h),o},decrypt(a,o){o=Pr(a.length-16,o,!1);let s=a.subarray(0,-16),c=a.subarray(-16),h=gi(r,e,t,s,i);if(!hi(c,h))throw new Error("invalid tag");return o.set(a.subarray(0,-16)),r(e,t,o,o,1),Se(h),o}}),Kr=li({blockSize:64,nonceLength:12,tagLength:16},Rn(Nn));var Er=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,t,i){return await this._seal(e,t,i)}async open(e,t,i){return await this._open(e,t,i)}_seal(e,t,i){return new Promise(n=>{let a=Kr(this._key,new Uint8Array(e),new Uint8Array(i)).encrypt(new Uint8Array(t));n(a.buffer)})}_open(e,t,i){return new Promise(n=>{let a=Kr(this._key,new Uint8Array(e),new Uint8Array(i)).decrypt(new Uint8Array(t));n(a.buffer)})}},_t=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:te.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new Er(e)}};var Fn=BigInt(1),_i=BigInt(2),Vn=BigInt(3),Xn=BigInt(5),vi=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed");function $n(r){let e=BigInt(10),t=BigInt(20),i=BigInt(40),n=BigInt(80),a=vi,s=r*r%a*r%a,c=M(s,_i,a)*s%a,h=M(c,Fn,a)*r%a,f=M(h,Xn,a)*h%a,u=M(f,e,a)*f%a,l=M(u,t,a)*u%a,p=M(l,i,a)*l%a,w=M(p,n,a)*p%a,x=M(w,n,a)*p%a,d=M(x,e,a)*f%a;return{pow_p_5_8:M(d,_i,a)*r%a,b2:s}}function Wn(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}var vt=(()=>{let r=vi;return xt({P:r,type:"x25519",powPminus2:e=>{let{pow_p_5_8:t,b2:i}=$n(e);return Re(M(t,Vn,r)*i,r)},adjustScalarBytes:Wn})})();var Ke=class extends Ie{async extract(e,t){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)return et(wr,new Uint8Array(e),new Uint8Array(t)).buffer;let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",i,t)}};var ot="X25519",Wt=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=32,this._nSk=32}async serializePublicKey(e){try{return await this._serializePublicKey(e)}catch(t){throw new V(t)}}async deserializePublicKey(e){try{return await this._importRawKey(e,!0)}catch(t){throw new R(t)}}async serializePrivateKey(e){try{return await this._serializePrivateKey(e)}catch(t){throw new V(t)}}async deserializePrivateKey(e){try{return await this._importRawKey(e,!1)}catch(t){throw new R(t)}}async importKey(e,t,i){try{if(e==="raw")return await this._importRawKey(t,i);if(t instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(t,i)}catch(n){throw new R(n)}}async generateKeyPair(){try{let e=await vt.utils.randomSecretKey(),t=new $(ot,e,"private",Y);return{publicKey:await this.derivePublicKey(t),privateKey:t}}catch(e){throw new X(e)}}async deriveKeyPair(e){try{let t=await this._hkdf.labeledExtract(B.buffer,ye,new Uint8Array(e)),i=await this._hkdf.labeledExpand(t,Le,B,this._nSk),n=new $(ot,new Uint8Array(i),"private",Y);return{privateKey:n,publicKey:await this.derivePublicKey(n)}}catch(t){throw new ne(t)}}async derivePublicKey(e){try{return await this._derivePublicKey(e)}catch(t){throw new R(t)}}async dh(e,t){try{return await this._dh(e,t)}catch(i){throw new V(i)}}async derive(e,t){try{return await this._derive(e,t)}catch(i){throw new V(i)}}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_serializePrivateKey(e){return new Promise(t=>{t(e.key.buffer)})}_importRawKey(e,t){return new Promise((i,n)=>{t&&e.byteLength!==this._nPk&&n(new Error("Invalid length of the key")),!t&&e.byteLength!==this._nSk&&n(new Error("Invalid length of the key")),i(new $(ot,new Uint8Array(e),t?"public":"private",t?[]:Y))})}_importJWK(e,t){return new Promise((i,n)=>{(typeof e.kty>"u"||e.kty!=="OKP")&&n(new Error(`Invalid kty: ${e.kty}`)),(typeof e.crv>"u"||e.crv!=="X25519")&&n(new Error(`Invalid crv: ${e.crv}`)),t?(typeof e.d<"u"&&n(new Error("Invalid key: `d` should not be set")),typeof e.x>"u"&&n(new Error("Invalid key: `x` not found")),i(new $(ot,ue(e.x),"public"))):(typeof e.d!="string"&&n(new Error("Invalid key: `d` not found")),i(new $(ot,ue(e.d),"private",Y)))})}_derivePublicKey(e){return new Promise((t,i)=>{try{let n=vt.getPublicKey(e.key);t(new $(ot,n,"public"))}catch(n){i(n)}})}_dh(e,t){return new Promise((i,n)=>{try{i(vt.getSharedSecret(e.key,t.key).buffer)}catch(a){n(a)}})}_derive(e,t){return new Promise((i,n)=>{try{i(vt.getSharedSecret(e,t))}catch(a){n(a)}})}},kt=class extends re{constructor(){let e=new Ke;super(S.DhkemX25519HkdfSha256,new Wt(e),e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:S.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};var Ee=class extends Oe{async extract(e,t){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)return et(mr,new Uint8Array(e),new Uint8Array(t)).buffer;let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",i,t)}};var Ai=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Yn=BigInt(1),Hr=BigInt(2),ki=BigInt(3),qn=BigInt(11),Jn=BigInt(22),Pi=BigInt(44),Zn=BigInt(88),Qn=BigInt(223);function ea(r){let e=Ai,t=r*r*r%e,i=t*t*r%e,n=M(i,ki,e)*i%e,a=M(n,ki,e)*i%e,o=M(a,Hr,e)*t%e,s=M(o,qn,e)*o%e,c=M(s,Jn,e)*s%e,h=M(c,Pi,e)*c%e,f=M(h,Zn,e)*h%e,u=M(f,Pi,e)*c%e,l=M(u,Hr,e)*t%e,p=M(l,Yn,e)*r%e;return M(p,Qn,e)*l%e}function ta(r){return r[0]&=252,r[55]|=128,r[56]=0,r}var Yt=(()=>{let r=Ai;return xt({P:r,type:"x448",powPminus2:e=>{let t=ea(e),i=M(t,Hr,r);return Re(i*e,r)},adjustScalarBytes:ta})})();var st="X448",Pt=class{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){try{return await this._serializePublicKey(e)}catch(t){throw new V(t)}}async deserializePublicKey(e){try{return await this._importRawKey(e,!0)}catch(t){throw new R(t)}}async serializePrivateKey(e){try{return await this._serializePrivateKey(e)}catch(t){throw new V(t)}}async deserializePrivateKey(e){try{return await this._importRawKey(e,!1)}catch(t){throw new R(t)}}async importKey(e,t,i){try{if(e==="raw")return await this._importRawKey(t,i);if(t instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(t,i)}catch(n){throw new R(n)}}async generateKeyPair(){try{let e=await Yt.utils.randomSecretKey(),t=new $(st,e,"private",Y);return{publicKey:await this.derivePublicKey(t),privateKey:t}}catch(e){throw new X(e)}}async deriveKeyPair(e){try{let t=await this._hkdf.labeledExtract(B.buffer,ye,new Uint8Array(e)),i=await this._hkdf.labeledExpand(t,Le,B,this._nSk),n=new $(st,new Uint8Array(i),"private",Y);return{privateKey:n,publicKey:await this.derivePublicKey(n)}}catch(t){throw new ne(t)}}async derivePublicKey(e){try{return await this._derivePublicKey(e)}catch(t){throw new R(t)}}async dh(e,t){try{return await this._dh(e,t)}catch(i){throw new V(i)}}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_serializePrivateKey(e){return new Promise(t=>{t(e.key.buffer)})}_importRawKey(e,t){return new Promise((i,n)=>{t&&e.byteLength!==this._nPk&&n(new Error("Invalid length of the key")),!t&&e.byteLength!==this._nSk&&n(new Error("Invalid length of the key")),i(new $(st,new Uint8Array(e),t?"public":"private",t?[]:Y))})}_importJWK(e,t){return new Promise((i,n)=>{e.kty!=="OKP"&&n(new Error(`Invalid kty: ${e.kty}`)),e.crv!=="X448"&&n(new Error(`Invalid crv: ${e.crv}`)),t?(typeof e.d<"u"&&n(new Error("Invalid key: `d` should not be set")),typeof e.x!="string"&&n(new Error("Invalid key: `x` not found")),i(new $(st,ue(e.x),"public"))):(typeof e.d!="string"&&n(new Error("Invalid key: `d` not found")),i(new $(st,ue(e.d),"private",Y)))})}_derivePublicKey(e){return new Promise((t,i)=>{try{let n=Yt.getPublicKey(e.key);t(new $(st,n,"public"))}catch(n){i(n)}})}_dh(e,t){return new Promise((i,n)=>{try{i(Yt.getSharedSecret(e.key,t.key).buffer)}catch(a){n(a)}})}};var At=class extends re{constructor(){let e=new Ee;super(S.DhkemX448HkdfSha512,new Pt(e),e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:S.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}};function ra(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Si(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function ut(r,...e){if(!ra(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function Ki(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Si(r.outputLen),Si(r.blockLen)}function ft(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Ei(r,e){ut(r);let t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function Fe(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}function qt(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function ia(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function St(r){return typeof r=="string"&&(r=ia(r)),ut(r),r}var ct=class{};function Hi(r){let e=i=>r().update(St(i)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}var Jt=class extends ct{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Ki(e);let i=St(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,a=new Uint8Array(n);a.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<a.length;o++)a[o]^=54;this.iHash.update(a),this.oHash=e.create();for(let o=0;o<a.length;o++)a[o]^=106;this.oHash.update(a),Fe(a)}update(e){return ft(this),this.iHash.update(e),this}digestInto(e){ft(this),ut(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:i,finished:n,destroyed:a,blockLen:o,outputLen:s}=this;return e=e,e.finished=n,e.destroyed=a,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Lr=(r,e,t)=>new Jt(r,e).update(t).digest();Lr.create=(r,e)=>new Jt(r,e);function na(r,e,t,i){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,i);let n=BigInt(32),a=BigInt(4294967295),o=Number(t>>n&a),s=Number(t&a),c=i?4:0,h=i?0:4;r.setUint32(e+c,o,i),r.setUint32(e+h,s,i)}var Zt=class extends ct{constructor(e,t,i,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(e),this.view=qt(this.buffer)}update(e){ft(this),e=St(e),ut(e);let{view:t,buffer:i,blockLen:n}=this,a=e.length;for(let o=0;o<a;){let s=Math.min(n-this.pos,a-o);if(s===n){let c=qt(e);for(;n<=a-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ft(this),Ei(e,this),this.finished=!0;let{buffer:t,view:i,blockLen:n,isLE:a}=this,{pos:o}=this;t[o++]=128,Fe(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(i,0),o=0);for(let u=o;u<n;u++)t[u]=0;na(i,n-8,BigInt(this.length*8),a),this.process(i,0);let s=qt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let h=c/4,f=this.get();if(h>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<h;u++)s.setUint32(4*u,f[u],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:i,length:n,finished:a,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=a,e.length=n,e.pos=s,n%t&&e.buffer.set(i),e}clone(){return this._cloneInto()}};var Z=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Q=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var Qt=BigInt(4294967295),Li=BigInt(32);function aa(r,e=!1){return e?{h:Number(r&Qt),l:Number(r>>Li&Qt)}:{h:Number(r>>Li&Qt)|0,l:Number(r&Qt)|0}}function Ii(r,e=!1){let t=r.length,i=new Uint32Array(t),n=new Uint32Array(t);for(let a=0;a<t;a++){let{h:o,l:s}=aa(r[a],e);[i[a],n[a]]=[o,s]}return[i,n]}var Ir=(r,e,t)=>r>>>t,Or=(r,e,t)=>r<<32-t|e>>>t,Ve=(r,e,t)=>r>>>t|e<<32-t,Xe=(r,e,t)=>r<<32-t|e>>>t,Kt=(r,e,t)=>r<<64-t|e>>>t-32,Et=(r,e,t)=>r>>>t-32|e<<64-t;function me(r,e,t,i){let n=(e>>>0)+(i>>>0);return{h:r+t+(n/2**32|0)|0,l:n|0}}var Oi=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),Ui=(r,e,t,i)=>e+t+i+(r/2**32|0)|0,Bi=(r,e,t,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0),ji=(r,e,t,i,n)=>e+t+i+n+(r/2**32|0)|0,zi=(r,e,t,i,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(i>>>0)+(n>>>0),Di=(r,e,t,i,n,a)=>e+t+i+n+a+(r/2**32|0)|0;var Ci=Ii(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),sa=Ci[0],ca=Ci[1],ze=new Uint32Array(80),De=new Uint32Array(80),er=class extends Zt{constructor(e=64){super(128,e,16,!1),this.Ah=Q[0]|0,this.Al=Q[1]|0,this.Bh=Q[2]|0,this.Bl=Q[3]|0,this.Ch=Q[4]|0,this.Cl=Q[5]|0,this.Dh=Q[6]|0,this.Dl=Q[7]|0,this.Eh=Q[8]|0,this.El=Q[9]|0,this.Fh=Q[10]|0,this.Fl=Q[11]|0,this.Gh=Q[12]|0,this.Gl=Q[13]|0,this.Hh=Q[14]|0,this.Hl=Q[15]|0}get(){let{Ah:e,Al:t,Bh:i,Bl:n,Ch:a,Cl:o,Dh:s,Dl:c,Eh:h,El:f,Fh:u,Fl:l,Gh:p,Gl:w,Hh:x,Hl:d}=this;return[e,t,i,n,a,o,s,c,h,f,u,l,p,w,x,d]}set(e,t,i,n,a,o,s,c,h,f,u,l,p,w,x,d){this.Ah=e|0,this.Al=t|0,this.Bh=i|0,this.Bl=n|0,this.Ch=a|0,this.Cl=o|0,this.Dh=s|0,this.Dl=c|0,this.Eh=h|0,this.El=f|0,this.Fh=u|0,this.Fl=l|0,this.Gh=p|0,this.Gl=w|0,this.Hh=x|0,this.Hl=d|0}process(e,t){for(let y=0;y<16;y++,t+=4)ze[y]=e.getUint32(t),De[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){let C=ze[y-15]|0,T=De[y-15]|0,N=Ve(C,T,1)^Ve(C,T,8)^Ir(C,T,7),G=Xe(C,T,1)^Xe(C,T,8)^Or(C,T,7),v=ze[y-2]|0,g=De[y-2]|0,P=Ve(v,g,19)^Kt(v,g,61)^Ir(v,g,6),A=Xe(v,g,19)^Et(v,g,61)^Or(v,g,6),k=Bi(G,A,De[y-7],De[y-16]),E=ji(k,N,P,ze[y-7],ze[y-16]);ze[y]=E|0,De[y]=k|0}let{Ah:i,Al:n,Bh:a,Bl:o,Ch:s,Cl:c,Dh:h,Dl:f,Eh:u,El:l,Fh:p,Fl:w,Gh:x,Gl:d,Hh:K,Hl:D}=this;for(let y=0;y<80;y++){let C=Ve(u,l,14)^Ve(u,l,18)^Kt(u,l,41),T=Xe(u,l,14)^Xe(u,l,18)^Et(u,l,41),N=u&p^~u&x,G=l&w^~l&d,v=zi(D,T,G,ca[y],De[y]),g=Di(v,K,C,N,sa[y],ze[y]),P=v|0,A=Ve(i,n,28)^Kt(i,n,34)^Kt(i,n,39),k=Xe(i,n,28)^Et(i,n,34)^Et(i,n,39),E=i&a^i&s^a&s,m=n&o^n&c^o&c;K=x|0,D=d|0,x=p|0,d=w|0,p=u|0,w=l|0,{h:u,l}=me(h|0,f|0,g|0,P|0),h=s|0,f=c|0,s=a|0,c=o|0,a=i|0,o=n|0;let _=Oi(P,k,m);i=Ui(_,g,A,E),n=_|0}({h:i,l:n}=me(this.Ah|0,this.Al|0,i|0,n|0)),{h:a,l:o}=me(this.Bh|0,this.Bl|0,a|0,o|0),{h:s,l:c}=me(this.Ch|0,this.Cl|0,s|0,c|0),{h,l:f}=me(this.Dh|0,this.Dl|0,h|0,f|0),{h:u,l}=me(this.Eh|0,this.El|0,u|0,l|0),{h:p,l:w}=me(this.Fh|0,this.Fl|0,p|0,w|0),{h:x,l:d}=me(this.Gh|0,this.Gl|0,x|0,d|0),{h:K,l:D}=me(this.Hh|0,this.Hl|0,K|0,D|0),this.set(i,n,a,o,s,c,h,f,u,l,p,w,x,d,K,D)}roundClean(){Fe(ze,De)}destroy(){Fe(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},tr=class extends er{constructor(){super(48),this.Ah=Z[0]|0,this.Al=Z[1]|0,this.Bh=Z[2]|0,this.Bl=Z[3]|0,this.Ch=Z[4]|0,this.Cl=Z[5]|0,this.Dh=Z[6]|0,this.Dl=Z[7]|0,this.Eh=Z[8]|0,this.El=Z[9]|0,this.Fh=Z[10]|0,this.Fl=Z[11]|0,this.Gh=Z[12]|0,this.Gl=Z[13]|0,this.Hh=Z[14]|0,this.Hl=Z[15]|0}};var Ti=Hi(()=>new tr);var Ni=Ti;var ht=class extends Ne{async extract(e,t){if(await this._setup(),e.byteLength===0&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)return Lr(Ni,new Uint8Array(e),new Uint8Array(t)).buffer;let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",i,t)}};var rr=class extends re{constructor(){let e=new Ke,t=new xe(S.DhkemP256HkdfSha256,e);super(S.DhkemP256HkdfSha256,t,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:S.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}};var ir=class extends re{constructor(){let e=new ht,t=new xe(S.DhkemP384HkdfSha384,e);super(S.DhkemP384HkdfSha384,t,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:S.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}};var nr=class extends re{constructor(){let e=new Ee,t=new xe(S.DhkemP521HkdfSha512,e);super(S.DhkemP521HkdfSha512,t,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:S.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}};var Ur=class extends gt{constructor(e){if(typeof e.kem=="number")switch(e.kem){case S.DhkemP256HkdfSha256:e.kem=new rr;break;case S.DhkemP384HkdfSha384:e.kem=new ir;break;case S.DhkemP521HkdfSha512:e.kem=new nr;break;case S.DhkemX25519HkdfSha256:e.kem=new kt;break;case S.DhkemX448HkdfSha512:e.kem=new At;break;default:throw new F(`The KEM (${e.kem}) cannot be specified by KemId. Use submodule for the KEM`)}if(typeof e.kdf=="number")switch(e.kdf){case ce.HkdfSha256:e.kdf=new Ke;break;case ce.HkdfSha384:e.kdf=new ht;break;default:e.kdf=new Ee;break}if(typeof e.aead=="number")switch(e.aead){case te.Aes128Gcm:e.aead=new rt;break;case te.Aes256Gcm:e.aead=new wt;break;case te.Chacha20Poly1305:e.aead=new _t;break;default:e.aead=new mt;break}super(e)}async generateKeyPair(){return await this._setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){return await this._setup(),await this._kem.deriveKeyPair(e)}async importKey(e,t,i=!0){return await this._setup(),await this._kem.importKey(e,t,i)}};export{Kn as Aead,te as AeadId,Ur as CipherSuite,We as DecapError,ne as DeriveKeyPairError,R as DeserializeError,$e as EncapError,Ye as ExportError,ee as HpkeError,F as InvalidParamError,Sn as Kdf,ce as KdfId,An as Kem,S as KemId,Ze as MessageLimitReachedError,X as NotSupportedError,Je as OpenError,qe as SealError,V as SerializeError,Ht as ValidationError};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
