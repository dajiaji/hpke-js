function q(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`positive integer expected, not ${r}`)}function ee(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}function te(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function N(r,...e){if(!te(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function re(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function we(r,e){N(r);let s=e.outputLen;if(r.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}var $=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),de=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Be=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Be)throw new Error("Non little-endian hardware is not supported");function Te(r){if(typeof r!="string")throw new Error(`string expected, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function J(r){if(typeof r=="string")r=Te(r);else if(te(r))r=r.slice();else throw new Error(`Uint8Array expected, got ${typeof r}`);return r}function xe(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function be(r,e){if(r.length!==e.length)return!1;let s=0;for(let t=0;t<r.length;t++)s|=r[t]^e[t];return s===0}var ie=(r,e)=>(Object.assign(e,r),e);function ne(r,e,s,t){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,s,t);let o=BigInt(32),i=BigInt(4294967295),a=Number(s>>o&i),n=Number(s&i),c=t?4:0,h=t?0:4;r.setUint32(e+c,a,t),r.setUint32(e+h,n,t)}var O=(r,e)=>r[e++]&255|(r[e++]&255)<<8,se=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=J(e),N(e,32);let s=O(e,0),t=O(e,2),o=O(e,4),i=O(e,6),a=O(e,8),n=O(e,10),c=O(e,12),h=O(e,14);this.r[0]=s&8191,this.r[1]=(s>>>13|t<<3)&8191,this.r[2]=(t>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|n<<2)&8191,this.r[7]=(n>>>11|c<<5)&8065,this.r[8]=(c>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let u=0;u<8;u++)this.pad[u]=O(e,16+2*u)}process(e,s,t=!1){let o=t?0:2048,{h:i,r:a}=this,n=a[0],c=a[1],h=a[2],u=a[3],d=a[4],b=a[5],x=a[6],p=a[7],w=a[8],y=a[9],g=O(e,s+0),_=O(e,s+2),B=O(e,s+4),D=O(e,s+6),M=O(e,s+8),R=O(e,s+10),C=O(e,s+12),j=O(e,s+14),m=i[0]+(g&8191),K=i[1]+((g>>>13|_<<3)&8191),P=i[2]+((_>>>10|B<<6)&8191),A=i[3]+((B>>>7|D<<9)&8191),v=i[4]+((D>>>4|M<<12)&8191),U=i[5]+(M>>>1&8191),k=i[6]+((M>>>14|R<<2)&8191),E=i[7]+((R>>>11|C<<5)&8191),S=i[8]+((C>>>8|j<<8)&8191),L=i[9]+(j>>>5|o),l=0,I=l+m*n+K*(5*y)+P*(5*w)+A*(5*p)+v*(5*x);l=I>>>13,I&=8191,I+=U*(5*b)+k*(5*d)+E*(5*u)+S*(5*h)+L*(5*c),l+=I>>>13,I&=8191;let T=l+m*c+K*n+P*(5*y)+A*(5*w)+v*(5*p);l=T>>>13,T&=8191,T+=U*(5*x)+k*(5*b)+E*(5*d)+S*(5*u)+L*(5*h),l+=T>>>13,T&=8191;let z=l+m*h+K*c+P*n+A*(5*y)+v*(5*w);l=z>>>13,z&=8191,z+=U*(5*p)+k*(5*x)+E*(5*b)+S*(5*d)+L*(5*u),l+=z>>>13,z&=8191;let H=l+m*u+K*h+P*c+A*n+v*(5*y);l=H>>>13,H&=8191,H+=U*(5*w)+k*(5*p)+E*(5*x)+S*(5*b)+L*(5*d),l+=H>>>13,H&=8191;let G=l+m*d+K*u+P*h+A*c+v*n;l=G>>>13,G&=8191,G+=U*(5*y)+k*(5*w)+E*(5*p)+S*(5*x)+L*(5*b),l+=G>>>13,G&=8191;let F=l+m*b+K*d+P*u+A*h+v*c;l=F>>>13,F&=8191,F+=U*n+k*(5*y)+E*(5*w)+S*(5*p)+L*(5*x),l+=F>>>13,F&=8191;let Y=l+m*x+K*b+P*d+A*u+v*h;l=Y>>>13,Y&=8191,Y+=U*c+k*n+E*(5*y)+S*(5*w)+L*(5*p),l+=Y>>>13,Y&=8191;let X=l+m*p+K*x+P*b+A*d+v*u;l=X>>>13,X&=8191,X+=U*h+k*c+E*n+S*(5*y)+L*(5*w),l+=X>>>13,X&=8191;let Z=l+m*w+K*p+P*x+A*b+v*d;l=Z>>>13,Z&=8191,Z+=U*u+k*h+E*c+S*n+L*(5*y),l+=Z>>>13,Z&=8191;let W=l+m*y+K*w+P*p+A*x+v*b;l=W>>>13,W&=8191,W+=U*d+k*u+E*h+S*c+L*n,l+=W>>>13,W&=8191,l=(l<<2)+l|0,l=l+I|0,I=l&8191,l=l>>>13,T+=l,i[0]=I,i[1]=T,i[2]=z,i[3]=H,i[4]=G,i[5]=F,i[6]=Y,i[7]=X,i[8]=Z,i[9]=W}finalize(){let{h:e,pad:s}=this,t=new Uint16Array(10),o=e[1]>>>13;e[1]&=8191;for(let n=2;n<10;n++)e[n]+=o,o=e[n]>>>13,e[n]&=8191;e[0]+=o*5,o=e[0]>>>13,e[0]&=8191,e[1]+=o,o=e[1]>>>13,e[1]&=8191,e[2]+=o,t[0]=e[0]+5,o=t[0]>>>13,t[0]&=8191;for(let n=1;n<10;n++)t[n]=e[n]+o,o=t[n]>>>13,t[n]&=8191;t[9]-=8192;let i=(o^1)-1;for(let n=0;n<10;n++)t[n]&=i;i=~i;for(let n=0;n<10;n++)e[n]=e[n]&i|t[n];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+s[0];e[0]=a&65535;for(let n=1;n<8;n++)a=(e[n]+s[n]|0)+(a>>>16)|0,e[n]=a&65535}update(e){re(this);let{buffer:s,blockLen:t}=this;e=J(e);let o=e.length;for(let i=0;i<o;){let a=Math.min(t-this.pos,o-i);if(a===t){for(;t<=o-i;i+=t)this.process(e,i);continue}s.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===t&&(this.process(s,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){re(this),we(e,this),this.finished=!0;let{buffer:s,h:t}=this,{pos:o}=this;if(o){for(s[o++]=1;o<16;o++)s[o]=0;this.process(s,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)e[i++]=t[a]>>>0,e[i++]=t[a]>>>8;return e}digest(){let{buffer:e,outputLen:s}=this;this.digestInto(e);let t=e.slice(0,s);return this.destroy(),t}};function De(r){let e=(t,o)=>r(o).update(J(t)).digest(),s=r(new Uint8Array(32));return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=t=>r(t),e}var ge=De(r=>new se(r));var me=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),Oe=me("expand 16-byte k"),Re=me("expand 32-byte k"),Ce=$(Oe),Ke=$(Re),lt=Ke.slice();function f(r,e){return r<<e|r>>>32-e}function oe(r){return r.byteOffset%4===0}var V=64,je=16,Pe=2**32-1,_e=new Uint32Array;function Ne(r,e,s,t,o,i,a,n){let c=o.length,h=new Uint8Array(V),u=$(h),d=oe(o)&&oe(i),b=d?$(o):_e,x=d?$(i):_e;for(let p=0;p<c;a++){if(r(e,s,t,u,a,n),a>=Pe)throw new Error("arx: counter overflow");let w=Math.min(V,c-p);if(d&&w===V){let y=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let g=0,_;g<je;g++)_=y+g,x[_]=b[_]^u[g];p+=V;continue}for(let y=0,g;y<w;y++)g=p+y,i[g]=o[g]^h[y];p+=w}}function ae(r,e){let{allowShortKeys:s,extendNonceFn:t,counterLength:o,counterRight:i,rounds:a}=xe({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return q(o),q(a),ee(i),ee(s),(n,c,h,u,d=0)=>{N(n),N(c),N(h);let b=h.length;if(u||(u=new Uint8Array(b)),N(u),q(d),d<0||d>=Pe)throw new Error("arx: counter overflow");if(u.length<b)throw new Error(`arx: output (${u.length}) is shorter than data (${b})`);let x=[],p=n.length,w,y;if(p===32)w=n.slice(),x.push(w),y=Ke;else if(p===16&&s)w=new Uint8Array(32),w.set(n),w.set(n,16),y=Ce,x.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);oe(c)||(c=c.slice(),x.push(c));let g=$(w);if(t){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");t(y,g,$(c.subarray(0,16)),g),c=c.subarray(16)}let _=16-o;if(_!==c.length)throw new Error(`arx: nonce must be ${_} or 16 bytes`);if(_!==12){let D=new Uint8Array(12);D.set(c,i?0:12-c.length),c=D,x.push(c)}let B=$(c);for(Ne(r,y,g,B,h,u,d,a);x.length>0;)x.pop().fill(0);return u}}function Ue(r,e,s,t,o,i=20){let a=r[0],n=r[1],c=r[2],h=r[3],u=e[0],d=e[1],b=e[2],x=e[3],p=e[4],w=e[5],y=e[6],g=e[7],_=o,B=s[0],D=s[1],M=s[2],R=a,C=n,j=c,m=h,K=u,P=d,A=b,v=x,U=p,k=w,E=y,S=g,L=_,l=B,I=D,T=M;for(let H=0;H<i;H+=2)R=R+K|0,L=f(L^R,16),U=U+L|0,K=f(K^U,12),R=R+K|0,L=f(L^R,8),U=U+L|0,K=f(K^U,7),C=C+P|0,l=f(l^C,16),k=k+l|0,P=f(P^k,12),C=C+P|0,l=f(l^C,8),k=k+l|0,P=f(P^k,7),j=j+A|0,I=f(I^j,16),E=E+I|0,A=f(A^E,12),j=j+A|0,I=f(I^j,8),E=E+I|0,A=f(A^E,7),m=m+v|0,T=f(T^m,16),S=S+T|0,v=f(v^S,12),m=m+v|0,T=f(T^m,8),S=S+T|0,v=f(v^S,7),R=R+P|0,T=f(T^R,16),E=E+T|0,P=f(P^E,12),R=R+P|0,T=f(T^R,8),E=E+T|0,P=f(P^E,7),C=C+A|0,L=f(L^C,16),S=S+L|0,A=f(A^S,12),C=C+A|0,L=f(L^C,8),S=S+L|0,A=f(A^S,7),j=j+v|0,l=f(l^j,16),U=U+l|0,v=f(v^U,12),j=j+v|0,l=f(l^j,8),U=U+l|0,v=f(v^U,7),m=m+K|0,I=f(I^m,16),k=k+I|0,K=f(K^k,12),m=m+K|0,I=f(I^m,8),k=k+I|0,K=f(K^k,7);let z=0;t[z++]=a+R|0,t[z++]=n+C|0,t[z++]=c+j|0,t[z++]=h+m|0,t[z++]=u+K|0,t[z++]=d+P|0,t[z++]=b+A|0,t[z++]=x+v|0,t[z++]=p+U|0,t[z++]=w+k|0,t[z++]=y+E|0,t[z++]=g+S|0,t[z++]=_+L|0,t[z++]=B+l|0,t[z++]=D+I|0,t[z++]=M+T|0}function Me(r,e,s,t){let o=r[0],i=r[1],a=r[2],n=r[3],c=e[0],h=e[1],u=e[2],d=e[3],b=e[4],x=e[5],p=e[6],w=e[7],y=s[0],g=s[1],_=s[2],B=s[3];for(let M=0;M<20;M+=2)o=o+c|0,y=f(y^o,16),b=b+y|0,c=f(c^b,12),o=o+c|0,y=f(y^o,8),b=b+y|0,c=f(c^b,7),i=i+h|0,g=f(g^i,16),x=x+g|0,h=f(h^x,12),i=i+h|0,g=f(g^i,8),x=x+g|0,h=f(h^x,7),a=a+u|0,_=f(_^a,16),p=p+_|0,u=f(u^p,12),a=a+u|0,_=f(_^a,8),p=p+_|0,u=f(u^p,7),n=n+d|0,B=f(B^n,16),w=w+B|0,d=f(d^w,12),n=n+d|0,B=f(B^n,8),w=w+B|0,d=f(d^w,7),o=o+h|0,B=f(B^o,16),p=p+B|0,h=f(h^p,12),o=o+h|0,B=f(B^o,8),p=p+B|0,h=f(h^p,7),i=i+u|0,y=f(y^i,16),w=w+y|0,u=f(u^w,12),i=i+u|0,y=f(y^i,8),w=w+y|0,u=f(u^w,7),a=a+d|0,g=f(g^a,16),b=b+g|0,d=f(d^b,12),a=a+d|0,g=f(g^a,8),b=b+g|0,d=f(d^b,7),n=n+c|0,_=f(_^n,16),x=x+_|0,c=f(c^x,12),n=n+c|0,_=f(_^n,8),x=x+_|0,c=f(c^x,7);let D=0;t[D++]=o,t[D++]=i,t[D++]=a,t[D++]=n,t[D++]=y,t[D++]=g,t[D++]=_,t[D++]=B}var He=ae(Ue,{counterRight:!1,counterLength:4,allowShortKeys:!1}),$e=ae(Ue,{counterRight:!1,counterLength:8,extendNonceFn:Me,allowShortKeys:!1});var Ge=new Uint8Array(16),Ae=(r,e)=>{r.update(e);let s=e.length%16;s&&r.update(Ge.subarray(s))},Fe=new Uint8Array(32);function ve(r,e,s,t,o){let i=r(e,s,Fe),a=ge.create(i);o&&Ae(a,o),Ae(a,t);let n=new Uint8Array(16),c=de(n);ne(c,0,BigInt(o?o.length:0),!0),ne(c,8,BigInt(t.length),!0),a.update(n);let h=a.digest();return i.fill(0),h}var ke=r=>(e,s,t)=>(N(e,32),N(s),{encrypt:(i,a)=>{let n=i.length,c=n+16;a?N(a,c):a=new Uint8Array(c),r(e,s,i,a,1);let h=ve(r,e,s,a.subarray(0,-16),t);return a.set(h,n),a},decrypt:(i,a)=>{let n=i.length,c=n-16;if(n<16)throw new Error("encrypted data must be at least 16 bytes");a?N(a,c):a=new Uint8Array(c);let h=i.subarray(0,-16),u=i.subarray(-16),d=ve(r,e,s,h,t);if(!be(u,d))throw new Error("invalid tag");return r(e,s,h,a,1),a}}),fe=ie({blockSize:64,nonceLength:12,tagLength:16},ke(He)),dt=ie({blockSize:64,nonceLength:24,tagLength:16},ke($e));var Ye={},Xe=Ze(globalThis,Ye);function Ze(r,e){return new Proxy(r,{get(s,t,o){return t in e?e[t]:r[t]},set(s,t,o){return t in e&&delete e[t],r[t]=o,!0},deleteProperty(s,t){let o=!1;return t in e&&(delete e[t],o=!0),t in r&&(delete r[t],o=!0),o},ownKeys(s){let t=Reflect.ownKeys(r),o=Reflect.ownKeys(e),i=new Set(o);return[...t.filter(a=>!i.has(a)),...o]},defineProperty(s,t,o){return t in e&&delete e[t],Reflect.defineProperty(r,t,o),!0},getOwnPropertyDescriptor(s,t){return t in e?Reflect.getOwnPropertyDescriptor(e,t):Reflect.getOwnPropertyDescriptor(r,t)},has(s,t){return t in e||t in r}})}var ce={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};var Q=new Uint8Array(0);var le=new Uint8Array([75,69,77,0,0]);var zt=new Uint8Array([101,97,101,95,112,114,107]),It=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);var ue=new Uint8Array([100,107,112,95,112,114,107]),ze=new Uint8Array([115,107]);var Xt=new Uint8Array([99,97,110,100,105,100,97,116,101]),Zt=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),Wt=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),qt=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),Jt=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),Vt=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Qt=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);var ye=class{constructor(e){Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new Uint8Array(e)}async seal(e,s,t){return await this._seal(e,s,t)}async open(e,s,t){return await this._open(e,s,t)}_seal(e,s,t){return new Promise(o=>{let i=fe(this._key,new Uint8Array(e),new Uint8Array(t)).encrypt(new Uint8Array(s));o(i.buffer)})}_open(e,s,t){return new Promise(o=>{let i=fe(this._key,new Uint8Array(e),new Uint8Array(t)).decrypt(new Uint8Array(s));o(i.buffer)})}},pe=class{constructor(){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ce.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}createEncryptionContext(e){return new ye(e)}};export{pe as Chacha20Poly1305};
/*! Bundled license information:

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
